require=function(e,t,n){function i(n,s){if(!t[n]){if(!e[n]){var o="function"==typeof require&&require;if(!s&&o)return o(n,!0);if(r)return r(n,!0);throw new Error("Cannot find module '"+n+"'")}var a=t[n]={exports:{}};e[n][0].call(a.exports,function(t){var r=e[n][1][t];return i(r?r:t)},a,a.exports)}return t[n].exports}for(var r="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,n){var i=n.ActionQueue=function(){this.initialize.apply(this,arguments)};_.extend(i.prototype,{initialize:function(e){this.target=e,this.pendingActionOperations=[],this.pendingRequest=null,r.push(this)},createActionOperation:function(e,t,n){return{action:e,operation:t,options:n}},createOptions:function(e){var t=this,n=_.clone(e.options)||{},i=n.complete;n.complete=function(){if(t.pendingActionOperation!==e)throw new Error("Pending action was not expected action!");t.pendingActionOperation=null,i&&i.apply(this,arguments),t.startNextActionIfPossible()};var r=n.beforeSend;return n.beforeSend=function(){t.pendingActionOperation=e,r&&r.apply(this,arguments)},n},addOperation:function(e,t,n){var i=this.createActionOperation(e,t,n);this.pendingActionOperations.push(i),this.startNextActionIfPossible()},startNextActionIfPossible:function(){if(null==this.pendingActionOperation&&0!==this.pendingActionOperations.length){var e=this.pendingActionOperations.shift(),t=e.action,n=e.operation;t.refreshModel(),t[n].call(t,this.createOptions(e)),this.startNextActionIfPossible()}null==this.pendingActionOperations&&0===this.pendingActionOperations.length&&this.remove()},remove:function(){r=_.without(r,this)}});{var r=n.queues=[];n.findOrCreateQueue=function(e){var t=_.find(r,function(t){return t.target===e});return t||(t=new i(e)),t},n.countQueuedActions=function(){return _.reduce(r,function(e,t){var n=t.pendingActionOperation?1:0;return n+t.pendingActionOperations.length+e},0)}}},{}],2:[function(e,t,n){var i="X-CSRF-Token";n.headers=function(){var e={};return this.token&&(e[i]=this.token),e},n.addToken=function(e){this.token&&e.setRequestHeader(i,this.token)}},{}],3:[function(){!function(e){e.dev={add:function(e,t){Object.defineProperty(this,e,{get:t})}}}(self)},{}],4:[function(e,t){var n=function(e){return e.charCodeAt()};_.extend(n,{BACKSPACE:8,TAB:9,RETURN:13,OPTION:18,COMMAND:91,SHIFT:16,CTRL:17,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,Z:90}),t.exports=n},{}],5:[function(e,t){var n={action:function(e){var t=[null,this].concat(_.rest(arguments));return new(e.bind.apply(e,t))}};t.exports=n},{}],6:[function(e,t){var n={isLoaded:function(){return this.fetched},markDirty:function(){this.dirty=!0},needsFetch:function(){return this.dirty||!this.isLoaded()},fetchIfNeeded:function(e){this.needsFetch()&&this.fetch(e)},markFetched:function(){this.fetched=!0,this.dirty=!1},wrapHandlers:function(e,t){e=e?_.clone(e):{};var n=e.success;e.success=function(){t.markFetched(),n&&n.apply(null,arguments)};var i=e.complete;return e.complete=function(){t.syncing=!1,i&&i.apply(null,arguments)},e}};t.exports=function(e){var t=e.prototype;_.extend(t,n);var i=t.fetch;t.fetch=function(e){this.syncing||(this.syncing=!0,e=this.wrapHandlers(e,this),i.call(this,e))};var r=t.save;r&&(t.save=function(e,t,n){var i;this.syncing=!0,null==e||_.isObject(e)?(i=e,n=t):(i={})[e]=t,n=this.wrapHandlers(n,this),r.call(this,i,n)});var s=t.create;s&&(t.create=function(e,t){return t=t?_.clone(t):{},(e=this._prepareModel(e,t))?(e.syncing=!0,t=this.wrapHandlers(t,e),void s.call(this,e,t)):!1})},t.exports.methods=n},{}],7:[function(e,t){var n=t.exports=function(){this.initialize.apply(this,arguments)};_.extend(n.prototype,{initialize:function(e,t,n){this.records=e||[],this.fields=t||[],this.allRecords=n||[]},getValues:function(){return _(this.records).map(function(e){return _(this.fields).map(function(t){return e.getValue(t.get("key"))})},this)},isMultiselect:function(){var e=this.records.length,t=this.fields.length;return e*t>1}})},{}],8:[function(e,t){var n=function(e){this.model=e,this.idAttribute=e.prototype.idAttribute,this.objects={}};_.extend(n.prototype,{register:function(e){if(e.id)e.id in this.objects&&console.warn("object registered twice:",e),this.objects[e.id]=e;else{var t="change:"+this.idAttribute;e.once(t,_.bind(this.register,this))}},add:function(e,t){e=e||{};var n,i=e[this.idAttribute];i&&(n=this.objects[i]);var r=!n;return r&&(n=new this.model(_.pick(e,this.idAttribute),t),this.register(n)),n.set(e,_.extend({parse:!0},t)),!n.collection&&t&&(n.collection=t.collection),r&&n.postInitialize&&n.postInitialize(),n},find:function(e){var t=this.objects[e];if(t)return t;var n={};return n[this.idAttribute]=e,this.add(n)}}),n.addStore=function(e){_.extend(e,{store:new n(e),find:function(e){return this.store.find(e)},add:function(e,t){return this.store.add(e,t)}})},t.exports=n},{}],9:[function(){},{}],10:[function(e,t){t.exports={demo:"<p>Let us show you what you can do with Fieldbook.</p><b>Click the link</b> to explore an example book.",help:"<p>Need help?</p><p>Click here to search for an answer to your question.</p>",sheetview:"This is a Fieldbook sheet. You can edit it just like a spreadsheet (go ahead, give it a try!)",shortid:"<b>Click the ID number</b> to view the detail page for â€œ{{name}}â€.",grouped:"This is a grouped view. The records have been grouped by â€œ{{groupField}}â€.",singlegroup:"<p>This is a grouped view, but all the records have {{groupField}}: â€œ{{value}}â€, so they're all in the same group.</p><p>You might find it more useful to group on a different column.</p><p><b>Click this link</b> to ungroup.</p>",uniquegroup:"<p>This is a grouped view, but every record has a different value for â€œ{{groupField}}â€.</p><p>You might find it more interesting to group on a column that has only a handful of possible values.</p><p><b>Click this link</b> to ungroup.</p>",movegroup:"Drag and drop groups to put them in a custom order.",moverow:"Drag rows between groups to change their â€œ{{groupField}}â€ value.",pbar:"<p>This is more than just a search barâ€”itâ€™s the <b>Power Bar</b>.</p><p>It lets you search, filter, sort, group, and more. Try it out.</p>","+nav":"<p>You can save any combination of search, sort, group, etc. as a link on the left.</p><p><b>Click here</b> to save this query.</p>",link:"<p>The â€œ{{field}}â€ column is a link to sheet â€œ{{sheet}}â€. Each value links to one record in â€œ{{sheet}}â€. </p><p><b>Click here</b> to go directly to the linked record.</p>",detail:"<p>In Fieldbook, rows are treated like database records. Each has its own detail page.</p><p>This is the page for â€œ{{name}}â€. Itâ€™s like looking at just one row, laid out vertically.</p>",subsheet:"This is a subsheet. It shows everything from the â€œ{{source}}â€ sheet where â€œ{{link}}â€ = â€œ{{name}}.â€"}},{}],11:[function(e,t){function n(e,t,n){this.xAnchor=e,this.yAnchor=t,this.points=_.deepClone(n)}var i="hsl(45, 100%, 57%)",r="hsl(45, 100%, 47%)",s=16,o={x:1,y:2,blur:8,color:"rgba(0,0,0,0.3)"};_.extend(n.prototype,{adjustedShape:function(e,t){var i=new n(null,null,this.points);return i.points.forEach(function(n){"right"===this.xAnchor&&(n[0]=e-n[0]),"bottom"===this.yAnchor&&(n[1]=t-n[1])},this),i},getBounds:function(){var e=1/0,t=1/0,n=-1/0,i=-1/0;return this.points.forEach(function(r){e=Math.min(r[0],e),t=Math.min(r[1],t),n=Math.max(r[0],n),i=Math.max(r[1],i)}),{left:e,right:n,top:t,bottom:i}}});var a={top:new n("left","top",[[16,-40],[16,0],[32,0]]),"top-right":new n("right","top",[[16,-40],[16,0],[32,0]]),bottom:new n("left","bottom",[[16,-40],[16,0],[32,0]]),"bottom-right":new n("right","bottom",[[16,-40],[16,0],[32,0]]),left:new n("left","bottom",[[-40,18],[0,35],[0,14]])};t.exports=function(e,t,n){var l=a[n],c={top:0,left:0,right:e,bottom:t};if(l){l=l.adjustedShape(e,t);var u=l.getBounds();c={top:Math.min(c.top,u.top),left:Math.min(c.left,u.left),bottom:Math.max(c.bottom,u.bottom),right:Math.max(c.right,u.right)}}var h,d=o.blur,f={x:-c.left+d-o.x,y:-c.top+d-o.y};if(l){var p=l.points[0];h={left:-p[0],top:-p[1]}}else h={left:0,top:0};var m,g,v=window.devicePixelRatio||1;m=c.right-c.left+2*d,g=c.bottom-c.top+2*d;var y=$("<canvas>").prop({width:m*v,height:g*v}).css({left:-f.x,top:-f.y,width:m,height:g}),b=y[0].getContext("2d");b.scale(v,v),b.translate(f.x,f.y),b.beginPath(),b.moveTo(s,0),b.arcTo(e,0,e,t,s),b.arcTo(e,t,0,t,s),b.arcTo(0,t,0,0,s),b.arcTo(0,0,e,0,s),l&&(b.moveTo.apply(b,_.last(l.points)),l.points.forEach(function(e){b.lineTo.apply(b,e)})),b.closePath();var w=b.createLinearGradient(0,0,0,t);return w.addColorStop(0,i),w.addColorStop(1,r),b.fillStyle=w,b.shadowOffsetX=o.x,b.shadowOffsetY=o.y,b.shadowBlur=o.blur,b.shadowColor=o.color,b.fill(),$("<div>").addClass("tip-background").css(h).append(y)}},{}],12:[function(e,t,n){var i=n.supportedBrowserVersions={Chrome:35,Firefox:29,Safari:6,IE:10};n.isSupportedBrowser=function(e){var t=i[e.family];return void 0===t?!1:e.major>=t}},{}],13:[function(e,t){_.templateSettings={interpolate:/\{\{(.+?)\}\}/g};var n={title:"Fieldbook","demo-title":"Fieldbook Demo","title-bar":"Fieldbook",home:"Home","title-bar-help":"Help","title-bar-feedback":"Feedback","coming-soon":"Coming soon",demo:"Demo","join-us":"We're hiring!","demo-intro":"A new information tool coming soon","demo-register":"Register for the beta:","sign-up-google":"Sign up with Google","sign-in-google":"Sign in with Google","sign-out":"Sign out","not-ready-yet":"Thanks! Fieldbook is still in private beta. You're registered, and we'll let you know when you can try it out.","all-books":"All Books","new-book-title":"New book","new-sheet-title":"Records","new-subsheet-title":"Subrecords","copied-title":"{{title}} (copy)","default-field-name":"Field ","name-field-name":"Name","search-placeholder":"Try: keywords, column names, â€œwhereâ€, â€œsortâ€, â€œgroupâ€","save-search":"Save view","update-search":"Update view","save-search-as-new":"Save as new view",share:"Shareâ€¦","sheet-sharing-private":"Private to you. Click to share","sheet-sharing-one":"Shared with {{nameOrEmail}}","sheet-sharing-multiple":"Shared with {{count}} other users","export-csv":"Download as CSV","wrap-text":"Wrap text","copy-book":"Copy book","leave-book":"Leave book","delete-book":"Delete book","share-title":"Share book","shared-with":"Shared with:","shared-with-none":"Not shared with anyone yet.","share-explanation":"Users you share with can view and edit the book, and share with others.","invite-placeholder":"Enter an email address",invite:"Share","add-field":"+","add-sheet":"Add sheet","add-subsheet":"Add subsheet","book-links-title":"Your books","no-books":"None right now! Drag and drop a CSV file to import, or create a blank book:","blank-book":"New book","import-csv":"Import CSV","drag-and-drop-tip":"Pro tip: Drag CSV files here to import","drag-and-drop-fallback":"Drag-and-drop is not supported in your browser. Import a CSV here instead:","view-record":"View","new-group-nav-item-name":"By {{name}}","new-unnamed-field-group-nav-item-name":"Grouped","default-group-name":"(none)","default-field-display-name":"Field {{position}}","new-group-name":"New {{name}}","by-groups":"By {{fieldNames}}","named-value":"{{fieldName}}: {{displayValue}}","unknown-field":"Unknown Field","all-clump-value":"All","select-name-field":"Links to this page display as:",unnamed:"(no name)","unnamed-field-slug":"field_{{position}}",untitled:"(no title)","this-record":"(this record)","removed-user":"â€“ Removed","restore-user":"undo","test-errors":"Test errors","grouping-by":"Grouping by","custom-order-message":"Using custom order on","book-invite-message":"{{addedByUser.name}} has invited you to share this book at {{invitedUser.email}}. You are logged in as:","book-invite-options":"You can add this email address to your account to view the book, or log in as a different user to claim the invitation.","claim-invite":"Add {{invitedUser.email}} to {{currentUser.name}}","claim-invite-different-user":"Log in as a different user","confirm-leave-title":"Leave this book?","confirm-leave-message":"You can't undo this. To rejoin the book, someone will have to share it with you again.","confirm-leave":"Leave book","field-actions":"More field actions","delete-sheet":"Delete sheet","name-field":"Name column","rename-field":"Rename column","search-field":"Search column","sort-field":"Sort by this column","group-field":"Group by this column","report-on-field":"Show report based on this column","edit-report-formula":"Edit summary formula for this column","insert-report-column-before":"Insert formula column left","insert-report-column-after":"Insert formula column right","remove-report-column":'Remove column "{{name}}"',"set-field-aggregate":"Display formula at bottom","set-aggregate-is-current":"(current)","set-field-formula":"Set a formula for this column","set-field-name-header":"Display links in this column usingâ€¦","set-field-name-cell":"Display this link asâ€¦","add-link":"Make this column a link to sheetâ€¦","add-link-this-sheet":"(this sheet)","add-link-new-sheet":"New sheet","extract-supersheet":"Create new linked sheet from this column","remove-link":"Remove link to sheet â€œ{{linkedSheet.title}}â€","make-name-field":"Use column for link display text","name-field-explanation":"Any link to a row in this sheet will use the text in this column as the link display text. The same text appears as a title on the detail page for this row.","delete-field":"Delete column â€œ{{name}}â€","delete-unnamed-field":"Delete this column","insert-record-above":"Insert row above","insert-record-below":"Insert row below","delete-record":"Delete row {{number}}","delete-group":"Delete group â€œ{{name}}â€","delete-subsheet":"Delete subsheet â€œ{{name}}â€","search-cell-value":"Find â€œ{{keyword}}â€ in this sheet","filter-cell-value":"Filter for {{field.name}} = â€œ{{value}}â€","feedback-title-feedback":"Send us a message:","feedback-title-question":"Ask us a question:","feedback-send":"Send","feedback-sending":"Sendingâ€¦","feedback-success-feedback":"Sent! Thank you.","feedback-success-question":"Got it! We'll get back to you soon.","feedback-error":"Error; try support@fieldbookapp.com",ok:"OK",done:"Done",details:"Details",more:"More",loading:"Loadingâ€¦",undo:"Undo",redo:"Redo",cancel:"Cancel",remove:"remove",ungroup:"ungroup",reload:"Reload",id:"ID","admin-title":"Fieldbook Admin","admin-title-bar":"Fieldbook Admin","disabled-reason-delete-book":"Only the creator of a book can delete it.","disabled-reason-leave-book":"You can't leave this book because you created it.","name-field-disabled-for-link":"This field can't be used for link display text because it's a link to another sheet.","add-link-disabled-for-name-field":"Link options are disabled because this field is currently used for link display text. To link this field to another sheet, choose a different link display text field.","error-invite-self":"You already have access to this book; no need to share with yourself!","error-invite-existing":"{{name}} ({{email}}) already has access to this book.","error-duplicate-group-name":"There is already a group named â€œ{{group}}â€.","error-delete-nonempty-group":"This group still has records in it. Delete the records or move them to another group first.","error-no-user-with-email":"No user with email {{email}}","error-parse-formula":'Can\'t interpret formula: "{{badFormula}}" (Press esc to cancel)',"error-parse-formula-generic":"Can't interpret formula (syntax error)","error-unknown-operator-1":"Could not perform {{operator}} with {{a}}, unknown operator!","error-unknown-operator-2":"Could not perform {{a}} {{operator}} {{b}}, unknown operator!","error-data-add-dates":"Cannot add two dates","error-date-add-bad-type":"Cannot add a date and a {{otherType}}","error-subtraction":"Cannot perform {{aType}} - {{bType}}","error-value":"Error","error-unknown-context":"Could not find linked sheet for {{name}}","error-formula-unknown-field":"Could not find a referenced field (was it misspelled?)","error-formula-unknown-field-named":"Cannot interpret formula: â€œ{{input}}â€ is not a field","error-formula-circular":"Cannot make circular references with formulas, bad key: {{key}}","error-formula-unknown-function":'Cannot interpret formula: unknown function "{{name}}"',"error-formula-field-not-link":"Cannot interpret formula: â€œ{{dotExprLeft}}â€ is not a link field","error-report-formula-not-aggregate":"Function {{name}} is not an aggregate function","error-report-formula-too-many-args":"Summary formulas must have at most 1 argument","error-report-formula-too-few-args":"Function {{name}} requires at least {{count}} arguments","error-interpret-query-term":"Cannot interpret query term","error-interpret-query-term-colon":"Cannot interpret query term:","no-group-expression":"Need at least one column to group","no-sort-expression":"Need at least one column to sort by","book-error-forbidden-title":"Private","book-error-forbidden-message":"You don't have access to this book.","book-load-error-title":"Error loading book","book-load-error-message":"Either you're having a network problem, or you hit a bug.","action-working-add-link":"Linkingâ€¦","action-working-extract-supersheet":"Creating linked sheetâ€¦","action-working-remove-link":"Removing linkâ€¦","action-working-paste-changes":"Pasting changesâ€¦","action-success-add-link":"Linked field â€œ{{fieldName}}â€ to sheet â€œ{{sheetTitle}}â€.","action-success-delete-book":"Deleted book â€œ{{title}}â€.","action-success-delete-field":"Deleted field â€œ{{name}}â€.","action-success-hide-name":"Name field hidden.","action-success-delete-group":"Deleted group â€œ{{name}}â€.","action-success-delete-nav-item":"Deleted saved view â€œ{{name}}â€.","action-success-delete-record":"Deleted record.","action-success-delete-sheet":"Deleted sheet â€œ{{title}}.â€","action-success-delete-subsheet":"Deleted subsheet â€œ{{name}}â€.","action-success-extract-supersheet":"Created sheet â€œ{{title}}â€.","action-success-leave-book":"Left book â€œ{{title}}â€.","action-success-remove-link":"Removed link from field â€œ{{fieldName}}â€ to sheet â€œ{{sheetTitle}}â€.","error-template":"Error {{action}}. This is our fault. Refresh the page and try again?","action-add-book-user":"sharing sheet","action-add-link":"making link","action-set-aggregate":"setting aggregate","action-copy-book":"copying book","action-create-field":"adding field","action-create-nav-item":"saving view","action-create-sheet":"creating sheet","action-create-subsheet":"adding subsheet","action-delete-book":"deleting book","action-delete-book-user":"removing user","action-delete-field":"deleting field","action-hide-name":"hiding name field","action-delete-group":"deleting group","action-delete-nav-item":"deleting saved view â€œ{{name}}â€","action-delete-record":"deleting record","action-delete-sheet":"deleting sheet â€œ{{title}}â€","action-delete-subsheet":"deleting subsheet","action-group-field":"creating grouped view","action-insert-group":"inserting group","action-insert-record":"inserting record","action-leave-book":"leaving book","action-move-field":"moving column","action-redo":"redoing action","action-remove-link":"removing link from field","action-rename-group":"renaming group","action-rename-subsheet":"renaming subsheet","action-reorder-group":"moving group","action-reorder-record":"moving record","action-set-name-field":"setting link display text","action-undo":"undoing action","action-update-field-formula":"updating formula","action-update-field-name":"updating field name","action-update-field-width":"saving column width","action-update-record":"updating record","action-update-record-paste":"updating record for paste","action-update-title":"updating title","import-filetype-error":"You can only import from CSV files. The file â€œ{{name}}â€ appears to be of type {{type}}.","client-error":"Something went wrong, and it's our fault. Refresh the page and try again?","outstanding-requests-warning":"We're still saving your changes; if you leave or reload this page now, we might lose some of them.","aggregate-name-sum":"Sum","aggregate-name-max":"Max","aggregate-name-min":"Min","aggregate-name-avg":"Average","aggregate-name-blank":"Blanks","aggregate-name-count":"Count","aggregate-name-non-blank":"Nonblanks","aggregate-name-none":"None","aggregate-name-default":"Sum","aggregate-type-name-default":"Default","aggregate-name-rows":"Rows","aggregate-name-cols":"Columns","aggregate-name-cells":"Cells","formula-panel-text":"Set formula for this column:","report-formula-panel-text":"Set summary formula for this column:","formula-panel-save":"Save","formula-panel-equals":"ï¼",selection:"Selection","field-icon-link":"This field links to {{name}}","field-icon-name":"When other sheets link to here, the link text comes from this field","col-tip-name":"Enter name, title, or the equivalent for each record here; or hide this column","col-tip-id":"ID number for each record (automatically assigned)","pending-records-done-remove":'The record you were editing has been filtered by the query "{{query}}".',"pending-records-done-sort":"The record you were editing has been sorted to a new position.","pending-records-remove":'The record you are editing does not match the query "{{query}}". It will be hidden when you finish editing.',"pending-records-sort":"The record you are editing will be sorted to a new position when you finish editing.","help-ask":"Ask us a questionâ€¦","help-placeholder":"Search help by keyword","command-search-tip":"Search for keyword â€œ{{keyword}}â€","command-column-search-tip":"Search column â€œ{{column}}â€ for keyword â€œ{{keyword}}â€","command-where-tip":"Filter for records matching: {{formula}}","command-sort-tip":"Sort by â€œ{{column}}â€","command-sort-desc-tip":" (descending)","command-group-tip":"Group by â€œ{{column}}â€","command-more-tip":", then by â€œ{{column}}â€","context-name-sort-secondary-field":"secondary field","context-name-function":"function...","context-name-search-keyword":"keyword search","context-name-where-formula":"formula","context-name-by-column":"by column","context-name-report-summaries":"summary formulas on columns","context-name-default-where":"column search","context-name-default-where-keyword":"keyword","context-name-more-completions":"â€¦","context-name-value":"value","extra-completions":"{{amountOver}} more, type to search","completion-back":"Back","completion-done":"Done","log-render":"Called {{name}} on view {{cid}} with class: {{className}}","trackjs-url":"https://my.trackjs.com/users/filtered?userid={{email}}","record-list-toggle-name":"Show name column","record-list-hide-name":"Hide name column","record-show-names":"Display record names/titles","record-show-ids":"Display only record ID numbers","link-name-use-ids":"Use IDs For Links","link-name-add":"Add name column to {{sheetTitle}}"};n.slug=function(e){return"string"!=typeof e?void 0:(e=e.replace(/[^a-zA-Z0-9]+/g," "),e=e.trim(),e=e.replace(/\s+/g,"_"),e=e.toLowerCase())},n.normalizeCase=function(e){return void 0===e||null===e?"":e.toString().toLowerCase()},n.normalize=function(e){return e?e.toString().trim():""},n.escapeRegExp=function(e){return n.escapeChars(e,".*+?^=!:${}()|\\[\\]/")},n.escapeChars=function(e,t){var n=new RegExp("(["+t+"\\\\])","g");return e.replace(n,"\\$1")},n.isBlank=function(e){return!e||0===e.trim().length},n.defaultString=function(e,t){return n.isBlank(e)?n[t]:e},n.contains=function(e,t){var i=n.normalizeCase(e),r=n.normalizeCase(t);return i&&-1!==i.indexOf(r)},n.capitalize=function(e){return e[0].toUpperCase()+e.slice(1)},n.truncate=function(e,t){return null==e?"":e.length<=t?e:e.slice(0,t-1)+"â€¦"},n.get=function(){return this[_.chain(arguments).toArray().compactNullish().value().join("-")]},n.ns=function(e){return function(t){return n[e+"-"+t]}},t.exports=n},{}],bootstrap:[function(e,t){t.exports=e("vTmI7L")},{}],handsontable:[function(e,t){t.exports=e("kwJIFI")},{}],spin:[function(e,t){t.exports=e("cinjjV")},{}],"backbone.mousetrap":[function(e,t){t.exports=e("8TR9Tt")},{}],"jquery.highlight":[function(e,t){t.exports=e("kY1XKv")},{}],linkify:[function(e,t){t.exports=e("57gGLX")},{}],14:[function(){_.mixin({compactNullish:function(e){return _.reject(e,function(e){return null==e})},deepClone:function(e){return JSON.parse(JSON.stringify(e))},concat:function(){var e=[];return _.each(arguments,function(t){_.isArray(t)?e=e.concat(t):e.push(t)}),e},soak:function(e,t){if(null==e)return e;var n,i,r=_.rest(arguments,2);for(t=_.isString(t)?t.split("."):_.toArray(t);i=t.shift();){var s=i.split("()");if(i=s[0],n=e,e=2===s.length?e[i]?e[i]():null:e[i],null==e)return e}if(r.length){var o=e;return o.apply(n,r)}return e},hasPrefix:function(e,t){return null==t?!1:null==e?!1:e.substring(0,t.length)===t},containsSorted:function(e,t){return-1!==_.indexOf(e,t,!0)},differenceSorted:function(e,t){return _.filter(e,function(e){return!_.containsSorted(t,e)})},clamp:function(e,t,n){return 2===arguments.length&&(n=t,t=0),Math.max(t,Math.min(e,n))},constant:function(e){return function(){return e}}})},{}],15:[function(e,t){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){if(e.source===window&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var t=n.shift();t()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],16:[function(e,t,n){!function(i){var r=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,empty:3,nonpipe:4,"'":5,'"':6,CHARS:7,ESCCHARS:8,command:9,commands:10,PIPE:11,output:12,$accept:0,$end:1},terminals_:{2:"error",5:"'",6:'"',7:"CHARS",8:"ESCCHARS",11:"PIPE"},productions_:[0,[3,0],[4,1],[4,1],[4,1],[4,1],[9,1],[9,2],[10,1],[10,1],[10,3],[10,2],[12,1]],performAction:function(e,t,n,i,r,s){var o=s.length-1;switch(r){case 5:this.$="\\"+s[o];break;case 7:this.$=s[o-1]+s[o];break;case 8:this.$=[];break;case 9:this.$=[s[o]];break;case 10:this.$=s[o-2].concat(s[o]);break;case 11:this.$=s[o-1];break;case 12:return s[o]}},table:[{1:[2,1],3:3,4:5,5:[1,6],6:[1,7],7:[1,8],8:[1,9],9:4,10:2,11:[2,1],12:1},{1:[3]},{1:[2,12],11:[1,10]},{1:[2,8],11:[2,8]},{1:[2,9],4:11,5:[1,6],6:[1,7],7:[1,8],8:[1,9],11:[2,9]},{1:[2,6],5:[2,6],6:[2,6],7:[2,6],8:[2,6],11:[2,6]},{1:[2,2],5:[2,2],6:[2,2],7:[2,2],8:[2,2],11:[2,2]},{1:[2,3],5:[2,3],6:[2,3],7:[2,3],8:[2,3],11:[2,3]},{1:[2,4],5:[2,4],6:[2,4],7:[2,4],8:[2,4],11:[2,4]},{1:[2,5],5:[2,5],6:[2,5],7:[2,5],8:[2,5],11:[2,5]},{1:[2,11],4:5,5:[1,6],6:[1,7],7:[1,8],8:[1,9],9:12,11:[2,11]},{1:[2,7],5:[2,7],6:[2,7],7:[2,7],8:[2,7],11:[2,7]},{1:[2,10],4:11,5:[1,6],6:[1,7],7:[1,8],8:[1,9],11:[2,10]}],defaultActions:{},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){function t(){var e;return e=n.lexer.lex()||d,"number"!=typeof e&&(e=n.symbols_[e]||e),e}var n=this,i=[0],r=[null],s=[],o=this.table,a="",l=0,c=0,u=0,h=2,d=1;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var f=this.lexer.yylloc;s.push(f);var p=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var m,g,v,y,b,w,x,k,_,E={};;){if(v=i[i.length-1],this.defaultActions[v]?y=this.defaultActions[v]:((null===m||"undefined"==typeof m)&&(m=t()),y=o[v]&&o[v][m]),"undefined"==typeof y||!y.length||!y[0]){var C="";_=[];for(w in o[v])this.terminals_[w]&&w>h&&_.push("'"+this.terminals_[w]+"'");C=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(l+1)+": Unexpected "+(m==d?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(C,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:f,expected:_})}if(y[0]instanceof Array&&y.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+m);switch(y[0]){case 1:i.push(m),r.push(this.lexer.yytext),s.push(this.lexer.yylloc),i.push(y[1]),m=null,g?(m=g,g=null):(c=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,f=this.lexer.yylloc,u>0&&u--);break;case 2:if(x=this.productions_[y[1]][1],E.$=r[r.length-x],E._$={first_line:s[s.length-(x||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(x||1)].first_column,last_column:s[s.length-1].last_column},p&&(E._$.range=[s[s.length-(x||1)].range[0],s[s.length-1].range[1]]),b=this.performAction.call(E,a,c,l,this.yy,y[1],r,s),"undefined"!=typeof b)return b;x&&(i=i.slice(0,-1*x*2),r=r.slice(0,-1*x),s=s.slice(0,-1*x)),i.push(this.productions_[y[1]][0]),r.push(E.$),s.push(E._$),k=o[i[i.length-2]][i[i.length-1]],i.push(k);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,i,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),i=e[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;
if(this._backtrack){for(var s in r)this[s]=r[s];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,i;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),s=0;s<r.length;s++)if(n=this._input.match(this.rules[r[s]]),n&&(!t||n[0].length>t[0].length)){if(t=n,i=s,this.options.backtrack_lexer){if(e=this.test_match(n,r[s]),e!==!1)return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?(e=this.test_match(t,r[i]),e!==!1?e:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){var e=this.conditionStack.length-1;return e>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,i){switch(n){case 0:return 11;case 1:return 7;case 2:return this.begin("QUOTE"),"'";case 3:return this.popState(),"'";case 4:this.begin("ESC");break;case 5:return 7;case 6:return this.begin("DBLQUOTE"),6;case 7:return this.popState(),6;case 8:this.begin("ESC");break;case 9:return 7;case 10:return this.popState(),8}},rules:[/^(?:\|)/,/^(?:[^\|\'\"]+)/,/^(?:')/,/^(?:')/,/^(?:\\)/,/^(?:[^'\\]+)/,/^(?:")/,/^(?:")/,/^(?:\\)/,/^(?:[^"\\]+)/,/^(?:.)/],conditions:{ESC:{rules:[10],inclusive:!1},DBLQUOTE:{rules:[7,8,9],inclusive:!1},QUOTE:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,2,6],inclusive:!0}}};return e}();return t.lexer=n,e.prototype=t,t.Parser=e,new e}();"undefined"!=typeof e&&"undefined"!=typeof n&&(n.parser=r,n.Parser=r.Parser,n.parse=function(){return r.parse.apply(r,arguments)},n.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),i.exit(1));var r=e("fs").readFileSync(e("path").normalize(t[1]),"utf8");return n.parser.parse(r)},"undefined"!=typeof t&&e.main===t&&n.main(i.argv.slice(1)))}(e("__browserify_process"))},{__browserify_process:15,fs:17,path:18}],19:[function(e,t,n){!function(i){var r=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,empty:3,"boolean":4,TRUE:5,FALSE:6,string:7,CHARS:8,quotedstring:9,"'":10,'"':11,cursorquoted:12,CURSOR:13,EOF:14,token:15,WORD:16,NUMBER:17,cursortoken:18,field:19,dotexpr:20,".":21,cursordotexpr:22,value:23,cursorvalue:24,expr:25,"(":26,")":27,"+":28,"-":29,"*":30,"/":31,"^":32,"**":33,":":34,"=":35,"<":36,">":37,"<=":38,">=":39,"!=":40,"<>":41,and:42,"&&":43,"&":44,or:45,"||":46,"|":47,not:48,"!":49,"if":50,then:51,"else":52,asc:53,desc:54,arguments:55,cursorexpr:56,openfn:57,closedcursorarguments:58,"CURSOR(":59,cursorarguments:60,missingop:61,nonemptyarguments:62,",":63,cursorargument:64,opencursorarguments:65,cursorformula:66,output:67,TOKEN:68,FORMULA:69,$accept:0,$end:1},terminals_:{2:"error",5:"TRUE",6:"FALSE",8:"CHARS",10:"'",11:'"',13:"CURSOR",14:"EOF",16:"WORD",17:"NUMBER",21:".",26:"(",27:")",28:"+",29:"-",30:"*",31:"/",32:"^",33:"**",34:":",35:"=",36:"<",37:">",38:"<=",39:">=",40:"!=",41:"<>",42:"and",43:"&&",44:"&",45:"or",46:"||",47:"|",48:"not",49:"!",50:"if",51:"then",52:"else",53:"asc",54:"desc",59:"CURSOR(",63:",",68:"TOKEN",69:"FORMULA"},productions_:[0,[3,0],[4,1],[4,1],[7,1],[7,2],[9,3],[9,3],[12,5],[12,5],[12,5],[12,5],[15,1],[15,1],[15,1],[15,1],[18,2],[18,1],[19,1],[20,1],[20,3],[22,3],[23,1],[23,1],[23,1],[23,1],[24,1],[25,1],[25,1],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,2],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,3],[25,2],[25,2],[25,4],[25,6],[25,2],[25,2],[25,4],[56,1],[56,1],[56,2],[56,2],[56,2],[56,3],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,4],[56,3],[56,3],[56,3],[56,2],[56,2],[56,3],[56,2],[56,2],[56,3],[56,2],[56,2],[56,3],[56,2],[56,2],[56,2],[56,2],[56,3],[56,4],[56,4],[56,5],[56,6],[56,6],[56,7],[56,5],[56,4],[56,4],[57,3],[57,3],[57,3],[61,3],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[61,4],[62,1],[62,3],[55,1],[55,1],[64,1],[64,1],[58,1],[58,3],[58,3],[58,3],[65,1],[65,3],[60,1],[60,1],[66,1],[66,1],[66,1],[67,0],[67,1],[67,1],[67,2],[67,2],[67,2],[67,1],[67,2],[67,2],[67,2]],performAction:function(e,t,n,i,r,s){var o=s.length-1;switch(r){case 4:this.$="";break;case 5:this.$=s[o-1].concat(s[o]);break;case 6:this.$={op:"'",val:s[o-1]};break;case 7:this.$={op:'"',val:s[o-1]};break;case 8:this.$={op:"'",val:s[o-3],cursor:!0};break;case 9:this.$={op:'"',val:s[o-3],cursor:!0};break;case 10:this.$={op:"'",val:s[o-3],cursor:!0};break;case 11:this.$={op:'"',val:s[o-3],cursor:!0};break;case 12:this.$={op:"bareword",val:s[o]};break;case 13:this.$={op:"bareword",val:s[o]};break;case 14:this.$={op:"bareword",val:s[o]};break;case 16:this.$=_.extend(s[o-1],{cursor:!0});break;case 18:this.$={field:s[o]};break;case 20:this.$={op:".",expr1:s[o-2],expr2:s[o]};break;case 21:this.$={op:".",expr1:s[o-2],expr2:{cursor:!0},cursor:!0};break;case 22:this.$={op:"bareword",val:!0};break;case 23:this.$={op:"bareword",val:!1};break;case 24:this.$={op:"bareword",val:parseFloat(s[o])};break;case 29:this.$={op:"(",expr:s[o-1]};break;case 30:this.$={op:"+",expr1:s[o-2],expr2:s[o]};break;case 31:this.$={op:"-",expr1:s[o-2],expr2:s[o]};break;case 32:this.$={op:"*",expr1:s[o-2],expr2:s[o]};break;case 33:this.$={op:"/",expr1:s[o-2],expr2:s[o]};break;case 34:this.$={op:"^",expr1:s[o-2],expr2:s[o]};break;case 35:this.$={op:"**",expr1:s[o-2],expr2:s[o]};break;case 36:this.$={op:"neg",expr:s[o]};break;case 37:this.$={op:":",expr1:s[o-2],expr2:s[o]};break;case 38:this.$={op:"=",expr1:s[o-2],expr2:s[o]};break;case 39:this.$={op:"<",expr1:s[o-2],expr2:s[o]};break;case 40:this.$={op:">",expr1:s[o-2],expr2:s[o]};break;case 41:this.$={op:"<=",expr1:s[o-2],expr2:s[o]};break;case 42:this.$={op:">=",expr1:s[o-2],expr2:s[o]};break;case 43:this.$={op:"!=",expr1:s[o-2],expr2:s[o]};break;case 44:this.$={op:"<>",expr1:s[o-2],expr2:s[o]};break;case 45:this.$={op:"and",expr1:s[o-2],expr2:s[o]};break;case 46:this.$={op:"&&",expr1:s[o-2],expr2:s[o]};break;case 47:this.$={op:"&",expr1:s[o-2],expr2:s[o]};break;case 48:this.$={op:"or",expr1:s[o-2],expr2:s[o]};break;case 49:this.$={op:"||",expr1:s[o-2],expr2:s[o]};break;case 50:this.$={op:"|",expr1:s[o-2],expr2:s[o]};break;case 51:this.$={op:"not",expr:s[o]};break;case 52:this.$={op:"!",expr:s[o]};break;case 53:this.$={op:"if",cond:s[o-2],then:s[o]};break;case 54:this.$={op:"if",cond:s[o-4],then:s[o-2],"else":s[o]};break;case 55:this.$={op:"order",ascending:!0,expr1:s[o-1]};break;case 56:this.$={op:"order",ascending:!1,expr1:s[o-1]};break;case 57:this.$={op:"fn",name:s[o-3],arguments:s[o-1]};break;case 60:this.$=_.extend(s[o-1],{cursor:!0});break;case 61:this.$={cursor:!0,op:"(",expr:{cursor:!0}};break;case 62:this.$={cursor:!0,op:"(",expr:s[o]};break;case 63:this.$={cursor:!0,op:"(",expr:s[o-1]};break;case 64:this.$={cursor:!0,op:"(",expr:s[o-1]};break;case 65:this.$={cursor:!0,op:"+",expr1:s[o-2],expr2:{cursor:!0}};break;case 66:this.$={cursor:!0,op:"+",expr1:s[o-2],expr2:s[o]};break;case 67:this.$={cursor:!0,op:"+",expr1:s[o-3],expr2:s[o-1]};break;case 68:this.$={cursor:!0,op:"+",expr1:s[o-2],expr2:s[o]};break;case 69:this.$={cursor:!0,op:"-",expr1:s[o-2],expr2:{cursor:!0}};break;case 70:this.$={cursor:!0,op:"-",expr1:s[o-2],expr2:s[o]};break;case 71:this.$={cursor:!0,op:"-",expr1:s[o-3],expr2:s[o-1]};break;case 72:this.$={cursor:!0,op:"-",expr1:s[o-2],expr2:s[o]};break;case 73:this.$={cursor:!0,op:"*",expr1:s[o-2],expr2:{cursor:!0}};break;case 74:this.$={cursor:!0,op:"*",expr1:s[o-2],expr2:s[o]};break;case 75:this.$={cursor:!0,op:"*",expr1:s[o-3],expr2:s[o-1]};break;case 76:this.$={cursor:!0,op:"*",expr1:s[o-2],expr2:s[o]};break;case 77:this.$={cursor:!0,op:"/",expr1:s[o-2],expr2:{cursor:!0}};break;case 78:this.$={cursor:!0,op:"/",expr1:s[o-2],expr2:s[o]};break;case 79:this.$={cursor:!0,op:"/",expr1:s[o-3],expr2:s[o-1]};break;case 80:this.$={cursor:!0,op:"/",expr1:s[o-2],expr2:s[o]};break;case 81:this.$={cursor:!0,op:"^",expr1:s[o-2],expr2:{cursor:!0}};break;case 82:this.$={cursor:!0,op:"^",expr1:s[o-2],expr2:s[o]};break;case 83:this.$={cursor:!0,op:"^",expr1:s[o-3],expr2:s[o-1]};break;case 84:this.$={cursor:!0,op:"^",expr1:s[o-2],expr2:s[o]};break;case 85:this.$={cursor:!0,op:"**",expr1:s[o-2],expr2:{cursor:!0}};break;case 86:this.$={cursor:!0,op:"**",expr1:s[o-2],expr2:s[o]};break;case 87:this.$={cursor:!0,op:"**",expr1:s[o-3],expr2:s[o-1]};break;case 88:this.$={cursor:!0,op:"**",expr1:s[o-2],expr2:s[o]};break;case 89:this.$={cursor:!0,op:"<=",expr1:s[o-2],expr2:{cursor:!0}};break;case 90:this.$={cursor:!0,op:"<=",expr1:s[o-2],expr2:s[o]};break;case 91:this.$={cursor:!0,op:"<=",expr1:s[o-3],expr2:s[o-1]};break;case 92:this.$={cursor:!0,op:"<=",expr1:s[o-2],expr2:s[o]};break;case 93:this.$={cursor:!0,op:">=",expr1:s[o-2],expr2:{cursor:!0}};break;case 94:this.$={cursor:!0,op:">=",expr1:s[o-2],expr2:s[o]};break;case 95:this.$={cursor:!0,op:">=",expr1:s[o-3],expr2:s[o-1]};break;case 96:this.$={cursor:!0,op:">=",expr1:s[o-2],expr2:s[o]};break;case 97:this.$={cursor:!0,op:"!=",expr1:s[o-2],expr2:{cursor:!0}};break;case 98:this.$={cursor:!0,op:"!=",expr1:s[o-2],expr2:s[o]};break;case 99:this.$={cursor:!0,op:"!=",expr1:s[o-3],expr2:s[o-1]};break;case 100:this.$={cursor:!0,op:"!=",expr1:s[o-2],expr2:s[o]};break;case 101:this.$={cursor:!0,op:"and",expr1:s[o-2],expr2:{cursor:!0}};break;case 102:this.$={cursor:!0,op:"and",expr1:s[o-2],expr2:s[o]};break;case 103:this.$={cursor:!0,op:"and",expr1:s[o-3],expr2:s[o-1]};break;case 104:this.$={cursor:!0,op:"and",expr1:s[o-2],expr2:s[o]};break;case 105:this.$={cursor:!0,op:"&&",expr1:s[o-2],expr2:{cursor:!0}};break;case 106:this.$={cursor:!0,op:"&&",expr1:s[o-2],expr2:s[o]};break;case 107:this.$={cursor:!0,op:"&&",expr1:s[o-3],expr2:s[o-1]};break;case 108:this.$={cursor:!0,op:"&&",expr1:s[o-2],expr2:s[o]};break;case 109:this.$={cursor:!0,op:"or",expr1:s[o-2],expr2:{cursor:!0}};break;case 110:this.$={cursor:!0,op:"or",expr1:s[o-2],expr2:s[o]};break;case 111:this.$={cursor:!0,op:"or",expr1:s[o-3],expr2:s[o-1]};break;case 112:this.$={cursor:!0,op:"or",expr1:s[o-2],expr2:s[o]};break;case 113:this.$={cursor:!0,op:"||",expr1:s[o-2],expr2:{cursor:!0}};break;case 114:this.$={cursor:!0,op:"||",expr1:s[o-2],expr2:s[o]};break;case 115:this.$={cursor:!0,op:"||",expr1:s[o-3],expr2:s[o-1]};break;case 116:this.$={cursor:!0,op:"||",expr1:s[o-2],expr2:s[o]};break;case 117:this.$={cursor:!0,op:"&",expr1:s[o-2],expr2:{cursor:!0}};break;case 118:this.$={cursor:!0,op:"&",expr1:s[o-2],expr2:s[o]};break;case 119:this.$={cursor:!0,op:"&",expr1:s[o-3],expr2:s[o-1]};break;case 120:this.$={cursor:!0,op:"&",expr1:s[o-2],expr2:s[o]};break;case 121:this.$={cursor:!0,op:"|",expr1:s[o-2],expr2:{cursor:!0}};break;case 122:this.$={cursor:!0,op:"|",expr1:s[o-2],expr2:s[o]};break;case 123:this.$={cursor:!0,op:"|",expr1:s[o-3],expr2:s[o-1]};break;case 124:this.$={cursor:!0,op:"|",expr1:s[o-2],expr2:s[o]};break;case 125:this.$={cursor:!0,op:"=",expr1:s[o-2],expr2:{cursor:!0}};break;case 126:this.$={cursor:!0,op:"=",expr1:s[o-2],expr2:s[o]};break;case 127:this.$={cursor:!0,op:"=",expr1:s[o-3],expr2:s[o-1]};break;case 128:this.$={cursor:!0,op:"=",expr1:s[o-2],expr2:s[o]};break;case 129:this.$={cursor:!0,op:">",expr1:s[o-2],expr2:{cursor:!0}};break;case 130:this.$={cursor:!0,op:">",expr1:s[o-2],expr2:s[o]};break;case 131:this.$={cursor:!0,op:">",expr1:s[o-3],expr2:s[o-1]};break;case 132:this.$={cursor:!0,op:">",expr1:s[o-2],expr2:s[o]};break;case 133:this.$={cursor:!0,op:"<",expr1:s[o-2],expr2:{cursor:!0}};break;case 134:this.$={cursor:!0,op:"<",expr1:s[o-2],expr2:s[o]};break;case 135:this.$={cursor:!0,op:"<",expr1:s[o-3],expr2:s[o-1]};break;case 136:this.$={cursor:!0,op:"<",expr1:s[o-2],expr2:s[o]};break;case 137:this.$={cursor:!0,op:":",expr1:s[o-2],expr2:{cursor:!0}};break;case 138:this.$={cursor:!0,op:":",expr1:s[o-2],expr2:s[o]};break;case 139:this.$={cursor:!0,op:"not",expr:{cursor:!0}};break;case 140:this.$={cursor:!0,op:"not",expr:s[o]};break;case 141:this.$={cursor:!0,op:"not",expr:s[o-1]};break;case 142:this.$={cursor:!0,op:"!",expr:{cursor:!0}};break;case 143:this.$={cursor:!0,op:"!",expr:s[o]};break;case 144:this.$={cursor:!0,op:"!",expr:s[o-1]};break;case 145:this.$={cursor:!0,op:"order",ascending:!0,expr1:{cursor:!0}};break;case 146:this.$={cursor:!0,op:"order",ascending:!0,expr1:s[o-1]};break;case 147:this.$={cursor:!0,op:"order",ascending:!0,expr1:s[o-2]};break;case 148:this.$={cursor:!0,op:"order",ascending:!1,expr1:{cursor:!0}};break;case 149:this.$={cursor:!0,op:"order",ascending:!1,expr1:s[o-1]};break;case 150:this.$={cursor:!0,op:"if",cond:{cursor:!0}};break;case 151:this.$={cursor:!0,op:"if",cond:s[o]};break;case 152:this.$={cursor:!0,op:"if",cond:s[o-1]};break;case 153:this.$={cursor:!0,op:"if",cond:s[o-2],then:{cursor:!0}};break;case 154:this.$={cursor:!0,op:"if",cond:s[o-2],then:s[o]};break;case 155:this.$={cursor:!0,op:"if",cond:s[o-3],then:s[o-1]};break;case 156:this.$={cursor:!0,op:"if",cond:s[o-4],then:s[o-2],"else":{cursor:!0}};break;case 157:this.$={cursor:!0,op:"if",cond:s[o-4],then:s[o-2],"else":s[o]};break;case 158:this.$={cursor:!0,op:"if",cond:s[o-5],then:s[o-3],"else":s[o-1]};break;case 159:this.$={cursor:!0,op:"fn",name:s[o-4],arguments:s[o-1]};break;case 160:this.$={cursor:!0,op:"fn",name:s[o-3],arguments:s[o-1]};break;case 161:this.$={cursor:!0,op:"fn",name:s[o-3],arguments:s[o-1]};break;case 162:this.$={cursor:!0,op:"fn",name:s[o-2],arguments:s[o]};break;case 163:this.$={cursor:!0,op:"fn",name:s[o-2],arguments:s[o]};break;case 164:this.$={cursor:!0,op:"fn",name:s[o-2],arguments:[]};break;case 165:this.$={cursor:!0,expr1:_.extend(s[o-2],{cursor:!0}),expr2:s[o],op:"NONE"};break;case 166:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 167:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 168:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 169:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 170:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 171:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 172:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 173:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 174:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 175:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 176:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 177:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 178:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 179:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 180:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 181:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 182:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 183:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 184:this.$={cursor:!0,expr1:s[o-3],expr2:_.extend(s[o],{cursor:!0}),op:"NONE"};break;case 185:this.$=[s[o]];break;case 186:this.$=s[o-2].concat(s[o]);break;case 187:this.$=[];break;case 191:this.$=[s[o]];break;case 192:this.$=s[o-2].concat({empty:!0,cursor:!0});break;case 193:this.$=s[o-2].concat(s[o]);break;case 194:this.$=s[o-2].concat(s[o]);break;case 195:this.$=[s[o]];break;case 196:this.$=s[o-2].concat(s[o]);break;case 201:return{cursor:!0};case 203:return s[o];case 204:return s[o];case 205:return[s[o]];case 206:return[s[o]];case 207:return _.extend([],{cursor:!0});case 208:return _.extend([],{cursor:!0});case 209:var a=s[o],l=a[0];return a=a.slice(1),_.extend(l,{cursor:!0}),[l].concat(a);case 210:return s[o];case 211:return s[o-1]}},table:[{1:[2,202],5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,5],14:[2,202],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:9,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:21,57:11,58:7,60:2,61:22,62:3,64:10,65:8,67:1,68:[1,4],69:[1,6]},{1:[3],14:[1,34]},{1:[2,203],14:[2,203]},{1:[2,204],14:[2,204],63:[1,35]},{4:41,5:[1,44],6:[1,45],9:42,10:[1,31],11:[1,32],12:43,13:[1,38],15:36,16:[1,39],17:[1,40],18:37},{1:[2,208],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,208],16:[1,56],17:[1,25],19:52,20:50,23:12,25:49,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],62:46},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:59,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{1:[2,197],14:[2,197],63:[1,60]},{1:[2,198],14:[2,198]},{1:[2,185],13:[1,82],14:[2,185],27:[2,185],28:[1,61],29:[1,62],30:[1,63],31:[1,64],32:[1,65],33:[1,66],35:[1,67],36:[1,68],37:[1,69],38:[1,70],39:[1,71],40:[1,72],41:[1,73],42:[1,74],43:[1,75],44:[1,76],45:[1,77],46:[1,78],47:[1,79],53:[1,80],54:[1,81],63:[2,185]},{1:[2,191],14:[2,191],27:[2,191],63:[2,191]},{1:[2,195],14:[2,195]},{1:[2,27],13:[2,27],14:[2,27],27:[2,27],28:[2,27],29:[2,27],30:[2,27],31:[2,27],32:[2,27],33:[2,27],35:[2,27],36:[2,27],37:[2,27],38:[2,27],39:[2,27],40:[2,27],41:[2,27],42:[2,27],43:[2,27],44:[2,27],45:[2,27],46:[2,27],47:[2,27],51:[2,27],52:[2,27],53:[2,27],54:[2,27],63:[2,27]},{1:[2,28],13:[2,28],14:[2,28],21:[1,83],27:[2,28],28:[2,28],29:[2,28],30:[2,28],31:[2,28],32:[2,28],33:[2,28],35:[2,28],36:[2,28],37:[2,28],38:[2,28],39:[2,28],40:[2,28],41:[2,28],42:[2,28],43:[2,28],44:[2,28],45:[2,28],46:[2,28],47:[2,28],51:[2,28],52:[2,28],53:[2,28],54:[2,28],63:[2,28]},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,85],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:84,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:86,57:87},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:88,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{1:[2,19],13:[2,19],14:[2,19],21:[2,19],27:[2,19],28:[2,19],29:[2,19],30:[2,19],31:[2,19],32:[2,19],33:[2,19],34:[1,89],35:[2,19],36:[2,19],37:[2,19],38:[2,19],39:[2,19],40:[2,19],41:[2,19],42:[2,19],43:[2,19],44:[2,19],45:[2,19],46:[2,19],47:[2,19],51:[2,19],52:[2,19],53:[2,19],54:[2,19],63:[2,19]},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,91],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:90,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:92,57:93},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,95],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:94,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:96,57:97},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,99],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:98,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:100,57:101},{1:[2,18],13:[2,18],14:[2,18],21:[2,18],26:[1,102],27:[2,18],28:[2,18],29:[2,18],30:[2,18],31:[2,18],32:[2,18],33:[2,18],34:[2,18],35:[2,18],36:[2,18],37:[2,18],38:[2,18],39:[2,18],40:[2,18],41:[2,18],42:[2,18],43:[2,18],44:[2,18],45:[2,18],46:[2,18],47:[2,18],51:[2,18],52:[2,18],53:[2,18],54:[2,18],59:[1,103],63:[2,18]},{1:[2,189],14:[2,189],27:[2,189],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[1,113],43:[1,114],44:[1,117],45:[1,115],46:[1,116],47:[1,118],63:[2,189]},{1:[2,190],14:[2,190],27:[2,190],63:[2,190]},{1:[2,22],13:[2,22],14:[2,22],27:[2,22],28:[2,22],29:[2,22],30:[2,22],31:[2,22],32:[2,22],33:[2,22],35:[2,22],36:[2,22],37:[2,22],38:[2,22],39:[2,22],40:[2,22],41:[2,22],42:[2,22],43:[2,22],44:[2,22],45:[2,22],46:[2,22],47:[2,22],51:[2,22],52:[2,22],53:[2,22],54:[2,22],63:[2,22]},{1:[2,23],13:[2,23],14:[2,23],27:[2,23],28:[2,23],29:[2,23],30:[2,23],31:[2,23],32:[2,23],33:[2,23],35:[2,23],36:[2,23],37:[2,23],38:[2,23],39:[2,23],40:[2,23],41:[2,23],42:[2,23],43:[2,23],44:[2,23],45:[2,23],46:[2,23],47:[2,23],51:[2,23],52:[2,23],53:[2,23],54:[2,23],63:[2,23]},{1:[2,24],13:[2,24],14:[2,24],27:[2,24],28:[2,24],29:[2,24],30:[2,24],31:[2,24],32:[2,24],33:[2,24],35:[2,24],36:[2,24],37:[2,24],38:[2,24],39:[2,24],40:[2,24],41:[2,24],42:[2,24],43:[2,24],44:[2,24],45:[2,24],46:[2,24],47:[2,24],51:[2,24],52:[2,24],53:[2,24],54:[2,24],63:[2,24]},{1:[2,25],13:[2,25],14:[2,25],27:[2,25],28:[2,25],29:[2,25],30:[2,25],31:[2,25],32:[2,25],33:[2,25],35:[2,25],36:[2,25],37:[2,25],38:[2,25],39:[2,25],40:[2,25],41:[2,25],42:[2,25],43:[2,25],44:[2,25],45:[2,25],46:[2,25],47:[2,25],51:[2,25],52:[2,25],53:[2,25],54:[2,25],63:[2,25]},{1:[2,58],14:[2,58],27:[2,58],28:[2,58],29:[2,58],30:[2,58],31:[2,58],32:[2,58],33:[2,58],35:[2,58],36:[2,58],37:[2,58],38:[2,58],39:[2,58],40:[2,58],42:[2,58],43:[2,58],44:[2,58],45:[2,58],46:[2,58],47:[2,58],63:[2,58]},{1:[2,59],14:[2,59],27:[2,59],28:[2,59],29:[2,59],30:[2,59],31:[2,59],32:[2,59],33:[2,59],35:[2,59],36:[2,59],37:[2,59],38:[2,59],39:[2,59],40:[2,59],42:[2,59],43:[2,59],44:[2,59],45:[2,59],46:[2,59],47:[2,59],63:[2,59]},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,125],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:124,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:122,57:123},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,125],16:[1,127],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:124,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:126},{3:129,7:128,8:[2,1],10:[2,1],13:[2,1]},{3:129,7:130,8:[2,1],11:[2,1],13:[2,1]},{1:[2,26],14:[2,26],27:[2,26],28:[2,26],29:[2,26],30:[2,26],31:[2,26],32:[2,26],33:[2,26],35:[2,26],36:[2,26],37:[2,26],38:[2,26],39:[2,26],40:[2,26],42:[2,26],43:[2,26],44:[2,26],45:[2,26],46:[2,26],47:[2,26],63:[2,26]},{1:[2,211],14:[2,211]},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,132],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:131,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:21,57:134,61:22,64:133},{1:[2,205],13:[1,135],14:[2,205]},{1:[2,206],14:[2,206]},{1:[2,207],14:[2,207]},{1:[2,12],13:[2,12],14:[2,12],27:[2,12],28:[2,12],29:[2,12],30:[2,12],31:[2,12],32:[2,12],33:[2,12],35:[2,12],36:[2,12],37:[2,12],38:[2,12],39:[2,12],40:[2,12],41:[2,12],42:[2,12],43:[2,12],44:[2,12],45:[2,12],46:[2,12],47:[2,12],51:[2,12],52:[2,12],53:[2,12],54:[2,12],63:[2,12]},{1:[2,13],13:[2,13],14:[2,13],27:[2,13],28:[2,13],29:[2,13],30:[2,13],31:[2,13],32:[2,13],33:[2,13],35:[2,13],36:[2,13],37:[2,13],38:[2,13],39:[2,13],40:[2,13],41:[2,13],42:[2,13],43:[2,13],44:[2,13],45:[2,13],46:[2,13],47:[2,13],51:[2,13],52:[2,13],53:[2,13],54:[2,13],63:[2,13]},{1:[2,14],13:[2,14],14:[2,14],27:[2,14],28:[2,14],29:[2,14],30:[2,14],31:[2,14],32:[2,14],33:[2,14],35:[2,14],36:[2,14],37:[2,14],38:[2,14],39:[2,14],40:[2,14],41:[2,14],42:[2,14],43:[2,14],44:[2,14],45:[2,14],46:[2,14],47:[2,14],51:[2,14],52:[2,14],53:[2,14],54:[2,14],63:[2,14]},{1:[2,15],13:[2,15],14:[2,15],27:[2,15],28:[2,15],29:[2,15],30:[2,15],31:[2,15],32:[2,15],33:[2,15],35:[2,15],36:[2,15],37:[2,15],38:[2,15],39:[2,15],40:[2,15],41:[2,15],42:[2,15],43:[2,15],44:[2,15],45:[2,15],46:[2,15],47:[2,15],51:[2,15],52:[2,15],53:[2,15],54:[2,15],63:[2,15]},{1:[2,17],14:[2,17],27:[2,17],28:[2,17],29:[2,17],30:[2,17],31:[2,17],32:[2,17],33:[2,17],35:[2,17],36:[2,17],37:[2,17],38:[2,17],39:[2,17],40:[2,17],42:[2,17],43:[2,17],44:[2,17],45:[2,17],46:[2,17],47:[2,17],63:[2,17]},{1:[2,2],13:[2,2],14:[2,2],27:[2,2],28:[2,2],29:[2,2],30:[2,2],31:[2,2],32:[2,2],33:[2,2],35:[2,2],36:[2,2],37:[2,2],38:[2,2],39:[2,2],40:[2,2],41:[2,2],42:[2,2],43:[2,2],44:[2,2],45:[2,2],46:[2,2],47:[2,2],51:[2,2],52:[2,2],53:[2,2],54:[2,2],63:[2,2]},{1:[2,3],13:[2,3],14:[2,3],27:[2,3],28:[2,3],29:[2,3],30:[2,3],31:[2,3],32:[2,3],33:[2,3],35:[2,3],36:[2,3],37:[2,3],38:[2,3],39:[2,3],40:[2,3],41:[2,3],42:[2,3],43:[2,3],44:[2,3],45:[2,3],46:[2,3],47:[2,3],51:[2,3],52:[2,3],53:[2,3],54:[2,3],63:[2,3]},{1:[2,209],14:[2,209],63:[1,136]},{1:[2,145],14:[2,145],27:[2,145],28:[2,145],29:[2,145],30:[2,145],31:[2,145],32:[2,145],33:[2,145],35:[2,145],36:[2,145],37:[2,145],38:[2,145],39:[2,145],40:[2,145],42:[2,145],43:[2,145],44:[2,145],45:[2,145],46:[2,145],47:[2,145],63:[2,145]},{1:[2,148],14:[2,148],27:[2,148],28:[2,148],29:[2,148],30:[2,148],31:[2,148],32:[2,148],33:[2,148],35:[2,148],36:[2,148],37:[2,148],38:[2,148],39:[2,148],40:[2,148],42:[2,148],43:[2,148],44:[2,148],45:[2,148],46:[2,148],47:[2,148],63:[2,148]},{1:[2,185],14:[2,185],27:[2,185],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,185]},{1:[2,28],13:[2,28],14:[2,28],21:[1,156],27:[2,28],28:[2,28],29:[2,28],30:[2,28],31:[2,28],32:[2,28],33:[2,28],35:[2,28],36:[2,28],37:[2,28],38:[2,28],39:[2,28],40:[2,28],41:[2,28],42:[2,28],43:[2,28],44:[2,28],45:[2,28],46:[2,28],47:[2,28],51:[2,28],52:[2,28],53:[2,28],54:[2,28],63:[2,28]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:157,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{1:[2,19],13:[2,19],14:[2,19],21:[2,19],27:[2,19],28:[2,19],29:[2,19],30:[2,19],31:[2,19],32:[2,19],33:[2,19],34:[1,158],35:[2,19],36:[2,19],37:[2,19],38:[2,19],39:[2,19],40:[2,19],41:[2,19],42:[2,19],43:[2,19],44:[2,19],45:[2,19],46:[2,19],47:[2,19],51:[2,19],52:[2,19],53:[2,19],54:[2,19],63:[2,19]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:159,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:160,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:161,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{1:[2,18],13:[2,18],14:[2,18],21:[2,18],26:[1,162],27:[2,18],28:[2,18],29:[2,18],30:[2,18],31:[2,18],32:[2,18],33:[2,18],34:[2,18],35:[2,18],36:[2,18],37:[2,18],38:[2,18],39:[2,18],40:[2,18],41:[2,18],42:[2,18],43:[2,18],44:[2,18],45:[2,18],46:[2,18],47:[2,18],51:[2,18],52:[2,18],53:[2,18],54:[2,18],63:[2,18]},{3:129,7:163,8:[2,1],10:[2,1]},{3:129,7:164,8:[2,1],11:[2,1]},{1:[2,210],14:[2,210],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:165,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,167],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:166,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:168,57:169},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,171],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:170,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:172,57:173},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,175],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:174,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:176,57:177},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,179],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:178,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:180,57:181},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,183],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:182,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:184,57:185},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,187],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:186,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:188,57:189},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,191],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:190,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:192,57:193},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,195],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:194,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:196,57:197},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,199],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:198,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:200,57:201},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,203],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:202,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:204,57:205},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,207],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:206,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:208,57:209},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,211],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:210,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:212,57:213},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],13:[1,215],16:[1,56],17:[1,25],19:52,20:50,23:12,25:214,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,217],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:216,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:218,57:219},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,221],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:220,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:222,57:223},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,225],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:224,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:226,57:227},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,229],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:228,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:230,57:231},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,233],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:232,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:234,57:235},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,237],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:236,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:238,57:239},{1:[2,55],13:[2,55],14:[2,55],27:[2,55],28:[2,55],29:[2,55],30:[2,55],31:[2,55],32:[2,55],33:[2,55],35:[2,55],36:[2,55],37:[2,55],38:[2,55],39:[2,55],40:[2,55],41:[2,55],42:[2,55],43:[2,55],44:[2,55],45:[2,55],46:[2,55],47:[2,55],51:[2,55],52:[2,55],53:[2,55],54:[2,55],63:[2,55]},{1:[2,56],13:[2,56],14:[2,56],27:[2,56],28:[2,56],29:[2,56],30:[2,56],31:[2,56],32:[2,56],33:[2,56],35:[2,56],36:[2,56],37:[2,56],38:[2,56],39:[2,56],40:[2,56],41:[2,56],42:[2,56],43:[2,56],44:[2,56],45:[2,56],46:[2,56],47:[2,56],51:[2,56],52:[2,56],53:[2,56],54:[2,56],63:[2,56]},{1:[2,60],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,60],16:[1,56],17:[1,25],19:52,20:50,23:12,25:240,26:[1,51],27:[2,60],28:[2,60],29:[2,60],30:[2,60],31:[2,60],32:[2,60],33:[2,60],35:[2,60],36:[2,60],37:[2,60],38:[2,60],39:[2,60],40:[2,60],42:[2,60],43:[2,60],44:[2,60],45:[2,60],46:[2,60],47:[2,60],48:[1,53],49:[1,54],50:[1,55],63:[2,60]},{13:[1,242],16:[1,243],19:241},{13:[1,263],27:[1,244],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[1,257],43:[1,258],44:[1,259],45:[1,260],46:[1,261],47:[1,262],53:[1,80],54:[1,81]},{1:[2,61],14:[2,61],27:[2,61],28:[2,61],29:[2,61],30:[2,61],31:[2,61],32:[2,61],33:[2,61],35:[2,61],36:[2,61],37:[2,61],38:[2,61],39:[2,61],40:[2,61],42:[2,61],43:[2,61],44:[2,61],45:[2,61],46:[2,61],47:[2,61],53:[1,47],54:[1,48],63:[2,61]},{1:[2,62],14:[2,62],27:[2,62],28:[2,62],29:[2,62],30:[2,62],31:[2,62],32:[2,62],33:[2,62],35:[2,62],36:[2,62],37:[2,62],38:[2,62],39:[2,62],40:[2,62],42:[2,62],43:[2,62],44:[2,62],45:[2,62],46:[2,62],47:[2,62],63:[2,62]},{14:[1,265]},{1:[2,36],13:[2,36],14:[2,36],27:[2,36],28:[2,36],29:[2,36],30:[2,36],31:[2,36],32:[2,36],33:[2,36],35:[2,36],36:[2,36],37:[2,36],38:[2,36],39:[2,36],40:[2,36],41:[2,36],42:[2,36],43:[2,36],44:[2,36],45:[2,36],46:[2,36],47:[2,36],51:[2,36],52:[2,36],53:[2,36],54:[2,36],63:[2,36]},{4:41,5:[1,44],6:[1,45],9:42,10:[1,31],11:[1,32],12:43,13:[1,267],15:266,16:[1,39],17:[1,40],18:268},{1:[2,51],13:[1,263],14:[2,51],27:[2,51],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[2,51],43:[2,51],44:[2,51],45:[2,51],46:[2,51],47:[2,51],51:[2,51],52:[2,51],53:[2,51],54:[2,51],63:[2,51]},{1:[2,139],14:[2,139],27:[2,139],28:[2,139],29:[2,139],30:[2,139],31:[2,139],32:[2,139],33:[2,139],35:[2,139],36:[2,139],37:[2,139],38:[2,139],39:[2,139],40:[2,139],42:[2,139],43:[2,139],44:[2,139],45:[2,139],46:[2,139],47:[2,139],53:[1,47],54:[1,48],63:[2,139]},{1:[2,140],14:[2,140],27:[2,140],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[2,140],43:[2,140],44:[2,140],45:[2,140],46:[2,140],47:[2,140],63:[2,140]},{14:[1,269]},{1:[2,52],13:[1,263],14:[2,52],27:[2,52],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[2,52],43:[2,52],44:[2,52],45:[2,52],46:[2,52],47:[2,52],51:[2,52],52:[2,52],53:[2,52],54:[2,52],63:[2,52]},{1:[2,142],14:[2,142],27:[2,142],28:[2,142],29:[2,142],30:[2,142],31:[2,142],32:[2,142],33:[2,142],35:[2,142],36:[2,142],37:[2,142],38:[2,142],39:[2,142],40:[2,142],42:[2,142],43:[2,142],44:[2,142],45:[2,142],46:[2,142],47:[2,142],53:[1,47],54:[1,48],63:[2,142]},{1:[2,143],14:[2,143],27:[2,143],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[2,143],43:[2,143],44:[2,143],45:[2,143],46:[2,143],47:[2,143],63:[2,143]},{14:[1,270]},{13:[1,263],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[1,257],43:[1,258],44:[1,259],45:[1,260],46:[1,261],47:[1,262],51:[1,271],53:[1,80],54:[1,81]},{1:[2,150],14:[2,150],27:[2,150],28:[2,150],29:[2,150],30:[2,150],31:[2,150],32:[2,150],33:[2,150],35:[2,150],36:[2,150],37:[2,150],38:[2,150],39:[2,150],40:[2,150],42:[2,150],43:[2,150],44:[2,150],45:[2,150],46:[2,150],47:[2,150],53:[1,47],54:[1,48],63:[2,150]},{1:[2,151],14:[2,151],27:[2,151],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[1,113],43:[1,114],44:[1,117],45:[1,115],46:[1,116],47:[1,118],63:[2,151]},{14:[1,272]},{1:[2,1],3:277,5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,275],14:[2,1],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:9,26:[1,14],27:[2,1],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],55:273,56:21,57:11,58:276,60:274,61:22,62:278,64:10,65:8},{3:277,5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:49,26:[1,51],27:[2,1],29:[1,15],48:[1,53],49:[1,54],50:[1,55],55:279,62:280},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:281,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:282,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:283,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:284,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:285,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:286,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:287,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:288,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:289,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:290,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:291,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:292,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:293,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:294,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:295,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:296,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:297,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:298,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{1:[2,146],14:[2,146],27:[2,146],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[1,113],43:[1,114],44:[1,117],45:[1,115],46:[1,116],47:[1,118],63:[2,146]},{14:[1,299]},{13:[1,263],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[1,257],43:[1,258],44:[1,259],45:[1,260],46:[1,261],47:[1,262],53:[1,80],54:[1,81]},{53:[1,47],54:[1,48]},{1:[2,149],14:[2,149],27:[2,149],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[1,113],43:[1,114],44:[1,117],45:[1,115],46:[1,116],47:[1,118],63:[2,149]},{13:[2,18],21:[2,18],26:[1,300],27:[2,18],28:[2,18],29:[2,18],30:[2,18],31:[2,18],32:[2,18],33:[2,18],34:[2,18],35:[2,18],36:[2,18],37:[2,18],38:[2,18],39:[2,18],40:[2,18],41:[2,18],42:[2,18],43:[2,18],44:[2,18],45:[2,18],46:[2,18],47:[2,18],53:[2,18],54:[2,18],59:[1,103],63:[2,18]},{8:[1,303],10:[1,301],13:[1,302]},{8:[2,4],10:[2,4],11:[2,4],13:[2,4],14:[2,4]},{8:[1,303],11:[1,304],13:[1,305]},{1:[2,186],13:[1,82],14:[2,186],27:[2,186],28:[1,61],29:[1,62],30:[1,63],31:[1,64],32:[1,65],33:[1,66],35:[1,67],36:[1,68],37:[1,69],38:[1,70],39:[1,71],40:[1,72],41:[1,73],42:[1,74],43:[1,75],44:[1,76],45:[1,77],46:[1,78],47:[1,79],53:[1,80],54:[1,81],63:[2,186]},{1:[2,192],14:[2,192],27:[2,192],53:[1,47],54:[1,48],63:[2,192]},{1:[2,193],14:[2,193],27:[2,193],63:[2,193]},{1:[2,196],14:[2,196]},{1:[2,16],14:[2,16],27:[2,16],28:[2,16],29:[2,16],30:[2,16],31:[2,16],32:[2,16],33:[2,16],35:[2,16],36:[2,16],37:[2,16],38:[2,16],39:[2,16],40:[2,16],42:[2,16],43:[2,16],44:[2,16],45:[2,16],46:[2,16],47:[2,16],63:[2,16]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:306,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:307,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:308,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:309,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:310,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:311,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:312,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:313,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:314,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:315,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:316,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:317,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:318,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:214,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:319,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:320,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:321,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:322,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:323,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:324,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{16:[1,243],19:241},{27:[1,244],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81]},{4:41,5:[1,44],6:[1,45],9:42,10:[1,57],11:[1,58],15:325,16:[1,39],17:[1,40]},{1:[2,51],13:[2,51],14:[2,51],27:[2,51],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,51],43:[2,51],44:[2,51],45:[2,51],46:[2,51],47:[2,51],51:[2,51],52:[2,51],53:[2,51],54:[2,51],63:[2,51]},{1:[2,52],13:[2,52],14:[2,52],27:[2,52],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,52],43:[2,52],44:[2,52],45:[2,52],46:[2,52],47:[2,52],51:[2,52],52:[2,52],53:[2,52],54:[2,52],63:[2,52]},{28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],51:[1,326],53:[1,80],54:[1,81]},{3:277,5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:49,26:[1,51],27:[2,1],29:[1,15],48:[1,53],49:[1,54],50:[1,55],55:327,62:280},{8:[1,303],10:[1,301]},{8:[1,303],11:[1,304]},{1:[2,194],14:[2,194],27:[2,194],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,194]},{1:[2,30],13:[1,263],14:[2,30],27:[2,30],28:[2,30],29:[2,30],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[2,30],36:[2,30],37:[2,30],38:[2,30],39:[2,30],40:[2,30],41:[2,30],42:[2,30],43:[2,30],44:[2,30],45:[2,30],46:[2,30],47:[2,30],51:[2,30],52:[2,30],53:[2,30],54:[2,30],63:[2,30]},{1:[2,65],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,65],16:[1,56],17:[1,25],19:52,20:50,23:12,25:328,26:[1,51],27:[2,65],28:[2,65],29:[2,65],30:[2,65],31:[2,65],32:[2,65],33:[2,65],35:[2,65],36:[2,65],37:[2,65],38:[2,65],39:[2,65],40:[2,65],42:[2,65],43:[2,65],44:[2,65],45:[2,65],46:[2,65],47:[2,65],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,65]},{1:[2,66],14:[2,66],27:[2,66],28:[2,66],29:[2,66],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[2,66],36:[2,66],37:[2,66],38:[2,66],39:[2,66],40:[2,66],42:[2,66],43:[2,66],44:[2,66],45:[2,66],46:[2,66],47:[2,66],63:[2,66]},{14:[1,329]},{1:[2,31],13:[1,263],14:[2,31],27:[2,31],28:[2,31],29:[2,31],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[2,31],36:[2,31],37:[2,31],38:[2,31],39:[2,31],40:[2,31],41:[2,31],42:[2,31],43:[2,31],44:[2,31],45:[2,31],46:[2,31],47:[2,31],51:[2,31],52:[2,31],53:[2,31],54:[2,31],63:[2,31]},{1:[2,69],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,69],16:[1,56],17:[1,25],19:52,20:50,23:12,25:330,26:[1,51],27:[2,69],28:[2,69],29:[2,69],30:[2,69],31:[2,69],32:[2,69],33:[2,69],35:[2,69],36:[2,69],37:[2,69],38:[2,69],39:[2,69],40:[2,69],42:[2,69],43:[2,69],44:[2,69],45:[2,69],46:[2,69],47:[2,69],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,69]},{1:[2,70],14:[2,70],27:[2,70],28:[2,70],29:[2,70],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[2,70],36:[2,70],37:[2,70],38:[2,70],39:[2,70],40:[2,70],42:[2,70],43:[2,70],44:[2,70],45:[2,70],46:[2,70],47:[2,70],63:[2,70]},{14:[1,331]},{1:[2,32],13:[1,263],14:[2,32],27:[2,32],28:[2,32],29:[2,32],30:[2,32],31:[2,32],32:[1,249],33:[1,250],35:[2,32],36:[2,32],37:[2,32],38:[2,32],39:[2,32],40:[2,32],41:[2,32],42:[2,32],43:[2,32],44:[2,32],45:[2,32],46:[2,32],47:[2,32],51:[2,32],52:[2,32],53:[2,32],54:[2,32],63:[2,32]},{1:[2,73],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,73],16:[1,56],17:[1,25],19:52,20:50,23:12,25:332,26:[1,51],27:[2,73],28:[2,73],29:[2,73],30:[2,73],31:[2,73],32:[2,73],33:[2,73],35:[2,73],36:[2,73],37:[2,73],38:[2,73],39:[2,73],40:[2,73],42:[2,73],43:[2,73],44:[2,73],45:[2,73],46:[2,73],47:[2,73],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,73]},{1:[2,74],14:[2,74],27:[2,74],28:[2,74],29:[2,74],30:[2,74],31:[2,74],32:[1,108],33:[1,109],35:[2,74],36:[2,74],37:[2,74],38:[2,74],39:[2,74],40:[2,74],42:[2,74],43:[2,74],44:[2,74],45:[2,74],46:[2,74],47:[2,74],63:[2,74]},{14:[1,333]},{1:[2,33],13:[1,263],14:[2,33],27:[2,33],28:[2,33],29:[2,33],30:[2,33],31:[2,33],32:[1,249],33:[1,250],35:[2,33],36:[2,33],37:[2,33],38:[2,33],39:[2,33],40:[2,33],41:[2,33],42:[2,33],43:[2,33],44:[2,33],45:[2,33],46:[2,33],47:[2,33],51:[2,33],52:[2,33],53:[2,33],54:[2,33],63:[2,33]},{1:[2,77],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,77],16:[1,56],17:[1,25],19:52,20:50,23:12,25:334,26:[1,51],27:[2,77],28:[2,77],29:[2,77],30:[2,77],31:[2,77],32:[2,77],33:[2,77],35:[2,77],36:[2,77],37:[2,77],38:[2,77],39:[2,77],40:[2,77],42:[2,77],43:[2,77],44:[2,77],45:[2,77],46:[2,77],47:[2,77],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,77]},{1:[2,78],14:[2,78],27:[2,78],28:[2,78],29:[2,78],30:[2,78],31:[2,78],32:[1,108],33:[1,109],35:[2,78],36:[2,78],37:[2,78],38:[2,78],39:[2,78],40:[2,78],42:[2,78],43:[2,78],44:[2,78],45:[2,78],46:[2,78],47:[2,78],63:[2,78]},{14:[1,335]},{1:[2,34],13:[1,263],14:[2,34],27:[2,34],28:[2,34],29:[2,34],30:[2,34],31:[2,34],32:[2,34],33:[2,34],35:[2,34],36:[2,34],37:[2,34],38:[2,34],39:[2,34],40:[2,34],41:[2,34],42:[2,34],43:[2,34],44:[2,34],45:[2,34],46:[2,34],47:[2,34],51:[2,34],52:[2,34],53:[2,34],54:[2,34],63:[2,34]},{1:[2,81],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,81],16:[1,56],17:[1,25],19:52,20:50,23:12,25:336,26:[1,51],27:[2,81],28:[2,81],29:[2,81],30:[2,81],31:[2,81],32:[2,81],33:[2,81],35:[2,81],36:[2,81],37:[2,81],38:[2,81],39:[2,81],40:[2,81],42:[2,81],43:[2,81],44:[2,81],45:[2,81],46:[2,81],47:[2,81],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,81]},{1:[2,82],14:[2,82],27:[2,82],28:[2,82],29:[2,82],30:[2,82],31:[2,82],32:[2,82],33:[2,82],35:[2,82],36:[2,82],37:[2,82],38:[2,82],39:[2,82],40:[2,82],42:[2,82],43:[2,82],44:[2,82],45:[2,82],46:[2,82],47:[2,82],63:[2,82]},{14:[1,337]},{1:[2,35],13:[1,263],14:[2,35],27:[2,35],28:[2,35],29:[2,35],30:[2,35],31:[2,35],32:[2,35],33:[2,35],35:[2,35],36:[2,35],37:[2,35],38:[2,35],39:[2,35],40:[2,35],41:[2,35],42:[2,35],43:[2,35],44:[2,35],45:[2,35],46:[2,35],47:[2,35],51:[2,35],52:[2,35],53:[2,35],54:[2,35],63:[2,35]},{1:[2,85],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,85],16:[1,56],17:[1,25],19:52,20:50,23:12,25:338,26:[1,51],27:[2,85],28:[2,85],29:[2,85],30:[2,85],31:[2,85],32:[2,85],33:[2,85],35:[2,85],36:[2,85],37:[2,85],38:[2,85],39:[2,85],40:[2,85],42:[2,85],43:[2,85],44:[2,85],45:[2,85],46:[2,85],47:[2,85],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,85]},{1:[2,86],14:[2,86],27:[2,86],28:[2,86],29:[2,86],30:[2,86],31:[2,86],32:[2,86],33:[2,86],35:[2,86],36:[2,86],37:[2,86],38:[2,86],39:[2,86],40:[2,86],42:[2,86],43:[2,86],44:[2,86],45:[2,86],46:[2,86],47:[2,86],63:[2,86]},{14:[1,339]},{1:[2,38],13:[1,263],14:[2,38],27:[2,38],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[2,38],36:[2,38],37:[2,38],38:[2,38],39:[2,38],40:[2,38],41:[2,38],42:[2,38],43:[2,38],44:[2,38],45:[2,38],46:[2,38],47:[2,38],51:[2,38],52:[2,38],53:[2,38],54:[2,38],63:[2,38]},{1:[2,125],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,125],16:[1,56],17:[1,25],19:52,20:50,23:12,25:340,26:[1,51],27:[2,125],28:[2,125],29:[1,15],30:[2,125],31:[2,125],32:[2,125],33:[2,125],35:[2,125],36:[2,125],37:[2,125],38:[2,125],39:[2,125],40:[2,125],42:[2,125],43:[2,125],44:[2,125],45:[2,125],46:[2,125],47:[2,125],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,125]},{1:[2,126],14:[2,126],27:[2,126],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[2,126],36:[2,126],37:[2,126],38:[2,126],39:[2,126],40:[2,126],42:[2,126],43:[2,126],44:[2,126],45:[2,126],46:[2,126],47:[2,126],63:[2,126]},{14:[1,341]},{1:[2,39],13:[1,263],14:[2,39],27:[2,39],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[2,39],36:[2,39],37:[2,39],38:[2,39],39:[2,39],40:[2,39],41:[2,39],42:[2,39],43:[2,39],44:[2,39],45:[2,39],46:[2,39],47:[2,39],51:[2,39],52:[2,39],53:[2,39],54:[2,39],63:[2,39]},{1:[2,133],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,133],16:[1,56],17:[1,25],19:52,20:50,23:12,25:342,26:[1,51],27:[2,133],28:[2,133],29:[1,15],30:[2,133],31:[2,133],32:[2,133],33:[2,133],35:[2,133],36:[2,133],37:[2,133],38:[2,133],39:[2,133],40:[2,133],42:[2,133],43:[2,133],44:[2,133],45:[2,133],46:[2,133],47:[2,133],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,133]},{1:[2,134],14:[2,134],27:[2,134],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[2,134],36:[2,134],37:[2,134],38:[2,134],39:[2,134],40:[2,134],42:[2,134],43:[2,134],44:[2,134],45:[2,134],46:[2,134],47:[2,134],63:[2,134]},{14:[1,343]},{1:[2,40],13:[1,263],14:[2,40],27:[2,40],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[2,40],36:[2,40],37:[2,40],38:[2,40],39:[2,40],40:[2,40],41:[2,40],42:[2,40],43:[2,40],44:[2,40],45:[2,40],46:[2,40],47:[2,40],51:[2,40],52:[2,40],53:[2,40],54:[2,40],63:[2,40]},{1:[2,129],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,129],16:[1,56],17:[1,25],19:52,20:50,23:12,25:344,26:[1,51],27:[2,129],28:[2,129],29:[1,15],30:[2,129],31:[2,129],32:[2,129],33:[2,129],35:[2,129],36:[2,129],37:[2,129],38:[2,129],39:[2,129],40:[2,129],42:[2,129],43:[2,129],44:[2,129],45:[2,129],46:[2,129],47:[2,129],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,129]},{1:[2,130],14:[2,130],27:[2,130],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[2,130],36:[2,130],37:[2,130],38:[2,130],39:[2,130],40:[2,130],42:[2,130],43:[2,130],44:[2,130],45:[2,130],46:[2,130],47:[2,130],63:[2,130]},{14:[1,345]},{1:[2,41],13:[1,263],14:[2,41],27:[2,41],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[2,41],36:[2,41],37:[2,41],38:[2,41],39:[2,41],40:[2,41],41:[2,41],42:[2,41],43:[2,41],44:[2,41],45:[2,41],46:[2,41],47:[2,41],51:[2,41],52:[2,41],53:[2,41],54:[2,41],63:[2,41]},{1:[2,89],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,89],16:[1,56],17:[1,25],19:52,20:50,23:12,25:346,26:[1,51],27:[2,89],28:[2,89],29:[1,15],30:[2,89],31:[2,89],32:[2,89],33:[2,89],35:[2,89],36:[2,89],37:[2,89],38:[2,89],39:[2,89],40:[2,89],42:[2,89],43:[2,89],44:[2,89],45:[2,89],46:[2,89],47:[2,89],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,89]},{1:[2,90],14:[2,90],27:[2,90],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[2,90],36:[2,90],37:[2,90],38:[2,90],39:[2,90],40:[2,90],42:[2,90],43:[2,90],44:[2,90],45:[2,90],46:[2,90],47:[2,90],63:[2,90]},{14:[1,347]},{1:[2,42],13:[1,263],14:[2,42],27:[2,42],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[2,42],36:[2,42],37:[2,42],38:[2,42],39:[2,42],40:[2,42],41:[2,42],42:[2,42],43:[2,42],44:[2,42],45:[2,42],46:[2,42],47:[2,42],51:[2,42],52:[2,42],53:[2,42],54:[2,42],63:[2,42]},{1:[2,93],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,93],16:[1,56],17:[1,25],19:52,20:50,23:12,25:348,26:[1,51],27:[2,93],28:[2,93],29:[1,15],30:[2,93],31:[2,93],32:[2,93],33:[2,93],35:[2,93],36:[2,93],37:[2,93],38:[2,93],39:[2,93],40:[2,93],42:[2,93],43:[2,93],44:[2,93],45:[2,93],46:[2,93],47:[2,93],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,93]},{1:[2,94],14:[2,94],27:[2,94],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[2,94],36:[2,94],37:[2,94],38:[2,94],39:[2,94],40:[2,94],42:[2,94],43:[2,94],44:[2,94],45:[2,94],46:[2,94],47:[2,94],63:[2,94]},{14:[1,349]},{1:[2,43],13:[1,263],14:[2,43],27:[2,43],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[2,43],36:[2,43],37:[2,43],38:[2,43],39:[2,43],40:[2,43],41:[2,43],42:[2,43],43:[2,43],44:[2,43],45:[2,43],46:[2,43],47:[2,43],51:[2,43],52:[2,43],53:[2,43],54:[2,43],63:[2,43]},{1:[2,97],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,97],16:[1,56],17:[1,25],19:52,20:50,23:12,25:350,26:[1,51],27:[2,97],28:[2,97],29:[1,15],30:[2,97],31:[2,97],32:[2,97],33:[2,97],35:[2,97],36:[2,97],37:[2,97],38:[2,97],39:[2,97],40:[2,97],42:[2,97],43:[2,97],44:[2,97],45:[2,97],46:[2,97],47:[2,97],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,97]},{1:[2,98],14:[2,98],27:[2,98],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[2,98],36:[2,98],37:[2,98],38:[2,98],39:[2,98],40:[2,98],42:[2,98],43:[2,98],44:[2,98],45:[2,98],46:[2,98],47:[2,98],63:[2,98]},{14:[1,351]},{1:[2,44],13:[2,44],14:[2,44],27:[2,44],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,44],36:[2,44],37:[2,44],38:[2,44],39:[2,44],40:[2,44],41:[2,44],42:[2,44],43:[2,44],44:[2,44],45:[2,44],46:[2,44],47:[2,44],51:[2,44],52:[2,44],53:[2,44],54:[2,44],63:[2,44]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:352,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{1:[2,45],13:[1,263],14:[2,45],27:[2,45],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[2,45],43:[2,45],44:[2,45],45:[2,45],46:[2,45],47:[2,45],51:[2,45],52:[2,45],53:[2,45],54:[2,45],63:[2,45]},{1:[2,101],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,101],16:[1,56],17:[1,25],19:52,20:50,23:12,25:353,26:[1,51],27:[2,101],28:[2,101],29:[1,15],30:[2,101],31:[2,101],32:[2,101],33:[2,101],35:[2,101],36:[2,101],37:[2,101],38:[2,101],39:[2,101],40:[2,101],42:[2,101],43:[2,101],44:[2,101],45:[2,101],46:[2,101],47:[2,101],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,101]},{1:[2,102],14:[2,102],27:[2,102],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[2,102],43:[2,102],44:[2,102],45:[2,102],46:[2,102],47:[2,102],63:[2,102]},{14:[1,354]},{1:[2,46],13:[1,263],14:[2,46],27:[2,46],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[2,46],43:[2,46],44:[2,46],45:[2,46],46:[2,46],47:[2,46],51:[2,46],52:[2,46],53:[2,46],54:[2,46],63:[2,46]},{1:[2,105],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,105],16:[1,56],17:[1,25],19:52,20:50,23:12,25:355,26:[1,51],27:[2,105],28:[2,105],29:[1,15],30:[2,105],31:[2,105],32:[2,105],33:[2,105],35:[2,105],36:[2,105],37:[2,105],38:[2,105],39:[2,105],40:[2,105],42:[2,105],43:[2,105],44:[2,105],45:[2,105],46:[2,105],47:[2,105],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,105]},{1:[2,106],14:[2,106],27:[2,106],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[2,106],43:[2,106],44:[2,106],45:[2,106],46:[2,106],47:[2,106],63:[2,106]},{14:[1,356]},{1:[2,47],13:[1,263],14:[2,47],27:[2,47],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[2,47],43:[2,47],44:[2,47],45:[2,47],46:[2,47],47:[2,47],51:[2,47],52:[2,47],53:[2,47],54:[2,47],63:[2,47]},{1:[2,117],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,117],16:[1,56],17:[1,25],19:52,20:50,23:12,25:357,26:[1,51],27:[2,117],28:[2,117],29:[1,15],30:[2,117],31:[2,117],32:[2,117],33:[2,117],35:[2,117],36:[2,117],37:[2,117],38:[2,117],39:[2,117],40:[2,117],42:[2,117],43:[2,117],44:[2,117],45:[2,117],46:[2,117],47:[2,117],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,117]},{1:[2,118],14:[2,118],27:[2,118],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[2,118],43:[2,118],44:[2,118],45:[2,118],46:[2,118],47:[2,118],63:[2,118]},{14:[1,358]},{1:[2,48],13:[1,263],14:[2,48],27:[2,48],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[2,48],43:[2,48],44:[2,48],45:[2,48],46:[2,48],47:[2,48],51:[2,48],52:[2,48],53:[2,48],54:[2,48],63:[2,48]},{1:[2,109],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,109],16:[1,56],17:[1,25],19:52,20:50,23:12,25:359,26:[1,51],27:[2,109],28:[2,109],29:[1,15],30:[2,109],31:[2,109],32:[2,109],33:[2,109],35:[2,109],36:[2,109],37:[2,109],38:[2,109],39:[2,109],40:[2,109],42:[2,109],43:[2,109],44:[2,109],45:[2,109],46:[2,109],47:[2,109],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,109]},{1:[2,110],14:[2,110],27:[2,110],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[2,110],43:[2,110],44:[2,110],45:[2,110],46:[2,110],47:[2,110],63:[2,110]},{14:[1,360]},{1:[2,49],13:[1,263],14:[2,49],27:[2,49],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[2,49],43:[2,49],44:[2,49],45:[2,49],46:[2,49],47:[2,49],51:[2,49],52:[2,49],53:[2,49],54:[2,49],63:[2,49]},{1:[2,113],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,113],16:[1,56],17:[1,25],19:52,20:50,23:12,25:361,26:[1,51],27:[2,113],28:[2,113],29:[1,15],30:[2,113],31:[2,113],32:[2,113],33:[2,113],35:[2,113],36:[2,113],37:[2,113],38:[2,113],39:[2,113],40:[2,113],42:[2,113],43:[2,113],44:[2,113],45:[2,113],46:[2,113],47:[2,113],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,113]},{1:[2,114],14:[2,114],27:[2,114],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[2,114],43:[2,114],44:[2,114],45:[2,114],46:[2,114],47:[2,114],63:[2,114]},{14:[1,362]},{1:[2,50],13:[1,263],14:[2,50],27:[2,50],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[2,50],43:[2,50],44:[2,50],45:[2,50],46:[2,50],47:[2,50],51:[2,50],52:[2,50],53:[2,50],54:[2,50],63:[2,50]},{1:[2,121],5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,121],16:[1,56],17:[1,25],19:52,20:50,23:12,25:363,26:[1,51],27:[2,121],28:[2,121],29:[1,15],30:[2,121],31:[2,121],32:[2,121],33:[2,121],35:[2,121],36:[2,121],37:[2,121],38:[2,121],39:[2,121],40:[2,121],42:[2,121],43:[2,121],44:[2,121],45:[2,121],46:[2,121],47:[2,121],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],63:[2,121]},{1:[2,122],14:[2,122],27:[2,122],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[2,122],43:[2,122],44:[2,122],45:[2,122],46:[2,122],47:[2,122],63:[2,122]},{14:[1,364]},{1:[2,165],14:[2,165],27:[2,165],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,165]},{1:[2,20],13:[2,20],14:[2,20],21:[2,20],27:[2,20],28:[2,20],29:[2,20],30:[2,20],31:[2,20],32:[2,20],33:[2,20],35:[2,20],36:[2,20],37:[2,20],38:[2,20],39:[2,20],40:[2,20],41:[2,20],42:[2,20],43:[2,20],44:[2,20],45:[2,20],46:[2,20],47:[2,20],51:[2,20],52:[2,20],53:[2,20],54:[2,20],63:[2,20]},{1:[2,21],14:[2,21],27:[2,21],28:[2,21],29:[2,21],30:[2,21],31:[2,21],32:[2,21],33:[2,21],35:[2,21],36:[2,21],37:[2,21],38:[2,21],39:[2,21],40:[2,21],42:[2,21],43:[2,21],44:[2,21],45:[2,21],46:[2,21],47:[2,21],63:[2,21]},{1:[2,18],13:[2,18],14:[2,18],21:[2,18],27:[2,18],28:[2,18],29:[2,18],30:[2,18],31:[2,18],32:[2,18],33:[2,18],35:[2,18],36:[2,18],37:[2,18],38:[2,18],39:[2,18],40:[2,18],41:[2,18],42:[2,18],43:[2,18],44:[2,18],45:[2,18],46:[2,18],47:[2,18],51:[2,18],52:[2,18],53:[2,18],54:[2,18],63:[2,18]},{1:[2,29],13:[2,29],14:[2,29],27:[2,29],28:[2,29],29:[2,29],30:[2,29],31:[2,29],32:[2,29],33:[2,29],35:[2,29],36:[2,29],37:[2,29],38:[2,29],39:[2,29],40:[2,29],41:[2,29],42:[2,29],43:[2,29],44:[2,29],45:[2,29],46:[2,29],47:[2,29],51:[2,29],52:[2,29],53:[2,29],54:[2,29],63:[2,29]},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,365],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:166,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:168,57:169},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,366],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:170,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:172,57:173},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,367],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:174,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:176,57:177},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,368],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:178,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:180,57:181},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,369],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:182,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:184,57:185},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,370],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:186,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:188,57:189},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,371],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:190,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:192,57:193},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,372],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:194,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:196,57:197},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,373],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:198,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:200,57:201},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,374],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:202,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:204,57:205},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,375],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:206,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:208,57:209},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,376],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:210,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:212,57:213},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,377],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:216,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:218,57:219},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,378],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:220,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:222,57:223},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,379],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:224,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:226,57:227},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,380],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:228,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:230,57:231},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,381],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:232,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:234,57:235},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,382],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:236,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:238,57:239},{1:[2,60],14:[2,60],27:[2,60],28:[2,60],29:[2,60],30:[2,60],31:[2,60],32:[2,60],33:[2,60],35:[2,60],36:[2,60],37:[2,60],38:[2,60],39:[2,60],40:[2,60],42:[2,60],43:[2,60],44:[2,60],45:[2,60],46:[2,60],47:[2,60],63:[2,60]},{1:[2,64],14:[2,64],27:[2,64],28:[2,64],29:[2,64],30:[2,64],31:[2,64],32:[2,64],33:[2,64],35:[2,64],36:[2,64],37:[2,64],38:[2,64],39:[2,64],40:[2,64],42:[2,64],43:[2,64],44:[2,64],45:[2,64],46:[2,64],47:[2,64],63:[2,64]},{1:[2,63],14:[2,63],27:[2,63],28:[2,63],29:[2,63],30:[2,63],31:[2,63],32:[2,63],33:[2,63],35:[2,63],36:[2,63],37:[2,63],38:[2,63],39:[2,63],40:[2,63],42:[2,63],43:[2,63],44:[2,63],45:[2,63],46:[2,63],47:[2,63],63:[2,63]},{1:[2,37],13:[1,135],14:[2,37],27:[2,37],28:[2,37],29:[2,37],30:[2,37],31:[2,37],32:[2,37],33:[2,37],35:[2,37],36:[2,37],37:[2,37],38:[2,37],39:[2,37],40:[2,37],41:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],47:[2,37],51:[2,37],52:[2,37],53:[2,37],54:[2,37],63:[2,37]},{1:[2,137],14:[2,137],27:[2,137],28:[2,137],29:[2,137],30:[2,137],31:[2,137],32:[2,137],33:[2,137],35:[2,137],36:[2,137],37:[2,137],38:[2,137],39:[2,137],40:[2,137],42:[2,137],43:[2,137],44:[2,137],45:[2,137],46:[2,137],47:[2,137],63:[2,137]},{1:[2,138],14:[2,138],27:[2,138],28:[2,138],29:[2,138],30:[2,138],31:[2,138],32:[2,138],33:[2,138],35:[2,138],36:[2,138],37:[2,138],38:[2,138],39:[2,138],40:[2,138],42:[2,138],43:[2,138],44:[2,138],45:[2,138],46:[2,138],47:[2,138],63:[2,138]},{1:[2,141],14:[2,141],27:[2,141],28:[2,141],29:[2,141],30:[2,141],31:[2,141],32:[2,141],33:[2,141],35:[2,141],36:[2,141],37:[2,141],38:[2,141],39:[2,141],40:[2,141],42:[2,141],43:[2,141],44:[2,141],45:[2,141],46:[2,141],47:[2,141],63:[2,141]},{1:[2,144],14:[2,144],27:[2,144],28:[2,144],29:[2,144],30:[2,144],31:[2,144],32:[2,144],33:[2,144],35:[2,144],36:[2,144],37:[2,144],38:[2,144],39:[2,144],40:[2,144],42:[2,144],43:[2,144],44:[2,144],45:[2,144],46:[2,144],47:[2,144],63:[2,144]},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,384],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:383,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:385,57:386},{1:[2,152],14:[2,152],27:[2,152],28:[2,152],29:[2,152],30:[2,152],31:[2,152],32:[2,152],33:[2,152],35:[2,152],36:[2,152],37:[2,152],38:[2,152],39:[2,152],40:[2,152],42:[2,152],43:[2,152],44:[2,152],45:[2,152],46:[2,152],47:[2,152],63:[2,152]},{1:[2,163],14:[2,163],27:[1,387]},{1:[2,162],14:[2,162]},{1:[2,164],3:277,5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],14:[2,164],16:[1,56],17:[1,25],19:52,20:50,23:12,25:49,26:[1,51],27:[2,1],29:[1,15],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],55:388,62:280},{1:[2,197],14:[2,197],27:[1,389],63:[1,60]},{1:[2,187],14:[2,187],27:[2,187]},{1:[2,188],14:[2,188],27:[2,188],63:[1,35]},{27:[1,390]},{27:[2,188],63:[1,136]},{1:[2,68],14:[2,68],27:[2,68],28:[2,68],29:[2,68],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,68],36:[2,68],37:[2,68],38:[2,68],39:[2,68],40:[2,68],41:[1,149],42:[2,68],43:[2,68],44:[2,68],45:[2,68],46:[2,68],47:[2,68],53:[1,80],54:[1,81],63:[2,68]},{1:[2,72],14:[2,72],27:[2,72],28:[2,72],29:[2,72],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,72],36:[2,72],37:[2,72],38:[2,72],39:[2,72],40:[2,72],41:[1,149],42:[2,72],43:[2,72],44:[2,72],45:[2,72],46:[2,72],47:[2,72],53:[1,80],54:[1,81],63:[2,72]},{1:[2,76],14:[2,76],27:[2,76],28:[2,76],29:[2,76],30:[2,76],31:[2,76],32:[1,141],33:[1,142],35:[2,76],36:[2,76],37:[2,76],38:[2,76],39:[2,76],40:[2,76],41:[1,149],42:[2,76],43:[2,76],44:[2,76],45:[2,76],46:[2,76],47:[2,76],53:[1,80],54:[1,81],63:[2,76]},{1:[2,80],14:[2,80],27:[2,80],28:[2,80],29:[2,80],30:[2,80],31:[2,80],32:[1,141],33:[1,142],35:[2,80],36:[2,80],37:[2,80],38:[2,80],39:[2,80],40:[2,80],41:[1,149],42:[2,80],43:[2,80],44:[2,80],45:[2,80],46:[2,80],47:[2,80],53:[1,80],54:[1,81],63:[2,80]},{1:[2,84],14:[2,84],27:[2,84],28:[2,84],29:[2,84],30:[2,84],31:[2,84],32:[2,84],33:[2,84],35:[2,84],36:[2,84],37:[2,84],38:[2,84],39:[2,84],40:[2,84],41:[1,149],42:[2,84],43:[2,84],44:[2,84],45:[2,84],46:[2,84],47:[2,84],53:[1,80],54:[1,81],63:[2,84]},{1:[2,88],14:[2,88],27:[2,88],28:[2,88],29:[2,88],30:[2,88],31:[2,88],32:[2,88],33:[2,88],35:[2,88],36:[2,88],37:[2,88],38:[2,88],39:[2,88],40:[2,88],41:[1,149],42:[2,88],43:[2,88],44:[2,88],45:[2,88],46:[2,88],47:[2,88],53:[1,80],54:[1,81],63:[2,88]},{1:[2,92],14:[2,92],27:[2,92],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,92],36:[2,92],37:[2,92],38:[2,92],39:[2,92],40:[2,92],41:[1,149],42:[2,92],43:[2,92],44:[2,92],45:[2,92],46:[2,92],47:[2,92],53:[1,80],54:[1,81],63:[2,92]},{1:[2,96],14:[2,96],27:[2,96],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,96],36:[2,96],37:[2,96],38:[2,96],39:[2,96],40:[2,96],41:[1,149],42:[2,96],43:[2,96],44:[2,96],45:[2,96],46:[2,96],47:[2,96],53:[1,80],54:[1,81],63:[2,96]},{1:[2,100],14:[2,100],27:[2,100],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,100],36:[2,100],37:[2,100],38:[2,100],39:[2,100],40:[2,100],41:[1,149],42:[2,100],43:[2,100],44:[2,100],45:[2,100],46:[2,100],47:[2,100],53:[1,80],54:[1,81],63:[2,100]},{1:[2,104],14:[2,104],27:[2,104],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,104],43:[2,104],44:[2,104],45:[2,104],46:[2,104],47:[2,104],53:[1,80],54:[1,81],63:[2,104]},{1:[2,108],14:[2,108],27:[2,108],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,108],43:[2,108],44:[2,108],45:[2,108],46:[2,108],47:[2,108],53:[1,80],54:[1,81],63:[2,108]},{1:[2,112],14:[2,112],27:[2,112],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,112],43:[2,112],44:[2,112],45:[2,112],46:[2,112],47:[2,112],53:[1,80],54:[1,81],63:[2,112]},{1:[2,116],14:[2,116],27:[2,116],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,116],43:[2,116],44:[2,116],45:[2,116],46:[2,116],47:[2,116],53:[1,80],54:[1,81],63:[2,116]},{1:[2,120],14:[2,120],27:[2,120],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,120],43:[2,120],44:[2,120],45:[2,120],46:[2,120],47:[2,120],53:[1,80],54:[1,81],63:[2,120]},{1:[2,124],14:[2,124],27:[2,124],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,124],43:[2,124],44:[2,124],45:[2,124],46:[2,124],47:[2,124],53:[1,80],54:[1,81],63:[2,124]},{1:[2,128],14:[2,128],27:[2,128],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,128],36:[2,128],37:[2,128],38:[2,128],39:[2,128],40:[2,128],41:[1,149],42:[2,128],43:[2,128],44:[2,128],45:[2,128],46:[2,128],47:[2,128],53:[1,80],54:[1,81],63:[2,128]},{1:[2,132],14:[2,132],27:[2,132],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,132],36:[2,132],37:[2,132],38:[2,132],39:[2,132],40:[2,132],41:[1,149],42:[2,132],43:[2,132],44:[2,132],45:[2,132],46:[2,132],47:[2,132],53:[1,80],54:[1,81],63:[2,132]},{1:[2,136],14:[2,136],27:[2,136],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,136],36:[2,136],37:[2,136],38:[2,136],39:[2,136],40:[2,136],41:[1,149],42:[2,136],43:[2,136],44:[2,136],45:[2,136],46:[2,136],47:[2,136],53:[1,80],54:[1,81],63:[2,136]},{1:[2,147],14:[2,147],27:[2,147],28:[2,147],29:[2,147],30:[2,147],31:[2,147],32:[2,147],33:[2,147],35:[2,147],36:[2,147],37:[2,147],38:[2,147],39:[2,147],40:[2,147],42:[2,147],43:[2,147],44:[2,147],45:[2,147],46:[2,147],47:[2,147],63:[2,147]},{3:277,5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,391],16:[1,127],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:9,26:[1,14],27:[2,1],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],55:327,56:21,58:392,61:22,62:393,64:10},{1:[2,6],13:[2,6],14:[2,6],27:[2,6],28:[2,6],29:[2,6],30:[2,6],31:[2,6],32:[2,6],33:[2,6],35:[2,6],36:[2,6],37:[2,6],38:[2,6],39:[2,6],40:[2,6],41:[2,6],42:[2,6],43:[2,6],44:[2,6],45:[2,6],46:[2,6],47:[2,6],51:[2,6],52:[2,6],53:[2,6],54:[2,6],63:[2,6]},{3:129,7:394,8:[2,1],10:[2,1],14:[2,1]},{8:[2,5],10:[2,5],11:[2,5],13:[2,5],14:[2,5]},{1:[2,7],13:[2,7],14:[2,7],27:[2,7],28:[2,7],29:[2,7],30:[2,7],31:[2,7],32:[2,7],33:[2,7],35:[2,7],36:[2,7],37:[2,7],38:[2,7],39:[2,7],40:[2,7],41:[2,7],42:[2,7],43:[2,7],44:[2,7],45:[2,7],46:[2,7],47:[2,7],51:[2,7],52:[2,7],53:[2,7],54:[2,7],63:[2,7]},{3:129,7:395,8:[2,1],11:[2,1],14:[2,1]},{1:[2,186],14:[2,186],27:[2,186],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,186]},{1:[2,30],13:[2,30],14:[2,30],27:[2,30],28:[2,30],29:[2,30],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,30],36:[2,30],37:[2,30],38:[2,30],39:[2,30],40:[2,30],41:[2,30],42:[2,30],43:[2,30],44:[2,30],45:[2,30],46:[2,30],47:[2,30],51:[2,30],52:[2,30],53:[2,30],54:[2,30],63:[2,30]},{1:[2,31],13:[2,31],14:[2,31],27:[2,31],28:[2,31],29:[2,31],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,31],36:[2,31],37:[2,31],38:[2,31],39:[2,31],40:[2,31],41:[2,31],42:[2,31],43:[2,31],44:[2,31],45:[2,31],46:[2,31],47:[2,31],51:[2,31],52:[2,31],53:[2,31],54:[2,31],63:[2,31]},{1:[2,32],13:[2,32],14:[2,32],27:[2,32],28:[2,32],29:[2,32],30:[2,32],31:[2,32],32:[1,141],33:[1,142],35:[2,32],36:[2,32],37:[2,32],38:[2,32],39:[2,32],40:[2,32],41:[2,32],42:[2,32],43:[2,32],44:[2,32],45:[2,32],46:[2,32],47:[2,32],51:[2,32],52:[2,32],53:[2,32],54:[2,32],63:[2,32]},{1:[2,33],13:[2,33],14:[2,33],27:[2,33],28:[2,33],29:[2,33],30:[2,33],31:[2,33],32:[1,141],33:[1,142],35:[2,33],36:[2,33],37:[2,33],38:[2,33],39:[2,33],40:[2,33],41:[2,33],42:[2,33],43:[2,33],44:[2,33],45:[2,33],46:[2,33],47:[2,33],51:[2,33],52:[2,33],53:[2,33],54:[2,33],63:[2,33]},{1:[2,34],13:[2,34],14:[2,34],27:[2,34],28:[2,34],29:[2,34],30:[2,34],31:[2,34],32:[2,34],33:[2,34],35:[2,34],36:[2,34],37:[2,34],38:[2,34],39:[2,34],40:[2,34],41:[2,34],42:[2,34],43:[2,34],44:[2,34],45:[2,34],46:[2,34],47:[2,34],51:[2,34],52:[2,34],53:[2,34],54:[2,34],63:[2,34]},{1:[2,35],13:[2,35],14:[2,35],27:[2,35],28:[2,35],29:[2,35],30:[2,35],31:[2,35],32:[2,35],33:[2,35],35:[2,35],36:[2,35],37:[2,35],38:[2,35],39:[2,35],40:[2,35],41:[2,35],42:[2,35],43:[2,35],44:[2,35],45:[2,35],46:[2,35],47:[2,35],51:[2,35],52:[2,35],53:[2,35],54:[2,35],63:[2,35]},{1:[2,38],13:[2,38],14:[2,38],27:[2,38],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,38],36:[2,38],37:[2,38],38:[2,38],39:[2,38],40:[2,38],41:[2,38],42:[2,38],43:[2,38],44:[2,38],45:[2,38],46:[2,38],47:[2,38],51:[2,38],52:[2,38],53:[2,38],54:[2,38],63:[2,38]},{1:[2,39],13:[2,39],14:[2,39],27:[2,39],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,39],36:[2,39],37:[2,39],38:[2,39],39:[2,39],40:[2,39],41:[2,39],42:[2,39],43:[2,39],44:[2,39],45:[2,39],46:[2,39],47:[2,39],51:[2,39],52:[2,39],53:[2,39],54:[2,39],63:[2,39]},{1:[2,40],13:[2,40],14:[2,40],27:[2,40],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,40],36:[2,40],37:[2,40],38:[2,40],39:[2,40],40:[2,40],41:[2,40],42:[2,40],43:[2,40],44:[2,40],45:[2,40],46:[2,40],47:[2,40],51:[2,40],52:[2,40],53:[2,40],54:[2,40],63:[2,40]},{1:[2,41],13:[2,41],14:[2,41],27:[2,41],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,41],36:[2,41],37:[2,41],38:[2,41],39:[2,41],40:[2,41],41:[2,41],42:[2,41],43:[2,41],44:[2,41],45:[2,41],46:[2,41],47:[2,41],51:[2,41],52:[2,41],53:[2,41],54:[2,41],63:[2,41]},{1:[2,42],13:[2,42],14:[2,42],27:[2,42],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,42],36:[2,42],37:[2,42],38:[2,42],39:[2,42],40:[2,42],41:[2,42],42:[2,42],43:[2,42],44:[2,42],45:[2,42],46:[2,42],47:[2,42],51:[2,42],52:[2,42],53:[2,42],54:[2,42],63:[2,42]},{1:[2,43],13:[2,43],14:[2,43],27:[2,43],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[2,43],36:[2,43],37:[2,43],38:[2,43],39:[2,43],40:[2,43],41:[2,43],42:[2,43],43:[2,43],44:[2,43],45:[2,43],46:[2,43],47:[2,43],51:[2,43],52:[2,43],53:[2,43],54:[2,43],63:[2,43]},{1:[2,45],13:[2,45],14:[2,45],27:[2,45],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,45],43:[2,45],44:[2,45],45:[2,45],46:[2,45],47:[2,45],51:[2,45],52:[2,45],53:[2,45],54:[2,45],63:[2,45]},{1:[2,46],13:[2,46],14:[2,46],27:[2,46],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,46],43:[2,46],44:[2,46],45:[2,46],46:[2,46],47:[2,46],51:[2,46],52:[2,46],53:[2,46],54:[2,46],63:[2,46]},{1:[2,47],13:[2,47],14:[2,47],27:[2,47],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,47],43:[2,47],44:[2,47],45:[2,47],46:[2,47],47:[2,47],51:[2,47],52:[2,47],53:[2,47],54:[2,47],63:[2,47]},{1:[2,48],13:[2,48],14:[2,48],27:[2,48],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,48],43:[2,48],44:[2,48],45:[2,48],46:[2,48],47:[2,48],51:[2,48],52:[2,48],53:[2,48],54:[2,48],63:[2,48]},{1:[2,49],13:[2,49],14:[2,49],27:[2,49],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,49],43:[2,49],44:[2,49],45:[2,49],46:[2,49],47:[2,49],51:[2,49],52:[2,49],53:[2,49],54:[2,49],63:[2,49]},{1:[2,50],13:[2,50],14:[2,50],27:[2,50],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[2,50],43:[2,50],44:[2,50],45:[2,50],46:[2,50],47:[2,50],51:[2,50],52:[2,50],53:[2,50],54:[2,50],63:[2,50]},{1:[2,37],13:[2,37],14:[2,37],27:[2,37],28:[2,37],29:[2,37],30:[2,37],31:[2,37],32:[2,37],33:[2,37],35:[2,37],36:[2,37],37:[2,37],38:[2,37],39:[2,37],40:[2,37],41:[2,37],42:[2,37],43:[2,37],44:[2,37],45:[2,37],46:[2,37],47:[2,37],51:[2,37],52:[2,37],53:[2,37],54:[2,37],63:[2,37]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:396,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{27:[1,387]},{1:[2,166],14:[2,166],27:[2,166],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,166]},{1:[2,67],14:[2,67],27:[2,67],28:[2,67],29:[2,67],30:[2,67],31:[2,67],32:[2,67],33:[2,67],35:[2,67],36:[2,67],37:[2,67],38:[2,67],39:[2,67],40:[2,67],42:[2,67],43:[2,67],44:[2,67],45:[2,67],46:[2,67],47:[2,67],63:[2,67]},{1:[2,167],14:[2,167],27:[2,167],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,167]},{1:[2,71],14:[2,71],27:[2,71],28:[2,71],29:[2,71],30:[2,71],31:[2,71],32:[2,71],33:[2,71],35:[2,71],36:[2,71],37:[2,71],38:[2,71],39:[2,71],40:[2,71],42:[2,71],43:[2,71],44:[2,71],45:[2,71],46:[2,71],47:[2,71],63:[2,71]},{1:[2,169],14:[2,169],27:[2,169],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,169]},{1:[2,75],14:[2,75],27:[2,75],28:[2,75],29:[2,75],30:[2,75],31:[2,75],32:[2,75],33:[2,75],35:[2,75],36:[2,75],37:[2,75],38:[2,75],39:[2,75],40:[2,75],42:[2,75],43:[2,75],44:[2,75],45:[2,75],46:[2,75],47:[2,75],63:[2,75]},{1:[2,170],14:[2,170],27:[2,170],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,170]},{1:[2,79],14:[2,79],27:[2,79],28:[2,79],29:[2,79],30:[2,79],31:[2,79],32:[2,79],33:[2,79],35:[2,79],36:[2,79],37:[2,79],38:[2,79],39:[2,79],40:[2,79],42:[2,79],43:[2,79],44:[2,79],45:[2,79],46:[2,79],47:[2,79],63:[2,79]},{1:[2,171],14:[2,171],27:[2,171],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,171]},{1:[2,83],14:[2,83],27:[2,83],28:[2,83],29:[2,83],30:[2,83],31:[2,83],32:[2,83],33:[2,83],35:[2,83],36:[2,83],37:[2,83],38:[2,83],39:[2,83],40:[2,83],42:[2,83],43:[2,83],44:[2,83],45:[2,83],46:[2,83],47:[2,83],63:[2,83]},{1:[2,168],14:[2,168],27:[2,168],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,168]},{1:[2,87],14:[2,87],27:[2,87],28:[2,87],29:[2,87],30:[2,87],31:[2,87],32:[2,87],33:[2,87],35:[2,87],36:[2,87],37:[2,87],38:[2,87],39:[2,87],40:[2,87],42:[2,87],43:[2,87],44:[2,87],45:[2,87],46:[2,87],47:[2,87],63:[2,87]},{1:[2,176],14:[2,176],27:[2,176],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,176]},{1:[2,127],14:[2,127],27:[2,127],28:[2,127],29:[2,127],30:[2,127],31:[2,127],32:[2,127],33:[2,127],35:[2,127],36:[2,127],37:[2,127],38:[2,127],39:[2,127],40:[2,127],42:[2,127],43:[2,127],44:[2,127],45:[2,127],46:[2,127],47:[2,127],63:[2,127]},{1:[2,177],14:[2,177],27:[2,177],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,177]},{1:[2,135],14:[2,135],27:[2,135],28:[2,135],29:[2,135],30:[2,135],31:[2,135],32:[2,135],33:[2,135],35:[2,135],36:[2,135],37:[2,135],38:[2,135],39:[2,135],40:[2,135],42:[2,135],43:[2,135],44:[2,135],45:[2,135],46:[2,135],47:[2,135],63:[2,135]},{1:[2,178],14:[2,178],27:[2,178],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,178]},{1:[2,131],14:[2,131],27:[2,131],28:[2,131],29:[2,131],30:[2,131],31:[2,131],32:[2,131],33:[2,131],35:[2,131],36:[2,131],37:[2,131],38:[2,131],39:[2,131],40:[2,131],42:[2,131],43:[2,131],44:[2,131],45:[2,131],46:[2,131],47:[2,131],63:[2,131]},{1:[2,172],14:[2,172],27:[2,172],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,172]},{1:[2,91],14:[2,91],27:[2,91],28:[2,91],29:[2,91],30:[2,91],31:[2,91],32:[2,91],33:[2,91],35:[2,91],36:[2,91],37:[2,91],38:[2,91],39:[2,91],40:[2,91],42:[2,91],43:[2,91],44:[2,91],45:[2,91],46:[2,91],47:[2,91],63:[2,91]},{1:[2,173],14:[2,173],27:[2,173],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,173]},{1:[2,95],14:[2,95],27:[2,95],28:[2,95],29:[2,95],30:[2,95],31:[2,95],32:[2,95],33:[2,95],35:[2,95],36:[2,95],37:[2,95],38:[2,95],39:[2,95],40:[2,95],42:[2,95],43:[2,95],44:[2,95],45:[2,95],46:[2,95],47:[2,95],63:[2,95]},{1:[2,174],14:[2,174],27:[2,174],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,174]},{1:[2,99],14:[2,99],27:[2,99],28:[2,99],29:[2,99],30:[2,99],31:[2,99],32:[2,99],33:[2,99],35:[2,99],36:[2,99],37:[2,99],38:[2,99],39:[2,99],40:[2,99],42:[2,99],43:[2,99],44:[2,99],45:[2,99],46:[2,99],47:[2,99],63:[2,99]},{1:[2,175],14:[2,175],27:[2,175],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,175]},{1:[2,183],14:[2,183],27:[2,183],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,183]},{1:[2,103],14:[2,103],27:[2,103],28:[2,103],29:[2,103],30:[2,103],31:[2,103],32:[2,103],33:[2,103],35:[2,103],36:[2,103],37:[2,103],38:[2,103],39:[2,103],40:[2,103],42:[2,103],43:[2,103],44:[2,103],45:[2,103],46:[2,103],47:[2,103],63:[2,103]},{1:[2,179],14:[2,179],27:[2,179],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,179]},{1:[2,107],14:[2,107],27:[2,107],28:[2,107],29:[2,107],30:[2,107],31:[2,107],32:[2,107],33:[2,107],35:[2,107],36:[2,107],37:[2,107],38:[2,107],39:[2,107],40:[2,107],42:[2,107],43:[2,107],44:[2,107],45:[2,107],46:[2,107],47:[2,107],63:[2,107]},{1:[2,181],14:[2,181],27:[2,181],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,181]},{1:[2,119],14:[2,119],27:[2,119],28:[2,119],29:[2,119],30:[2,119],31:[2,119],32:[2,119],33:[2,119],35:[2,119],36:[2,119],37:[2,119],38:[2,119],39:[2,119],40:[2,119],42:[2,119],43:[2,119],44:[2,119],45:[2,119],46:[2,119],47:[2,119],63:[2,119]},{1:[2,184],14:[2,184],27:[2,184],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,184]},{1:[2,111],14:[2,111],27:[2,111],28:[2,111],29:[2,111],30:[2,111],31:[2,111],32:[2,111],33:[2,111],35:[2,111],36:[2,111],37:[2,111],38:[2,111],39:[2,111],40:[2,111],42:[2,111],43:[2,111],44:[2,111],45:[2,111],46:[2,111],47:[2,111],63:[2,111]},{1:[2,180],14:[2,180],27:[2,180],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,180]},{1:[2,115],14:[2,115],27:[2,115],28:[2,115],29:[2,115],30:[2,115],31:[2,115],32:[2,115],33:[2,115],35:[2,115],36:[2,115],37:[2,115],38:[2,115],39:[2,115],40:[2,115],42:[2,115],43:[2,115],44:[2,115],45:[2,115],46:[2,115],47:[2,115],63:[2,115]},{1:[2,182],14:[2,182],27:[2,182],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],53:[1,80],54:[1,81],63:[2,182]},{1:[2,123],14:[2,123],27:[2,123],28:[2,123],29:[2,123],30:[2,123],31:[2,123],32:[2,123],33:[2,123],35:[2,123],36:[2,123],37:[2,123],38:[2,123],39:[2,123],40:[2,123],42:[2,123],43:[2,123],44:[2,123],45:[2,123],46:[2,123],47:[2,123],63:[2,123]},{1:[2,65],14:[2,65],27:[2,65],28:[2,65],29:[2,65],30:[2,65],31:[2,65],32:[2,65],33:[2,65],35:[2,65],36:[2,65],37:[2,65],38:[2,65],39:[2,65],40:[2,65],42:[2,65],43:[2,65],44:[2,65],45:[2,65],46:[2,65],47:[2,65],53:[1,47],54:[1,48],63:[2,65]},{1:[2,69],14:[2,69],27:[2,69],28:[2,69],29:[2,69],30:[2,69],31:[2,69],32:[2,69],33:[2,69],35:[2,69],36:[2,69],37:[2,69],38:[2,69],39:[2,69],40:[2,69],42:[2,69],43:[2,69],44:[2,69],45:[2,69],46:[2,69],47:[2,69],53:[1,47],54:[1,48],63:[2,69]},{1:[2,73],14:[2,73],27:[2,73],28:[2,73],29:[2,73],30:[2,73],31:[2,73],32:[2,73],33:[2,73],35:[2,73],36:[2,73],37:[2,73],38:[2,73],39:[2,73],40:[2,73],42:[2,73],43:[2,73],44:[2,73],45:[2,73],46:[2,73],47:[2,73],53:[1,47],54:[1,48],63:[2,73]},{1:[2,77],14:[2,77],27:[2,77],28:[2,77],29:[2,77],30:[2,77],31:[2,77],32:[2,77],33:[2,77],35:[2,77],36:[2,77],37:[2,77],38:[2,77],39:[2,77],40:[2,77],42:[2,77],43:[2,77],44:[2,77],45:[2,77],46:[2,77],47:[2,77],53:[1,47],54:[1,48],63:[2,77]},{1:[2,81],14:[2,81],27:[2,81],28:[2,81],29:[2,81],30:[2,81],31:[2,81],32:[2,81],33:[2,81],35:[2,81],36:[2,81],37:[2,81],38:[2,81],39:[2,81],40:[2,81],42:[2,81],43:[2,81],44:[2,81],45:[2,81],46:[2,81],47:[2,81],53:[1,47],54:[1,48],63:[2,81]},{1:[2,85],14:[2,85],27:[2,85],28:[2,85],29:[2,85],30:[2,85],31:[2,85],32:[2,85],33:[2,85],35:[2,85],36:[2,85],37:[2,85],38:[2,85],39:[2,85],40:[2,85],42:[2,85],43:[2,85],44:[2,85],45:[2,85],46:[2,85],47:[2,85],53:[1,47],54:[1,48],63:[2,85]},{1:[2,125],14:[2,125],27:[2,125],28:[2,125],29:[2,125],30:[2,125],31:[2,125],32:[2,125],33:[2,125],35:[2,125],36:[2,125],37:[2,125],38:[2,125],39:[2,125],40:[2,125],42:[2,125],43:[2,125],44:[2,125],45:[2,125],46:[2,125],47:[2,125],53:[1,47],54:[1,48],63:[2,125]},{1:[2,133],14:[2,133],27:[2,133],28:[2,133],29:[2,133],30:[2,133],31:[2,133],32:[2,133],33:[2,133],35:[2,133],36:[2,133],37:[2,133],38:[2,133],39:[2,133],40:[2,133],42:[2,133],43:[2,133],44:[2,133],45:[2,133],46:[2,133],47:[2,133],53:[1,47],54:[1,48],63:[2,133]},{1:[2,129],14:[2,129],27:[2,129],28:[2,129],29:[2,129],30:[2,129],31:[2,129],32:[2,129],33:[2,129],35:[2,129],36:[2,129],37:[2,129],38:[2,129],39:[2,129],40:[2,129],42:[2,129],43:[2,129],44:[2,129],45:[2,129],46:[2,129],47:[2,129],53:[1,47],54:[1,48],63:[2,129]},{1:[2,89],14:[2,89],27:[2,89],28:[2,89],29:[2,89],30:[2,89],31:[2,89],32:[2,89],33:[2,89],35:[2,89],36:[2,89],37:[2,89],38:[2,89],39:[2,89],40:[2,89],42:[2,89],43:[2,89],44:[2,89],45:[2,89],46:[2,89],47:[2,89],53:[1,47],54:[1,48],63:[2,89]},{1:[2,93],14:[2,93],27:[2,93],28:[2,93],29:[2,93],30:[2,93],31:[2,93],32:[2,93],33:[2,93],35:[2,93],36:[2,93],37:[2,93],38:[2,93],39:[2,93],40:[2,93],42:[2,93],43:[2,93],44:[2,93],45:[2,93],46:[2,93],47:[2,93],53:[1,47],54:[1,48],63:[2,93]},{1:[2,97],14:[2,97],27:[2,97],28:[2,97],29:[2,97],30:[2,97],31:[2,97],32:[2,97],33:[2,97],35:[2,97],36:[2,97],37:[2,97],38:[2,97],39:[2,97],40:[2,97],42:[2,97],43:[2,97],44:[2,97],45:[2,97],46:[2,97],47:[2,97],53:[1,47],54:[1,48],63:[2,97]},{1:[2,101],14:[2,101],27:[2,101],28:[2,101],29:[2,101],30:[2,101],31:[2,101],32:[2,101],33:[2,101],35:[2,101],36:[2,101],37:[2,101],38:[2,101],39:[2,101],40:[2,101],42:[2,101],43:[2,101],44:[2,101],45:[2,101],46:[2,101],47:[2,101],53:[1,47],54:[1,48],63:[2,101]},{1:[2,105],14:[2,105],27:[2,105],28:[2,105],29:[2,105],30:[2,105],31:[2,105],32:[2,105],33:[2,105],35:[2,105],36:[2,105],37:[2,105],38:[2,105],39:[2,105],40:[2,105],42:[2,105],43:[2,105],44:[2,105],45:[2,105],46:[2,105],47:[2,105],53:[1,47],54:[1,48],63:[2,105]},{1:[2,117],14:[2,117],27:[2,117],28:[2,117],29:[2,117],30:[2,117],31:[2,117],32:[2,117],33:[2,117],35:[2,117],36:[2,117],37:[2,117],38:[2,117],39:[2,117],40:[2,117],42:[2,117],43:[2,117],44:[2,117],45:[2,117],46:[2,117],47:[2,117],53:[1,47],54:[1,48],63:[2,117]},{1:[2,109],14:[2,109],27:[2,109],28:[2,109],29:[2,109],30:[2,109],31:[2,109],32:[2,109],33:[2,109],35:[2,109],36:[2,109],37:[2,109],38:[2,109],39:[2,109],40:[2,109],42:[2,109],43:[2,109],44:[2,109],45:[2,109],46:[2,109],47:[2,109],53:[1,47],54:[1,48],63:[2,109]},{1:[2,113],14:[2,113],27:[2,113],28:[2,113],29:[2,113],30:[2,113],31:[2,113],32:[2,113],33:[2,113],35:[2,113],36:[2,113],37:[2,113],38:[2,113],39:[2,113],40:[2,113],42:[2,113],43:[2,113],44:[2,113],45:[2,113],46:[2,113],47:[2,113],53:[1,47],54:[1,48],63:[2,113]},{1:[2,121],14:[2,121],27:[2,121],28:[2,121],29:[2,121],30:[2,121],31:[2,121],32:[2,121],33:[2,121],35:[2,121],36:[2,121],37:[2,121],38:[2,121],39:[2,121],40:[2,121],42:[2,121],43:[2,121],44:[2,121],45:[2,121],46:[2,121],47:[2,121],53:[1,47],54:[1,48],63:[2,121]},{1:[2,53],13:[1,263],14:[2,53],27:[2,53],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[1,257],43:[1,258],44:[1,259],45:[1,260],46:[1,261],47:[1,262],51:[2,53],52:[1,397],53:[2,53],54:[2,53],63:[2,53]},{1:[2,153],14:[2,153],27:[2,153],28:[2,153],29:[2,153],30:[2,153],31:[2,153],32:[2,153],33:[2,153],35:[2,153],36:[2,153],37:[2,153],38:[2,153],39:[2,153],40:[2,153],42:[2,153],43:[2,153],44:[2,153],45:[2,153],46:[2,153],47:[2,153],53:[1,47],54:[1,48],63:[2,153]},{1:[2,154],14:[2,154],27:[2,154],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[1,113],43:[1,114],44:[1,117],45:[1,115],46:[1,116],47:[1,118],63:[2,154]},{14:[1,398]},{1:[2,57],13:[2,57],14:[2,57],27:[2,57],28:[2,57],29:[2,57],30:[2,57],31:[2,57],32:[2,57],33:[2,57],35:[2,57],36:[2,57],37:[2,57],38:[2,57],39:[2,57],40:[2,57],41:[2,57],42:[2,57],43:[2,57],44:[2,57],45:[2,57],46:[2,57],47:[2,57],51:[2,57],52:[2,57],53:[2,57],54:[2,57],63:[2,57]},{27:[1,399]},{1:[2,160],14:[2,160],27:[2,160],28:[2,160],29:[2,160],30:[2,160],31:[2,160],32:[2,160],33:[2,160],35:[2,160],36:[2,160],37:[2,160],38:[2,160],39:[2,160],40:[2,160],42:[2,160],43:[2,160],44:[2,160],45:[2,160],46:[2,160],47:[2,160],63:[2,160]},{1:[2,161],14:[2,161],27:[2,161],28:[2,161],29:[2,161],30:[2,161],31:[2,161],32:[2,161],33:[2,161],35:[2,161],36:[2,161],37:[2,161],38:[2,161],39:[2,161],40:[2,161],42:[2,161],43:[2,161],44:[2,161],45:[2,161],46:[2,161],47:[2,161],63:[2,161]},{3:277,5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:49,26:[1,51],27:[2,1],29:[1,15],48:[1,53],49:[1,54],50:[1,55],53:[1,47],54:[1,48],55:388,62:280},{27:[1,389],63:[1,60]},{27:[2,188],63:[1,400]},{8:[1,303],10:[1,402],14:[1,401]},{8:[1,303],11:[1,404],14:[1,403]},{1:[2,53],13:[2,53],14:[2,53],27:[2,53],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],51:[2,53],52:[1,405],53:[2,53],54:[2,53],63:[2,53]},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,407],16:[1,20],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:406,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:408,57:409},{1:[2,155],14:[2,155],27:[2,155],28:[2,155],29:[2,155],30:[2,155],31:[2,155],32:[2,155],33:[2,155],35:[2,155],36:[2,155],37:[2,155],38:[2,155],39:[2,155],40:[2,155],42:[2,155],43:[2,155],44:[2,155],45:[2,155],46:[2,155],47:[2,155],63:[2,155]},{1:[2,159],14:[2,159],27:[2,159],28:[2,159],29:[2,159],30:[2,159],31:[2,159],32:[2,159],33:[2,159],35:[2,159],36:[2,159],37:[2,159],38:[2,159],39:[2,159],40:[2,159],42:[2,159],43:[2,159],44:[2,159],45:[2,159],46:[2,159],47:[2,159],63:[2,159]},{5:[1,23],6:[1,24],9:26,10:[1,31],11:[1,32],12:33,13:[1,132],16:[1,127],17:[1,25],19:16,20:13,22:28,23:12,24:27,25:131,26:[1,14],29:[1,15],48:[1,17],49:[1,18],50:[1,19],53:[1,29],54:[1,30],56:21,61:22,64:133},{1:[2,8],14:[2,8],27:[2,8],28:[2,8],29:[2,8],30:[2,8],31:[2,8],32:[2,8],33:[2,8],35:[2,8],36:[2,8],37:[2,8],38:[2,8],39:[2,8],40:[2,8],42:[2,8],43:[2,8],44:[2,8],45:[2,8],46:[2,8],47:[2,8],63:[2,8]},{1:[2,10],14:[2,10],27:[2,10],28:[2,10],29:[2,10],30:[2,10],31:[2,10],32:[2,10],33:[2,10],35:[2,10],36:[2,10],37:[2,10],38:[2,10],39:[2,10],40:[2,10],42:[2,10],43:[2,10],44:[2,10],45:[2,10],46:[2,10],47:[2,10],63:[2,10]},{1:[2,9],14:[2,9],27:[2,9],28:[2,9],29:[2,9],30:[2,9],31:[2,9],32:[2,9],33:[2,9],35:[2,9],36:[2,9],37:[2,9],38:[2,9],39:[2,9],40:[2,9],42:[2,9],43:[2,9],44:[2,9],45:[2,9],46:[2,9],47:[2,9],63:[2,9]},{1:[2,11],14:[2,11],27:[2,11],28:[2,11],29:[2,11],30:[2,11],31:[2,11],32:[2,11],33:[2,11],35:[2,11],36:[2,11],37:[2,11],38:[2,11],39:[2,11],40:[2,11],42:[2,11],43:[2,11],44:[2,11],45:[2,11],46:[2,11],47:[2,11],63:[2,11]},{5:[1,23],6:[1,24],9:26,10:[1,57],11:[1,58],16:[1,56],17:[1,25],19:52,20:50,23:12,25:410,26:[1,51],29:[1,15],48:[1,53],49:[1,54],50:[1,55]},{1:[2,54],13:[1,263],14:[2,54],27:[2,54],28:[1,245],29:[1,246],30:[1,247],31:[1,248],32:[1,249],33:[1,250],35:[1,251],36:[1,252],37:[1,253],38:[1,254],39:[1,255],40:[1,256],41:[1,149],42:[1,257],43:[1,258],44:[1,259],45:[1,260],46:[1,261],47:[1,262],51:[2,54],52:[2,54],53:[2,54],54:[2,54],63:[2,54]},{1:[2,156],14:[2,156],27:[2,156],28:[2,156],29:[2,156],30:[2,156],31:[2,156],32:[2,156],33:[2,156],35:[2,156],36:[2,156],37:[2,156],38:[2,156],39:[2,156],40:[2,156],42:[2,156],43:[2,156],44:[2,156],45:[2,156],46:[2,156],47:[2,156],53:[1,47],54:[1,48],63:[2,156]},{1:[2,157],14:[2,157],27:[2,157],28:[1,104],29:[1,105],30:[1,106],31:[1,107],32:[1,108],33:[1,109],35:[1,119],36:[1,121],37:[1,120],38:[1,110],39:[1,111],40:[1,112],42:[1,113],43:[1,114],44:[1,117],45:[1,115],46:[1,116],47:[1,118],63:[2,157]},{14:[1,411]},{1:[2,54],13:[2,54],14:[2,54],27:[2,54],28:[1,137],29:[1,138],30:[1,139],31:[1,140],32:[1,141],33:[1,142],35:[1,143],36:[1,144],37:[1,145],38:[1,146],39:[1,147],40:[1,148],41:[1,149],42:[1,150],43:[1,151],44:[1,152],45:[1,153],46:[1,154],47:[1,155],51:[2,54],52:[2,54],53:[2,54],54:[2,54],63:[2,54]},{1:[2,158],14:[2,158],27:[2,158],28:[2,158],29:[2,158],30:[2,158],31:[2,158],32:[2,158],33:[2,158],35:[2,158],36:[2,158],37:[2,158],38:[2,158],39:[2,158],40:[2,158],42:[2,158],43:[2,158],44:[2,158],45:[2,158],46:[2,158],47:[2,158],63:[2,158]}],defaultActions:{},parseError:function(e,t){if(!t.recoverable)throw new Error(e);
this.trace(e)},parse:function(e){function t(){var e;return e=n.lexer.lex()||d,"number"!=typeof e&&(e=n.symbols_[e]||e),e}var n=this,i=[0],r=[null],s=[],o=this.table,a="",l=0,c=0,u=0,h=2,d=1;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var f=this.lexer.yylloc;s.push(f);var p=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var m,g,v,y,b,w,x,k,_,E={};;){if(v=i[i.length-1],this.defaultActions[v]?y=this.defaultActions[v]:((null===m||"undefined"==typeof m)&&(m=t()),y=o[v]&&o[v][m]),"undefined"==typeof y||!y.length||!y[0]){var C="";_=[];for(w in o[v])this.terminals_[w]&&w>h&&_.push("'"+this.terminals_[w]+"'");C=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(l+1)+": Unexpected "+(m==d?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(C,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:f,expected:_})}if(y[0]instanceof Array&&y.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+m);switch(y[0]){case 1:i.push(m),r.push(this.lexer.yytext),s.push(this.lexer.yylloc),i.push(y[1]),m=null,g?(m=g,g=null):(c=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,f=this.lexer.yylloc,u>0&&u--);break;case 2:if(x=this.productions_[y[1]][1],E.$=r[r.length-x],E._$={first_line:s[s.length-(x||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(x||1)].first_column,last_column:s[s.length-1].last_column},p&&(E._$.range=[s[s.length-(x||1)].range[0],s[s.length-1].range[1]]),b=this.performAction.call(E,a,c,l,this.yy,y[1],r,s),"undefined"!=typeof b)return b;x&&(i=i.slice(0,-1*x*2),r=r.slice(0,-1*x),s=s.slice(0,-1*x)),i.push(this.productions_[y[1]][0]),r.push(E.$),s.push(E._$),k=o[i[i.length-2]][i[i.length-1]],i.push(k);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,i,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),i=e[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var s in r)this[s]=r[s];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,i;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),s=0;s<r.length;s++)if(n=this._input.match(this.rules[r[s]]),n&&(!t||n[0].length>t[0].length)){if(t=n,i=s,this.options.backtrack_lexer){if(e=this.test_match(n,r[s]),e!==!1)return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?(e=this.test_match(t,r[i]),e!==!1?e:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){var e=this.conditionStack.length-1;return e>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,i){switch(n){case 0:break;case 1:return 34;case 2:return 26;case 3:return 27;case 4:return 63;case 5:return 17;case 6:return 17;case 7:return 21;case 8:return 28;case 9:return 29;case 10:return 33;case 11:return 30;case 12:return 31;case 13:return 32;case 14:return 38;case 15:return 39;case 16:return 40;case 17:return 41;case 18:return 35;case 19:return 36;case 20:return 37;case 21:return 49;case 22:return 42;case 23:return 45;case 24:return 48;case 25:return 50;case 26:return 51;case 27:return 52;case 28:return 53;case 29:return 53;case 30:return 54;case 31:return 54;case 32:return 5;case 33:return 6;case 34:return 16;case 35:return 59;case 36:return 13;case 37:return 13;case 38:return 13;case 39:return 14;case 40:return 14;case 41:return 14;case 42:return this.begin("QUOTE"),"'";case 43:return this.popState(),"'";case 44:this.begin("ESC");break;case 45:return 8;case 46:return this.begin("DBLQUOTE"),11;case 47:return this.popState(),11;case 48:this.begin("ESC");break;case 49:return 8;case 50:return this.popState(),8;case 51:return 68;case 52:return 69}},rules:[/^(?:\s+)/,/^(?::)/,/^(?:\()/,/^(?:\))/,/^(?:,)/,/^(?:\d+(\.\d*)?)/,/^(?:\.\d+)/,/^(?:\.)/,/^(?:\+)/,/^(?:-)/,/^(?:\*\*)/,/^(?:\*)/,/^(?:\/)/,/^(?:\^)/,/^(?:<=)/,/^(?:>=)/,/^(?:!=)/,/^(?:<>)/,/^(?:=)/,/^(?:<)/,/^(?:>)/,/^(?:!)/,/^(?:and\b)/,/^(?:or\b)/,/^(?:not\b)/,/^(?:if\b)/,/^(?:then\b)/,/^(?:else\b)/,/^(?:ascending\b)/,/^(?:asc\b)/,/^(?:descending\b)/,/^(?:desc\b)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:\w+)/,/^(?:\s*â€¸\s*\()/,/^(?:â€¸)/,/^(?:â€¸)/,/^(?:â€¸)/,/^(?:$)/,/^(?:$)/,/^(?:$)/,/^(?:')/,/^(?:')/,/^(?:\\)/,/^(?:[^'\\â€¸]*)/,/^(?:")/,/^(?:")/,/^(?:\\)/,/^(?:[^"\\â€¸]*)/,/^(?:.)/,/^(?:%%TOKEN%%)/,/^(?:%%FORMULA%%)/],conditions:{ESC:{rules:[50],inclusive:!1},DBLQUOTE:{rules:[38,40,47,48,49],inclusive:!1},QUOTE:{rules:[37,39,43,44,45],inclusive:!1},INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,41,42,46,51,52],inclusive:!0}}};return e}();return t.lexer=n,e.prototype=t,t.Parser=e,new e}();"undefined"!=typeof e&&"undefined"!=typeof n&&(n.parser=r,n.Parser=r.Parser,n.parse=function(){return r.parse.apply(r,arguments)},n.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),i.exit(1));var r=e("fs").readFileSync(e("path").normalize(t[1]),"utf8");return n.parser.parse(r)},"undefined"!=typeof t&&e.main===t&&n.main(i.argv.slice(1)))}(e("__browserify_process"))},{__browserify_process:15,fs:17,path:18}],20:[function(e,t,n){!function(i){var r=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,empty:3,nonspace:4,"'":5,'"':6,CHARS:7,ESCCHARS:8,element:9,elements:10,SPACE:11,output:12,$accept:0,$end:1},terminals_:{2:"error",5:"'",6:'"',7:"CHARS",8:"ESCCHARS",11:"SPACE"},productions_:[0,[3,0],[4,1],[4,1],[4,1],[4,1],[9,1],[9,2],[10,1],[10,1],[10,3],[10,2],[12,1]],performAction:function(e,t,n,i,r,s){var o=s.length-1;switch(r){case 5:this.$="\\"+s[o];break;case 7:this.$=s[o-1]+s[o];break;case 8:this.$=[];break;case 9:this.$=[s[o]];break;case 10:this.$=s[o-2].concat(s[o]);break;case 11:this.$=s[o-1].concat("");break;case 12:return s[o]}},table:[{1:[2,1],3:3,4:5,5:[1,6],6:[1,7],7:[1,8],8:[1,9],9:4,10:2,11:[2,1],12:1},{1:[3]},{1:[2,12],11:[1,10]},{1:[2,8],11:[2,8]},{1:[2,9],4:11,5:[1,6],6:[1,7],7:[1,8],8:[1,9],11:[2,9]},{1:[2,6],5:[2,6],6:[2,6],7:[2,6],8:[2,6],11:[2,6]},{1:[2,2],5:[2,2],6:[2,2],7:[2,2],8:[2,2],11:[2,2]},{1:[2,3],5:[2,3],6:[2,3],7:[2,3],8:[2,3],11:[2,3]},{1:[2,4],5:[2,4],6:[2,4],7:[2,4],8:[2,4],11:[2,4]},{1:[2,5],5:[2,5],6:[2,5],7:[2,5],8:[2,5],11:[2,5]},{1:[2,11],4:5,5:[1,6],6:[1,7],7:[1,8],8:[1,9],9:12,11:[2,11]},{1:[2,7],5:[2,7],6:[2,7],7:[2,7],8:[2,7],11:[2,7]},{1:[2,10],4:11,5:[1,6],6:[1,7],7:[1,8],8:[1,9],11:[2,10]}],defaultActions:{},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){function t(){var e;return e=n.lexer.lex()||d,"number"!=typeof e&&(e=n.symbols_[e]||e),e}var n=this,i=[0],r=[null],s=[],o=this.table,a="",l=0,c=0,u=0,h=2,d=1;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var f=this.lexer.yylloc;s.push(f);var p=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var m,g,v,y,b,w,x,k,_,E={};;){if(v=i[i.length-1],this.defaultActions[v]?y=this.defaultActions[v]:((null===m||"undefined"==typeof m)&&(m=t()),y=o[v]&&o[v][m]),"undefined"==typeof y||!y.length||!y[0]){var C="";_=[];for(w in o[v])this.terminals_[w]&&w>h&&_.push("'"+this.terminals_[w]+"'");C=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(l+1)+": Unexpected "+(m==d?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(C,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:f,expected:_})}if(y[0]instanceof Array&&y.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+m);switch(y[0]){case 1:i.push(m),r.push(this.lexer.yytext),s.push(this.lexer.yylloc),i.push(y[1]),m=null,g?(m=g,g=null):(c=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,f=this.lexer.yylloc,u>0&&u--);break;case 2:if(x=this.productions_[y[1]][1],E.$=r[r.length-x],E._$={first_line:s[s.length-(x||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(x||1)].first_column,last_column:s[s.length-1].last_column},p&&(E._$.range=[s[s.length-(x||1)].range[0],s[s.length-1].range[1]]),b=this.performAction.call(E,a,c,l,this.yy,y[1],r,s),"undefined"!=typeof b)return b;x&&(i=i.slice(0,-1*x*2),r=r.slice(0,-1*x),s=s.slice(0,-1*x)),i.push(this.productions_[y[1]][0]),r.push(E.$),s.push(E._$),k=o[i[i.length-2]][i[i.length-1]],i.push(k);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,i,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),i=e[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var s in r)this[s]=r[s];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,i;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),s=0;s<r.length;s++)if(n=this._input.match(this.rules[r[s]]),n&&(!t||n[0].length>t[0].length)){if(t=n,i=s,this.options.backtrack_lexer){if(e=this.test_match(n,r[s]),e!==!1)return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?(e=this.test_match(t,r[i]),e!==!1?e:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){var e=this.conditionStack.length-1;return e>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,i){switch(n){case 0:return 11;case 1:return 7;case 2:return this.begin("QUOTE"),"'";case 3:return this.popState(),"'";case 4:this.begin("ESC");break;case 5:return 7;case 6:return this.begin("DBLQUOTE"),6;case 7:return this.popState(),6;case 8:this.begin("ESC");break;case 9:return 7;case 10:return this.popState(),8}},rules:[/^(?:[\s\|]+)/,/^(?:[^\s\'\"\|]+)/,/^(?:')/,/^(?:')/,/^(?:\\)/,/^(?:[^'\\]+)/,/^(?:")/,/^(?:")/,/^(?:\\)/,/^(?:[^"\\]+)/,/^(?:.)/],conditions:{ESC:{rules:[10],inclusive:!1},DBLQUOTE:{rules:[7,8,9],inclusive:!1},QUOTE:{rules:[3,4,5],inclusive:!1},INITIAL:{rules:[0,1,2,6],inclusive:!0}}};return e}();return t.lexer=n,e.prototype=t,t.Parser=e,new e}();"undefined"!=typeof e&&"undefined"!=typeof n&&(n.parser=r,n.Parser=r.Parser,n.parse=function(){return r.parse.apply(r,arguments)},n.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),i.exit(1));var r=e("fs").readFileSync(e("path").normalize(t[1]),"utf8");return n.parser.parse(r)},"undefined"!=typeof t&&e.main===t&&n.main(i.argv.slice(1)))}(e("__browserify_process"))},{__browserify_process:15,fs:17,path:18}],21:[function(e,t){var n=e("util"),i=function(e){var t=this,i=function(){return t.apply(this,arguments)};return _.extend(i,t),n.inherits(i,t),_.extend(i.prototype,e),i},r=function(e){return e.extend=i,e};t.exports=r},{util:22}],dropzone:[function(e,t){t.exports=e("gxgH3g")},{}],17:[function(){},{}],18:[function(e,t,n){!function(e){function t(e,t){for(var n=[],i=0;i<e.length;i++)t(e[i],i,e)&&n.push(e[i]);return n}function i(e,t){for(var n=0,i=e.length;i>=0;i--){var r=e[i];"."==r?e.splice(i,1):".."===r?(e.splice(i,1),n++):n&&(e.splice(i,1),n--)}if(t)for(;n--;n)e.unshift("..");return e}var r=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;n.resolve=function(){for(var n="",r=!1,s=arguments.length;s>=-1&&!r;s--){var o=s>=0?arguments[s]:e.cwd();"string"==typeof o&&o&&(n=o+"/"+n,r="/"===o.charAt(0))}return n=i(t(n.split("/"),function(e){return!!e}),!r).join("/"),(r?"/":"")+n||"."},n.normalize=function(e){var n="/"===e.charAt(0),r="/"===e.slice(-1);return e=i(t(e.split("/"),function(e){return!!e}),!n).join("/"),e||n||(e="."),e&&r&&(e+="/"),(n?"/":"")+e},n.join=function(){var e=Array.prototype.slice.call(arguments,0);return n.normalize(t(e,function(e){return e&&"string"==typeof e}).join("/"))},n.dirname=function(e){var t=r.exec(e)[1]||"",n=!1;return t?1===t.length||n&&t.length<=3&&":"===t.charAt(1)?t:t.substring(0,t.length-1):"."},n.basename=function(e,t){var n=r.exec(e)[2]||"";return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},n.extname=function(e){return r.exec(e)[3]||""},n.relative=function(e,t){function i(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=n.resolve(e).substr(1),t=n.resolve(t).substr(1);for(var r=i(e.split("/")),s=i(t.split("/")),o=Math.min(r.length,s.length),a=o,l=0;o>l;l++)if(r[l]!==s[l]){a=l;break}for(var c=[],l=a;l<r.length;l++)c.push("..");return c=c.concat(s.slice(a)),c.join("/")}}(e("__browserify_process"))},{__browserify_process:15}],23:[function(e,t,n){function i(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]==t)return n;return-1}function r(e,t,n){if(e&&"object"==typeof e&&e.href)return e;if("string"!=typeof e)throw new TypeError("Parameter 'url' must be a string, not "+typeof e);for(var r={},o=e,a=0,d=o.length;d>a&&-1!==i(f,o.charAt(a));a++);0!==a&&(o=o.substr(a));var p=h.exec(o);if(p){p=p[0];var C=p.toLowerCase();r.protocol=C,o=o.substr(p.length)}if(n||p||o.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===o.substr(0,2);!S||p&&k[p]||(o=o.substr(2),r.slashes=!0)}if(!k[p]&&(S||p&&!_[p])){var $=i(o,"@");if(-1!==$){for(var R=!0,a=0,d=v.length;d>a;a++){var A=i(o,v[a]);if(-1!==A&&$>A){R=!1;break}}R&&(r.auth=o.substr(0,$),o=o.substr($+1))}for(var F=-1,a=0,d=g.length;d>a;a++){var A=i(o,g[a]);-1!==A&&(0>F||F>A)&&(F=A)}-1!==F?(r.host=o.substr(0,F),o=o.substr(F)):(r.host=o,o="");for(var T=l(r.host),V=u(T),a=0,d=V.length;d>a;a++){var I=V[a];r[I]=T[I]}if(r.hostname=r.hostname||"",r.hostname.length>y)r.hostname="";else for(var N=r.hostname.split(/\./),a=0,d=N.length;d>a;a++){var O=N[a];if(O&&!O.match(b)){for(var L="",M=0,D=O.length;D>M;M++)L+=O.charCodeAt(M)>127?"x":O[M];if(!L.match(b)){var P=N.slice(0,a),B=N.slice(a+1),q=O.match(w);q&&(P.push(q[1]),B.unshift(q[2])),B.length&&(o="/"+B.join(".")+o),r.hostname=P.join(".");break}}}r.hostname=r.hostname.toLowerCase();for(var U=r.hostname.split("."),H=[],a=0;a<U.length;++a){var j=U[a];H.push(j.match(/[^A-Za-z0-9_-]/)?"xn--"+c.encode(j):j)}r.hostname=H.join("."),r.host=(r.hostname||"")+(r.port?":"+r.port:""),r.href+=r.host}if(!x[C]){for(var a=0,d=m.length;d>a;a++){var K=m[a],W=encodeURIComponent(K);W===K&&(W=escape(K)),o=o.split(K).join(W)}for(var z=o.length,a=0,d=f.length;d>a;a++){var G=i(o,f[a]);-1!==G&&(z=Math.min(G,z))}o=o.substr(0,z)}var Q=i(o,"#");-1!==Q&&(r.hash=o.substr(Q),o=o.slice(0,Q));var Y=i(o,"?");return-1!==Y?(r.search=o.substr(Y),r.query=o.substr(Y+1),t&&(r.query=E.parse(r.query)),o=o.slice(0,Y)):t&&(r.search="",r.query={}),o&&(r.pathname=o),_[p]&&r.hostname&&!r.pathname&&(r.pathname="/"),(r.pathname||r.search)&&(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=s(r),r}function s(e){"string"==typeof e&&(e=r(e));var t=e.auth||"";if(t){t=t.split("@").join("%40");for(var n=0,i=v.length;i>n;n++){var s=v[n];t=t.split(s).join(encodeURIComponent(s))}t+="@"}var o=e.protocol||"",a=void 0!==e.host?t+e.host:void 0!==e.hostname?t+e.hostname+(e.port?":"+e.port:""):!1,l=e.pathname||"",c=e.query&&("object"==typeof e.query&&u(e.query).length?E.stringify(e.query):"")||"",h=e.search||c&&"?"+c||"",d=e.hash||"";return o&&":"!==o.substr(-1)&&(o+=":"),e.slashes||(!o||_[o])&&a!==!1?(a="//"+(a||""),l&&"/"!==l.charAt(0)&&(l="/"+l)):a||(a=""),d&&"#"!==d.charAt(0)&&(d="#"+d),h&&"?"!==h.charAt(0)&&(h="?"+h),o+a+l+h+d}function o(e,t){return s(a(e,t))}function a(e,t){if(!e)return t;if(e=r(s(e),!1,!0),t=r(s(t),!1,!0),e.hash=t.hash,""===t.href)return e.href=s(e),e;if(t.slashes&&!t.protocol)return t.protocol=e.protocol,_[t.protocol]&&t.hostname&&!t.pathname&&(t.path=t.pathname="/"),t.href=s(t),t;if(t.protocol&&t.protocol!==e.protocol){if(!_[t.protocol])return t.href=s(t),t;if(e.protocol=t.protocol,!t.host&&!k[t.protocol]){for(var n=(t.pathname||"").split("/");n.length&&!(t.host=n.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==n[0]&&n.unshift(""),n.length<2&&n.unshift(""),t.pathname=n.join("/")}return e.pathname=t.pathname,e.search=t.search,e.query=t.query,e.host=t.host||"",e.auth=t.auth,e.hostname=t.hostname||t.host,e.port=t.port,(void 0!==e.pathname||void 0!==e.search)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.slashes=e.slashes||t.slashes,e.href=s(e),e}var o=e.pathname&&"/"===e.pathname.charAt(0),a=void 0!==t.host||t.pathname&&"/"===t.pathname.charAt(0),l=a||o||e.host&&t.pathname,c=l,u=e.pathname&&e.pathname.split("/")||[],n=t.pathname&&t.pathname.split("/")||[],h=e.protocol&&!_[e.protocol];if(h&&(delete e.hostname,delete e.port,e.host&&(""===u[0]?u[0]=e.host:u.unshift(e.host)),delete e.host,t.protocol&&(delete t.hostname,delete t.port,t.host&&(""===n[0]?n[0]=t.host:n.unshift(t.host)),delete t.host),l=l&&(""===n[0]||""===u[0])),a)e.host=t.host||""===t.host?t.host:e.host,e.hostname=t.hostname||""===t.hostname?t.hostname:e.hostname,e.search=t.search,e.query=t.query,u=n;else if(n.length)u||(u=[]),u.pop(),u=u.concat(n),e.search=t.search,e.query=t.query;else if("search"in t){if(h){e.hostname=e.host=u.shift();var d=e.host&&i(e.host,"@")>0?e.host.split("@"):!1;d&&(e.auth=d.shift(),e.host=e.hostname=d.shift())}return e.search=t.search,e.query=t.query,(void 0!==e.pathname||void 0!==e.search)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=s(e),e}if(!u.length)return delete e.pathname,e.search?delete e.path:e.path="/"+e.search,e.href=s(e),e;for(var f=u.slice(-1)[0],p=(e.host||t.host)&&("."===f||".."===f)||""===f,m=0,g=u.length;g>=0;g--)f=u[g],"."==f?u.splice(g,1):".."===f?(u.splice(g,1),m++):m&&(u.splice(g,1),m--);if(!l&&!c)for(;m--;m)u.unshift("..");!l||""===u[0]||u[0]&&"/"===u[0].charAt(0)||u.unshift(""),p&&"/"!==u.join("/").substr(-1)&&u.push("");var v=""===u[0]||u[0]&&"/"===u[0].charAt(0);if(h){e.hostname=e.host=v?"":u.length?u.shift():"";var d=e.host&&i(e.host,"@")>0?e.host.split("@"):!1;d&&(e.auth=d.shift(),e.host=e.hostname=d.shift())}return l=l||e.host&&u.length,l&&!v&&u.unshift(""),e.pathname=u.join("/"),(void 0!==e.pathname||void 0!==e.search)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=t.auth||e.auth,e.slashes=e.slashes||t.slashes,e.href=s(e),e}function l(e){var t={},n=d.exec(e);return n&&(n=n[0],t.port=n.substr(1),e=e.substr(0,e.length-n.length)),e&&(t.hostname=e),t}var c={encode:function(e){return e}};n.parse=r,n.resolve=o,n.resolveObject=a,n.format=s;var u=Object.keys||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)e.hasOwnProperty(n)&&(t[t.length]=n);return t},h=/^([a-z0-9.+-]+:)/i,d=/:[0-9]+$/,f=["<",">",'"',"`"," ","\r","\n"," "],p=["{","}","|","\\","^","~","[","]","`"].concat(f),m=["'"],g=["%","/","?",";","#"].concat(p).concat(m),v=["/","@","?","#"].concat(f),y=255,b=/^[a-zA-Z0-9][a-z0-9A-Z_-]{0,62}$/,w=/^([a-zA-Z0-9][a-z0-9A-Z_-]{0,62})(.*)$/,x={javascript:!0,"javascript:":!0},k={javascript:!0,"javascript:":!0},_={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},E=e("querystring")},{querystring:24}],22:[function(e,t,n){function i(e){return e instanceof Array||Array.isArray(e)||e&&e!==Object.prototype&&i(e.__proto__)}function r(e){return e instanceof RegExp||"object"==typeof e&&"[object RegExp]"===Object.prototype.toString.call(e)}function s(e){if(e instanceof Date)return!0;if("object"!=typeof e)return!1;var t=Date.prototype&&a(Date.prototype),n=e.__proto__&&a(e.__proto__);return JSON.stringify(n)===JSON.stringify(t)}e("events");n.isArray=i,n.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},n.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},n.print=function(){},n.puts=function(){},n.debug=function(){},n.inspect=function(e,t,l,c){function u(e,l){if(e&&"function"==typeof e.inspect&&e!==n&&(!e.constructor||e.constructor.prototype!==e))return e.inspect(l);switch(typeof e){case"undefined":return d("undefined","undefined");case"string":var c="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return d(c,"string");case"number":return d(""+e,"number");case"boolean":return d(""+e,"boolean")}if(null===e)return d("null","null");var f=o(e),p=t?a(e):f;if("function"==typeof e&&0===p.length){if(r(e))return d(""+e,"regexp");var m=e.name?": "+e.name:"";return d("[Function"+m+"]","special")}if(s(e)&&0===p.length)return d(e.toUTCString(),"date");var g,v,y;if(i(e)?(v="Array",y=["[","]"]):(v="Object",y=["{","}"]),"function"==typeof e){var b=e.name?": "+e.name:"";g=r(e)?" "+e:" [Function"+b+"]"}else g="";if(s(e)&&(g=" "+e.toUTCString()),0===p.length)return y[0]+g+y[1];if(0>l)return r(e)?d(""+e,"regexp"):d("[Object]","special");h.push(e);var w=p.map(function(t){var n,r;if(e.__lookupGetter__&&(e.__lookupGetter__(t)?r=e.__lookupSetter__(t)?d("[Getter/Setter]","special"):d("[Getter]","special"):e.__lookupSetter__(t)&&(r=d("[Setter]","special"))),f.indexOf(t)<0&&(n="["+t+"]"),r||(h.indexOf(e[t])<0?(r=null===l?u(e[t]):u(e[t],l-1),r.indexOf("\n")>-1&&(r=i(e)?r.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+r.split("\n").map(function(e){return"   "+e}).join("\n"))):r=d("[Circular]","special")),"undefined"==typeof n){if("Array"===v&&t.match(/^\d+$/))return r;n=JSON.stringify(""+t),n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=d(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=d(n,"string"))}return n+": "+r});h.pop();var x=0,k=w.reduce(function(e,t){return x++,t.indexOf("\n")>=0&&x++,e+t.length+1},0);return w=k>50?y[0]+(""===g?"":g+"\n ")+" "+w.join(",\n  ")+" "+y[1]:y[0]+g+" "+w.join(", ")+" "+y[1]}var h=[],d=function(e,t){var n={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i={special:"cyan",number:"blue","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"}[t];return i?"["+n[i][0]+"m"+e+"["+n[i][1]+"m":e};return c||(d=function(e){return e}),u(e,"undefined"==typeof l?2:l)};n.log=function(){},n.pump=null;var o=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},a=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.hasOwnProperty.call(e,n)&&t.push(n);return t},l=Object.create||function(e,t){var n;if(null===e)n={__proto__:null};else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");var i=function(){};i.prototype=e,n=new i,n.__proto__=e}return"undefined"!=typeof t&&Object.defineProperties&&Object.defineProperties(n,t),n};n.inherits=function(e,t){e.super_=t,e.prototype=l(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})};var c=/%[sdj%]/g;n.format=function(e){if("string"!=typeof e){for(var t=[],i=0;i<arguments.length;i++)t.push(n.inspect(arguments[i]));return t.join(" ")}for(var i=1,r=arguments,s=r.length,o=String(e).replace(c,function(e){if("%%"===e)return"%";if(i>=s)return e;switch(e){case"%s":return String(r[i++]);case"%d":return Number(r[i++]);case"%j":return JSON.stringify(r[i++]);default:return e}}),a=r[i];s>i;a=r[++i])o+=null===a||"object"!=typeof a?" "+a:" "+n.inspect(a);return o}},{events:25}],26:[function(e,t){!function(){var n=e("../common/strings"),i=function(e){var i="set"+n.capitalize(e);t.exports[i]=function(n){t.exports[e]=n}};i("reportPerformanceMetrics"),i("useAlertForErrors"),i("disableExceptionCatching"),i("droppableTolerance"),i("disableDropzone")}()},{"../common/strings":13}],27:[function(e,t){var n=e("../common/strings");t.exports.addTo=function(e,t,i){function r(e,t){var n;return n=$("<span/>"),n.addClass("field-icon "+e),n.tooltip({title:t,container:i})}t.isLink()&&r("icon-link field-icon-link",_.template(n["field-icon-link"],{name:t.linkedSheet().displayTitle()})).appendTo(e),t.isNameField()&&r("field-icon-name",n["field-icon-name"]).appendTo(e),t.hasAnyFormula()&&r("field-icon-formula",t.editableFormula()).appendTo(e)
}},{"../common/strings":13}],28:[function(e,t,n){var i=e("./gen/expressionParser"),r=e("./gen/commandParser"),s=e("./gen/pipetteParser"),o=e("./gen/spacesParser"),a=(e("../common/strings"),n.cursorToken="â€¸");n.parsePowerBar=function(e){var t=s.parse(e);return _.chain(t).map(function(e){e=e.trim();var t;try{return t=r.parse(e),null!=t?_.extend(t,{text:e}):t}catch(n){return{cmd:"invalid",text:e.replace(a,""),error:n}}}).compactNullish().value()},n.parsePartialFormula=function(e){var t=i.parse(e);return t.cursor&&0===t.length?{cursor:!0}:t[0]},n.parseFormula=function(e){return i.parse("%%FORMULA%%"+e)},n.autoSplit=function(e){return o.parse(e)},n.pipeSplit=function(e){return s.parse(e)}},{"../common/strings":13,"./gen/commandParser":29,"./gen/expressionParser":19,"./gen/pipetteParser":16,"./gen/spacesParser":20}],30:[function(e,t){var n=e("util"),i=e("./extendable"),r=function(){this.initialize.apply(this,arguments),r.super_.call(this,this.message)};n.inherits(r,Error),_.extend(r.prototype,{name:"AppError",initialize:function(e){this.message=e}}),i(r),t.exports=r},{"./extendable":21,util:22}],31:[function(e,t,n){{var i=e("./appError"),r=e("../common/strings"),s="DisplayableError",o=s+": ",a=n.DisplayableError=i.extend({name:s,displayable:!0,initialize:function(e,t){var n;n=t?_.template(r[e],t):r[e],this.message=o+n,this.rawMessage=n},getMessage:function(){return this.rawMessage}}),l=n.ExecutionError=a.extend({name:"ExecutionError"});n.UnknownContext=l.extend({name:"UnknownContext"})}n.isDisplayableErrorMessage=function(e){return-1!==e.indexOf(o)},n.removeDisplayableErrorPrefix=function(e){return e.replace(new RegExp("^.*"+o),"")}},{"../common/strings":13,"./appError":30}],29:[function(e,t,n){!function(i){var r=function(){function t(){this.yy={}}var n={trace:function(){},yy:{},symbols_:{error:2,word:3,WORD:4,cmd:5,SOLOCURSOR:6,'"':7,"'":8,ARGS:9,output:10,$accept:0,$end:1},terminals_:{2:"error",4:"WORD",6:"SOLOCURSOR",7:'"',8:"'",9:"ARGS"},productions_:[0,[3,1],[3,2],[5,1],[5,1],[5,3],[5,3],[5,2],[5,2],[5,2],[10,1]],performAction:function(e,t,n,i,r,s){var o=s.length-1;switch(r){case 2:return s[o-1]+s[o];case 3:return null;case 4:return i.makeCommand("","%%TOKEN%% "+s[o]);case 5:return i.makeCommand("","%%TOKEN%% "+s[o-2]+s[o-1]+s[o]);case 6:return i.makeCommand("","%%TOKEN%% "+s[o-2]+s[o-1]+s[o]);case 7:return i.makeCommand("","%%TOKEN%% "+s[o-1]+s[o]);case 8:return i.makeCommand("","%%TOKEN%% "+s[o-1]+s[o]);case 9:return i.makeCommand(s[o-1],s[o]);case 10:return s[o]}},table:[{3:4,4:[1,7],5:2,6:[1,3],7:[1,5],8:[1,6],10:1},{1:[3]},{1:[2,10]},{1:[2,3]},{1:[2,4],4:[1,9],9:[1,8]},{3:10,4:[1,7]},{3:11,4:[1,7]},{1:[2,1],4:[2,1],7:[2,1],8:[2,1],9:[2,1]},{1:[2,9]},{1:[2,2],4:[2,2],7:[2,2],8:[2,2],9:[2,2]},{1:[2,7],4:[1,9],7:[1,12]},{1:[2,8],4:[1,9],8:[1,13]},{1:[2,5]},{1:[2,6]}],defaultActions:{2:[2,10],3:[2,3],8:[2,9],12:[2,5],13:[2,6]},parseError:function(e,t){if(!t.recoverable)throw new Error(e);this.trace(e)},parse:function(e){function t(){var e;return e=n.lexer.lex()||d,"number"!=typeof e&&(e=n.symbols_[e]||e),e}var n=this,i=[0],r=[null],s=[],o=this.table,a="",l=0,c=0,u=0,h=2,d=1;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var f=this.lexer.yylloc;s.push(f);var p=this.lexer.options&&this.lexer.options.ranges;this.parseError="function"==typeof this.yy.parseError?this.yy.parseError:Object.getPrototypeOf(this).parseError;for(var m,g,v,y,b,w,x,k,_,E={};;){if(v=i[i.length-1],this.defaultActions[v]?y=this.defaultActions[v]:((null===m||"undefined"==typeof m)&&(m=t()),y=o[v]&&o[v][m]),"undefined"==typeof y||!y.length||!y[0]){var C="";_=[];for(w in o[v])this.terminals_[w]&&w>h&&_.push("'"+this.terminals_[w]+"'");C=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(l+1)+": Unexpected "+(m==d?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(C,{text:this.lexer.match,token:this.terminals_[m]||m,line:this.lexer.yylineno,loc:f,expected:_})}if(y[0]instanceof Array&&y.length>1)throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+m);switch(y[0]){case 1:i.push(m),r.push(this.lexer.yytext),s.push(this.lexer.yylloc),i.push(y[1]),m=null,g?(m=g,g=null):(c=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,f=this.lexer.yylloc,u>0&&u--);break;case 2:if(x=this.productions_[y[1]][1],E.$=r[r.length-x],E._$={first_line:s[s.length-(x||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(x||1)].first_column,last_column:s[s.length-1].last_column},p&&(E._$.range=[s[s.length-(x||1)].range[0],s[s.length-1].range[1]]),b=this.performAction.call(E,a,c,l,this.yy,y[1],r,s),"undefined"!=typeof b)return b;x&&(i=i.slice(0,-1*x*2),r=r.slice(0,-1*x),s=s.slice(0,-1*x)),i.push(this.productions_[y[1]][0]),r.push(E.$),s.push(E._$),k=o[i[i.length-2]][i[i.length-1]],i.push(k);break;case 3:return!0}}return!0}},i=function(){var t={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var i=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var r=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===i.length?this.yylloc.first_column:0)+i[i.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[r[0],r[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,i,r;if(this.options.backtrack_lexer&&(r={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(r.yylloc.range=this.yylloc.range.slice(0))),i=e[0].match(/(?:\r\n?|\n).*/g),i&&(this.yylineno+=i.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var s in r)this[s]=r[s];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,i;this._more||(this.yytext="",this.match="");for(var r=this._currentRules(),s=0;s<r.length;s++)if(n=this._input.match(this.rules[r[s]]),n&&(!t||n[0].length>t[0].length)){if(t=n,i=s,this.options.backtrack_lexer){if(e=this.test_match(n,r[s]),e!==!1)return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?(e=this.test_match(t,r[i]),e!==!1?e:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){var e=this.conditionStack.length-1;return e>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return e=this.conditionStack.length-1-Math.abs(e||0),e>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(t,n,i,r){var s=e("./expressionParser").parse;t.makeCommand=function(e,t){var n=-1!==e.indexOf("â€¸");e=e.replace("â€¸",""),":"===e.slice(-1)&&(e=e.slice(0,-1),t="%%TOKEN%% "+t),"("===t[0]&&(t=t.slice(1),")"===t.slice(-1)?t=t.slice(0,-1):")â€¸"===t.slice(-2)&&(t=t.slice(0,-2)+"â€¸"));var i=s(t);return{cmd:e,cursor:n||i.cursor||_.chain(i).pluck("cursor").any(_.identity).value(),arguments:i}};switch(i){case 0:return 6;case 1:return this.begin("ARGS"),4;case 2:return this.begin("QUOTE"),"'";case 3:return this.popState(),"'";case 4:this.begin("ESC");break;case 5:return 4;case 6:return this.begin("DBLQUOTE"),7;case 7:return this.popState(),7;case 8:this.begin("ESC");break;case 9:return 4;case 10:return this.popState(),4;case 11:return":";case 12:return 9;case 13:this.begin("PAREN");break;case 14:return 9;case 15:return}},rules:[/^(?:^â€¸$)/,/^(?:[â€¸\w]+:?)/,/^(?:')/,/^(?:')/,/^(?:\\)/,/^(?:[^'\\]+)/,/^(?:")/,/^(?:")/,/^(?:\\)/,/^(?:[^"\\]+)/,/^(?:.)/,/^(?:":)/,/^(?:.+)/,/^(?:\()/,/^(?:[^\)]+)/,/^(?:\))/],conditions:{ARGS:{rules:[12,13],inclusive:!1},ESC:{rules:[10],inclusive:!1},DBLQUOTE:{rules:[7,8,9],inclusive:!1},QUOTE:{rules:[3,4,5],inclusive:!1},PAREN:{rules:[14,15],inclusive:!1},INITIAL:{rules:[0,1,2,6,11],inclusive:!0}}};return t}();return n.lexer=i,t.prototype=n,n.Parser=t,new t}();"undefined"!=typeof e&&"undefined"!=typeof n&&(n.parser=r,n.Parser=r.Parser,n.parse=function(){return r.parse.apply(r,arguments)},n.main=function(t){t[1]||(console.log("Usage: "+t[0]+" FILE"),i.exit(1));var r=e("fs").readFileSync(e("path").normalize(t[1]),"utf8");return n.parser.parse(r)},"undefined"!=typeof t&&e.main===t&&n.main(i.argv.slice(1)))}(e("__browserify_process"))},{"./expressionParser":19,__browserify_process:15,fs:17,path:18}],32:[function(e,t){var n=e("./index"),i=e("./model"),r=i.extend({url:"/account"});r.set=function(e){return this.account=new r(e)},r.isCurrentUser=function(e){return e.id===this.account.id},r.currentUser=function(){return n.User.find(this.account.id)},t.exports=r},{"./index":33,"./model":34}],35:[function(e,t){var n=e("./model"),i=e("./collection"),r=e("./index"),s=n.extend({hasOne:{user:function(e){return r.User.add(e)}},book:function(){return this.collection&&this.collection.parent},isCreator:function(){return this.get("user")===this.book().get("creator")},canDelete:function(){return!this.isCreator()},contextKeys:["canDelete"]});s.Collection=i.extend({model:s}),t.exports=s},{"./collection":36,"./index":33,"./model":34}],37:[function(e,t){var n=e("../actions"),i=e("./model"),r=e("./collection"),s=i.extend({});s.Collection=r.extend({model:s,renameValue:function(e,t,n){return this.action(s.RenameValue,e,t).do(n)},parse:function(e){return _.map(e,function(e){return{name:e}})},setValues:function(e,t){return this.action(s.SetValues,e).do(t)}}),s.SetValues=n.Action.extend({initialize:function(e,t){this.collection=e,this.newValues=t,this.oldValues=e.pluck("name"),this.oldType=e.parent.get("type"),this.newType=t.length>0?"enum":"generic"},perform:function(e){this.setValues(this.newValues,this.newType,e)},revert:function(e){this.setValues(this.oldValues,this.oldType,e)},setValues:function(e,t,n){this.collection.update(e,n),this.collection.parent.set("type",t);var i=_.map(e,function(e){return{name:e}});this.collection.reset(i)}}),s.RenameValue=n.Action.extend({initialize:function(e,t,n){this.collection=e,this.from=t,this.to=n},renameEnum:function(e,t,n){var i={op:"rename",from:e,to:t};this.collection.patch([i],n);var r=this.collection.findWhere({name:e});r.set("name",t)},perform:function(e){this.renameEnum(this.from,this.to,e)},revert:function(e){this.renameEnum(this.to,this.from,e)}}),t.exports=s},{"../actions":38,"./collection":36,"./model":34}],39:[function(e,t){var n=e("./model"),i=n.extend({initialize:function(){this.set("url",window.location.href),this.set(_.pick(navigator,"userAgent","appVersion","platform","vendor"))},urlRoot:"/errorReports"});i.makeFromError=function(e,t){var n=e?e.toString():t,r=e&&e.stack;return new i({summary:n,stacktrace:r})},t.exports=i},{"./model":34}],40:[function(e,t){var n=e("./model"),i=n.extend({initialize:function(){this.set("url",window.location.href),this.set(_.pick(navigator,"userAgent","appVersion","platform","vendor"))},urlRoot:"/feedback"});t.exports=i},{"./model":34}],41:[function(e,t){var n=e("./model"),i=e("./collection"),r=(e("./sheet"),n.extend({idAttribute:"key",sheet:function(){return this.collection&&this.collection.parent},sheetId:function(){var e=this.sheet();return e&&e.id},shortUrl:function(){var e=this.sheet();return e&&e.url()+"/"+this.id},contextKeys:["sheetId","shortUrl","displayName"]}));r.Collection=i.extend({model:r}),t.exports=r},{"./collection":36,"./model":34,"./sheet":42}],42:[function(e,t){var n=e("../actions"),i=e("./index"),r=e("./model"),s=e("./collection"),o=e("./store"),a=(e("../../common/strings"),e("../parser")),l=r.extend({urlRoot:function(){return this.isNew()&&this.collection&&this.collection.url?null:"/sheets"},hasMany:{fields:function(){return new i.Field.Collection([],{url:function(){return this.parent.url()+"/fields"}})},deletedFields:function(){return new i.Field.Collection([],{url:function(){return this.parent.url()+"/deletedFields"}})},records:function(){return new i.Record.Collection([],{url:function(){return this.parent.url()+"/records"}})},navItems:function(){return new i.NavItem.Collection([],{url:function(){return this.parent.url()+"/navItems"}})},subsheets:function(){return new i.Subsheet.Collection([],{url:function(){return this.parent.url()+"/subsheets"}})}},initialize:function(){this.on("records:sync",_.bind(this.onRecordSync,this))},getFields:function(){return this.get("fields")},isLoaded:function(){return this.has("title")&&this.has("fields")&&this.has("records")&&this.has("navItems")&&this.has("subsheets")},needsFetch:function(){return r.prototype.needsFetch.call(this)?!0:this.get("records").any(function(e){return e.dirty})},markFetched:function(){r.prototype.markFetched.call(this),this.get("records")&&this.get("records").markFetched()},book:function(){return this.collection&&this.collection.parent},fieldWithKey:function(e){var t=this.get("fields");return t?t.findWhere({key:e}):void 0},deletedFieldWithKey:function(e){var t=this.get("deletedFields");return t?t.findWhere({key:e}):void 0},fieldWithSlug:function(e){return _.soak(this.get("fields"),"find",function(t){return t.slug()===e})},nameField:function(){var e=this.get("nameKey");return e?this.fieldWithKey(e):null},deleteNameField:function(e){this.nameField().destroy(e)},restoreNameField:function(e){var t=this.get("nameKey");if(null!=t){var n=this.deletedFieldWithKey(t),i=this.getFields();i.unshift(n),i.restore(n,e)}},navItemWithKey:function(e){var t=this.get("navItems");return t?t.find(function(t){return t.get("key")===e}):void 0},queryForNavKey:function(e){var t;return e&&(t=this.navItemWithKey(e)),t?this.query(null,t.get("query").powerBarTerms):null},recordNames:function(){var e=this.get("records");return e&&e.invoke("name")},recordIdNames:function(){var e=this.get("records");return e&&e.invoke("displayIdName")},findRecordByName:function(e){var t=this.get("records");return t&&t.find(function(t){return t.name()===e||t.shortName()===e})},findRecordByIdName:function(e){var t=this.get("records");return t&&t.find(function(t){return t.displayIdName()===e})},hasSubsheet:function(e,t){return this.get("subsheets").any(function(n){return n.get("sheet").id===e.id&&n.get("field").id===t.id})},potentialSubsheets:function(){var e=this,t=this.book();if(!t)return[];var n=t.get("sheets").map(function(t){return t.get("fields").filter(function(t){return t.isLinkToSheet(e)})});n=_.flatten(n);var i=_.reject(n,function(t){return e.hasSubsheet(t.sheet(),t)});return _.map(i,function(e){return{sheet:e.sheet().toJSON(),field:e.toJSON()}})},canDeleteGroup:function(e,t){return!this.get("records").any(function(n){return _.all(e,function(e,i){var r=t[i];return n.getValue(e).isEqual(r)})})},setNameKey:function(e,t){this.saveIfNeeded("nameKey",e,t)},addSubsheet:function(e,t){var n=this,i=t.success;t.success=function(e){var t=n.book(),r=e.get("sheet");t&&t.has("sheets")&&t.get("sheets").add(r),r.get("records")||r.set("records",[]),i&&i.apply(null,arguments)},this.get("subsheets").create(e,t)},query:function(e,t){try{return new i.powerbar.Query(e,t,this)}catch(n){return console.warn(n),null}},autoQuery:function(e){var t,n,i,r,s=a.autoSplit(e);for(t=s.length;t>0;t--){n=s.slice(0,t).join(" "),i=this.query(n);var o=_.soak(i,"commands.0.error");if(r=r||o,i&&1===i.commands.length){var l=i.commands[0].isValid||o.displayable;if(l=l||!_(["bareword",":",null,void 0]).contains(_.soak(i.commands[0],"original.expressions.0.op")))return{query:i,remainder:s.slice(t).join(" ")}}}return{remainder:e,error:r}},resultSheet:function(){return i.powerbar.results.ResultSheet.fromSheet(this)},newNavItem:function(e){if(e){var t=e.nameify(),n=e.boundTerms();return{name:t,query:{powerBarTerms:n}}}},updateNavItem:function(e,t,n){var i=this.navItemWithKey(t),r=e.boundTerms();i.saveIfNeeded("query",{powerBarTerms:r},n)},contextKeys:["url","displayTitle"],destroy:function(e){return this.action(l.Delete).do(e)},onRecordSync:function(e){e instanceof i.Record&&this.get("fields").each(function(t){t.updateEnumIfNeeded(e.getDisplayValue(t.id))})},goodGroupField:function(){var e=1/0,t=null,n=this.get("records");return this.getFields().each(function(i){var r=n.chain().invoke("getValue",i.get("key")).invoke("displayValue").uniq().value().length;r>1&&e>r&&(t=i,e=r)},this),t},displayValuesForField:function(e){var t=this.get("records"),n=e.get("key");return t.map(function(e){return e.getDisplayValue(n)})}});o.addStore(l),l.Collection=s.extend({model:function(e,t){return l.add(e,t)}}),l.Delete=n.Delete.extend({wrapOptions:function(e){var t=this.collection.parent,n=e.success;return e.success=function(){t.markDirty(),t.fetch({success:n})},e},perform:function(e){e=this.wrapOptions(e),n.Delete.prototype.perform.call(this,e)},revert:function(e){e=this.wrapOptions(e),n.Delete.prototype.revert.call(this,e)}}),l.displayedSheet=function(){var e=$(".sheet-detail");return _.chain(e).soak("data","view").soak("viewModel.sheet").value()},t.exports=l},{"../../common/strings":13,"../actions":38,"../parser":28,"./collection":36,"./index":33,"./model":34,"./store":8}],43:[function(e,t){var n=e("./model"),i=e("./collection"),r=e("./store"),s=n.extend({hasEmail:function(e){return _.contains(this.get("emails"),e)},queueTarget:function(){return this}});r.addStore(s),s.Collection=i.extend({model:function(e,t){return s.add(e,t)}}),t.exports=s},{"./collection":36,"./model":34,"./store":8}],44:[function(e,t){var n=(e("../actions"),e("./index")),i=e("./model"),r=e("./collection"),s=i.extend({hasOne:{sheet:function(e){return n.Sheet.add(e)},field:function(e){return new n.Field(e)}},isLoaded:function(){var e=this.has("field")&&this.has("sheet");if(!e)return!1;var t=this.get("sheet");return t.has("title")&&t.has("fields")},toContext:function(){var e=_.clone(this.attributes);return e.sheet&&(e.sheet=e.sheet.pick("_id","title")),e.field&&(e.field=e.field.pick("key","name")),e}});s.Collection=r.extend({model:s}),t.exports=s},{"../actions":38,"./collection":36,"./index":33,"./model":34}],45:[function(e,t,n){n.EditProcessor=e("./editProcessor"),n.GroupRecordList=e("./groupRecordList"),n.NameFieldSettings=e("./nameFieldSettings"),n.RecordIterator=e("./recordIterator"),n.RecordList=e("./recordList"),n.ReportRecordList=e("./reportRecordList"),n.SheetRecordList=e("./sheetRecordList"),n.SheetViewModel=e("./sheetViewModel"),n.SubsheetRecordList=e("./subsheetRecordList"),n.ViewModel=e("./viewModel")},{"./editProcessor":46,"./groupRecordList":47,"./nameFieldSettings":48,"./recordIterator":49,"./recordList":50,"./reportRecordList":51,"./sheetRecordList":52,"./sheetViewModel":53,"./subsheetRecordList":54,"./viewModel":55}],48:[function(e,t){var n=e("../../common/strings"),i=e("./viewModel"),r=i.extend({initialize:function(){this.record=this.options.record,this.sheet=this.options.sheet||this.record.sheet(),this.hasTitle=this.options.hasTitle,this.useShortId=this.options.useShortId,this.showNameField=this.options.showNameField},nameFieldOptions:function(){var e=this.sheet.get("fields"),t=this.record;return e.map(function(e){var i={field:e.toContext()};return t&&(i.displayValue=t.getDisplayValue(e.id)||n.unnamed),i})},toContext:function(){var e={hasTitle:this.hasTitle,namesOnly:!this.record,noName:!this.sheet.has("nameKey"),options:this.nameFieldOptions()};return this.record&&(e.shortId=this.useShortId?this.record.displayId():this.record.displayIdName()),e}});t.exports=r},{"../../common/strings":13,"./viewModel":55}],49:[function(e,t){var n=e("./viewModel"),i=n.extend({initialize:function(){this.records=this.options.records,_.isArray(this.records)||"function"!=typeof this.records.toArray||(this.records=this.records.toArray())},contains:function(e){return-1!==this.records.indexOf(e)},current:function(){return this.records[this.index]},setCurrent:function(e){this.index=this.records.indexOf(e)},total:function(){return this.records.length},hasNext:function(){return this.index+1<this.total()},hasPrev:function(){return this.index>0},nextRecord:function(){return this.hasNext()?this.records[this.index+1]:void 0},prevRecord:function(){return this.hasPrev()?this.records[this.index-1]:void 0},nextId:function(){var e=this.nextRecord();return e&&e.id},prevId:function(){var e=this.prevRecord();return e&&e.id},toContext:function(){return{number:this.index+1,total:this.total(),nextId:this.nextId(),prevId:this.prevId()}}});t.exports=i},{"./viewModel":55}],52:[function(e,t){var n=e("./recordList"),i=n.extend({type:"sheet",initialize:function(){this.sheetViewModel=this.options.sheetViewModel,this.sheet=this.sheetViewModel.sheet,this.absolute=!0,this.records=this.sheetViewModel.records(),n.prototype.initialize.call(this)}});t.exports=i},{"./recordList":50}],56:[function(e,t){var n=e("./view"),i=e("../../common/strings");t.exports=function(e,t,r,s){s=s||{};var o=t.getValue(r),a={text:o.displayValue()};s.href?a.href=s.href:o&&o.isRef()&&(a.href=o.linkUrl(),a.text=a.text||i.unnamed),a.rightAligned=o.isNumericValue()||o.isDate(),o.isError()?(a.error=!0,e.addClass("error-cell"),e.tooltip({title:o.getMessage(),placement:"right",container:s.container})):(e.removeClass("error-cell"),e.tooltip("destroy")),e.html(n.partials.value(a))}},{"../../common/strings":13,"./view":57}],58:[function(e,t){var n=e("./view"),i=e("../parser").cursorToken,r=e("../../common/strings"),s=n.extend({className:"chit",initialize:function(){this.reinitialize(this.options)},reinitialize:function(e){this.$el.empty(),this.$el.removeClass("error selected"),this.$el.tooltip("destroy"),this.el.normalize(),this.formatted=!1,this.edited=!1,this.render();var t=e.command;if(t)if(t.error){this.$el.text(t.string.replace(i,"").trim()),this.$el.addClass("error");var n;t.error.displayable&&n?(n=t.error.message,n=n.replace(new RegExp("^"+"Cannot interpret formula:".split().join("\\"),"g"),r["error-interpret-query-term-colon"])):n=r["error-interpret-query-term"],this.$el.tooltip({placement:"top",container:"body",title:n}),this.formatted=!0}else{this.$el.text(t.string.trim());var s=this.$el.html();s=s.replace(t.name,t.name.bold()),this.$el.html(s);var o=t.name;t.command.isDefaultWhere()&&(o="search");var a=this.icons[o];a&&(s=$("<i>").addClass("icon-fixed-width icon-"+a).prependTo(this.el)),t.tip&&this.$el.tooltip({placement:"top",container:"body",title:t.tip}),this.formatted=!0}else e.text&&this.$el.text(e.text);this.$el.text()||this.$el.text(""),this.$el.prop("contenteditable",!0)},icons:{sort:"sort",group:"th-list",search:"search",report:"bar-chart",where:"filter"},val:function(e){return arguments.length?(this.$el.text(e),this.el.normalize(),this):this.$el.text()},getCursorPosition:function(){var e=document.getSelection();return e.rangeCount?(e=e.getRangeAt(0),e.startOffset!==e.endOffset?-1:e.startOffset):-1},setCursorPosition:function(e){if(this.formatted)throw new Error("Can't set cursor on formatted chit.");switch(e){case"start":e=0;break;case"end":e=this.val().length}var t=document.createRange(),n=this.el.childNodes.length?this.el.childNodes[0]:this.el;t.setStart(n,e),t.setEnd(n,e);var i=document.getSelection();i.removeAllRanges(),i.addRange(t)},textWithCursorToken:function(){var e=this.val(),t=document.getSelection();return t.rangeCount?(t=t.getRangeAt(0),e.slice(0,t.startOffset)+i+e.slice(t.endOffset)):e+i},selectContent:function(){if(this.formatted)throw new Error("Can't select formatted chit.");var e=document.createRange(),t=document.getSelection();e.selectNodeContents(this.el),t.removeAllRanges(),t.addRange(e)},isContentSelected:function(){var e=document.getSelection();return e.rangeCount?(e=e.getRangeAt(0),0===e.startOffset&&e.endOffset===this.val().length):!1},select:function(){this.$el.addClass("selected").trigger("chit-selected")},deformat:function(){this.formatted&&(this.$el.tooltip("destroy"),this.$el.removeClass("error"),this.$el.text(this.$el.text()),this.formatted=!1)},events:{focus:"deformat"}});t.exports=s},{"../../common/strings":13,"../parser":28,"./view":57}],59:[function(e,t){var n=e("./view"),i=e("./chitView"),r=e("../keys"),s=e("../parser"),o=(s.cursorToken,e("../models/powerbar/commands")),a=n.extend({className:"chit-well",initialize:function(){$("<input>").addClass("offscreen").appendTo(this.el),this.content=$("<div>").appendTo(this.el),this.viewModel=this.options.viewModel,this.render()},chit$:function(e){return 0===arguments.length?this.content.children():this.content.children().filter(function(t,n){return $(n).is(e)})},selectedChitEls:function(){return this.chit$(".selected")},nonEmptyChitEls:function(){return this.chit$(":not(:empty)")},render:function(){if(!this.chit$(":focus").length&&!this.rendering){this.rendering=!0,this.saveSelection();for(var e=this.viewModel.getCommandDescriptors(),t=this.nonEmptyChitEls().toArray().map(function(e){return $(e).view()}),n=e.length,r=t.length;n>r;r++)t.push(new i);var s=t;t=_.head(t,n),_.zip(e,t).forEach(function(e){var t=e[0],n=e[1];n.reinitialize({command:t})}),$(_.chain(s).difference(t).pluck("el").value()).remove();var o=$(_.pluck(t,"el")).filter(function(e,t){return!$(t).parent().length});this.content.append(o),this.resetEmptyChits(),this.restoreSelection(),this.rendering=!1}},saveSelection:function(){this.selection=[],this.nonEmptyChitEls().each(function(e,t){$(t).is(".selected")&&this.selection.push(e)}.bind(this))},restoreSelection:function(){var e=this.nonEmptyChitEls();this.selection.forEach(function(t){e.eq(t).addClass("selected")})},resetEmptyChits:function(){this.chit$().find("br").remove();for(var e=this.chit$(":empty:not(:focus)").toArray().map(function(e){return $(e).view()}),t=this.chit$().length+1-e.length,n=e.length;t>n;n++)e.push(new i);var r=e;e=_.head(e,t),_.chain(r).difference(e).pluck("$el").invoke("remove"),this.chit$(":not(:empty), :focus").each(function(t,n){$(n).before(e.shift().el)}),this.content.append(e.shift().el);var s=this.chit$(":focus"),o=s.prevAll().filter(this.chit$(":empty")).first().add(s.nextAll().filter(this.chit$(":empty")).first());o.remove()},editingChit:function(){var e=this.chit$(":focus").first();return e.length?e.view():null},getQueryString:function(e){return 0===arguments.length&&(e=this.nonEmptyChitEls()),e.map(function(e,t){return $(t).text()}).toArray().join(" | ")},rechittify:function(e){var t=e||this.chit$(":focus"),n=t.is(":focus");if(t.length){var r=t.text();if(!n||t.view().getCursorPosition()===r.length){var a=s.pipeSplit(r);if(a.length>1){var l=a.pop().trim(),c=a.map(function(e){return new i({text:e.trim()}).$el});return t.view().reinitialize({text:l}),n&&t.view().setCursorPosition("end"),t.before(c),this.resetEmptyChits(),c.push(t),void c.forEach(this.rechittify.bind(this))}var u=this.viewModel.sheet,h=u.autoQuery(r);if(h.query){var d=h.query.commands[0];if(!n||""!==h.remainder){var f=u.autoQuery(h.remainder),p=!0;if(_.contains(["bareword",":"],_.soak(d,"expressions.0.op"))){if(p=!1,n&&!f.query)return;o.commandsMatching(d.stringify(u)).length&&(p=!0)}if(p)if(f.query){if(n&&"bareword"===_.soak(f.query.commands[0],"expressions.0.op")&&(!o.isCommand(f.query.stringify())||!/\s/.test(r.slice(-1)))){var m=u.autoQuery(f.remainder);if(!m.query)return}}else if("ValidationError"!==_.soak(f,"error.name"))return;var g=h.query.getCommandDescriptors()[0],v=new i({command:g});t.before(v.el),t.view().reinitialize({text:h.remainder}),n&&t.view().setCursorPosition("end"),this.triggerInputIfEditing(),this.resetEmptyChits(),this.rechittify(e)}}}}},triggerInputIfEditing:function(e){this.activeAutocompleteExists()||this.editingChit()&&this.$el.trigger("input",[e])},events:{click:function(e){var t=$(e.target).closest(".chit");t.is(":focus")||(e.preventDefault(),0!==t.length?(this.render(),this.onNextTick(function(){this.clickChit(t)})):(this.chit$(":focus").is(t)&&this.chit$(":focus").blur(),this.onNextTick(function(){this.clickChit(this.chit$().last())})))},"mousedown .chit":function(e){$(e.target).is(":focus")||e.preventDefault()},mousedown:function(e){this.dragging={},this.dragging.start=$(e.target).closest(".chit").add($(".chit").last()).first(),$(window).one("mouseup",function(){delete this.dragging}.bind(this))},mousemove:function(e){if(this.dragging){var t=$(document.elementFromPoint(e.pageX,e.pageY)).closest(".chit");if(t.length&&!t.is(":focus")){if(this.chit$(":focus").length){var n;this.dragging.start.is(":empty")?(n=this.nonEmptyChitEls().index(this.dragging.start.prevAll(".chit:not(:empty)").first()),this.triggerInputIfEditing(),this.dragging.start=-1===n?this.chit$().first():this.nonEmptyChitEls().eq(n).next()):(n=this.nonEmptyChitEls().index(this.dragging.start),this.triggerInputIfEditing(),this.dragging.start=this.nonEmptyChitEls().eq(n))}if(t=$(document.elementFromPoint(e.pageX,e.pageY)).closest(".chit"),t.length){if(this.selectedChitEls().removeClass("selected"),t.is(this.dragging.start))return void t.view().select();var i;i=t.is(this.dragging.start.prevAll())?this.dragging.start.prevUntil(t):this.dragging.start.nextUntil(t),i.add(this.dragging.start).add(t).filter(".chit:not(:empty)").each(function(e,t){$(t).view().select()
})}}}},"keydown .chit":"onChitKeyDown","keydown .offscreen":"onKeyDown","input .offscreen":"startEditing",keyup:function(e){this.triggerInputIfEditing(e)},"input .chit":function(e){var t=$(e.target);t.view().edited=!0},"blur .offscreen":function(e){this.$(".offscreen").val(""),this.chit$().removeClass("selected"),this.$(e.relatedTarget).length||this.$el.trigger("blur")},"blur .chit":function(e){this.rechittify($(e.target)),this.$(e.relatedTarget).length||this.$el.trigger("blur")},"paste .offscreen":function(){this.onNextTick(function(){var e=this.editingChit().$el,t=e.next().next();this.blur();var n=t.prev().prev();n.length||(n=this.chit$().last()),n.focus(),n.view().setCursorPosition("end")})},"paste .chit":function(e){var t=$(e.target),n=t.view();""===n.val()&&(n.val(" "),n.setCursorPosition(1)),t.view().edited=!0,this.onNextTick(function(){this.rechittify(t)})},"focus .chit":function(e){$(e.target).view().edited=!1,this.$(e.relatedTarget)&&this.$el.trigger("focus"),this.chit$().removeClass("selected"),this.originalChitValue=$(e.target).view().val()},"focus .offscreen":function(e){this.$(e.relatedTarget)&&this.$el.trigger("focus"),this.$el.trigger("nonedit-select")},"chit-selected .chit":function(){var e=this.$(".offscreen");0===e.length&&(e=$('<input class = "offscreen">').prependTo(this.el)),e.focus();var t=this.getQueryString(this.selectedChitEls());e.val(t),e.get(0).setSelectionRange(0,t.length)}},hasFocus:function(){return this.$(".chit:focus,.offscreen:focus").length},focus:function(){this.chit$().last().focus()},blur:function(){this.$(":focus").blur()},clickChit:function(e){e.focus(),e.view().deformat(),e.view().selectContent(),this.resetEmptyChits(),this.triggerInputIfEditing()},onChitKeyDown:function(e){this.chit$().tooltip("hide"),(e.metaKey||e.ctrlKey)&&e.stopPropagation();var t=$(e.target);if(!_.contains([r.COMMAND,r.CTRL,r.OPTION,r.SHIFT],e.keyCode)){var n=t.view();if(e.metaKey&&e.keyCode===r("Z")&&(n.edited||(e.preventDefault(),e.shiftKey?(this.blur(),this.redo()):(this.blur(),this.undo()))),e.keyCode===r.RIGHT&&(n.getCursorPosition()===t.text().length||n.isContentSelected())){e.preventDefault(),this.$el.trigger("blur");var i=t.next();return i.is(":empty")?i.focus():(e.shiftKey||this.chit$().removeClass("selected"),i.length&&i.view().select()),this.rechittify(t),void this.render()}if(e.keyCode===r.TAB){if(!this.activeAutocompleteExists())return this.onTab(e);e.preventDefault()}e.keyCode===r.RETURN&&(this.activeAutocompleteExists()?e.preventDefault():(this.blur(),this.$el.trigger("blur"))),e.keyCode===r.ESC&&(this.editingChit().val(this.originalChitValue),this.blur(),this.$el.trigger("blur"));var s;if(e.keyCode===r.LEFT&&(""===n.val()||0===n.getCursorPosition())||e.keyCode===r.BACKSPACE&&0===n.getCursorPosition()&&t.text().length){if(e.preventDefault(),s=t.prevAll(".chit").first(),!s.length)return;return this.triggerInputIfEditing(e),s.is(":empty")?s.focus():(e.shiftKey||this.chit$().removeClass("selected"),s.length&&s.view().select()),void this.rechittify(t)}if(e.keyCode===r.BACKSPACE&&t.is(":empty")){if(e.preventDefault(),s=t.prev(),!s.length)return;var o=s.is(":empty");return o&&(s.prev().tooltip("destroy"),s.prev().remove()),s.tooltip("destroy"),s.remove(),s=t.prevAll().filter($(".chit:not(:empty)")).first(),this.triggerInputIfEditing(e),s=0===s.length?this.chit$().first():s.next(),s.focus(),s.view().setCursorPosition("end"),void this.resetEmptyChits()}return(e.metaKey||e.ctrlKey)&&e.keyCode===r("A")?(this.blur(),void this.selectAll(e)):void(_.contains([r.BACKSPACE,r.LEFT,r.RIGHT,r.DOWN,r.UP],e.keyCode)||this.onNextTick(this.rechittify))}},activeAutocompleteExists:function(){return 0!==$(".autocomplete li.active").length},onKeyDown:function(e){switch(e.keyCode){case r.LEFT:e.preventDefault(),this.arrowLeft(e);break;case r.RIGHT:e.preventDefault(),this.arrowRight(e);break;case r.UP:e.preventDefault(),this.arrowUp(e);break;case r.DOWN:e.preventDefault(),this.arrowDown(e);break;case r.BACKSPACE:e.preventDefault(),this.backspace(e);break;case r.RETURN:e.preventDefault(),this.enter(e);break;case r.TAB:this.onTab(e);break;case r("A"):(e.metaKey||e.ctrlKey)&&this.selectAll(e)}},arrowLeft:function(e){var t=this.selectedChitEls().first();if(0!==t.length){var n;e.shiftKey?(n=t.prevAll().filter(function(e,t){return $(t).is(".chit:not(:empty)")}).first(),n.length&&n.view().select()):t.prev().focus()}},arrowRight:function(e){var t=this.selectedChitEls().last();if(0!==t.length){var n;e.shiftKey?(n=t.nextAll().filter(function(e,t){return $(t).is(".chit:not(:empty)")}).first(),n.length&&n.view().select()):(this.selectedChitEls().removeClass("selected"),t.next().focus())}},arrowUp:function(e){e.shiftKey?this.selectedChitEls().first().prevAll(":not(:empty)").each(function(e,t){$(t).view().select()}):this.chit$().removeClass("selected").first().focus()},arrowDown:function(e){e.shiftKey?this.selectedChitEls().last().nextAll(":not(:empty)").each(function(e,t){$(t).view().select()}):this.chit$().removeClass("selected").last().focus()},backspace:function(e){var t=this.selectedChitEls();if(this.chit$().tooltip("hide"),0!==t.length){var n=t.first().prevAll().filter($(".chit:not(:empty)")).first();t.tooltip("destroy"),t.remove(),this.triggerInputIfEditing(e);var i;i=0===n.length?this.chit$().first():n.next(),i.focus(),this.resetEmptyChits()}},enter:function(){var e=this.selectedChitEls().first();0!==e.length&&(e.focus(),e.view().deformat(),e.view().selectContent(),this.resetEmptyChits())},onTab:function(e){e.preventDefault();var t=this.chit$(":focus, .selected").first();this.triggerInputIfEditing(e);var n=this.chit$();n.removeClass("selected");var i;i=e.shiftKey?{siblings:"prevAll",terminal:"first"}:{siblings:"nextAll",terminal:"last"};var r=t[i.siblings]().filter(function(e,t){return!$(t).is(":empty")}).first();this.$(".offscreen").focus(),this.render(),0===r.length?(r=this.chit$()[i.terminal](),r.focus()):r.view().select(),this.$el.trigger("blur"),this.$el.trigger("input")},selectAll:function(e){e.preventDefault(),e.stopPropagation(),this.nonEmptyChitEls().each(function(e,t){$(t).view().select()})},startEditing:function(){var e=this.selectedChitEls();if(0!==e.length){var t=e.first(),n=e.not(t),i=this.$(".offscreen");this.chit$().tooltip("hide"),n.tooltip("destroy"),n.remove();var r=i.val();i.val(""),e.view().deformat(),e.view().val(r),e.view().setCursorPosition("end")}}});a.deferrableRendering(),t.exports=a},{"../keys":4,"../models/powerbar/commands":60,"../parser":28,"./chitView":58,"./view":57}],61:[function(e,t){var n=e("./view"),i=e("./modalView"),r=i.extend({className:"confirm-leave modal hide fade",template:n.templates.confirmLeave,events:{"click .confirm-leave":function(){this.options.onConfirm()}}});t.exports=r},{"./modalView":62,"./view":57}],63:[function(e,t){!function(){var n=e("./view"),i=e("./modalView"),r=e("../globalEvents"),s=e("../models/expressions/expression"),o=e("../../common/strings"),a=e("./autocompleteView"),l=i.extend({positionPad:10,className:"modal hide formula-view",template:n.templates.formula,initialize:function(){this.render(),this.setup()},context:function(){return{isReportFormula:this.options.field.isReportFormula(),initialValue:this.initialEditableValue()}},setup:function(){var e=this;this.formulaField=this.$(".formula-field"),this.onNextTick(function(){e.autocompleteView=new a({input:e.formulaField,inputSelectorClass:"formula-field",source:function(t,n){t="="+t,e.options.field.queryAutocompleteValues(t,function(e){n(_.map(e,function(e){return e.slice(1)}))})}}),e.$(".autocomplete-container").append(e.autocompleteView.$el)})},reposition:function(){var e=this.options.avoidSpan;if(e){var t=this.$el.offset(),n=this.$el.width(),i=e.left-n-this.positionPad,r=e.right+this.positionPad;i>this.positionPad?t.left=i:r+this.positionPad<document.body.clientWidth&&(t.left=r);var s=this.$el.height(),o=e.top-s-this.positionPad,a=e.bottom+this.positionPad;t.top=a+s+this.positionPad<window.innerHeight?a:o,this.$el.offset(t)}},events:{"input .formula-field":"onEdit","blur .formula-field":function(){this.formulaField.focus()},"click .fv-save":function(){var e=!0;return this.captureActions(function(){var t=this.options.field,n=this.formulaField.val();if(""===n.trim())if(t.isReportFormula()){t.restoreStashed();var i=s.parse('""',t.formulaSheet(),{forbiddenFields:[t]});t.saveFormula(i)}else t.removeFormula();else try{var r=s.parse(n,t.formulaSheet(),{forbiddenFields:[t]});t.isReportFormula()&&r.validateReportExpression(),t.restoreStashed(),t.saveFormula(r)}catch(a){if(e=!1,a instanceof s.ParseError||a instanceof s.ValidationError){var l=this.$(".error");return l.text(a instanceof s.ValidationError?a.message:o["error-parse-formula-generic"]),void this.$(".error").show()}throw a}}),e?(this.didSave=!0,void this.hide()):!1},show:Tips.displayAfter(function(){this.formulaField.val(this.initialEditableValue()),r.trigger("formulaView:show"),this.onEdit()}),shown:function(){this.reposition(),this.$el.prev().css({opacity:.3}),this.$el.draggable();this.options.field;this.formulaField.focus()},hide:Tips.displayAfter(function(){var e=this.options.field;this.didSave||e.restoreStashed(),l.formulaView===this&&delete l.formulaView,r.trigger("formulaView:hide")})},initialEditableValue:function(){var e=this.options.initialValue||"";return!this.getField().isReportFormula()||'""'!==e&&"''"!==e?e:""},getField:function(){return this.options.field},onEdit:function(e){if(13===_.soak(e,"keyCode"))this.$(".fv-save").click();else{this.$(".error").hide();var t=this.formulaField.val();t=t.trim()||'""';var n=this.options.field;try{var i=s.parse(t,n.formulaSheet(),{forbiddenFields:[n]});n.isReportFormula()&&i.validateReportExpression();var r=n.get("expression");if(!r||i.stringify(n.formulaSheet())!==r.stringify(n.formulaSheet())){n.stash();var o={type:"formula",expression:i};n.isReportFormula()&&(o.type="report-formula",o.name=i.nameify(n.formulaSheet())),n.set(o)}}catch(a){if(a instanceof s.ParseError||a instanceof s.ValidationError)return;throw a}}}});l.beginFormulaPanel=function(e){this.formulaView=new l(e),this.formulaView.show()},t.exports=l}()},{"../../common/strings":13,"../globalEvents":64,"../models/expressions/expression":65,"./autocompleteView":66,"./modalView":62,"./view":57}],67:[function(e,t){var n=(e("../../common/strings"),e("./view")),i=e("./index"),r=e("../viewModels/help/help"),s=r.Entry,o=e("../keys"),a=n.extend({className:"help-container",initialize:function(){this.$el.html(n.templates.help()),this.input=this.$(".help-input"),this.render(),this.askView=new i.FeedbackView.AskView,this.onNextTick(function(){this.askView.$el.appendTo(this.$el.parent())})},helpClicked:function(){s.currentEntry&&s.end(),this.show()},show:function(){this.$el.fadeIn(200),this.input.focus().select()},hide:function(){this.$el.fadeOut(200)},events:{"input .help-input":"render","click .question:not(.ask)":"onClickQuestion","click .question.ask":"onClickAskUs","keydown .help-input":"onKeyDown","mouseenter li":function(e){this.$(".active").removeClass("active"),$(e.target).addClass("active")},"mouseleave li":function(e){$(e.target).removeClass("active")}},keyboardEvents:{"?":function(){return this.show(),!1}},renderQuestions:function(){var e=this.input.val();this.$(".questions").html(n.templates.helpQuestions({questions:this.getQuestions()})),s.getQueryTerms(e).forEach(function(e){this.$(".questions").highlight(e)})},render:function(){this.renderQuestions()},getQuestions:function(){var e=this.input.val(),t=s.find(e);return t.map(function(e){return{title:e.prototype.title,id:e.id}})},clear:function(){this.input.val("")},onClickQuestion:Tips.displayAfter(function(e){var t=s.get($(e.target).closest(".question").data("entry"));s.begin(t),this.clear(),this.hide()}),onClickAskUs:function(){this.clear(),this.hide(),this.askView.show()},onKeyDown:function(e){if(this.$el.is(":visible"))if(e.keyCode===o.DOWN||e.keyCode===o.UP){this.$("li").length>1&&e.preventDefault();var t=this.$("li.active");this.$("li").removeClass("active");var n;e.keyCode===o.DOWN?(n=t.next(),0===n.length&&(n=this.$("li").first())):e.keyCode===o.UP&&(n=t.prev(),0===n.length&&(n=this.$("li").last())),t.removeClass("active"),n.addClass("active"),n[0].scrollIntoViewIfNeeded()}else if(e.keyCode===o.RETURN){e.stopPropagation(),e.preventDefault();var i=this.$("li.active");i.click(),this.hide()}else e.keyCode===o.ESC&&this.hide()}});t.exports=a},{"../../common/strings":13,"../keys":4,"../viewModels/help/help":69,"./index":68,"./view":57}],68:[function(e,t,n){n.TipView=e("./tipView"),n.BookListView=e("./bookListView"),n.ErrorAlertView=e("./errorAlertView"),n.FeedbackView=e("./feedbackView"),n.RecordListView=e("./recordListView"),n.ReportRecordListView=e("./reportRecordListView"),n.RecordView=e("./recordView"),n.RootView=e("./rootView"),n.BookUsersView=e("./bookUsersView"),n.SheetView=e("./sheetView"),n.StatusBarView=e("./statusBarView"),n.HelpView=e("./helpView")},{"./bookListView":71,"./bookUsersView":78,"./errorAlertView":72,"./feedbackView":73,"./helpView":67,"./recordListView":74,"./recordView":76,"./reportRecordListView":75,"./rootView":77,"./sheetView":79,"./statusBarView":80,"./tipView":70}],62:[function(e,t){var n=e("./view"),i=n.extend({className:"modal hide fade",template:null,initialize:function(){this.render()},context:function(){return this.options},render:function(){var e=this;this.$el.html(this.template(this.context())),this.$el.modal({show:!1,keyboard:!0}),this.$el.on("hidden",_.bind(this.remove,this)),this.$el.on("show",function(){e.isShown=!0}),this.$el.on("hide",function(){e.isShown=!1})},show:function(){this.$el.modal("show")},hide:function(){this.$el.modal("hide")}});t.exports=i},{"./view":57}],81:[function(e,t){var n=e("./view"),i=(e("../keys"),e("../routing")),r=(e("./autocompleteView"),e("./chitWellView")),s=e("./menuAutocompleteView"),o=n.extend({className:"powerbar",template:n.templates.powerbar,initialize:function(){this.viewModel=this.options.viewModel,this.setQueryTextDelayed=_.debounce(_.bind(this.setQueryText,this),100),this.listenTo(this.viewModel,"queryTextChanged",this.renderQueryTextDeferred),this.listenTo(this.viewModel,"sheetChanged",this.renderSaveSearchButtonDeferred),this.listenTo(this.viewModel,"navQueryChanged",this.renderSavedSearchQueryDeferred)},renderSaveSearchButton:function(){var e=this.$(".save-search,.search-actions-menu"),t=this.$(".search").val();this.viewModel.canSaveSearch(t)?e.removeAttr("disabled"):e.attr("disabled",!0)},renderSavedSearchQuery:function(){_.soak(this.chitWell,"blur()");var e=this.viewModel.navItemSearchText();this.viewModel.setQueryText(e),_.soak(this.chitWell,"render()")},render:function(){this.$el.html(n.templates.powerbar(this.context())),this.renderSavedSearchQuery(),this.renderSaveSearchButton(),this.chitWell=new r({viewModel:this.viewModel}),this.$(".search-container").append(this.chitWell.el),this.autocompleteView=new s({source:_.bind(this.viewModel.queryAutocompletions,this.viewModel),sheet:this.viewModel.sheet,input:this.chitWell.$el,onSelect:_.bind(this.setQueryFromCompletion,this),inputSelectorClass:this.chitWell.className}),this.autocompleteView.render(),this.$el.append(this.autocompleteView.$el)},renderQueryText:function(){this.chitWell.render()},context:function(){return{showUpdateSearchButton:this.viewModel.navQuery()}},saveOrUpdateSearch:function(e,t){if(this.viewModel.canSaveSearch()){var n=this,r=this.$(".save-search");this.addSpinner(r,this.greyButtonSpinnerOptions);var s={success:function(e){n.stopSpinning(r),mixpanel.track("save_search",{sheet_id:n.viewModel.sheet.id,navKey:e.id});var s={};(t||!n.viewModel.navQuery())&&(s.editSheetTitle=!0),i.router.flash(s).goToSheet(n.viewModel.sheet.id,e.id)},error:this.errorHandler({action:"create-nav-item",spinner:r}),forceNewNavItem:t};this.viewModel.navQuery()&&!t?this.viewModel.updateSearch(s):this.viewModel.saveSearch(s)}},setQueryText:function(){var e=this.chitWell.getQueryString();this.renderSaveSearchButton();try{this.viewModel.setQueryText(e)}catch(t){console.warn(t)}},setQueryFromCompletion:function(e,t){t||(t=this.chitWell.editingChit()),this.captureActions(function(){t.val(e)})},editedChit:function(){this.captureActions(function(){this.viewModel.originalQuery||this.viewModel.beginEditingQueryText(),this.setQueryText(),this.viewModel.endEditingQueryText(),this.chitWell.renderDeferred()})},keyboardEvents:{"/":function(){return this.chitWell.focus(),!1}},events:{"focus .chit-well":function(){this.viewModel.beginEditingQueryText()},"blur .chit-well":function(){this.editedChit()},"input .chit-well":function(){this.setQueryTextDelayed()},"submit .search-form":function(e){e.preventDefault(),this.$(".search").blur()},"click .save-search":function(e){this.captureActions(function(){e.preventDefault(),this.saveOrUpdateSearch(e)})},"click .save-as-new":function(e){this.captureActions(function(){e.preventDefault(),this.saveOrUpdateSearch(e,!0)})}}});o.deferrableRendering(),t.exports=o},{"../keys":4,"../routing":82,"./autocompleteView":66,"./chitWellView":59,"./menuAutocompleteView":83,"./view":57}],75:[function(e,t){var n=e("./recordListView"),i=e("./view"),r=t.exports=n.extend({tableViewOptions:function(){var e=n.prototype.tableViewOptions.apply(this,arguments);return delete e.rowHeaders,e.manualColumnMove="> th.data.report-formula",e.fillHandle=!1,e.minSpareRows=this.model.shouldShowExtraRow()?1:0,e},createColumns:function(){var e=n.prototype.createColumns.apply(this,arguments);return _.each(e,function(e){e.field&&!e.field.isReportFormula()&&(e.readOnly=!0)}),e},renderBase:function(){return this.$el.addClass("report"),n.prototype.renderBase.apply(this,arguments)},clickHeaderCell:function(e){var t=$(e.target).closest("th"),n=this.tableView.columnIndexForHeaderCell(t);this.tableView.selectColumn(n)},showFieldContextMenu:function(e){var t=$(e.target).closest("th"),n=t.data("column"),r=n.field;if(r.isReportFormula()){var s={key:r.get("key"),name:r.displayName()};this.showContextMenu(e,{cell:t},i.partials.reportFormulaFieldMenuItems(s)),this.$(".floating-dropdown [title]").tooltip({placement:"right",container:".record-list"})}},addField:function(){this.insertFieldAndEdit()},insertFieldAndEdit:function(e,t){var n=this.model.insertReportFormula(e,t);this.onNextTick(function(){this.beginEditingFormulaField(n)})},events:{"click .insert-column-before":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".insert-column-before"),n=this.model.fieldWithKey(t.data("key"));this.insertFieldAndEdit(n,{before:!0})})},"click .insert-column-after":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".insert-column-after"),n=this.model.fieldWithKey(t.data("key"));this.insertFieldAndEdit(n,{before:!1})})},"click .edit-formula":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".edit-formula"),n=this.model.fieldWithKey(t.data("key"));this.onNextTick(function(){this.beginEditingFormulaField(n,n.editableFormula().slice(1))})})}},showAggregateContextMenu:function(){},showCellContextMenu:function(){},onColumnResized:function(){},onTableEdited:function(){}});r.deferrableRendering()},{"./recordListView":74,"./view":57}],80:[function(e,t){var n=e("../actions"),i=(e("../routing"),e("./view")),r=i.extend({className:"status-bar",fadeDuration:200,initialize:function(){this.message={},this.messageOptions={},this.render(),this.$el.hide(),this.listenTo(n.history,"do",this.hide),this.listenTo(n.history,"undo",this.hide),this.listenTo(n.history,"redo",this.hide),r.view=this},isShown:function(){return this.$el.is(":visible")},isHidden:function(){return!this.isShown()},render:function(){this.$el.html(i.templates.statusBar(this.message))},show:function(e){_.isString(e)&&(e={text:e}),this.message=e,this.render(),this.$el.fadeIn(this.fadeDuration)},hide:function(e){e=e||{},(!this.messageOptions.permanent||e.force)&&this.$el.fadeOut(this.fadeDuration)},events:{"click .text":function(){this.hide({force:!0})},"click .undo":function(){this.undo()}},setMessageOptions:function(e){this.messageOptions=e||{}}});r.show=function(e,t){this.view&&(this.view.setMessageOptions(t),this.view.show(e))},r.hide=function(e){this.view&&this.view.hide(e)},t.exports=r},{"../actions":38,"../routing":82,"./view":57}],84:[function(e,t,n){var i=e("./types"),r=e("../extendable"),s=e("../strings"),o=(n.computeAggregate=function(e,t){var n;if(!(e in a))throw new Error("Cannot find aggregate with type: "+e);n=a[e];var i=new n(t);return i.canPerform()?{displayName:i.displayName,value:i.perform()}:null},n.Aggregate=function(){this.initialize.apply(this,arguments)});_.extend(o.prototype,{initialize:function(e){var t=this;this.values=_.map(e,function(e){return _.filter(e,t.filter)})},canPerform:function(){return!0},hasInterestingData:function(){return this.canPerform()},filter:function(){return!0},perform:function(){throw new Error("subclass should implement perform")}}),r(o);var a=n.registry={},l=function(e){a[e.prototype.type]=e},c=n.LinearAggregate=o.extend({initialize:function(){o.prototype.initialize.apply(this,arguments),this.values=_.flatten(this.values,!0)}}),u=n.NumberAggregate=c.extend({canPerform:function(){return this.values.length>0},filter:function(e){return e.isNumericValue()}}),h=n.SumAggregate=u.extend({type:"sum",canPerform:function(){return!0},hasInterestingData:function(){return this.values.length>0},perform:function(){return 0===this.values.length?i.createNumber(0):_.reduce(_.rest(this.values),function(e,t){return e.performOperation("+",t)},this.values[0])}}),d=n.MinMaxAggregate=u.extend({perform:function(){var e=this;return _.reduce(this.values,function(t,n){var i=t.performOperation(e.operation,n);return i.booleanValue()&&(t=n),t},this.values[0])}}),f=n.MaxAggregate=d.extend({type:"max",operation:"<"}),p=n.MinAggregate=d.extend({type:"min",operation:">"}),m=n.AverageAggregate=u.extend({type:"avg",perform:function(){if(0===this.values.length)return i.createEmpty();var e=i.createNumber(this.values.length),t=_.reduce(_.rest(this.values),function(e,t){return e.performOperation("+",t)},this.values[0]);return t.performOperation("/",e)}}),g=n.CountAggregate=c.extend({type:"count",minArgs:0,maxArgs:0,perform:function(){return i.createNumber(this.values.length)}}),v=n.BlankAggregate=g.extend({type:"blank",minArgs:1,hasInterestingData:function(){return this.values.length>0},filter:function(e){return e.isEmpty()}}),y=n.NonblankAggregate=g.extend({type:"non-blank",minArgs:1,hasInterestingData:function(){return this.values.length>0},filter:function(e){return!e.isEmpty()}}),b=n.NoneAggregate=o.extend({type:"none",canPerform:function(){return!1}}),w=n.DefaultAggregate=h.extend({type:"default",canPerform:function(){return _.any(this.values,function(e){return e.isNumericValue()})}}),x=n.RowsAggregate=o.extend({type:"rows",canPerform:function(){return this.values.length>1},perform:function(){return i.createNumber(this.values.length)}}),k=n.ColumnsAggregate=o.extend({type:"cols",canPerform:function(){return this.values[0].length>1},perform:function(){return i.createNumber(this.values[0].length)}}),E=n.CellsAggregate=o.extend({type:"cells",canPerform:function(){var e=this.values.length,t=this.values[0].length;return e>1&&t>1},perform:function(){return i.createNumber(_.flatten(this.values).length)}}),C=n.selectionAggregates=[h,p,m,f,x,k,E,v,y],S=n.fieldAggregates=[w,h,p,m,f,v,y,g,b],$=n.expressionAggregates=[h,p,m,f,v,y,g];_.each(S,l),_.chain(S).concat(C,$).each(function(e){var t=e.prototype.type,n=s["aggregate-name-"+t],i=s["aggregate-type-name-"+t];null==i&&(i=n);var r=e.prototype.functionName||s.slug(t);e.prototype.displayName=n,e.prototype.typeName=i,e.prototype.functionName=r})},{"../extendable":21,"../strings":13,"./types":85}],86:[function(e,t,n){var i=n.types=e("./types"),r=n.sorting=e("./sorting"),s=n.aggregates=e("./aggregates");n.create=i.create,n.createEmpty=i.createEmpty,n.createNumber=i.createNumber,n.isEmpty=i.isEmpty,n.isRef=i.isRef,n.isValueObject=i.isValueObject,n.makeJSON=i.makeJSON,n.makeError=i.makeError,n.makeRef=i.makeRef,n.parseType=i.parseType,n.SortKey=r.SortKey,n.sortValues=r.sortValues,n.sortWithKeys=r.sortWithKeys,n.computeAggregate=s.computeAggregate},{"./aggregates":84,"./sorting":87,"./types":85}],87:[function(e,t,n){var i=e("./types"),r=n.sortWithKeys=function(e,t){t||(t=[new s(_.identity,!0)]);var n=_.map(e,function(e,n){return{index:n,sortValues:_.map(t,function(t){return t.sortValueFor(e)}),value:e}});return n.sort(function(e,t){for(var n=0,i=_.zip(e.sortValues,t.sortValues),r=0;r<i.length;r++){var s=i[r][0],o=i[r][1];if(n=s.compare(o),0!==n)break}return 0===n&&(n=e.index-t.index),n}),_.map(n,function(e){return e.value})};n.sortValues=function(e,t){return r(e,[new s(_.identity,!t)])};var s=n.SortKey=function(){this.initialize.apply(this,arguments)};_.extend(s.prototype,{initialize:function(e,t,n){this.func=e,this.ascending=t,this.orderedValueMap=n||{}},sortValueFor:function(e){var t=this.func(e),n=t;i.isValueObject(n)||(n=i.create(t));var r=this.orderedValueFor(n);return null!==r&&(n=new a(n,r)),new o(n,this.ascending)},orderedValueFor:function(e){if(!this.orderedValueMap)return null;var t=e.displayValue();return t in this.orderedValueMap?this.orderedValueMap[t]:null}});var o=function(){this.initialize.apply(this,arguments)};_.extend(o.prototype,{initialize:function(e,t){this.value=e,this.ascending=t},compare:function(e){var t=this.value.differentTypeCompare(e.value);return this.ascending?t:-1*t}});var a=i.Value.extend({type:"enum",initialize:function(e,t){this.baseValue=e,this.enumOrder=t,this.value=e.value,this.textValue=e.textValue,this.precedence=e.precedence},compare:function(e){return this.enumOrder-e.enumOrder},forwarder:function(e,t){return this.baseValue[e].apply(this.baseValue,t)},callOperation:function(){return this.forwarder("callOperation",arguments)},hasOperator:function(){return this.forwarder("hasOperator",arguments)},numericValue:function(){return this.forwarder("numericValue",arguments)},booleanValue:function(){return this.forwarder("booleanValue",arguments)},displayValue:function(){return this.forwarder("displayValue",arguments)},saveValue:function(){return this.forwarder("saveValue",arguments)}});i.addOrder(a,0)},{"./types":85}],88:[function(e,t,n){n.Expression=e("./expression")},{"./expression":65}],89:[function(e,t){var n=e("../../../common/strings"),i=(e("../../parser"),e("./query")),r=e("./commands"),s=e("../expressions/expression"),o=e("../../parser").cursorToken,a=e("../../../common/errors"),l=r,c=3,u=function(e,t){this.sheet=e,this.field=t};_.extend(u.prototype,{words:function(e){return n.normalizeCase(e).trim().split(/\W/)},valuesMatching:function(e,t){var i=this,r=t.sheet||this.sheet,s=r.get("fields"),o=r.get("records"),a=t.key?[t.key]:s&&s.pluck("key");e=n.normalizeCase(e);var l=a&&o&&o.map(function(r){return _.map(a,function(s){var o=r.getDisplayValue(s),a=t.keywords?i.words(o):[o];return _.map(a,function(t){var i=n.normalizeCase(t);return 0===i.indexOf(e)?t:void 0})})});return _.chain(l).flatten().compact().uniq().first(t.limit).value()},fieldExpr:function(e){return e&&{field:e.slug()}},keywordExpr:function(e){return e&&{op:"bareword",val:e}},dotExpr:function(e,t){return{op:".",expr1:e,expr2:this.fieldExpr(t)}},valueExpr:function(e,t){return e?(t=t||'"',('"'===t||"'"===t)&&(e=n.escapeChars(e,t)),{op:t,val:e}):null},matchExpr:function(e,t){return{op:":",expr1:e,expr2:t}},eqExpr:function(e,t){return{op:"=",expr1:e,expr2:t}},functionExpr:function(e,t){return{op:"fn",name:e,arguments:t}},exampleExpressions:function(e){e=e||{};var t=e.field||this.sheet.get("fields").first(),n=this.sheet.get("records"),i=t&&n.find(function(e){return e.has(t.id)}),r=i&&t&&i.getDisplayValue(t.id),s=this.words(r),o=s[0];return{keywordExpr:this.keywordExpr(o),fieldExpr:this.fieldExpr(t),valueExpr:this.valueExpr(r)}},suggestedCommands:function(){var e=[];return e.push((new r.DefaultSearch).addArgument({completionContext:new h("search-keyword",{useForNextCompletions:!0})})),e.push((new r.DefaultWhere).addArgument({completionContext:new h("default-where",{useForNextCompletions:!0})})),e.push((new r.WhereCommand).addArgument({completionContext:new h("where-formula")})),e.push((new r.SortCommand).addArgument({completionContext:new h("by-column")})),e.push((new r.GroupCommand).addArgument({completionContext:new h("by-column")})),e.push((new r.ReportCommand).addArgument({completionContext:new h("report-summaries")})),e},suggestedArgs:function(e,t){return this.expressionCompletions(s.make({cursor:!0}),t,e)},defaultWhereFieldCompletions:function(e){var t=this.sheet.get("fields"),n=(this.sheet.get("records"),t&&t.filter(function(t){return 0===t.slug().indexOf(e)})),i=this;return _.map(n,function(e){var t=i.fieldExpr(e),n=new h("default-where-keyword");return new r.DefaultWhere({arguments:[i.matchExpr(t,{completionContext:n})]})})},queryExtensions:function(e,t){t=t||d;var n=[];return n=t.is("search-keyword")?this.valueCompletions("",{limit:Number.MAX_VALUE,op:"bareword"}):t.is("default-where")?this.defaultWhereFieldCompletions(""):this.suggestedCommands(),_.map(n,function(t){return e.clone().addCommand(t)})},commandExtensions:function(e,t){if(!e.canTakeMoreArgs())return[];if("report"===e.canonicalName)return[];var n=this.suggestedArgs(e,t);return _.map(n,function(t){return e.clone().addArgument(t).setComplete()})},fieldCompletions:function(e,t){var i=this;t=t||this.sheet;var r,s=n.normalizeCase(e.field),o=t.get("fields"),a=o&&o.chain().without(this.field).filter(function(e){return 0===e.slug().indexOf(s)}).map(function(e){return r=e,i.fieldExpr(e)}).value();if(1===a.length){if(r.isLink()){var l=r.linkedSheet(),c=l.get("fields").chain().without(this.field).map(function(e){return i.dotExpr(a[0],e)}).value();return a.concat(c)}return a}return a},comparisonCompletions:function(e){var t=e.cursorExpr();if(!t)return[];if(t===e.expr1){var n=this.expressionCompletions(t);return _.map(n,function(t){return e.clone().replaceCursorExpr(t).setComplete()},this)}if(e.expr1.hasField()||"."===e.expr1.op){var i=e.expr2.op;if("bareword"!==i&&"'"!==i&&'"'!==i&&void 0!==i)return[];var r,s,o=e.expr2.val||"";if("."===e.expr1.op?(s=e.expr1.expr1.getLinkedSheet(this.sheet),r=e.expr1.expr2.keyId(s)):(r=e.expr1.keyId(this.sheet),s=this.sheet),!r)return[];var a={key:r,limit:5,sheet:s};":"===e.op&&(a.keywords=!0);var l=this.valuesMatching(o,a);return void 0===i&&(i=":"===e.op?"bareword":'"'),_.map(l,function(t){return e.clone().replaceCursorExpr(this.valueExpr(t,i)).setComplete()},this)}return[]},valueCompletions:function(e,t){t=_.defaults(t||{},{keywords:!0,limit:3,op:"bareword"});var n=this.valuesMatching(e,t),i=this;return _.map(n,function(e){return new r.DefaultSearch({arguments:[i.valueExpr(e,t.op)]})})},searchCompletions:function(e){var t=this,i=this.sheet.get("fields"),s=this.sheet.get("records"),o=e.expressions[0];if(!o)return[];var a,l,c,u,h,d=n.normalizeCase(o.val),f=[];if(f=f.concat(this.valueCompletions(d,{op:o.op})),"bareword"!==o.op)return f;var p=i&&i.filter(function(e){return 0===e.slug().indexOf(d)}),m=_.map(p,function(e){u=t.fieldExpr(e),l=s&&s.find(function(t){return t.has(e.id)}),c=l&&l.getDisplayValue(e.id);var n=t.words(c),i=n[0],o=t.keywordExpr(i);return u&&o?new r.DefaultWhere({arguments:[t.matchExpr(u,o)]}):void 0});if(f=f.concat(_.compact(m)),1===p.length&&(a=p[0],l=s&&s.find(function(e){return e.has(a.id)}),c=l&&l.getDisplayValue(a.id),u=this.fieldExpr(a),h=this.valueExpr(c),u&&h&&f.push(new r.WhereCommand({arguments:[this.eqExpr(u,h)]})),u)){f.push(new r.SortCommand({arguments:[u]})),f.push(new r.GroupCommand({arguments:[u]}));var g=r.lookupAggregateCommand("sum");f.push(new g({arguments:[u]}));var v=this.functionExpr("sum",[u]),y=this.functionExpr("count",[]);f.push(new r.ReportCommand({arguments:[y,v]}))}a=i&&i.first(),u=this.fieldExpr(a);var b=_.uniq(r.commandsMatching(d));if(1===b.length&&0===f.length&&0!==b[0].prototype.maxArgs){var w=b[0];f=this.commandCompletions(new w({arguments:[{}]}))
}else f=_.concat(f,_.chain(b).map(function(e){return t.suggestionsForCommand(e)}).compactNullish().value());return f},suggestionsForCommand:function(e){var t=this.sheet.get("fields"),n=t&&t.first(),i=this.fieldExpr(n),s=this.sheet.get("records"),o=_.any([r.GroupCommand,r.SortCommand],function(t){return e===t});if(o||e.prototype.isAggregate){if(i){var a=[];return e.prototype.minArgs>0&&(a=[i]),new e({arguments:a})}}else if(e===r.WhereCommand){var l=s&&s.find(function(e){return e.has(n.id)}),c=l&&l.getDisplayValue(n.id),u=this.valueExpr(c);if(i&&u)return new r.WhereCommand({arguments:[this.eqExpr(i,{completionContext:new h("value")})]})}else{if(e===r.ReverseCommand)return new r.ReverseCommand({arguments:[]});if(e===r.ReportCommand&&i){var d=this.functionExpr("sum",[i]);return new r.ReportCommand({arguments:[d]})}}return null},argumentExtensions:function(e,t){if(e instanceof r.SortCommand&&t.field){var n=this.sheet.getFields(),i=t.field,s=n.find(function(e){return e.nameMatch(i)});if(s)return[{op:"order",ascending:!1,expr1:_.clone(t)},e.clone().replaceCursorArgument(t).addArgument({completionContext:new h("sort-secondary-field")})]}if(e instanceof r.WhereCommand){var o=t.clone?t.clone():_.clone(t),a=this.exampleExpressions({field:this.sheet.fieldWithSlug(t.field)});if(t.field)return[this.eqExpr(o,a.valueExpr)];if("fn"===t.op)return[{op:"and",expr1:o,expr2:a.fieldExpr}]}return[]},reportCompletions:function(e){var t=e.getCursorArgument()||_.last(e.expressions);t||(t=s.make({}));var n=[];return t.hasField()||null==t.op?n=this.functionCompletions(t,function(e,t){return!!t.aggregate},new h("function",{useForNextCompletions:!0})):"fn"===t.op&&(n=this.expressionCompletions(t,null,e)),_.map(n,function(t){return e.clone().replaceCursorArgument(t).setComplete()})},commandCompletions:function(e,t){if(e instanceof r.DefaultSearch)return this.searchCompletions(e);if("report"===e.canonicalName)return this.reportCompletions(e);var n=e.getCursorArgument()||_.last(e.expressions);if(!n)return[];var i=this.expressionCompletions(n,t,e),o="";try{o=n.stringify(this.sheet)}catch(l){if(l instanceof a.ExecutionError)return[];throw l}return i=_.chain(i).filter(function(t){var n=s.make(t,e).stringify(this.sheet);return n===o||-1===_.chain(e.expressions).invoke("stringify",this.sheet).indexOf(n).value()},this).value(),1===i.length?i=i.concat(this.argumentExtensions(e,i[0])):n.empty||(i=i.concat(this.argumentExtensions(e,n))),_.map(i,function(t){return t instanceof r.PowerBarCommand?t:e.clone().replaceCursorArgument(t).setComplete()})},canExtendCommand:function(e){return 0===e.expressions.length},queryCompletions:function(e,t){t=t||d;var i=e.getCursorCommand();if(!i)return[];var r=[];if(t.is("default-where")&&i instanceof l.DefaultSearch){var s=i.expressions[0],o=s?n.normalizeCase(s.val):"";r=this.defaultWhereFieldCompletions(o)}else r=this.commandCompletions(i,t),this.canExtendCommand(i)?r=r.concat(this.commandExtensions(i,t)):1===r.length&&(r=r.concat(this.commandCompletions(r[0],t)));return _.each(r,function(e){if(e instanceof l.WhereCommand&&!e.isDefaultWhere()&&1===e.expressions.length){var t=e.expressions[0];!t.field&&!t.key||t.getCompletionContext()||(t.completionContext=new h("more-completions"))}}),_.map(r,function(t){return e.clone().replaceCursorCommand(t)})},shouldExtendQuery:function(e){var t=_.last(e.commands);return!t||!t.isComplete()&&t.argsComplete()?(t instanceof r.DefaultWhere||t instanceof r.DefaultSearch)&&t.expressions.length>0?!1:!0:!1},fieldOrFunctionCompletions:function(e,t){t=t||d;var n=[];return t.is("function")||(n=n.concat(this.fieldCompletions(e))),n=n.concat(this.functionCompletions(e,null,t))},functionCompletions:function(e,t,i){i=i||d;var r=n.normalizeCase(e.field);if(""===r&&!i.is("function")&&!i.is("limited-functions"))return s.make({completionContext:new h("function",{useForNextCompletions:!0})});var o=this.sheet.get("fields").chain().without(this.field).first().value(),a=this.fieldExpr(o),l=_.keys(s.functionConfig),u=this,f=_.chain(l).filter(function(e){return 0===n.normalizeCase(e).indexOf(r)}).filter(function(e){var n=s.getFunctionConfig(e);return t?t(e,n):!n.aggregate}).map(function(e){var t=s.getFunctionConfig(e);return u.functionExpr(e,_.times(t.minArgs,function(){return _.clone(a)}))});return""!==r||t||i.is("function")||(f=f.first(c)),f.value()},opCompletions:function(e){return _.map(["+","-","=","<","and","or"],function(t){var n=e.clone();return n.op=t,n},this)},expressionCompletions:function(e,t,n){var i=e.cursorExpr();if(!i&&e.hasField()||void 0===e.op)return n&&"group"===n.canonicalName?this.fieldCompletions(e):this.fieldOrFunctionCompletions(e,t);if(_.contains(["<=",">=","!=","<>","=","<",">",":"],e.op))return this.comparisonCompletions(e);if("NONE"===e.op)return _.chain(this.expressionCompletions(i,t,n)).map(function(t){var n=e.clone().replaceCursorExpr(t).setComplete();return this.opCompletions(n)},this).flatten().value();if("."===e.op)try{var r=this.field?[this.field]:[];e.expr1.validate(this.sheet,{forbiddenFields:r});var o=e.expr1.getLinkedSheet(this.sheet);if(!o)return[];var l=this.fieldCompletions(e.expr2,o);if(1===l.length){var c=l[0];l.push(this.eqExpr(c,{completionContext:new h("value")}))}return _.map(l,function(t){return e.clone().replaceRightExpr(t).setComplete()})}catch(u){if(u instanceof s.ValidationError||u instanceof a.ExecutionError)return[];throw u}if("fn"===e.op){var d=e.name,f=s.getFunctionConfig(d);if(!f)return[];var p=e.arguments,m=e.getCursorArgument();if(m&&p.length===f.maxArgs)return _.map(this.expressionCompletions(m,t,n),function(t){return e.clone().replaceCursorArgument(t)});if(p.length<f.maxArgs){if(m&&m.hasCursor(this.sheet))return _.chain(this.expressionCompletions(m,t,n)).map(function(t){return e.clone().replaceCursorArgument(t)},this).map(function(e){return this.expressionCompletions(e,t,n)},this).flatten().value();if(p.length<f.maxArgs)return _.map(this.expressionCompletions(s.make({}),t,n),function(t){return e.clone().addArgument(t).setComplete()})}}if(i){var g=this.expressionCompletions(i,t,n);return _.map(g,function(t){return e.clone().replaceCursorExpr(t)})}return[]},reportFormulaCompletions:function(e){if(e.length>1&&e[e.length-1]===o){var t=e.substr(0,e.length-1);try{return s.parse(t,this.sheet),[]}catch(n){}}var i=new h("limited-functions",{useForNextCompletions:!0});return this.expressionCompletionStrings(e,function(e){return e.hasCursor(this.sheet)?e.hasField()||null==e.op?this.functionCompletions(e,function(e,t){return t.aggregate},i):"fn"===e.op?this.expressionCompletions(e,i):void 0:[]}.bind(this))},formulaCompletions:function(e){var t=new h("limited-functions",{useForNextCompletions:!0});return this.expressionCompletionStrings(e,function(e){return e?this.expressionCompletions(e,t):this.fieldOrFunctionCompletions(s.make({}),t)}.bind(this))},expressionCompletionStrings:function(e,t){var n;try{n=s.parse(e,null,{partialAllowed:!0})}catch(i){return console.warn(i),[]}var r=t(n);return _.chain(r).map(s.make).invoke("setComplete").invoke("stringify",this.sheet).value()},completions:function(e,t){var n;try{n=new i(e,null,this.sheet,{allowInvalid:!0})}catch(r){return console.warn(r),[]}var s=[];return s=this.shouldExtendQuery(n)?this.queryExtensions(n,t):this.queryCompletions(n,t),_.chain(s).filter(function(e){if(e.getCompletionContext())return!0;try{return e.validate(this.sheet,{forbiddenFields:[]}),!0}catch(t){return!1}},this).invoke("setComplete").value()}}),t.exports=u;var h=function(){this.initialize.apply(this,arguments)};_.extend(h.prototype,{initialize:function(e,t){t=t||{},this.id=e,this.useForNextCompletions=t.useForNextCompletions,e&&(this.name=n["context-name-"+e])},is:function(e){return this.id===e}});var d=new h;u.CompletionContext=h},{"../../../common/errors":31,"../../../common/strings":13,"../../parser":28,"../expressions/expression":65,"./commands":60,"./query":90}],91:[function(e,t,n){n.GroupCommand=e("./groupCommand"),n.Autocompleter=e("./autocompleter"),n.Query=e("./query"),n.commands=e("./commands"),n.results=e("./results")},{"./autocompleter":89,"./commands":60,"./groupCommand":92,"./query":90,"./results":93}],90:[function(e,t){var n=e("./commands"),i=e("../../parser"),r=e("./results"),s=e("../sheet"),o=function(){this.initialize.apply(this,arguments)};_.extend(o.prototype,{initialize:function(e,t,r,s){this.commands=[],this.matches={},this.sheet=r,s=s||{},t||(t=e?i.parsePowerBar(e):[]);var o=t.map(function(e){var t=this.makeCommand(e);if(s.allowInvalid)return t;try{return t.validate(this.sheet,{forbiddenFields:[]}),t}catch(i){return new n.BadCommand({text:e.text,error:i,original:t})}}.bind(this));this.addCommands(o)},clone:function(){var e=new o(null,null,this.sheet);return e.addCommands(_.invoke(this.commands,"clone")),e},isValid:function(e){e=e||{forbiddenFields:[]};try{this.validate(e)}catch(t){return!1}return _.all(_.pluck(this.commands,"isValid"))},validate:function(e){return _.each(this.commands,function(t){t.validate(this.sheet,e)}.bind(this))},hasOneCommand:function(){return 1===this.commands.length},firstCommand:function(){return this.commands[0]},hasCommands:function(){return this.commands.length>0},isComplete:function(){return!this.hasCommands()||_.every(this.commands,function(e){return e.isComplete()})},setComplete:function(){return _.invoke(this.commands,"setComplete"),this},nameify:function(){var e=this.createResults();return _.map(this.commands,function(t){return t.nameify(e)}).join(" ")},addMatch:function(e,t){t=t||"all",this.matches[t]=this.matches[t]||{},this.matches[t][e]=!0},termsForKey:function(e){var t=[];return e in this.matches&&(t=t.concat(_.keys(this.matches[e]))),this.matches.all&&(t=t.concat(_.keys(this.matches.all))),t},executePipeline:function(){this.validatePipeline(this.sheet);var e=this.createResults();return e.applyCommands(this.commands)},getCompletionContext:function(){return _.chain(this.commands).invoke("getCompletionContext").find(_.identity).value()},validatePipeline:function(){var e=this;_.each(this.commands,function(t,n){if(t.isReport()&&e.commands.length-1!==n)throw new Error("Cannot put any commands after a reporting command")})},makeCommand:function(e){var t=e.cmd;if("invalid"===t)return new n.BadCommand({text:e.text,error:e.error});var i=e.arguments,r=e.cursor,s=n.lookup(t);if(!s){if(!(1===i.length&&(void 0!==i[0].val||i[0].cursor)||0===i.length&&r))throw new Error('unknown command "'+t+'"');s=n.DefaultWhere;var o=t;_.isString(t)&&(o={field:t});var a={op:":",expr1:o,expr2:i[0]};a.expr2||(a.expr2={cursor:!0},a.cursor=!0),i=[a]}return new s({arguments:i,cursor:r})},createResults:function(){var e=this.sheet;return e instanceof s&&(e=r.Results.fromSheet(e)),e},stringify:function(e){var t=this.createResults();return _.map(this.commands,function(n){return n.stringify(t,e)}).join(" | ")},getCommandDescriptors:function(){var e=this.createResults();return this.commands.map(function(t){return t.isValid?{command:t,name:t.canonicalName,string:t.stringify(e),tip:t.explain(e)}:{error:t.error,string:t.text}})},isEqual:function(e){return this===e?!0:e instanceof o?this.stringify()===e.stringify():!1},boundTerms:function(){var e=this.createResults();return _.map(this.commands,function(t){return t.boundTerms(e)})},toggleSortField:function(e){var t=_.last(this.commands);if(t&&t.isSort())t.toggleField(e),0===t.expressions.length&&(this.commands=this.commands.slice(0,this.commands.length-1));else{var i=new n.SortCommand({arguments:[{key:e.get("key")}]});this.addCommand(i)}},addKeyword:function(e){var t=!/\W/.test(e),i=t?"bareword":'"',r=new n.DefaultSearch({arguments:[{op:i,val:e}]});this.addCommand(r)},addFilter:function(e,t){var i={op:"=",expr1:{key:e},expr2:{op:'"',val:t}},r=_.last(this.commands);if(!r||!r.isWhere()||r instanceof n.DefaultWhere){var s=new n.WhereCommand({arguments:[i]});this.addCommand(s)}else r.addArgument(i)},isGrouped:function(){var e=0;return _.each(this.commands,function(t){t.isGroup()?e++:t.isReport()&&(e=0)}),e>0},groupCommands:function(){return _.filter(this.commands,function(e){return e.isGroup()})},addOrUpdateGroupBy:function(e){var t=_.last(this.commands);if(t&&t.isGroup())t.addField(e);else{var i=new n.GroupCommand({arguments:[{key:e.get("key")}]},this);this.addCommand(i)}},addReportQuery:function(e){this.addOrUpdateGroupBy(e);var t=new n.ReportCommand({arguments:[{op:"fn",name:"count",arguments:[]}]});this.addCommand(t)},replaceReportExpressions:function(e){var t=_.chain(this.commands).filter(function(e){return e.isReport()}).last().value();t.isAggregate?(this.commands=_.without(this.commands,t),t=new n.ReportCommand({arguments:e}),this.addCommand(t)):t.expressions=e},removeGroupBy:function(e){var t=this.groupCommands();0!==t.length&&(_.each(this.commands,function(t){t.isGroup()&&t.removeField(e,this.sheet)},this),this.commands=_.filter(this.commands,function(e){return e.isGroup()&&e.hasNoArguments()?!1:!0}))},addCommand:function(e){return e.query=this,this.commands.push(e),this},addCommands:function(e){var t=this;_.each(e,function(e){t.addCommand(e)})},replaceLastCommand:function(e){return this.commands.pop(),this.addCommand(e)},replaceCursorCommand:function(e){return _.find(this.commands,function(t,n){var i=!t.isComplete();return i&&(this.commands[n]=e),i},this),this},getCursorCommand:function(){return _.find(this.commands,function(e){return!e.isComplete()})},contextify:function(){var e={};return e.commands=_.invoke(this.commands,"contextify",this.sheet),e}}),t.exports=o},{"../../parser":28,"../sheet":42,"./commands":60,"./results":93}],24:[function(e,t,n){function i(e,t){if(0==e[t].length)return e[t]={};var n={};for(var i in e[t])n[i]=e[t][i];return e[t]=n,n}function r(e,t,n,s){var o=e.shift();if(o){var a=t[n]=t[n]||[];"]"==o?g(a)?""!=s&&a.push(s):"object"==typeof a?a[v(a).length]=s:a=t[n]=[t[n],s]:~m(o,"]")?(o=o.substr(0,o.length-1),!w.test(o)&&g(a)&&(a=i(t,n)),r(e,a,o,s)):(!w.test(o)&&g(a)&&(a=i(t,n)),r(e,a,o,s))}else g(t[n])?t[n].push(s):t[n]="object"==typeof t[n]?s:"undefined"==typeof t[n]?s:[t[n],s]}function s(e,t,n){if(~m(t,"]")){{var i=t.split("[");i.length}r(i,e,"base",n)}else{if(!w.test(t)&&g(e.base)){var s={};for(var o in e.base)s[o]=e.base[o];e.base=s}h(e.base,t,n)}return e}function o(e){var t={base:{}};return y(v(e),function(n){s(t,n,e[n])}),t.base}function a(e){return b(String(e).split("&"),function(e,t){var n=m(t,"="),i=d(t),r=t.substr(0,i||n),o=t.substr(i||n,t.length),o=o.substr(m(o,"=")+1,o.length);return""==r&&(r=t,o=""),""==r?e:s(e,f(r),f(o))},{base:{}}).base}function l(e,t){if(!t)throw new TypeError("stringify expects an object");return t+"="+encodeURIComponent(e)}function c(e,t){var n=[];if(!t)throw new TypeError("stringify expects an object");for(var i=0;i<e.length;i++)n.push(x(e[i],t+"["+i+"]"));return n.join("&")}function u(e,t){for(var n,i=[],r=v(e),s=0,o=r.length;o>s;++s)n=r[s],i.push(null==e[n]?encodeURIComponent(n)+"=":x(e[n],t?t+"["+encodeURIComponent(n)+"]":encodeURIComponent(n)));return i.join("&")}function h(e,t,n){var i=e[t];void 0===i?e[t]=n:g(i)?i.push(n):e[t]=[i,n]}function d(e){for(var t,n,i=e.length,r=0;i>r;++r)if(n=e[r],"]"==n&&(t=!1),"["==n&&(t=!0),"="==n&&!t)return r}function f(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}}var p=Object.prototype.toString,m="function"==typeof Array.prototype.indexOf?function(e,t){return e.indexOf(t)}:function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},g=Array.isArray||function(e){return"[object Array]"==p.call(e)},v=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},y="function"==typeof Array.prototype.forEach?function(e,t){return e.forEach(t)}:function(e,t){for(var n=0;n<e.length;n++)t(e[n])},b=function(e,t,n){if("function"==typeof e.reduce)return e.reduce(t,n);for(var i=n,r=0;r<e.length;r++)i=t(i,e[r]);return i},w=/^[0-9]+$/;n.parse=function(e){return null==e||""==e?{}:"object"==typeof e?o(e):a(e)};var x=n.stringify=function(e,t){return g(e)?c(e,t):"[object Object]"==p.call(e)?u(e,t):"string"==typeof e?l(e,t):t+"="+encodeURIComponent(String(e))}},{}],94:[function(e){var t=e("./help"),n=t.Step,i=t.Condition,r=t.EventCondition;i.OnRecordDetail=i.extend({createStep:function(){return new n.GoToRecord},test:function(){return this.check.exists(".record-detail")}}),i.OnSheetDetail=i.extend({createStep:function(){return new n.GoToSheet},test:function(){return this.check.exists(".sheet-detail")}}),i.SheetNotEmpty=i.extend({createStep:function(){return new n.GoToNonEmptySheet},test:function(){return this.check.exists("a.short-id")}}),i.OnBookDetail=i.extend({createStep:function(){return new n.GoToBookDetail},test:function(){return this.check.exists(".book-detail")}}),i.OnBookList=i.extend({createStep:function(){return new n.GoToBookList},test:function(){return this.check.exists(".book-list")}}),i.OnFormulaPanel=i.extend({createStep:function(){return new n.OpenFormulaPanel},test:function(){return this.check.exists(".formula-panel")}}),i.OnFormulaPanelForNewField=i.extend({createStep:function(){return new n.OpenFormulaPanelForNewField},test:function(){return this.check.exists(".formula-panel")}}),i.NotOnFormulaPanel=i.extend({createStep:function(){return new n.CloseFormulaPanel},test:function(){return!this.check.exists(".formula-panel")}}),i.SubsheetButtonClicked=r.extend({targetSelector:".add-subsheet",eventName:"click",createStep:function(){return new n.ClickSubsheetButton}}),i.SheetMenuOpened=r.extend({targetSelector:".sheet-actions",eventName:"click",createStep:function(){return new n.OpenSheetMenu}}),i.AggregatesVisible=i.extend({createStep:function(){return new n.ScrollToAggregates},test:function(){return this.check.exists(".empty td.data")}}),i.AggregatesMenuOpened=r.extend({targetSelector:".empty td.data",eventName:"fieldbook:showmenu",createStep:function(){return new n.OpenAggregatesMenu}}),i.NewFieldSettingsOpened=r.extend({targetSelector:".field-settings",eventName:"fieldbook:showmenu",createStep:function(){return new n.OpenNewFieldSettings}}),i.AddedField=i.extend({createStep:function(){return new n.AddField},test:function(){var e=$(".sheet-detail");if(!e.length)return!1;var t=this.state;t=t.addColumn=t.addColumn||{};var n=t.sheet=e.data("view").context();t.sheet?t.sheet._id!==n._id&&(t.sheet=n):t.sheet=n;var i,r;i=t.oldFields||_.pluck(t.sheet.fields,"key"),r=_.pluck(n.fields,"key");var s=_.difference(r,i);return t.oldFields=r,s.length?(t.field=_.last(s),!0):!1}}),i.NamedNewField=r.extend({targetSelector:".colHeader",eventName:"blur",createStep:function(){return new n.NameNewField}})},{"./help":69}],69:[function(e,t){!function(n){var i=e("../../../common/extendable"),r=e("../tips/tip"),s=function(e){this.options=e||{},this.initialize()};_.extend(s.prototype,{initialize:function(){},test:function(){return!0},createStep:function(){return null},getStep:function(){return this.step?this.step:(this.step=this.createStep(),this.step.setState(this.state),this.step)},check:{exists:function(e){return $(e).length>0}}}),t.exports.Condition=i(s);var o=s.extend({targetSelector:null,eventName:"",hasFired:!1,initialize:function(){s.prototype.initialize.apply(this,arguments);var e=function(){this.hasFired=!0,_.defer(Tips.display)}.bind(this),t=_.result(this,"targetSelector"),n=this.eventName;$("body").one(n+".help",t,e)},test:function(){return this.hasFired}});t.exports.EventCondition=o;var a=function(e){this.options=e||{},this.initialize()};_.extend(a.prototype,{initialize:function(){this.createConditions()},createConditions:function(){this.conditions=[]},setState:function(e){this.state=e,this.conditions.forEach(function(e){e.state=this.state},this)},createContext:function(){return null},tipContent:function(){return null},findElement:function(){return null},pointer:"none",makeTip:function(){var e=r.ElementTip.extendNoRegister({pointerLocation:this.pointer,content:this.tipContent.bind(this),findElement:this.findElement.bind(this)});return new e(this.options.context)},displayTip:function(){if(this.noTip)return!0;var e=this.makeTip(),t=this.findElement();return t&&0===t.length?!1:(Tips.showTip(e),!0)},showNext:function(){var e=_.find(this.conditions,function(e){return!e.test()});return e?(e.getStep().showNext(),!1):this.displayTip()}}),t.exports.Step=a=i(a);var l=a.extend({title:"Unnamed Help Entry",initialize:function(){a.prototype.initialize.apply(this,arguments),this.setState({})},keyWords:[],showNext:function(){var e=a.prototype.showNext.apply(this,arguments);return e&&l.currentEntry===this&&l.end(),e}});l.begin=function(e){l.currentEntry=new e,$(".help-button").addClass("help-active")},l.end=function(){l.currentEntry=null,$(".help-button").removeClass("help-active"),$("body").off(".help")};var c=[];t.exports.Entry=l,l.add=function(e){c.push(e),e.id=_.uniqueId("HelpEntry-")},l.get=function(e){return _.findWhere(c,{id:e})},l.implement=function(e,t){_.chain(c).pluck("prototype").findWhere({cid:e}).extend(t)},l.getQueryTerms=function(e){var t=e.toLowerCase().split(/\W+/);return _.without(t,"")},l.find=function(e){var t=l.getQueryTerms(e);return _.chain(c).filter(function(e){return _.all(t,function(t){return _.any(e.prototype.keyWords,function(e){return-1!==e.indexOf(t)})||-1!==e.prototype.title.toLowerCase().indexOf(t)})}).value()},n.Entry=l}(self)},{"../../../common/extendable":21,"../tips/tip":95}],96:[function(e){e("../tips/tip")},{"../tips/tip":95}],97:[function(e){function t(e){o[e.name]=o.extend({createConditions:function(){this.conditions=e.conditions.map(function(e){return new a[e]})},noTip:null==e.content,tipContent:e.content?function(){var t=this.createContext();return t?_.template(e.content,t):e.content}:null,findElement:function(){var t=e.target;return t?(_.isArray(t)&&(t=_.find(t,function(e){return $(e).length})),$(t)):void 0},pointer:e.pointer})}function n(e,t){return o[e]=o[e].extend(t)}function i(e,t){return $(_.find(e,function(e){return $(e).closest("th").data("key")===t}))}var r=e("./help"),s=e("../../gen/help.json").steps,o=r.Step,a=r.Condition;s.forEach(t),n("OpenNewFieldSettings",{findElement:function(){var e=this.state.addColumn.field;return i($(".field-settings"),e)}}),n("NameNewField",{findElement:function(){var e=this.state.addColumn.field;return i($(".colHeader"),e)}})},{"../../gen/help.json":98,"./help":69}],99:[function(e,t){t.exports.sheetTips=e("./sheetTips"),t.exports.bookListTips=e("./bookListTips"),t.exports.detailTips=e("./detailTips")},{"./bookListTips":101,"./detailTips":102,"./sheetTips":100}],95:[function(e,t){!function(){function n(e){p.push(e)}function i(){return l.account.get("showTips")}function r(e){return s(e.prototype.id)}function s(e){return _.contains(l.account.get("shownTips"),e)}function o(e,t){null==t&&(t=!0);var n=l.account,i=n.get("shownTips");t?i.push(e.prototype.id):i=_.without(i,e.prototype.id),n.save({shownTips:i},{patch:!0})}var a=e("../../../common/extendable"),l=e("../../models/account"),c=e("./tipContent"),u=2,h=0,d=0,f=function(){this.initialize.apply(this,arguments)};_.extend(f.prototype,{id:"",pointerLocation:"none",prerequisite:null,throttled:!0,initialize:function(e){this.context=e},unshow:function(){o(this.constructor,!1),h=d},shouldTrigger:function(){throw new Error("shouldTrigger must be overridden by subclasses")},makeTemplateContext:function(){return{}},content:function(){var e=c[this.id],t=this.makeTemplateContext();return _.isFunction(e)?e(t):_.template(e,t)}}),t.exports.Tip=f=a(f);var p=[];f.extendNoRegister=f.extend,f.extend=function(){var e=this.extendNoRegister.apply(this,arguments);return n(e),e},t.exports.create=function(e){if(!i())return null;var t=6e4/u,n=Date.now()-h<t,a=null,l=_.find(p,function(t){return n&&t.prototype.throttled?!1:t.prototype.prerequisite&&!s(t.prototype.prerequisite)?!1:r(t)?!1:(a=new t(e),a.shouldTrigger()?(d=h,h=Date.now(),!0):(a=null,!1))});return l&&o(l),a},t.exports.ElementTip=f.extendNoRegister({findElement:function(){throw new Error("findElement must be overridden by subclasses")},pointerLocation:"left"}),l.prototype.testTipShowOnly=function(e){var t=_.chain(p).pluck("prototype").pluck("id").without(e).value();this.save({shownTips:t,showTips:!0},{patch:!0})}}()},{"../../../common/extendable":21,"../../models/account":32,"./tipContent":10}],25:[function(e,t,n){!function(e){function t(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}e.EventEmitter||(e.EventEmitter=function(){});var i=n.EventEmitter=e.EventEmitter,r="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=10;i.prototype.setMaxListeners=function(e){this._events||(this._events={}),this._events.maxListeners=e},i.prototype.emit=function(e){if("error"===e&&(!this._events||!this._events.error||r(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var t=this._events[e];if(!t)return!1;if("function"==typeof t){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);t.apply(this,n)}return!0}if(r(t)){for(var n=Array.prototype.slice.call(arguments,1),i=t.slice(),s=0,o=i.length;o>s;s++)i[s].apply(this,n);return!0}return!1},i.prototype.addListener=function(e,t){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",e,t),this._events[e])if(r(this._events[e])){if(!this._events[e].warned){var n;n=void 0!==this._events.maxListeners?this._events.maxListeners:s,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}this._events[e].push(t)}else this._events[e]=[this._events[e],t];else this._events[e]=t;return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){var n=this;return n.on(e,function i(){n.removeListener(e,i),t.apply(this,arguments)}),this},i.prototype.removeListener=function(e,n){if("function"!=typeof n)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var i=this._events[e];if(r(i)){var s=t(i,n);if(0>s)return this;i.splice(s,1),0==i.length&&delete this._events[e]}else this._events[e]===n&&delete this._events[e];return this},i.prototype.removeAllListeners=function(e){return 0===arguments.length?(this._events={},this):(e&&this._events&&this._events[e]&&(this._events[e]=null),this)},i.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),r(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]}}(e("__browserify_process"))},{__browserify_process:15}],fieldbook:[function(e,t){t.exports=e("GeNGfE")},{}],GeNGfE:[function(e,t,n){n.trackJs=e("./trackJs"),e("../common/underscore.fieldbook"),e("./dev"),n.csrf=e("./csrf"),n.models=e("./models"),n.actions=e("./actions"),n.actionQueue=e("./actionQueue"),n.views=e("./views"),n.table=e("./table"),n.routing=e("./routing"),n.env=e("./env")},{"../common/underscore.fieldbook":14,"./actionQueue":1,"./actions":38,"./csrf":2,"./dev":3,"./env":26,"./models":33,"./routing":82,"./table":104,"./trackJs":103,"./views":68}],105:[function(e,t){var n=e("../../common/strings"),i=e("../actions"),r=e("./index"),s=e("./model"),o=e("./collection"),a=e("./expressions/expression"),l=e("../../common/values"),c=e("../parser"),u=s.extend({idAttribute:"key",hasMany:{"enum":function(){return new r.EnumValue.Collection([],{url:function(){return this.parent.url()+"/enum"}})}},defaults:{width:160},isLink:function(){return"link"===this.get("type")},isFormula:function(){return"formula"===this.get("type")},isReportFormula:function(){return"report-formula"===this.get("type")},sheet:function(){return this.collection&&this.collection.parent},sheetId:function(){var e=this.sheet();return e&&e.id},book:function(){var e=this.sheet();return e&&e.book()},position:function(){return this.collection?this.collection.indexOf(this)+1:null},linkedSheet:function(){var e=this.get("linkedSheet");return e&&e._id&&r.Sheet.find(e._id)},editableFormula:function(){return"="+this.get("expression").stringify(this.formulaSheet())},hasAnyFormula:function(){return this.isFormula()||this.isReportFormula()},isLinkToSheet:function(e){return this.linkedSheet()===e},setAggregate:function(e,t){this.saveIfNeeded("aggregate",e,t)},getAggregate:function(){return this.get("aggregate")||"default"},enumValues:function(){return this.get("enum").pluck("name")},displayName:function(){var e=this.get("name");return e?e:_.template(n["default-field-display-name"],{position:this.position()})},parse:function(e){return e.expression&&(e.expression=a.make(e.expression)),e},saveEnums:function(e,t){this.get("enum").setValues(e,t)},removeEnum:function(e){this.saveEnums([],e)},enumOrderedValueMap:function(){return this.isEnum()?_.object(this.get("enum").map(function(e,t){return[e.get("name"),t]})):{}},removeEnumValue:function(e,t){var n=this.enumValues();n=_.without(n,e),this.saveEnums(n,t)},resolveValue:function(e){if(l.isEmpty(e))return l.createEmpty();if(this.isLink()&&(_.isString(e)&&(e=l.makeRef(null,null,e)),!e.id&&e.name)){var t=this.linkedSheet(),n=t&&t.findRecordByIdName(e.name);n&&(e.id=n.id)}return l.create(e)},queryAutocompleteValues:function(e,t){e=e||"";var i=new RegExp(n.escapeRegExp(e.trim()),"i"),r=function(n){t(1===n.length?_.filter(n,function(t){return t!==e}):n)};this.isLink()?this.autocompleteLinks(i,r):/^=/.test(e)?(-1===e.indexOf(c.cursorToken)&&(e+=c.cursorToken),this.autocompleteFormula(e,r)):this.autocompleteColumnValues(i,r)},autocompleter:function(){return this._autocompleter?this._autocompleter:this._autocompleter=new r.powerbar.Autocompleter(this.formulaSheet(),this)},autocompleteFormula:function(e,t){var n,i=this.autocompleter(),r=e.substr(1,e.length);n=this.isReportFormula()?i.reportFormulaCompletions(r):i.formulaCompletions(r),t(_.map(n,function(e){return"="+e}))},autocompleteColumnValues:function(e,t){var n=[];if(this.isEnum())n=this.enumValues();else if(this.sheet()){var i=this;n=this.sheet().get("records").map(function(e){return e.getDisplayValue(i.get("key"))}),n=_.uniq(n),n=l.sortValues(n)}n=_.filter(n,function(t){return""!==t&&e.test(t)}),t(n)},autocompleteLinks:function(e,t){var n=this.linkedSheet();if(!n)return t([]);var i=function(n){var i=n.recordNames(),r=_.filter(i,function(t){return e.test(t)});t(r)};n.get("records")&&!n.needsFetch()?i(n):n.fetch({success:i})},isEnum:function(){return"enum"===this.get("type")},nameMatch:function(e){e=n.normalize(e).toLowerCase();var t=n.normalize(this.get("name")).toLowerCase();return e===t||e===this.slug()},slug:function(){var e=this.get("name");if(""!==e&&null!=e)return n.slug(e);var t=this.position();return t?_.template(n["unnamed-field-slug"],{position:t}):void 0},isNameField:function(){var e=this.sheet();return e&&e.get("nameKey")===this.id},rename:function(e,t){return e=e.trim(),e||this.get("name")?this.saveIfNeeded("name",e,t):void 0},resize:function(e,t){return this.saveIfNeeded("width",e,t)},updateEnumIfNeeded:function(e){if(this.isEnum()){var t=this.get("enum");e=n.normalize(e),_.contains(this.enumValues(),e)||t.push({name:e})}},addLink:function(e,t){return this.action(u.UpdateLink,e).do(t)},removeLink:function(e){return this.action(u.UpdateLink,null).do(e)},saveFormula:function(e,t){return e?(_.isString(e)&&(e=a.parse(l.create(e))),void(this.isReportFormula()?this.set({name:e.nameify(this.formulaSheet()),expression:e}):this.saveIfNeeded({type:"formula",expression:e},t))):this.removeFormula(t)},formulaSheet:function(){return this.isReportFormula()?this.get("sourceSheet"):this.sheet()},removeFormula:function(e){this.isFormula()?this.saveIfNeeded({type:"generic",expression:null},e):this.isReportFormula()&&this.set("expression",null)},destroy:function(e){return this.action(u.Delete).do(e)
},contextKeys:["slug","isNameField","linkedSheet","sheetId"],toJSON:function(){var e=s.prototype.toJSON.apply(this,arguments);return e.expression&&(e.expression=e.expression.boundTerms(this.sheet())),e}});u.Collection=o.extend({model:u}),u.UpdateLink=i.Action.extend({initialize:function(e,t){this.model=e,this.collection=e.collection,this.previousAttrs=e.pick("type","linkedSheet"),this.attrs=t?{type:"link",linkedSheet:{_id:t}}:{type:"generic",linkedSheet:null}},saveAndRefresh:function(e,t){var n=this.collection.parent,i=n.book(),r=t.success;t.success=function(){i.markDirty(),i.fetch({success:r})},this.model.save(e,_.extend({patch:!0},t))},perform:function(e){this.saveAndRefresh(this.attrs,e)},revert:function(e){this.saveAndRefresh(this.previousAttrs,e)}}),u.Delete=i.Delete.extend({wrapOptions:function(e){var t=this.collection.parent.book(),n=e.success;return e.success=function(){t.markDirty(),t.fetch({success:n})},e},perform:function(e){e=this.wrapOptions(e),i.Delete.prototype.perform.call(this,e)},revert:function(e){e=this.wrapOptions(e),i.Delete.prototype.revert.call(this,e)}}),t.exports=u},{"../../common/strings":13,"../../common/values":86,"../actions":38,"../parser":28,"./collection":36,"./expressions/expression":65,"./index":33,"./model":34}],33:[function(e,t,n){n.Account=e("./account"),n.Book=e("./book"),n.BookUser=e("./bookUser"),n.EnumValue=e("./enumValue"),n.ErrorReport=e("./errorReport"),n.expressions=e("./expressions"),n.Feedback=e("./feedback"),n.Field=e("./field"),n.NavItem=e("./navItem"),n.powerbar=e("./powerbar"),n.Record=e("./record"),n.Sheet=e("./sheet"),n.BookUser=e("./bookUser"),n.Subsheet=e("./subsheet"),n.User=e("./user"),n.groupSort=e("./groupSort"),n.backbone=e("./backbone")},{"./account":32,"./backbone":109,"./book":106,"./bookUser":35,"./enumValue":37,"./errorReport":39,"./expressions":88,"./feedback":40,"./field":105,"./groupSort":108,"./navItem":41,"./powerbar":91,"./record":107,"./sheet":42,"./subsheet":44,"./user":43}],108:[function(e,t){var n=e("../../common/values"),i=(t.exports=function(e,t,r){var s=_.map(t,function(e,t){var n=function(e){return r(e,t)};return i(e,n)});return n.sortWithKeys(e,s)},t.exports.sortKeyForField=function(e,t){var i={};return e.isEnum()&&(i=e.enumOrderedValueMap()),new n.SortKey(t,!0,i)})},{"../../common/values":86}],46:[function(e,t){var n=e("./viewModel"),i=e("../models/expressions/expression"),r=e("../models"),s=e("../../common/values"),o=n.extend({initialize:function(){this.options.fields||(this.options.fields=this.options.sheet.get("fields").toArray()),this.newRecords={}},fieldAt:function(e,t){return this.options.transposed?e:t.field},recordAt:function(e,t){return this.options.transposed?this.options.record:t?t:(this.newRecords[e]||(this.newRecords[e]=r.Record.add()),this.newRecords[e])},isFieldNameChange:function(e,t){return this.options.transposed&&t===this.tableView.columns[0]},fieldChangeSummary:function(e){var t=this.summaries.fields[e.id];return t||(t={field:e},this.summaries.fields[e.id]=t),t},recordChangeSummary:function(e){var t=this.summaries.records[e.cid];return t||(t={record:e,attributes:{},previousAttributes:{},newValues:[]},this.summaries.records[e.cid]=t),t},updateForFieldNameChange:function(e,t,n){var i=this.fieldChangeSummary(e);i.name=n},updateForValueChange:function(e,t,n,i){var r=this.recordChangeSummary(e);if(_.isNumber(t))r.newValues.push(i);else{var s=t.id;r.previousAttributes[s]=e.getValue(s),r.attributes[s]=t.resolveValue(i)}},updateSummaryForChange:function(e,t,n,i){var r,s=this.tableView.rowAt(e),o=t.column;if(r=_.isNumber(t)?t:this.fieldAt(s,o),this.isFieldNameChange(s,o))this.updateForFieldNameChange(r,n,i);else{var a=this.recordAt(e,s,o);this.updateForValueChange(a,r,n,i)}},isRecordDelete:function(e){if(e.record.isNew())return!1;var t=e.attributes;return _.all(this.options.fields,function(e){return e.id in t&&t[e.id].isEmpty()})},transformRowClearsIntoRecordDeletes:function(){if(!this.options.transposed){var e=this;_.each(this.summaries.records,function(t){e.isRecordDelete(t)&&(t.attributes={},t.previousAttributes={},t.isDelete=!0)})}},updateSummariesForFormulaChange:function(e,t){var n=this.options.sheet,r=e.record,o=e.attributes[t],a=n.fieldWithKey(t),l=this.fieldChangeSummary(a);if(!i.isFormula(o))return l.formula=null,void(l.badFormula=null);try{l.formula=i.parse(o,a.formulaSheet(),{forbiddenFields:[a]}),l.badFormula=null,e.attributes[t]=s.createEmpty(),e.previousAttributes[t]=r.getValue(t)}catch(c){if(!(c instanceof i.ParseError||c instanceof i.ValidationError))throw c;l.badFormula=o.displayValue(),l.badFormulaRecord=r,c instanceof i.ValidationError&&(l.message=c.message),delete l.formula,delete e.attributes[t],delete e.previousAttributes[t]}},transformFormulaStringsIntoFieldUpdates:function(){var e=this;_.each(this.summaries.records,function(t){_.each(_.keys(t.attributes),function(n){e.updateSummariesForFormulaChange(t,n)})})},isNoOp:function(e,t){return e=e||s.createEmpty(),t=t||s.createEmpty(),_.isEqual(t,e)?!0:t.isRef()&&e.isRef()&&t.hasId(e.id)?!0:!1},removeNoOps:function(){var e=this;_.each(_.values(this.summaries.records),function(t){if(!t.isDelete){_.each(_.keys(t.attributes),function(n){var i=t.attributes[n],r=t.previousAttributes[n];e.isNoOp(r,i)&&(delete t.attributes[n],delete t.previousAttributes[n])});var n=!_.isEmpty(t.newValues);n=n&&_.any(t.newValues,function(e){return null!=e}),_.isEmpty(t.attributes)&&!n&&delete e.summaries.records[t.record.cid]}})},processChanges:function(e,t){var n=this;return this.tableView=e,this.summaries={fields:{},records:{}},_.each(t,function(e){n.updateSummaryForChange.apply(n,e)}),this.transformRowClearsIntoRecordDeletes(),this.transformFormulaStringsIntoFieldUpdates(),this.removeNoOps(),this.summaries},getRecordChanges:function(e){return void 0===e?this.summaries.records:this.summaries.records[e.cid]},getFieldChanges:function(){return this.summaries.fields},getFormulaChanges:function(){return _.filter(this.summaries.fields,function(e){return"formula"in e})},getFirstBadFormulaChange:function(){return _.find(this.summaries.fields,function(e){return!!e.badFormula})}});t.exports=o},{"../../common/values":86,"../models":33,"../models/expressions/expression":65,"./viewModel":55}],47:[function(e,t){var n=e("../../common/errors"),i=e("./recordList"),r=e("../actions"),s=e("../../common/strings"),o=(e("../models"),e("../../common/values")),a=i.extend({type:"group",initialize:function(){this.showGroupFieldAction=!0,this.showSearchFieldAction=!0,i.prototype.initialize.call(this),this.allowTitleRename=this.hasOneNonLinkField(),this.showDeleteListAction=this.hasOneNonLinkField(),this.showGroupInsertActions=this.hasOneNonLinkField()},hasOneField:function(){return 1===this.fixedKeys.length},hasOneNonLinkField:function(){return this.hasOneField()&&!this.fixedFields()[0].isLink()},titles:function(e){if(void 0===e){var t=this;return _.map(this.fixedValues,function(e,n){var i=t.fixedField(n);return t.titleForValue(e,i)})}var n=this.fixedValues[e],i=this.fixedField(e);return this.titleForValue(n,i)},deleteTitle:function(){return _.template(s["named-value"],{fieldName:this.fixedField(0).displayName(),displayValue:this.fixedValues[0].displayValue()})},titleUrl:function(e){return this.fixedValues[e].linkUrl()},titleForValue:function(e){return e.isEmpty()?s["default-group-name"]:e.displayValue()},showFieldNames:function(){return!0},fixedField:function(e){return this.sheet.fieldWithKey(this.fixedKeys[e])},firstFixedValue:function(){return this.fixedValues[0]},allValuesMatch:function(e){return e.length!==this.fixedValues.length?!1:_.all(this.fixedValues,function(t,n){var i=e[n];return t.isEqual(i)})},editableTitleText:function(){return this.fixedValues[0].displayValue()},startListeners:function(){i.prototype.startListeners.call(this)},rename:function(e){if(this.hasOneNonLinkField()){var t=this.firstFixedValue();if(e=o.create(e),!e.isEqual(t)){var i=t,s=this.fixedField(0);if(this.sheetViewModel.hasGroup(e))throw new n.DisplayableError("error-duplicate-group-name",{group:this.titleForValue(e,s)});s.isEnum()?s.get("enum").renameValue(i.displayValue(),e.displayValue()):this.sheet.get("records").bulkUpdate(s,i.toJSON(),e.toJSON());var a=this,l=function(e){a.fixedValues[0]=e,a.records.each(function(t){t.set(a.fixedField(0).get("key"),e)}),a.trigger("titleChanged")};r.performCustomAction({perform:function(){l(e)},revert:function(){l(i)},queueTarget:this})}}},"delete":function(e){if(!this.showDeleteListAction)throw new Error("Attempting to delete a group when we aren't allowed to");if(!this.sheet.canDeleteGroup(this.fixedKeys,this.fixedValues))throw new n.DisplayableError("error-delete-nonempty-group");var t=this.fixedFields()[0];if(!t.isEnum())throw new Error("Attempted to delete a group on a field that isn't enum");t.removeEnumValue(this.fixedValues[0].displayValue(),e)}});t.exports=a},{"../../common/errors":31,"../../common/strings":13,"../../common/values":86,"../actions":38,"../models":33,"./recordList":50}],50:[function(e,t){var n=(e("../../common/strings"),e("./index")),i=e("./viewModel"),r=e("../models"),s=e("../actions"),o=e("../../common/values"),a={showGroupFieldAction:!0,showSearchFieldAction:!0,showReportAction:!0,showDeleteListAction:!0,showSortOption:!0,showGroupOption:!0,showActionColumn:!0,showRecordLink:!0,sortable:!0},l=i.extend({type:"record-list",initialize:function(){_.defaults(this,this.options,a),this.sheet||(this.sheet=this.options.sheet),this.records||(this.records=this.options.records||this.sheet.get("records")),this.allowTitleRename=!0,this.showDeleteListAction=!0,this.delayListeners||this.startListeners()},startListeners:function(){this.stopListening(),this.listenTo(this.fieldsCollection(),"add",this.onFieldAdded),this.listenTo(this.fieldsCollection(),"remove",this.onFieldsDeleted),this.listenTo(this.fieldsCollection(),"change reset sort",this.onFieldsChanged),this.listenTo(this.records,"add",this.onRecordAdded),this.listenTo(this.records,"change reset",this.onRecordsChanged),this.listenTo(this.records,"remove",this.onRecordRemoved);var e=this.sheet.book();e&&this.listenTo(e,"sheets:change:nameKey",this.onSheetNameKeyChanged)},onRecordRemoved:function(e){this.resetRecordsHash(),this.trigger("recordRemoved",e)},deleteField:function(e,t){e.destroy(t)},restoreField:function(e,t){this.fieldsCollection().restore(e,t)},showHeaderButtons:function(){return!0},setSheetViewModel:function(e){this.sheetViewModel=e},showFieldNames:function(){return!1},hasRecordAtIndex:function(e,t){var n=this.getRecordsHash();return e.cid in n?n[e.cid]===t:!1},getIndexForRecord:function(e){var t=this.getRecordsHash();return e.cid in t?t[e.cid]:-1},resetRecordsHash:function(){this.recordsHash=null},getRecordsHash:function(){if(this.recordsHash)return this.recordsHash;var e={};return this.records.each(function(t,n){e[t.cid]=n}),this.recordsHash=e},getAllRecords:function(){return this.records.models},remove:function(){this.stopListening()},hasTitles:function(){var e=this.titles();return e?e.length>0:!1},titleUrl:function(){return null},titles:function(){return null},recordsWithSummary:function(){return this.records.models},summaryValue:function(e){if(0===this.records.length)return null;var t=this.records.map(function(t){return t.getValue(e.get("key"))});return o.computeAggregate(e.getAggregate(),[t])},cloneWithRecords:function(e,t){e instanceof r.Record.Collection||(e=new r.Record.Collection(e,{url:this.records.url,comparator:null}),e.parent=this.records.parent),t.records=e,_.defaults(t,this.getCloneDefaults());var n=t.type||this.constructor;return new n(t)},getCloneDefaults:function(){return _.pick(this,"showGroupFieldAction","showSearchFieldAction","showReportAction","showSortOption","showGroupOption","title","sheet","records","fixedKeys","fixedValues","sortable")},isEqual:function(e){var t=_.omit(this.getCloneDefaults(),"records","sheet"),n=_.omit(e.getCloneDefaults(),"records","sheet");return _.isEqual(t,n)?this.sheet.id!==e.sheet.id?!1:this.records.size()!==e.records.size()?!1:this.records.every(function(t,n){return t===e.records.at(n)}):!1},getFields:function(){return this.fieldsCollection()},editableTitleText:function(){return this.title},hasFixedKeys:function(){return this.fixedKeys&&this.fixedKeys.length>0},fixedValueForRecord:function(e){return this.fixedKey?e.getValue(this.fixedKey):null},fieldsCollection:function(){return this.sheet.get("fields")},fields:function(){var e=this.fieldsCollection();if(!e)return null;if(e=e.toArray(),this.hasFixedKeys()){var t=this;e=_.reject(e,function(e){return _.any(t.fixedKeys,function(t){return e.id===t})})}return e},fieldWithKey:function(e){return this.fieldsCollection().findWhere({key:e})},recordIterator:function(){return new n.RecordIterator({records:this.records})},saveRecordAttributes:function(e,t,n,i){var r=this;if(e.isNew()&&(e.set("sheetId",this.sheet.id),e.once("change:_id",function(){r.trigger("recordAdded",e)})),this.fixedKeys&&_.each(this.fixedKeys,function(i,s){if(!e.has(i)){var o=r.fixedValues[s];n[i]=e.get(i),t[i]=o,e.set(i,o)}}),!e.collection){var s=this.sheet.get("records"),o=s.last(),a=o&&o.has("ordinal")?parseInt(o.get("ordinal")):s.length-1;e.set("ordinal",a+1),s.add(e,{silent:!0})}e.isNew()&&this.addedRecord(e,i),e.patch(t,n,i)},addedRecord:function(e,t){var n=this;s.performCustomAction({perform:function(){t.index?n.records.add(e,{at:t.index}):n.records.add(e)},revert:function(){n.records.remove(e)},queueTarget:e})},saveBulkChanges:function(e,t){if(this.hasFixedKeys()){var n=this;_.each(this.fixedKeys,function(t,i){_.each(e,function(r){r.attributes||(e.attributes={}),r.attributes[t]=n.fixedValues[i],r.previousAttributes[t]=r.record.getValue(t)})})}this.sheet.action(c,e,this).do(t)},saveChanges:function(e,t){var n=this;_.each(e,function(e){e.isDelete?n.destroyRecord(e.record,t):n.saveRecordAttributes(e.record,e.attributes,e.previousAttributes,t)})},saveFormulaChanges:function(e,t){_.each(e,function(e){var n=e.field;n.saveFormula(e.formula,t)})},moveField:function(e,t,n){var i=this.fields(),r=this.fieldsCollection(),s=i[e],o=r.indexOf(i[t]);r.move(s,o,n)},moveRecord:function(e,t,n){var i={};if(t.before&&e.get("ordinal")<t.before.get("ordinal")?i.ordinal=t.before.get("ordinal"):t.after&&e.get("ordinal")>t.after.get("ordinal")&&(i.ordinal=t.after.get("ordinal")),this.hasFixedKeys()){var r=this;_.each(this.fixedKeys,function(t,n){var s=r.fixedValues[n];e.getValue(t).isEqual(s)||(i[t]=s.toJSON())})}t.before?this.moveRecordTo(e,t.before,{after:!0}):t.after&&this.moveRecordTo(e,t.after,{after:!1}),this.sheet.get("records").move(e,i,n)},moveRecordTo:function(e,t,n){n=n||{},this.records.contains(e)&&this.records.remove(e);var i=this.records.indexOf(t);n.after&&(i+=1),this.records.add(e,{at:i})},removeRecord:function(e){this.records.remove(e)},insertRecordAbove:function(e,t){var n=this.getIndexForRecord(e);this.insertRecordAt(e.get("ordinal"),n,t)},insertRecordBelow:function(e,t){var n=this.getIndexForRecord(e)+1;this.insertRecordAt(e.get("ordinal")+1,n,t)},insertRecordAt:function(e,t,n){var i=this.sheet.get("records").insertRecord(e);n=_.defaults(n||{},{index:t}),this.saveRecordAttributes(i,_.clone(i.attributes),{},n)},addField:function(e){e=_.extend({wait:!0},e),this.fieldsCollection().create({},e)},rename:function(){throw new Error("rename-group not implemented")},"delete":function(){throw new Error("delete-group not implemented")},deleteTitle:function(){return this.title},fixedFields:function(){if(!this.fixedKeys)return[];var e=this;return _.map(this.fixedKeys,function(t){return e.sheet.fieldWithKey(t)})},numberOfShownTitles:function(e){if(!this.fixedKeys)return 0;if(!e)return this.fixedKeys.length;var t=0,n=!0;return _.each(this.fixedValues,function(i,r){var s=e.fixedValues[r];i.isEqual(s)&&n?t+=1:n=!1}),this.fixedKeys.length-t},destroyRecord:function(e,t){var n=this.records.indexOf(e),i=this;s.performCustomAction({perform:function(){var t=e.collection;i.records.remove(e),e.collection=t},revert:function(){var t=e.collection;i.records.add(e,{at:n}),e.collection=t},queueTarget:this}),e.destroy(t),this.trigger("recordDeleted",e)},onFieldAdded:function(e){this.trigger("fieldAdded",e)},onFieldsChanged:function(e){if(e instanceof r.Field&&e.changed){var t=_.any(e.changed,function(e,t){return"type"!==t});if(!t)return}this.trigger("fieldsChanged")},onFieldsDeleted:function(){this.trigger("fieldsDeleted")},onRecordAdded:function(e){this.resetRecordsHash(),this.trigger("recordAdded",e)},onRecordsChanged:function(e){this.resetRecordsHash(),this.trigger("recordsChanged",e)},onSheetNameKeyChanged:function(e){var t=this.fieldsCollection().any(function(t){return t.linkedSheet()===e});t&&this.trigger("linkedSheetNameKeyChanged")}});t.exports=l;var c=s.Action.extend({initialize:function(e,t,n){this.changes=t,this.model=e,this.startingFields=e.get("fields").clone(),this.startingRecords=e.get("records").clone(),this.recordList=n},doUpdate:function(e,t){return _.each(e,function(e){e.records&&_.each(e.records,function(e){e.values=_.map(e.values,function(e){return _.isObject(e)?e.toJSON():e})})}),this.model.request("patch",e,t)},changedFieldKeys:function(){return _.chain(this.changes).map(function(e){return e.attributes?_.keys(e.attributes):null}).compactNullish().flatten(!0).uniq().value()},perform:function(e){this.refreshModel();var t={op:"records"},n=this.changedFieldKeys();t.fields=n,t.records=_.map(this.changes,function(e){var t={};e.record.isNew()||(t.id=e.record.id);var i=[];return _.each(n,function(t){if(!(t in e.attributes)){var n=e.record.getValue(t);e.attributes[t]=n,e.previousAttributes[t]=n}i.push(e.attributes[t])}),t.values=i.concat(e.newValues),t});var i=e.success,r=this;e.success=function(){var e=r.model.get("fields").pluck("key"),t=r.startingFields.pluck("key");r.addedKeys=_.difference(e,t);var n=r.model.get("records").pluck("_id"),s=r.startingRecords.pluck("_id");r.addedRecordIds=_.difference(n,s),r.addRecords(),i&&i.apply(this,arguments)},this.doUpdate([t],e)},addRecords:function(){var e=this,t=this.model.get("records").filter(function(t){return _.any(e.addedRecordIds,function(e){return t.id===e})});e.recordList.records.add(t)},removeRecords:function(){var e=this,t=this.recordList.records.filter(function(t){return _.any(e.addedRecordIds,function(e){return t.id===e})});e.recordList.records.remove(t)},revert:function(e){this.refreshModel();var t=[];_.isEmpty(this.addedKeys)||t.push({op:"fields",deleteFields:this.addedKeys});var n={op:"records",deleteRecords:this.addedRecordIds,fields:this.changedFieldKeys()};n.records=_.chain(this.changes).map(function(e){var t=e.record;if(t.id){var i={};return i.id=t.id,i.values=_.map(n.fields,function(t){return e.previousAttributes[t]}),i}}).compactNullish().value(),t.push(n);var i=e.success,r=this;e.success=function(){i&&i.apply(this,arguments),r.removeRecords()},this.doUpdate(t,e)},reperform:function(e){this.refreshModel();var t=[];this.addedKeys&&t.push({op:"fields",restoreFields:this.addedKeys});var n=this.changedFieldKeys(),i=n.concat(this.addedKeys),r={op:"records",restoreRecords:this.addedRecordIds,fields:i},s=0,o=this;r.records=_.map(this.changes,function(e){var t={};t.id=e.record.id,e.record.isNew()&&(t.id=o.addedRecordIds[s],s++);var i=[];return _.each(n,function(t){i.push(e.attributes[t])}),t.values=i.concat(e.newValues),t}),t.push(r);var a=e.success;e.success=function(){a&&a.apply(this,arguments),o.addRecords()},this.doUpdate(t,e)}})},{"../../common/strings":13,"../../common/values":86,"../actions":38,"../models":33,"./index":45,"./viewModel":55}],51:[function(e,t){{var n=e("./recordList"),i=e("../../common/values"),r=e("../models");t.exports=n.extend({type:"report",initialize:function(){n.prototype.initialize.apply(this,arguments),this.sourceSheet=this.options.sourceSheet,this.showGroupFieldAction=!1,this.showSearchFieldAction=!1,this.showDeleteListAction=!1,this.showGroupInsertActions=!1,this.showSortOption=!1,this.showGroupOption=!1,this.showRecordLink=!1,this.sortable=!1,this.title=null,this.fixedValue=null,this.fixedKey=null},deleteField:function(e){e.isReportFormula()&&this.sheet.get("fields").remove(e)},showHeaderButtons:function(e){return e.isReportFormula()},recordsWithSummary:function(){return _.chain(this.records.models).concat(this.summaryRecord).compactNullish().value()},shouldShowExtraRow:function(){return!!this.summaryRecord},summaryValue:function(e){if(this.summaryRecord){var t=this.summaryRecord.getValue(e.get("key")),n=i.createEmpty();if(!e.isReportFormula()){var r=n;n=t,t=r}return{value:t,displayName:n.displayValue()}}return null},insertReportFormula:function(e,t){var n=this.sheet.get("fields"),i=n.length;e&&(i=n.indexOf(e),t.before||i++);var s={name:"",key:_.uniqueId("aggregateField_"),type:"report-formula",expression:r.expressions.Expression.parse('""'),sourceSheet:this.sourceSheet};return n.add(s,{at:i}),n.at(i)},moveField:function(e,t,n){var i=this.sheet.get("fields"),r=i.filter(function(e){return e.isReportFormula()}),s=i.indexOf(r[0]),o=i.at(s+e);i.move(o,s+t,n)}})}},{"../../common/values":86,"../models":33,"./recordList":50}],53:[function(e,t){var n=e("../actions"),i=e("../../common/strings"),r=e("../models"),s=e("./index"),o=e("./viewModel"),a=e("../../common/values"),l=e("../parser").cursorToken,c=o.extend({initialize:function(){this.sheet=this.options.sheet,this.book=this.sheet.book(),this.navKey=this.options.navKey,this.autocompleter=new r.powerbar.Autocompleter(this.sheet),this.listenTo(this.sheet,"change",this.onSheetChanged),this.listenTo(this.sheet,"change:title",this.onSheetTitleChanged),this.listenTo(this.sheet,"fields:enum:all",this.updateRecordListOrder),this.listenTo(this.sheet,"fields:enum:reset",this.updateRecordListOrder),this.listenTo(this.sheet,"fields:reset",this.updateRecordListOrder),this.listenTo(this.sheet,"records:add",this.updateQueryResults),this.listenTo(this.sheet,"records:change",this.onRecordChanged),this.listenTo(this.sheet,"records:remove",this.updateQueryResults),this.listenTo(this.sheet,"records:reset",this.updateQueryResults),this.listenTo(this.sheet,"navItems:change",this.onNavItemsChanged),this.listenTo(this.sheet,"navItems:reset",this.onNavItemsReset),this.listenTo(this.sheet,"fields:change",this.onFieldsChange)},onFieldsChange:function(){this.trigger("fieldsChanged")},onRecordChanged:function(e){return this.isGrouped()&&!this.anyNonGroupFieldChanged(e)?void this.updateRecordListOrder():void this.updateQueryResults()},anyNonGroupFieldChanged:function(e){var t=this.groupFields();return _.any(e.changed,function(e,n){return _.all(t,function(e){return n!==e.get("key")})})},updateQueryResults:function(){this.query&&(this.cachedRecordLists=null,this.trigger("queryChanged"))},getCommandDescriptors:function(e){return 0===arguments.length&&(e=this.query),e?e.getCommandDescriptors():[]},needsFetch:function(){return!this.book||this.sheet.needsFetch()},load:function(){var e=this;r.Book.qfetchBySheetIfNeeded(this.sheet).then(function(t){e.book=t,e.trigger("load")}).done()},showGroupInsertActions:function(){return this.canModifyGroups()},allowGroupsSortable:function(){return this.canModifyGroups()},canModifyGroups:function(){return this.hasOneGroup()?!this.groupFields()[0].isLink():!1},beginEditingQueryText:function(){this.originalQuery=this.getNewQuery()},setQueryText:function(e,t){t&&t.capture&&this.beginEditingQueryText(),e=e.replace(l,""),e+=l;var n=this.sheet.query(e);n&&(n.setComplete(),this.query&&n.isEqual(this.query)||(this.query=n,this.trigger("queryChanged"),t&&t.capture&&this.endEditingQueryText()))},endEditingQueryText:function(){this.originalQuery.isEqual(this.query)||this.action(c.UpdateQuery,this.query,this.originalQuery).push()},updateRecordListOrder:function(){if(this.isGrouped()){if(this.groupFields().length>1)return this.updateQueryResults();{var e,t=this.groups();_.pluck(this.cachedRecordLists,"fixedValues")}if(e=this.canModifyGroups()&&this.groupFields()[0].isEnum()?this.groupFields()[0].get("enum").map(function(e){return[a.create(e.get("name"))]}):r.groupSort(t,this.groupFields(),function(e,t){return e[t]}),!_.isEqual(t,e)){if(this.cachedRecordLists){var n=[],i=this;_.each(e,function(e){var t=i.findOrCreateGroupRecordList(e);n.push(t)});var s=this.groupFields()[0];s.isEnum()||(n=_.filter(n,function(e){return 0!==e.records.length})),this.cachedRecordLists=n}this.trigger("groupsChanged")}}},findOrCreateGroupRecordList:function(e){if(!this.isGrouped())throw new Error("Tried to ask for a grouped record list when not grouped");if(!this.cachedRecordLists||0===this.cachedRecordLists.length)throw new Error("Cannot find or create a new group with existing groups");var t=_.find(this.cachedRecordLists,function(t){return t.allValuesMatch(e)});return t?t:this.cachedRecordLists[0].cloneWithRecords([],{fixedValues:e,sheetViewModel:this})},navItem:function(){return this.sheet.navItemWithKey(this.navKey)},navQuery:function(){var e=this.navItem();return e&&e.get("query")},title:function(){if(this.navKey){var e=this.navItem();return e&&e.displayName()}return this.sheet.displayTitle()},editableTitleText:function(){if(this.navKey){var e=this.navItem();return e&&e.get("name")}return this.sheet.get("title")},navItemSearchText:function(){var e=this.navQuery();if(e&&e.powerBarTerms.length>0){var t=this.sheet.queryForNavKey(this.navKey);return t.stringify()}return""},toggleSortField:function(e){if(null==e)throw new Error("null key");var t=this.fieldWithKey(e);if(null==t)throw new Error("field does not exist for key: "+e);var n=this.getNewQuery();n.toggleSortField(t),this.updateQuery(n)},addKeyword:function(e){var t=this.getNewQuery();t.addKeyword(e),this.updateQuery(t)},addFilter:function(e,t){var n=this.getNewQuery();n.addFilter(e,t),this.updateQuery(n)},queryString:function(){return this.query?this.query.stringify():""},updateQuery:function(e,t){t=t||{},this.action(c.UpdateQuery,e,this.query,t).do()},queryAutocompletions:function(e,t,n){return this.autocompleter.completions(e,n)},isGrouped:function(){if(!this.query)return!1;if(this.query.isGrouped()){var e=this.groupFields();return e?e.length>0:!1}return!1},hasOneGroup:function(){return this.isGrouped()?1===this.groupFields().length:!1},groupFields:function(){return this.lastResults?this.lastResults.getFixedFields():[]},firstGroupField:function(){return this.lastResults?this.lastResults.firstRecordList().fixedField(0):null},startResultListeners:function(e){var t=e.firstSheet(),n=this.lastResults&&this.lastResults.firstSheet();if(t!==n&&(n&&n.synthetic&&this.stopListening(n),"report"===_.soak(e,"firstRecordList().type"))){var i="fields:change fields:remove fields:add fields:reset fields:sort",r=_.bind(this.onReportFormulaChange,this,t);this.listenTo(t,i,r)}},onReportFormulaChange:function(e){var t=e.get("fields").chain().filter(function(e){return e.isReportFormula()}).map(function(e){return e.get("expression")}).value(),i=this.getNewQuery();i.replaceReportExpressions(t),n.history.capture(function(){this.query.isEqual(i)||this.updateQuery(i,{suppressResultsUpdate:!0})}.bind(this))},recordLists:function(){if(this.cachedQuery===this.query&&this.cachedRecordLists)return this.cachedRecordLists;var e;if(this.query)try{e=this.query.executePipeline()}catch(t){return console.warn(t),this.cachedRecordLists}else e=r.powerbar.results.Results.fromSheet(this.sheet);return this.lastResults&&e.reuseRecordLists(this.lastResults),this.startResultListeners(e),this.lastResults=e,e.startListeners(),this.cachedQuery=this.query,this.cachedRecordLists=e.recordLists,_.invoke(this.cachedRecordLists,"setSheetViewModel",this),this.isGrouped()||(this.cachedRecordLists[0].absolute=!0),this.cachedRecordLists},fieldWithKey:function(e){return this.sheet.fieldWithKey(e)},recordListForValues:function(e){return _.find(this.recordLists(),function(t){return _.all(e,function(e,n){return t.fixedValues[n].isEqual(e)})})},recordsForGroup:function(e){if(!this.isGrouped())return null;var t=this.recordListForValues(e);return t?t.records.models:[]},canSaveSearch:function(e){var t=this.query;return e&&(t=this.sheet.query(e)),t&&t.hasCommands()},recordIterator:function(){var e;return this.isGrouped()?(e=_.map(this.groups(),_.bind(this.recordsForGroup,this)),e=_.flatten(e)):e=this.recordLists()[0].records.models,new s.RecordIterator({records:e})},saveTitle:function(e,t){this.navKey?this.navItem().saveIfNeeded("name",e,t):this.sheet.saveIfNeeded("title",e,t)},groups:function(){return _.pluck(this.recordLists(),"fixedValues")},hasGroup:function(e){return _.any(this.groups(),function(t){return _.any(t,function(t){return e.isEqual(t)})})},insertGroup:function(e,t){if(this.hasOneGroup()){if(!this.showGroupInsertActions())throw new Error("Cannot insert a group into a linked field");for(var n=this.groupFields()[0],r=_.template(i["new-group-name"],n.attributes),s=_.chain(this.groups()).map(function(e){return e[0]}).clone().value(),o=r,l=1,c=a.create(r);this.hasGroup(c);)l+=1,r=o+" "+l.toString(),c=a.create(r);s.splice(e,0,c),this.saveGroups(s,t)}},indexOfValue:function(e,t){for(var n=0;n<e.length;n++)if(e[n].isEqual(t))return n;return null},moveGroup:function(e,t,n){if(this.canModifyGroups()){var i,r=this.recordLists(),s=_.indexOf(r,e),o=e.fixedField(0);i=o.isEnum()?_.map(o.enumValues(),function(e){return a.create(e)}):_.chain(r).pluck("fixedValues").flatten(!0).value();var l=_.clone(i),c=e.fixedValues[0];i=_.filter(i,function(e){return!e.isEqual(c)});var u=0,h=l[t];s!==t&&(u=s>t?this.indexOfValue(i,h):this.indexOfValue(i,h)+1,i.splice(u,0,c),this.saveGroups(i,n))}},saveGroups:function(e,t){if(!this.canModifyGroups())throw new Error("Cannot save groups with multiple groups or a link group");var n=this.firstGroupField(),i=_.map(e,function(e){return e.displayValue()});n.saveEnums(i,t)},updateSearch:function(e){this.canSaveSearch()&&this.sheet.updateNavItem(this.query,this.navKey,e)},saveSearch:function(e,t){if(this.canSaveSearch()||t){var n=this.sheet.newNavItem(this.query);return this.saveNavItem(n,e)}},getNewQuery:function(){return this.query?this.query.clone():new r.powerbar.Query},groupBy:function(e){var t=this.fieldWithKey(e),n=this.getNewQuery();n.addOrUpdateGroupBy(t),this.updateQuery(n)},reportOn:function(e){var t=this.fieldWithKey(e),n=this.getNewQuery();n.addReportQuery(t),this.updateQuery(n)},ungroup:function(e){if(this.isGrouped()){var t=this.getNewQuery();t.removeGroupBy(e),this.updateQuery(t)}},removeCustomOrder:function(e,t){var n=_.find(this.groupFields(),function(t){return t.get("key")===e});if(!n)throw new Error("Cannot remove order when not grouping");if(!n.isEnum())throw new Error("Cannot remove order when not grouping by an enum field");n.removeEnum(t)},saveNavItem:function(e,t){return t=_.extend({wait:!0},t),this.sheet.get("navItems").create(e,t),e},onSheetChanged:function(){this.trigger("sheetChanged")},onSheetTitleChanged:function(){this.navKey||this.trigger("titleChanged")},onNavItemsChanged:function(e){e instanceof r.NavItem&&e.id===this.navKey&&("name"in e.changed&&this.trigger("titleChanged"),"query"in e.changed&&this.trigger("navQueryChanged"))},onNavItemsReset:function(){this.navKey&&(this.trigger("titleChanged"),this.updateQueryResults())},toContext:function(){return this.sheet.toContext()}});c.UpdateQuery=n.Action.extend({initialize:function(e,t,n,i){this.viewModel=e,this.query=t,this.previousQuery=n,this.options=i},update:function(e,t){this.viewModel.query=e,t&&(this.viewModel.cachedQuery=e),this.viewModel.trigger("queryTextChanged")},perform:function(){this.update(this.query,this.options.suppressResultsUpdate)},revert:function(){this.update(this.previousQuery)},reperform:function(){this.update(this.query)},queueTarget:function(){return this.viewModel.sheet.queueTarget()}}),t.exports=c},{"../../common/strings":13,"../../common/values":86,"../actions":38,"../models":33,"../parser":28,"./index":45,"./viewModel":55}],54:[function(e,t){var n=e("./recordList"),i=(e("../actions"),e("../models"),e("../../common/values")),r=n.extend({type:"subsheet",initialize:function(){this.subsheet=this.options.subsheet,this.record=this.options.record,this.sheet=this.subsheet.get("sheet"),this.fixedKeys=[this.subsheet.get("field").get("key")],this.fixedValues=[i.makeRef(this.record.id)],this.title=this.sheet.displayTitle(),this.records=this.record.childrenFor(this.subsheet.id),this.showGroupFieldAction=!1,this.showSearchFieldAction=!1,this.showReportAction=!1,this.showSortOption=!1,this.showGroupOption=!1,this.sortable=!0,n.prototype.initialize.call(this)
},startListeners:function(){n.prototype.startListeners.apply(this,arguments),this.listenTo(this.sheet,"change:title",this.onSheetTitleChanged)},titles:function(){return[this.title]},editableTitleText:function(){return this.sheet.get("title")},rename:function(e,t){this.sheet.saveIfNeeded("title",e,t)},"delete":function(e){this.subsheet.destroy(e)},onSheetTitleChanged:function(){this.title=this.sheet.displayTitle(),this.trigger("titleChanged")}});t.exports=r},{"../../common/values":86,"../actions":38,"../models":33,"./recordList":50}],110:[function(e,t){var n=e("./view"),i=e("../../common/values"),r=n.extend({className:"aggregate-box",initialize:function(){this.render()},render:function(){var e=this.region;if(!e||!e.isMultiselect())return void this.hide();var t=this.createContext(e.getValues());this.$el.html(n.templates.aggregateBox(t)),this.show()},createContext:function(e){var t=_.chain(i.aggregates.selectionAggregates).map(function(t){return new t(e)}).filter(function(e){return e.canPerform()&&e.hasInterestingData()}).map(function(e){var t=e.perform();return t?{displayName:e.displayName,value:t.displayValue()}:void 0}).compactNullish().value();return{aggregates:t}},setRegion:function(e){this.region=e,this.render()}});t.exports=r},{"../../common/values":86,"./view":57}],71:[function(e,t){var n=e("dropzone"),i=e("../../common/strings"),r=e("../csrf"),s=e("../models"),o=e("../routing"),a=e("../env"),l=e("./view"),c=e("./statusBarView"),u=l.extend({className:"book-list",largeGreySpinnerOptions:{lines:11,length:11,width:4,radius:11,color:"#333"},initialize:function(){this.model=this.model||s.Book.collection;var e={};e.user=s.Account.account.toContext(),e.testErrors=o.hasParam("test_errors"),this.$el.html(l.templates.bookList(e)),this.renderDropzone(),c.hide(),this.listenTo(this.model,"add",this.renderBooksDeferred),this.listenTo(this.model,"change",this.renderBooksDeferred),this.listenTo(this.model,"remove",this.onBookRemoved),this.listenTo(this.model,"reset",this.renderBooksDeferred),this.listenTo(this.model,"sort",this.renderBooksDeferred),this.listenTo(this.model,"sync",this.renderBooksDeferred),this.model.fetchIfNeeded(),this.render()},renderDropzone:function(){var e=this,t=this.$(".content-box"),o=t.get(0),l=this.$(".import-csv").get(0),c=t,u=new n(o,{acceptedFiles:"text/csv,application/csv,.csv",url:"/books.json",paramName:"import",clickable:l,previewsContainer:$("<div>").get(0),dictFallbackMessage:i["drag-and-drop-fallback"],forceFallback:a.disableDropzone});u instanceof n?(u.on("sending",function(t,n){e.addSpinner(c,e.largeGreySpinnerOptions),r.addToken(n)}),u.on("success",function(t,n){e.stopSpinning(c);var i=s.Book.add(n);e.goToNewBook(i),e.model.add(i)}),u.on("error",function(t,n){e.stopSpinning(c),n===u.options.dictInvalidFileType&&(n=_.template(i["import-filetype-error"],t)),e.showAlert(n)}),$(l).tooltip({placement:"right",delay:{show:200,hide:0},title:i["drag-and-drop-tip"]})):u instanceof window.HTMLElement&&e.$(".import-input").on("change",function(){mixpanel.track("new_book");var t=e.$(".import-form");t.submit(),e.addSpinner(c,e.largeGreySpinnerOptions)})},renderBooks:Tips.displayAfter(function(){if(o.hasParam("test_deferred_errors"))throw new Error("BOOM!");var e=this.model.map(function(e){return l.partials.bookLink(e.toContext())}),t=this.$(".book-links"),n=this.$(".no-books");if(e.length>0)n.hide(),t.show(),t.html(e.join(""));else{t.hide(),n.show();var r=this.model.isLoaded()?i["no-books"]:i.loading;n.text(r)}}),render:function(){document.title=i.title,this.renderBooks()},events:{"click .blank-book":"createBook","click .welcome-banner .close":function(){var e=s.Account.account;e.saveIfNeeded("needsWelcome",!1)},"click .test-errors":function(e){throw e.preventDefault(),new Error("BOOM!")}},createBook:function(e){var t,n,i=this.$(".content-box");$.contains(i.get(0),e.target)?(t=$(e.target),t.blur(),n=this.greyButtonSpinnerOptions):(t=i,n=this.largeGreySpinnerOptions),this.addSpinner(t,n);var r=this;this.model.create({},{wait:!0,success:function(e){r.stopSpinning(t),r.goToNewBook(e)},error:r.errorHandler({action:"create-sheet",spinner:t})})},goToNewBook:function(e){mixpanel.track("new_book",{id:e.id}),o.router.flash({editBookTitle:!0}).goToBook(e.id)},onBookRemoved:function(e){var t=this.$('.book-item[data-id="'+e.id+'"]');t.fadeOut({complete:function(){t.remove()}})}});u.deferrableRendering(),t.exports=u},{"../../common/strings":13,"../csrf":2,"../env":26,"../models":33,"../routing":82,"./statusBarView":80,"./view":57,dropzone:"gxgH3g"}],78:[function(e,t){var n=e("../../common/strings"),i=e("../models"),r=e("./view"),s=e("./modalView"),o=s.extend({className:"book-users modal hide fade",template:r.templates.bookUsers,initialize:function(){this.listenTo(this.model,"users:add",this.onBookUserAdded),this.listenTo(this.model,"users:remove",this.onBookUserRemoved),this.listenTo(this.model,"users:reset",this.onBookUsersReset),this.sharedWith=_.invoke(this.model.sharedWith(),"toContext"),this.render()},input:function(){return this.$(".invite-input")},button:function(){return this.$(".invite.btn")},errorMessage:function(){return this.$(".error")},updateButton:function(){var e=this.input().val().trim();e?this.button().removeAttr("disabled"):this.button().attr("disabled","disabled")},context:function(){return{sharedWith:this.sharedWith}},render:function(){s.prototype.render.apply(this,arguments),this.$el.on("shown",_.bind(this.focusInput,this)),this.updateButton()},focusInput:function(){this.input().focus()},showError:function(e,t){t=t||"text-error";var n=this.errorMessage();n.removeClass("text-error text-info"),n.addClass(t),n.text(e),n.fadeIn()},hideError:function(){this.errorMessage().fadeOut()},events:{"input .invite-input":function(){this.updateButton(),this.hideError()},"submit .invite-form":function(){var e=this.input().val(),t=this.button();if(e=e&&e.trim()){var r=this.model.bookUserForEmail(e);if(r){var s=i.Account.isCurrentUser(r.get("user")),o=s?"error-invite-self":"error-invite-existing",a=_.template(n[o],r.get("user").attributes);return void this.showError(a,"text-info")}this.hideError(),this.addSpinner(t,this.greyButtonSpinnerOptions);var l=this;this.invite(e,{success:function(e){mixpanel.track("share_book",{book_id:l.model.id,user_id:e.get("user").id}),l.stopSpinning(t)},error:function(){l.stopSpinning(t);var e=_.template(n["error-template"],{action:n["action-add-book-user"]});l.showAlert(e)}})}},"click .remove-user":function(e){var t=$(e.target).closest(".user"),n=this.model.get("users").get(t.data("bookUserId"));n.destroy({error:this.errorHandler("delete-book-user")})},"click .restore-user":function(e){var t=$(e.target).closest(".user");this.model.get("users").restore({id:t.data("bookUserId")})}},invite:function(e,t){t=_.extend({wait:!0},t);var n=new i.User({email:e}),r=new i.BookUser({user:n});return this.model.get("users").create(r,t),r},onBookUserAdded:function(e){this.sharedWith.push(e.toContext()),this.render()},onBookUserRemoved:function(e){var t=_.findWhere(this.sharedWith,{_id:e.id});t.removed=!0,this.render()},onBookUsersReset:function(){var e=this.sharedWith;_.each(this.model.sharedWith(),function(t){var n=_.findWhere(e,{_id:t.id});if(n){var i=e.indexOf(n);e[i]=t.toContext()}else e.push(t.toContext())}),this.render()}});t.exports=o},{"../../common/strings":13,"../models":33,"./modalView":62,"./view":57}],73:[function(e,t){var n=e("../../common/strings"),i=e("./view"),r=e("../keys"),s=e("../models"),r=e("../keys"),o=i.extend({className:"feedback-view",sentiment:"",initialize:function(){this.$el.html(i.templates.feedbackPanel()),this.$(".feedback-title").text(n.get("feedback","title",this.sentiment)),this.input=this.$(".feedback-input")},show:function(){this.$el.fadeIn(200),this.$(".feedback-status").text(""),this.input.focus(),this.input.select()},hide:function(){this.$el.fadeOut(200)},keyboardEvents:{escape:"hide"},events:{"click .send-button":"send","click .smokescreen":"hide","keydown .feedback-input":"onKeyDown"},send:function(){var e=this.input.val(),t=this.$(".feedback-status");t.text(n["feedback-sending"]);var i=new s.Feedback({sentiment:this.sentiment,message:e});i.save(null,{success:function(){this.feedbackText="",t.text(n.get("feedback","success",this.sentiment)),setTimeout(function(){this.hide(),this.input.val("")}.bind(this),1800)}.bind(this),error:function(){t.text(n.get("feedback","error"))}})},onKeyDown:function(e){e.keyCode===r.ESC&&this.hide()}}),a=o.extend({sentiment:"question"});t.exports.AskView=a;var l=o.extend({sentiment:"feedback",keyboardEvents:{"!":function(){this.onNextTick(this.show)}}});t.exports.FeedbackView=l},{"../../common/strings":13,"../keys":4,"../models":33,"./view":57}],74:[function(e,t){function n(e,t){var n=e.closest("tr");t?n.attr("data-cid",t.cid):n.removeAttr("data-cid"),t&&t.id?(n.removeClass("empty"),n.addClass("record"),n.data("id",t.id),n.attr("data-id",t.id)):(n.removeClass("record"),n.addClass("empty"),n.removeData("id"),n.removeAttr("data-id"))}var i=(e("../actions"),e("handsontable")),r=e("../../common/strings"),s=e("../models"),o=e("../viewModels"),a=e("../routing"),l=e("../table"),c=e("../keys"),u=e("./view"),h=e("./statusBarView"),d=e("./cellRender"),f=e("../../common/values"),p=e("../models/region"),m=e("./formulaView"),g=e("./addLinkView"),v=e("./linkNameView"),y=e("../globalEvents"),b=(e("../models/expressions/expression"),e("../fieldIcons")),w=u.extend({className:"record-list",tableViewOptions:function(){var e=this;return{colHeaders:!0,rowHeaders:function(t){var n=e.tableView.rowAt(t);return u.partials.shortId({url:n.url(),shortId:n.get("shortId")})},dataSchema:function(){var e=s.Record.add();return e.isEmptyRow=!0,e},isEmptyRow:function(e){var t=this.getDataAtRow(e);return t.isBlank()&&_.isEmpty(t.attemptedChanges)&&t.isEmptyRow},didRender:this.updateIdAndName.bind(this),willKeyDown:function(){e.onNextTick(e.updateIdAndName)},minSpareRows:1,manualColumnResize:!0,manualColumnMove:"> th.data",manualRowMove:{items:"> tr.record",appendTo:".record-list",connectWith:".table-view tbody"},sendExtraColumnsOnPaste:!0,skipRedrawOnPaste:!0,afterChange:_.bind(this.onTableEdited,this),afterColumnResize:_.bind(this.onColumnResized,this),afterColumnMove:_.bind(this.onColumnMoved,this),afterRowMove:_.bind(this.onRowMoved,this),beforeKeyDown:_.bind(this.onKeyDown,this),fixedColumnsLeft:this.model.sheet.get("stickyNameField")&&this.model.sheet.nameField()?1:0}},initialize:function(){this.parent=this.options.parent,this.columns=[],this.setupModel(),this.renderBase(),this.listenTo(y,"formulaView:show",this.onShowFormulaView),this.listenTo(y,"formulaView:hide",this.onHideFormulaView)},columnForKey:function(e){return _.findWhere(this.columns,{key:e})},editingHeader:function(){var e=_.find(this.tableView.headerCells(),function(e){var t=$(e),n=t.data("column");return n.isEditingHeader&&n.isEditingHeader(t)});if(e){var t=$(e).data("column");return t.field.get("key")}return null},editHeader:function(e){var t=_.find(this.tableView.headerCells(),function(t){return $(t).data("column").field.get("key")===e});if(t){var n=$(t),i=n.data("column");i.beginEditingHeader(n)}},setupModel:function(){this.model.startListeners(),this.listenTo(this.model,"titleChanged",this.renderTitles),this.listenTo(this.model,"fieldAdded",this.renderAddedFieldDeferred),this.listenTo(this.model,"fieldsChanged",this.renderColumnsAndRowsDeferred),this.listenTo(this.model,"fieldsDeleted",this.renderColumnsAndRowsDeferred),this.listenTo(this.model,"recordAdded",this.onRecordAdded),this.listenTo(this.model,"recordsChanged",this.onRecordsChanged),this.listenTo(this.model,"recordRemoved",this.renderRowsDeferred),this.listenTo(this.model,"recordDeleted",this.showDeleteStatusMessageDeferred),this.listenTo(this.model,"linkedSheetNameKeyChanged",this.renderRowsDeferred),this.listenTo(this.model,"bulkUpdate",this.deselect)},onRecordAdded:function(e){e.id&&this.renderColumnsAndRowsDeferred()},onRecordsChanged:function(e){e instanceof s.Record&&!e.isNew()?this.renderChangedRecord(e):this.renderRowsDeferred()},renderChangedRecord:function(e){var t=this.$("tbody tr[data-id="+e.id+"] td.data");if(0===t.length&&e.changed._id){var i=this.$("tbody tr.empty")[0];t=$("td.data",i),n($(i),e)}if(0!==t.length){this.renderChangedColumns(e.changed,t,e);var r=this.$("tbody tr.empty").last(),o=new s.Record;o.isEmptyRow=!0,this.renderChangedColumns(e.changed,$(r).find("td.data"),o)}},renderChangedColumns:function(e,t,n){t.each(function(){var t=$(this),i=t.data("column");if(!i){var r=t.closest("tr"),s=r.closest("tbody"),o=r.find("td"),a=s.find("tr"),l=o.index(t),c=a.index(r),u="missing column for cell "+l+" of "+o.length;throw u+=" in row "+c+" of "+a.length,u+=", record.isEmptyRow: "+n.isEmptyRow,u+=', cell class="'+t.attr("class")+'"',new Error(u)}var h=i.field.get("key");h in e&&i.render($(this),n,i.get(n))})},showDeleteStatusMessage:function(){this.showStatus({action:"delete-record",undoable:!0})()},remove:function(){this.tableView&&this.tableView.remove(),this.model.remove(),u.prototype.remove.apply(this,arguments)},hideNameField:function(){this.captureActions(function(){var e=this.model.sheet.nameField();this.model.deleteField(e,{error:this.errorHandler("hide-name")}),this.tableView.tableOptions.fixedColumnsLeft=0,this.tableView.reset(),this.onNextTick(function(){this.updateIdAndName()})})},resetTable:function(){this.tableView&&this.tableView.reset()},titleSize:function(e,t){return 1===t?"middle":e===t-1?"small":e===t-2?"middle":"large"},shownTitles:function(){return"numberOfShownTitles"in this.options?this.options.numberOfShownTitles:1},renderTitles:function(){var e=this.$(".record-list-title");if(e&&!e.is(":focus")){var t=this.model.titles();if(t){var n=this.shownTitles(),i=_.range(t.length-n,t.length),r=this.model.fixedFields(),s=this,o=_.map(i,function(e){var n=t[e],i=(s.titleSize(e,t.length),s.model.titleUrl(e));return{title:n,url:i?i:!1,ruler:t.length>1?0===e:!1,size:s.titleSize(e,t.length),fieldName:r[e].displayName()}});e.html(u.partials.groupTitles({titles:o,allowTitleRename:this.model.allowTitleRename,showDeleteListAction:this.model.showDeleteListAction,showFieldNames:this.model.showFieldNames()}))}}},renderRows:function(e){this.tableNeedsReset&&this.resetTable(),this.tableNeedsReset=!1,this.tableView.load({columns:e,rows:this.model.records}),this.tableView.setRowSortable(this.model.sortable)},renderColumnsAndRows:function(){var e=this.model.fields();if(e&&(this.columns=this.createColumns(),this.renderRows(this.columns),this.updateFormulaHighlight(),this.afterNextRender)){var t=this.afterNextRender;this.afterNextRender=null,t.call(this)}},createColumns:function(){var e=this.model.fields(),t=this,n=this.model.showSortOption,i=this.model.showGroupOption,r=_.map(e,function(e){return new x({field:e,showSortOption:n,showGroupOption:i,recordList:t.model})}),s=this.parent;return r.forEach(function(e){e.delegate=s}),this.model.showActionColumn&&r.push(new k({recordList:this.model})),r},renderAddedField:function(){this.renderColumnsAndRows(),this.fieldAddedFromHere&&this.beginEditingHeaderWithKey(this.fieldAddedFromHere),this.fieldAddedFromHere=null},addAfterNextRender:function(e){if(this.afterNextRender){var t=this.afterNextRender;this.afterNextRender=function(){t.call(this),e.call(this)}}else this.afterNextRender=e},updateIdAndName:function(){if("report"!==this.model.type){var e=r.ns("col-tip");this.$("thead th").first().html('<div class="relative"><span class="colHeader">ID</span></div>').addClass("fixed id-col").find(".colHeader").tooltip({container:"body",title:e("id")});var t=this.model.sheet.get("stickyNameField");this.$("tbody th").addClass("fixed id-col");var n=this.$("thead th").eq(1);if(t&&_.soak(n.data("column"),"field.isNameField()")?(n.addClass("fixed name-col").find(".colHeader").tooltip({container:"body",title:e("name")}),n.hasClass("ui-draggable")&&n.draggable("disable"),n.hasClass("ui-droppable")&&n.droppable("disable"),this.$("tbody tr").find("td:eq(0)").addClass("fixed name-col")):(n.removeClass("fixed name-col").find(".colHeader").tooltip("destroy"),n.hasClass("ui-draggable")&&n.draggable("enable"),n.hasClass("ui-droppable")&&n.droppable("enable")),t){var i=u.partials.fieldHeaderButtons({showSortOption:!1,showGroupOption:!1});this.$("thead th:eq(0) .relative").append(i).find("[title]").tooltip({container:".record-list"})}}},render:function(){this.renderBase(),this.renderColumnsAndRows()},updateShownTitles:function(e){var t=e?e.model:null;this.options.numberOfShownTitles=this.model.numberOfShownTitles(t),this.renderTitles()},renderBase:function(){this.$el.html(u.templates.recordList(this.model)),this.tableView&&this.stopListening(this.tableView),this.tableView=new l.TableView({el:this.$(".table-view"),options:this.tableViewOptions()}),this.listenTo(this.tableView,"afterSelection",this.selectionChanged),this.listenTo(this.tableView,"afterDeselect",this.selectionChanged),this.renderTitles()},onInput:function(e){if("="===e.target.value[0]){this.endEditing(!0);var t=this.tableView.getSelected()[1],n=this.tableView.columnAt(t).field,i=e.target,r=i.value.slice(1);this.beginEditingFormulaField(n,r)}},beginEditingFormulaField:function(e,t){var n=this.tableView.findColumnCells({field:e});if(0===n.length)throw new Error("Can't find column cells for field "+e.id);var i=n.offset().left,r=i+n.outerWidth(),s=this.$("thead"),o=s.offset().top,a=o+s.outerHeight();m.beginFormulaPanel({initialValue:t,field:e,avoidSpan:{top:o,bottom:a,left:i,right:r}})},onShowFormulaView:function(){this.tableView.deselect(),this.updateFormulaHighlight()},onHideFormulaView:function(){this.updateFormulaHighlight()},updateFormulaHighlight:function(){this.$(".formula-editing").removeClass("formula-editing");var e=_.soak(m,"formulaView.getField()");if(e){var t=this.tableView.findColumnCells({field:e});if(0===t.length)throw new Error("Can't find column cells for field "+e.id);t.addClass("formula-editing")}},showContextMenu:function(e,t,n){e.preventDefault(),e.stopPropagation(),$(e.target).trigger("fieldbook:showmenu");var i=this.$(".floating-dropdown"),r=i.find(".dropdown-menu").first();i.removeClass("open"),r.html(n),r.data("context",t);var s={top:e.pageY,left:e.pageX},o=r.outerWidth(!0),a=$(window).width();s.left+o>a&&(s.left=a-o),i.offset(s),r.find(".dropdown-submenu").on("mouseover",function(){var e=$(this).find(".dropdown-menu"),t=e.offset(),n=e.width();t.left+n>a&&(t.left=s.left-n,e.offset(t))}),i.find(".dropdown-toggle").dropdown("toggle")},events:{"click .record-list-title .editable-title":"beginEditingTitle","keyup .handsontableInput":"onInput","focus .handsontableInput":"onInput",mousewheel:function(){this.onNextTick(this.updateIdAndName)},"focus [contenteditable]":function(e){this.onNextTick(function(){$(e.target).closest("th.data").addClass("editing"),$(e.target).selectText()})},"keydown [contenteditable]":function(e){var t=$(e.target),n=t.closest("thead th");if(e.which===c.COMMAND)e.stopPropagation();else if(e.which===c.RETURN){if(e.stopPropagation(),t.blur(),0===n.length)return;var i=this.tableView.columnIndexForHeaderCell(n);this.onNextTick(function(){this.tableView.select(0,i)})}else if(e.which===c.TAB&&!e.shiftKey){if(0===n.length)return;e.preventDefault();var r=this.tableView.columnIndexForHeaderCell(n),s=this.model.fields()[r+1];s?this.beginEditingHeaderWithKey(s.id):this.addField()}},"click thead th.data":"clickHeaderCell","focus .colHeader":function(e){var t=$(e.target).closest("th");t.find(".field-options").hide()},"blur .colHeader":function(e){var t=$(e.target).closest("th");t.find(".field-options").show()},"blur .record-list-title .editable-title":function(e){this.model.allowTitleRename&&this.captureActions(function(){var t=$(e.target),n=r.normalize(t.text());try{this.model.rename(n,{error:this.errorHandler("rename-"+this.model.type)})}finally{this.renderTitles()}})},"blur thead th.data":function(e){this.captureActions(function(){var t=$(e.target).closest("th");if(t.data("column")){var n=t.data("column").field;t.removeClass("editing"),n.rename(t.text(),{error:this.errorHandler("update-field-name")})}})},"click tbody th":function(e){if(e.ctrlKey)return void e.stopPropagation();var t=$(e.target).closest("tr"),n=this.tableView.rowIndexForTableRow(t);this.tableView.selectRow(n)},"click .add-field":"addField","click .table-view":function(e){$(":focus").not(e.target).blur()},"contextmenu thead th.data":"showFieldContextMenu","click .field-settings":"showFieldContextMenu","contextmenu tbody th":"showRowContextMenu","contextmenu .empty td.data":"showAggregateContextMenu","contextmenu tbody tr:not(.empty) td.data":"showCellContextMenu","click .record-list-settings":function(e){if(this.model.showDeleteListAction){var t={deleteActionTemplate:"delete-"+this.model.type,name:this.model.deleteTitle()};this.showContextMenu(e,this,u.partials.groupMenuItems(t))}},"click .rename-field":function(e){e.preventDefault();var t=$(e.target).closest(".rename-field");this.beginEditingHeaderWithKey(t.data("key"))},"click .make-name-field":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".make-name-field");t.is(".disabled")||this.model.sheet.setNameKey(t.data("key"),{error:this.errorHandler("set-name-field")})})},"click .add-link":function(e){e.preventDefault();var t=$(e.target).closest(".add-link"),n=this.model.fieldWithKey(t.data("key")),i=t.data("sheetId"),s=this.model.sheet.book().sheetWithId(i),o={fieldName:n.displayName(),sheetTitle:s.displayTitle()},a=function(){this.captureActions(function(){n.addLink(i,{success:this.showStatus({action:"add-link",context:o,undoable:!0}),error:this.errorHandler("add-link")})}.bind(this)),h.show({text:r["action-working-add-link"]})}.bind(this),l=s.get("stickyNameField");if(l&&s.nameField())a();else if(l)v.promptNameColumn({sheet:s,field:n}).then(function(e){e?s.restoreNameField({success:a}):a()});else{var c=new g({fromSheet:this.model.sheet,sheet:s,field:n});c.on("addlink-complete",function(e){s.setNameKey(e||null,{error:this.errorHandler("set-name-field")}),a()}.bind(this)),c.show()}},"click .set-aggregate":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".set-aggregate"),n=this.model.fieldWithKey(t.data("key"));n.setAggregate(t.data("type"),{error:this.errorHandler("set-aggregate")})})},"click .name-option:not(.disabled)":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".name-option"),n=t.data("key")||null,i=$(e.target).closest(".dropdown-menu").parents(".dropdown-menu").data("context").cell,r=i.data("column").field.linkedSheet();r.setNameKey(n,{error:this.errorHandler("set-name-field")})})},"click .set-formula":function(e){e.preventDefault();var t,n=$(e.target).closest(".set-formula"),i=this.model.fieldWithKey(n.data("key"));t="formula"===i.get("type")?i.get("expression").stringify(i.formulaSheet()):"",this.beginEditingFormulaField(i,t)},"click .extract-supersheet":function(e){e.preventDefault();var t=$(e.target).closest(".extract-supersheet");t.is(".disabled")||(this.captureActions(function(){var e=this,n=this.model.sheet;n.book().extractSupersheet(n,t.data("key"),{wait:!0,success:function(t){n.fetch(),a.router.goToSheet(t.id),e.showStatus({action:"extract-supersheet",context:t,undoable:!0})()},error:this.errorHandler("create-sheet")})}),h.show({text:r["action-working-extract-supersheet"]}))},"click .remove-link":function(e){e.preventDefault();var t=$(e.target).closest(".remove-link"),n=this.model.fieldWithKey(t.data("key")),i=n.linkedSheet();i&&(this.captureActions(function(){var e={fieldName:n.displayName(),sheetTitle:i.displayTitle()};n.removeLink({success:this.showStatus({action:"remove-link",context:e,undoable:!0}),error:this.errorHandler("remove-link")})}),h.show({text:r["action-working-remove-link"]}))},"click .delete-field":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".delete-field"),n=this.model.fieldWithKey(t.data("key"));this.model.deleteField(n,{success:this.showStatus({action:"delete-field",context:n,undoable:!0}),error:this.errorHandler("delete-field")})})},"click .hide-name-field":function(e){e.preventDefault(),this.hideNameField()},"click .toggle-name-field":function(e){e.preventDefault(),this.model.sheet.nameField()?this.hideNameField():this.captureActions(function(){this.model.sheet.restoreNameField(),this.tableView.tableOptions.fixedColumnsLeft=1,this.tableView.reset()})},"click .insert-record-above":function(e){this.insertRecordFromContextMenu(e,"above")},"click .insert-record-below":function(e){this.insertRecordFromContextMenu(e,"below")},"click .delete-record":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".delete-record"),n=t.data("id");if(n){var i=s.Record.find(n);this.model.destroyRecord(i,{error:this.errorHandler("delete-record")})}})},"click .delete-record-list":function(e){this.captureActions(function(){e.preventDefault();var t="delete-"+this.model.type;this.model.delete({success:this.showStatus({action:t,context:{name:this.model.deleteTitle()},undoable:!0}),error:this.errorHandler(t)})})}},clickHeaderCell:function(e){var t=$(e.target);if(!t.hasClosest(".add-field")){if(e.ctrlKey)return void e.stopPropagation();if(!t.hasClosest(".sort-option")&&!t.hasClosest(".group-option")){var n=new Date,i=t.closest("th"),r=i.data("lastClickTime");i.data("lastClickTime",n);var s=i.data("column");if(!s.isEditingHeader(i))if(n-r<this.doubleClickThreshold)this.tableView.deselect(),s.beginEditingHeader(i);else{var o=this.tableView.columnIndexForHeaderCell(i);this.tableView.selectColumn(o)}}}},deselect:function(){this.tableView.deselect()},selectionChanged:function(e,t,n,i,r){var s;_.any([e,t,n,i,r],_.isUndefined)||(s=this.getSelectionRegion()),this.trigger("selectionChanged",e,s)},getSelectionRegion:function(){var e=this.tableView.getSelected();if(e){var t=e[0],n=e[1],i=e[2],r=e[3],s=Math.min(t,i),o=Math.max(t,i),a=this,l=_.chain(s).range(o+1).map(function(e){return a.tableView.rowAt(e)}).value(),c=_.filter(l,function(e){return e&&e.hasData()}),u=Math.min(n,r),h=Math.max(n,r),d=_.chain(u).range(h+1).map(function(e){return e=a.tableView.columnAt(e),e.field}).compactNullish().value();return new p(c,d,l)}},selectChanges:function(e){var t=_.min(_.map(e,function(e){return e[0]})),n=_.max(_.map(e,function(e){return e[0]})),i=_.map(e,function(e){var t=e[1];if(_.isObject(t)){var n=_.find(this.tableView.columns,function(e){return e.field.get("key")===t.column.field.get("key")});return this.tableView.columns.indexOf(n)}return t}.bind(this)),r=_.min(i),s=_.max(i),o=this.tableView,a=[o.rowAt(t),o.rowAt(n),o.columnAt(r),o.columnAt(s)];!_.any(a,_.isUndefined)&&this.model.sortable&&this.tableView.setSelected([t,r,n,s])},onTableEdited:function(e,t,n){this.captureActions(function(){if(t){h.hide();var i=new o.EditProcessor({sheet:this.model.sheet,fields:this.model.fields()});if(i.processChanges(e,t),"paste"===n){var s=this;return this.model.saveBulkChanges(i.getRecordChanges(),{success:function(){h.hide(),s.addAfterNextRender(function(){s.selectChanges(t)})},error:this.errorHandler("update-record-paste")})}this.model.saveChanges(i.getRecordChanges(),{error:this.errorHandler("update-record")}),this.model.saveFormulaChanges(i.getFormulaChanges(),{error:this.errorHandler("update-field-formula")});var a=i.getFirstBadFormulaChange();if(a){var l=a.message;l||(l=_.template(r["error-parse-formula"],a)),h.show({type:"error",text:l}),this.onNextTick(function(){this.beginEditingCell(a.badFormulaRecord,a.field,a.badFormula)})}}}),"paste"===n&&h.show({text:r["action-working-paste-changes"]})},records:function(){return this.model.getAllRecords()},onColumnResized:function(e,t,n){this.captureActions(function(){var i=e.columnAt(t);if(n=e.getColWidth(t),i instanceof x){var r=i.field;r.resize(n,{error:this.errorHandler("update-field-width")})}})},onColumnMoved:function(e,t,n){this.captureActions(function(){this.model.moveField(t,n,{error:this.errorHandler("move-field")})})},onRowMoved:function(e,t,n){var i=t.data("id"),r=s.Record.find(i);if(!$.contains(this.el,t.get(0))){var o=t.closest(".record-list").data("view");return this.tableNeedsReset=o.tableNeedsReset=!0,this.model.removeRecord(r),void o.onRowMoved(e,t,n)}this.captureActions(function(){var e=n.index(t),i=e>0&&n.eq(e-1),o=n.eq(e+1),a=i&&i.data("id"),l=o&&o.data("id"),c=a&&s.Record.find(a),u=l&&s.Record.find(l),h={before:c,after:u};this.model.moveRecord(r,h,{error:this.errorHandler("reorder-record")})})},onKeyDown:function(e,t){if(t.metaKey&&t.which===c.RETURN){var n=t.shiftKey?"above":"below";this.insertRecordFromKeyboardShortcut(t,n)}},makeFieldContext:function(e){var t=e.data("column");if(!t||!t.field)return{};var n=t.field.toContext();if(n.showSearchAction=this.model.showSearchFieldAction,n.showGroupAction=this.model.showGroupFieldAction,n.showReportAction=this.model.showReportAction,n.linkedSheet){var i=new o.NameFieldSettings({sheet:t.field.linkedSheet()});n.nameMenuContext=i.toContext()}n.sheets=this.model.sheet.book().get("sheets").toContext();var r=_.findWhere(n.sheets,{_id:this.model.sheet.id});return r.isCurrent=!0,n.aggregates=this.generateAggregatesContext(t.field),n},makeRowContext:function(e){var t=e.data("id"),n=e.find("th"),i={id:t,number:n.text()};return i.id||(i.disabled=!0),i},showFieldContextMenu:function(e){var t,n=$(e.target).closest("th"),i=this.makeFieldContext(n),r=this.model.sheet.get("stickyNameField");n.is(".id-col")&&r?t=u.partials.idFieldMenuItems({hasName:this.model.sheet.nameField()}):n.is(".name-col")&&r?t=u.partials.nameFieldMenuItems(i):n.is(".id-col")||(t=u.partials.fieldMenuItems(i)),t&&this.showContextMenu(e,{cell:n},t),this.$(".floating-dropdown [title]").tooltip({placement:"right",container:".record-list"})},showRowContextMenu:function(e){var t=$(e.target).closest("tr"),n=this.makeRowContext(t);this.showContextMenu(e,{row:t},u.partials.recordMenuItems(n))},showCellContextMenu:function(e){var t=$(e.target).closest("td.data"),n=$(e.target).closest("tr"),i=n.data("id"),a=t.data("column"),l=s.Record.find(i),c=l&&l.getValue(a.key),h=c&&c.isRef(),d={row:this.makeRowContext(n),field:this.makeFieldContext(t),isRef:h};if(h){var f=new o.NameFieldSettings({record:c.linkedRecord()});d.nameMenuContext=f.toContext()}if(this.model.showSearchFieldAction){var p=c&&c.displayValue(),m=p&&p.toLowerCase();d.keyword=r.truncate(m,50),d.value=r.truncate(p,50)}var g=u.partials.cellMenuItems(d);this.showContextMenu(e,{row:n,cell:t},g)},showAggregateContextMenu:function(e){var t=$(e.target).closest("td"),n=t.data("column"),i=n.field.toContext();i.aggregates=this.generateAggregatesContext(n.field),this.showContextMenu(e,{cell:t},u.partials.aggregateMenuItems(i))},generateAggregatesContext:function(e){var t=e.getAggregate();return _.map(f.aggregates.fieldAggregates,function(e){var n=e.prototype.type;return{typeName:e.prototype.typeName,type:n,isCurrent:t===n}})},insertRecordFromContextMenu:function(e,t){e.preventDefault();var n=$(e.target).closest(".dropdown-menu"),i=n.data("context").row;if(i.data("id")){var r=this.tableView.rowIndexForTableRow(i);this.insertRecord(r,t)}},insertRecordFromKeyboardShortcut:function(e,t){var n=this.tableView.table.getSelected();if(n){e.stopImmediatePropagation();var i="above"===t?n[0]:n[2];this.insertRecord(i,t)}},insertRecord:function(e,t){this.captureActions(function(){var n=this.tableView.rowAt(e),i={error:this.errorHandler("insert-record")};"above"===t?(this.model.insertRecordAbove(n,i),this.tableView.select(e,0)):(this.model.insertRecordBelow(n,i),this.tableView.select(e+1,0))})},beginEditingCell:function(e,t,n){var i=this.tableView.rows.indexOf(e),r=_.findWhere(this.tableView.columns,{field:t}),s=this.tableView.columns.indexOf(r);this.tableView.beginEditing(i,s,n)},beginEditingHeaderWithKey:function(e){var t=this.columnForKey(e);if(t){var n=this.columns.indexOf(t);this.tableView.scrollToColumn(n);var i=this.tableView.$('thead th[data-key="'+e+'"]');t.beginEditingHeader(i)}},beginEditingFirstHeader:function(){var e=_.result(this.model,"sheet"),t=0;
e&&e.get("stickyNameField")&&e.nameField()&&(t=1);var n=this.model.fields()[t];this.beginEditingHeaderWithKey(n.id)},beginEditingTitle:function(){if(this.model.allowTitleRename){var e=this.$(".record-list-title .editable-title");e.is(":focus")||(e.text(this.model.editableTitleText()),e.focus())}},isEditingTitle:function(){return this.$(".record-list-title .editable-title").is(":focus")},endEditing:function(e){this.tableView.endEditing(e)},setPendingRecords:function(e){var t=_.pluck(e,"record");_.each(this.lastPendingChanges||[],function(e){var n=e.record;if(!_.contains(t,n)){var i=this.$('tr.record[data-cid="'+n.cid+'"]');i.addClass("pending-transition-temporary"),i.removeClass("pending-transition pending-"+e.action),_.delay(function(){i.removeClass("pending-transition-temporary")},300)}}.bind(this)),_.each(e,function(e){var t=this.$('tr.record[data-cid="'+e.record.cid+'"]');t.removeClass("pending-remove pending-sort"),t.addClass("pending-transition"),t.addClass("pending-"+e.action)}.bind(this)),this.lastPendingChanges=e},hasPendingRecords:function(){return this.lastPendingRecords?!_.isEmpty(this.lastPendingRecords):!1},addField:Tips.displayAfter(function(){this.captureActions(function(){var e=this.tableView.$(".add-field .relative"),t=this;this.endEditing(!1),this.addSpinner(e,{lines:10,rotate:30,length:4,width:1,radius:3}),this.model.addField({success:function(n){t.fieldAddedFromHere=n.id,t.stopSpinning(e)},error:this.errorHandler({action:"create-field",spinner:e})})})})});w.deferrableRendering(),w.deferrable("showDeleteStatusMessage"),t.exports=w;var x=l.ModelKeyColumn.extend({initialize:function(){this.field=this.options.field,this.showSortOption=this.options.showSortOption,this.showGroupOption=this.options.showGroupOption,this.recordList=this.options.recordList,this.listenTo(this.field,"change",this.update),this.update();var e=this;this.editor=function(t,n,r,s,o,a){return(e.field.isFormula()||e.field.isReportFormula())&&(a=e.field.editableFormula()),i.AutocompleteEditor.apply(null,arguments)},this.source=this.source},update:function(){var e=this.field;this.key=e.id,this.title=_.escape(e.get("name"))||"&nbsp;",this.width=e.get("width")},className:"data",decorateHeaderCell:function(e){x.__super__.decorateHeaderCell.apply(this,arguments),e.attr("data-key",this.key);var t=e.data("column").field,n=t.isNameField()&&t.sheet().get("stickyNameField");n||this.editableElement(e).attr("contenteditable",!0);var i=e.find(".relative");if(b.addTo(i.find(".colHeader"),t,".record-list"),this.field.isReportFormula()&&e.addClass("report-formula"),this.recordList.showHeaderButtons(this.field)){var r={showSortOption:this.showSortOption,showGroupOption:this.showGroupOption&&!this.field.isNameField()},s=u.partials.fieldHeaderButtons(r);i.append(s).find("[title]").tooltip({container:".record-list"})}x.editingHeaderKey===this.key&&(this.beginEditingHeader(e),x.editingHeaderKey=null)},cleanUpHeaderCell:function(e){this.isEditingHeader(e)&&(x.editingHeaderKey=this.key),x.__super__.cleanUpHeaderCell.apply(this,arguments),e.removeAttr("data-key"),this.editableElement(e).removeAttr("contenteditable")},get:function(e){return e&&e.getDisplayValue(this.key)},set:function(e,t){e.id||""===t||null==t||s.expressions.Expression.isFormula(t)||(e.attemptedChanges=e.attemptedChanges||{},e.attemptedChanges[this.field.get("key")]=t,e.isEmptyRow=!1)},render:function(e,t){e.removeClass("action");var i={container:".record-list"};if(this.field.isNameField()&&!t.synthetic&&(i.href=t.url()),t.id)d(e,t,this.key,i);else if(t.isEmptyRow)this.renderSummary(e);else if(t.attemptedChanges){var r=t.attemptedChanges[this.field.get("key")]||"";e.text(r)}else d(e,t,this.key,i);n(e,t),this.delegate&&this.delegate.onCellRender(this,e)},renderSummary:function(e){var t=this.recordList.summaryValue(this.field);if(null!==t){var n=u.partials.summaryCell({summaryValue:t.value.displayValue(),displayName:t.displayName});e.html(n)}else e.html("")},source:function(e,t){this.field.queryAutocompleteValues(e,t)},editableElement:function(e){return e.find(".colHeader")},isEditingHeader:function(e){return this.editableElement(e).is(":focus")},beginEditingHeader:function(e){this.editableElement(e).focus()},endEditingHeader:function(e){this.editableElement(e).blur()}}),k=l.Column.extend({className:"action",headerClassName:"add-field",title:r["add-field"],width:45,initialize:function(){this.readOnly=!0,this.movable=!1,this.recordList=this.options.recordList},render:function(e,t){e.removeClass("data"),this.recordList.showRecordLink&&t.id?e.html(u.partials.recordLink({url:t.url()})):e.empty(),n(e,t)}});dev.add("recordListView",function(){return w.displayedView()})},{"../../common/strings":13,"../../common/values":86,"../actions":38,"../fieldIcons":27,"../globalEvents":64,"../keys":4,"../models":33,"../models/expressions/expression":65,"../models/region":7,"../routing":82,"../table":104,"../viewModels":45,"./addLinkView":111,"./cellRender":56,"./formulaView":63,"./linkNameView":112,"./statusBarView":80,"./view":57,handsontable:"kwJIFI"}],76:[function(e,t){var n=e("handsontable"),i=e("../../common/strings"),r=e("../routing"),s=(e("../models"),e("../viewModels")),o=e("../table"),a=e("./view"),l=e("./statusBarView"),c=e("./recordListView"),u=e("./cellRender"),h=e("../models/region"),d=e("../fieldIcons"),f=e("../keys"),p=function(){return this.options.onBeginEditing&&this.options.onBeginEditing(this),n.TextEditor.apply(null,arguments)},m=o.ModelKeyColumn.extend({initialize:function(){this.editor=_.bind(p,this)},key:"name",className:"field",width:200,set:function(){},render:function(e,t){o.ModelKeyColumn.prototype.render.apply(this,arguments),d.addTo(e,t,"body")}}),g=o.Column.extend({initialize:function(){this.record=this.options.record;var e=this;this.editor=function(t,i,r,s,o,a){e.options.onBeginEditing&&e.options.onBeginEditing(e);var l=t.getDataAtRow(r);return l.isFormula()&&(a=l.editableFormula()),e.editingField=l,n.AutocompleteEditor.apply(null,arguments)},this.source=function(t,n){var i=e.editingField;return i?void i.queryAutocompleteValues(t,n):n([])}},className:"value",width:400,get:function(e){return this.record.getDisplayValue(e.id)},set:function(){},render:function(e,t){var n={container:".attributes"};u(e,this.record,t.id,n)}}),v=a.extend({className:"record-detail",initialize:function(){this.createView(),this.loadData()},remove:function(){_.invoke(this.recordListViews,"remove"),a.prototype.remove.apply(this,arguments)},loadData:function(){this.stopListening();var e=this;this.model.qfetchIfNeeded().then(function(){e.listenTo(e.model,"change",e.renderAttributesDeferred),e.listenTo(e.model,"sync",e.renderSubsheetsDeferred);var t=e.model.sheet();t&&(e.sheet||(e.sheet=t,e.listenTo(e.sheet,"change:title",e.renderHeaderDeferred),e.listenTo(e.sheet,"change:nameKey",e.renderHeaderDeferred),e.listenTo(e.sheet,"fields:add",e.renderAttributesDeferred),e.listenTo(e.sheet,"fields:change",e.renderAttributesDeferred),e.listenTo(e.sheet,"fields:remove",e.renderAttributesDeferred),e.listenTo(e.sheet,"fields:reset",e.renderAttributesDeferred),e.listenTo(e.sheet,"subsheets:add",e.renderSubsheetsDeferred),e.listenTo(e.sheet,"subsheets:change",e.renderSubsheetsDeferred),e.listenTo(e.sheet,"subsheets:remove",e.renderSubsheetsDeferred),e.listenTo(e.sheet,"subsheets:reset",e.renderSubsheetsDeferred)),e.sheet.fetchIfNeeded(),e.render(),e.listenTo(e.tableView,"afterSelection",e.selectionChanged),e.listenTo(e.tableView,"afterDeselect",e.selectionChanged))}).done()},createView:function(){this.$el.html(a.templates.record({showNameField:null!=this.model.sheet().nameField()})),this.tableView=new o.TableView({el:this.$(".attributes.table-view"),options:{afterChange:_.bind(this.onTableEdited,this)}})},renderHeader:function(){if(!this.sheet||!this.sheet.has("fields"))return void this.$(".record-header").hide();this.$(".record-header").show(),this.$(".sheet-title").text(this.sheet.displayTitle()),this.$(".sheet-title").attr("href",this.sheet.url());var e=null!=this.model.sheet().nameField(),t=this.model.shortName()||i.unnamed;if(this.$(".record-name").text(t),document.title=t,this.$(".short-id").text(this.model.displayId()).toggleClass("secondary",e),this.model.sheet().get("stickyNameField"))null==this.model.sheet().nameField()?(this.$(".record-name").css({display:"none"}),this.$(".name-shown-check").removeClass("icon-ok"),this.$(".name-hidden-check").addClass("icon-ok")):(this.$(".record-name").css({display:""}),this.$(".name-shown-check").addClass("icon-ok"),this.$(".name-hidden-check").removeClass("icon-ok"));else{var n=new s.NameFieldSettings({record:this.model,hasTitle:!0,useShortId:!0,showNameField:e}),r=a.partials.recordNameMenuItems(n.toContext());this.$(".name-menu").html(r),this.$(".name-menu").find(".disabled").tooltip({placement:"right",container:".record-detail",title:i["name-field-disabled-for-link"]}),this.model.sheet().nameField()?this.$(".record-name").show():this.$(".record-name").hide()}},renderAttributes:function(){this.renderHeader();var e=this.model,t=this.sheet&&this.sheet.get("fields");if(t){t.head().isNameField()&&(t=t.rest());var n=_.bind(this.onBeginEditing,this),i=[new m({onBeginEditing:n}),new g({record:e,onBeginEditing:n})];this.tableView.load({columns:i,rows:t})}},renderSubsheets:Tips.displayAfter(function(){_.invoke(this.recordListViews,"remove"),this.$(".subsheets").empty();var e={recordName:this.model.name()||i["this-record"],potentialSubsheets:this.sheet.potentialSubsheets()};this.$(".add-subsheet-group").html(a.partials.addSubsheetButtons(e));var t=this.sheet&&this.sheet.get("subsheets");if(this.$(".add-subsheet").attr("disabled",!t),t){if(t.length>0&&(!this.model.isLoaded()||!this.sheet.isLoaded()))return void this.$(".loading-subsheets").show();this.$(".loading-subsheets").hide();var n=this.model,r=t.map(function(e){return new s.SubsheetRecordList({subsheet:e,record:n})}),o=_.map(r,function(e){return new c({model:e})}),l=_.pluck(o,"$el");this.$(".subsheets").append(l),_.invoke(o,"renderColumnsAndRows"),this.recordListViews=o,this.bubble(o,"selectionChanged"),this.$(".subsheets").sortable({items:"> .record-list",axis:"y",handle:".record-list-header",tolerance:"pointer",update:_.bind(this.onSubsheetMoved,this)})}}),render:function(){this.model.isLoaded()&&this.sheet&&(this.renderAttributes(),this.renderSubsheets(),Tips.display(this))},events:{"click .name-option":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".name-option");if(!t.is(".disabled")){var n=t.data("key")||null;this.sheet.setNameKey(n,{error:this.errorHandler("set-name-field")})}})},"click .show-name":function(e){e.preventDefault(),this.sheet.nameField()||this.captureActions(function(){var t=$(e.target).closest(".show-name");t.is(".disabled")||this.sheet.restoreNameField()})},"click .hide-name":function(e){e.preventDefault(),this.sheet.nameField()&&this.captureActions(function(){var t=$(e.target).closest(".hide-name");t.is(".disabled")||this.sheet.deleteNameField()})},"click .add-subsheet":"addSubsheet","click .subsheets .record-list a":"onLinkClicked","focus .record-name":function(){this.onNextTick(function(){this.$(".record-name").selectText()})},"keydown .record-name":function(e){var t=this.$(".record-name");e.which===f.COMMAND?e.stopPropagation():e.which===f.RETURN&&(e.stopPropagation(),t.blur())},"blur .record-name":function(){var e=this.$(".record-name");this.captureActions(function(){var t=e.text().trim();this.model.saveName(t)})}},captureLink:function(e,t){if(/^\/records\//.test(t)){var n=$(e.target).closest(".record-list").data("view");if(n){var i=n.model;r.router.flash({recordIterator:i.recordIterator()})}}a.prototype.captureLink.apply(this,arguments)},beginEditingValue:function(e,t){var n=this.sheet.get("fields").indexOf(e),i=1;this.tableView.beginEditing(n,i,t)},addSubsheet:function(e){this.captureActions(function(){if(this.sheet){var t=$(e.target).closest(".add-subsheet"),n=!1,i={};t.data("sheetId")&&t.data("fieldKey")?(i.sheet={_id:t.data("sheetId")},i.field={key:t.data("fieldKey")}):n=!0;var r=this.$(".add-subsheet.btn");r.blur(),this.addSpinner(r,this.greyButtonSpinnerOptions);var s=this;this.sheet.addSubsheet(i,{wait:!0,success:function(e){if(s.stopSpinning(r),n){s.renderSubsheets();var t=_.find(s.recordListViews,function(t){return t.model.subsheet===e});t&&t.beginEditingTitle()}else s.model.markDirty(),s.model.fetch()},error:this.errorHandler({action:"create-subsheet",spinner:r})})}})},onBeginEditing:function(e){this.$(".handsontableInput").removeClass("field value"),this.$(".handsontableInput").addClass(e.className)},onTableEdited:function(e,t){this.captureActions(function(){if(t){l.hide();var n=this,r=new s.EditProcessor({sheet:this.sheet,record:this.model,transposed:!0});r.processChanges(e,t);var o=r.getRecordChanges(this.model);o&&!_.isEmpty(o.attributes)&&this.model.patch(o.attributes,o.previousAttributes,{error:this.errorHandler("update-record")});var a=r.getFieldChanges();_.each(a,function(e){var t=e.field;"name"in e&&t.rename(e.name,{error:n.errorHandler("update-field-name")}),"formula"in e&&t.saveFormula(e.formula,{error:n.errorHandler("update-field-formula")})});var c=r.getFirstBadFormulaChange();if(c){var u=c.message;u||(u=_.template(i["error-parse-formula"],c)),l.show({type:"error",text:u}),this.onNextTick(function(){this.beginEditingValue(c.field,c.badFormula)})}}})},onSubsheetMoved:function(e,t){this.captureActions(function(){var e=t.item.data("view"),n=e.model,i=this.$(".subsheets .record-list").index(t.item),r=this.sheet.get("subsheets");r.move(n.subsheet,i,{error:this.errorHandler("move-subsheet")})})},selectionChanged:function(e,t,n,i,r){var s;if(!_.any([e,t,n,i,r],_.isUndefined)){var o=([this.model],Math.min(t,i)),a=Math.max(t,i),l=_.chain(o).range(a+1).map(function(t){return e.rowAt(t)}).value();s=new h([this.model],l)}this.trigger("selectionChanged",e,s)}});v.deferrableRendering(),t.exports=v},{"../../common/strings":13,"../fieldIcons":27,"../keys":4,"../models":33,"../models/region":7,"../routing":82,"../table":104,"../viewModels":45,"./cellRender":56,"./recordListView":74,"./statusBarView":80,"./view":57,handsontable:"kwJIFI"}],77:[function(e,t){var n=e("../models"),i=(e("../viewModels"),e("./view")),r=e("./feedbackView"),s=e("./bookListView"),o=e("./bookView"),a=(e("./recordView"),e("./sheetView"),e("./statusBarView")),l=e("./helpView"),c=i.extend({className:"root",initialize:function(){this.model=this.model||n.Book.collection,this.$el.html(i.templates.root()),this.content=this.$(".content"),this.statusBarView=new a({el:this.$(".status-bar")}),$(".title-bar a").on("click",_.bind(this.onLinkClicked,this)),$(".title-bar [title]").tooltip({placement:"bottom"}),this.helpView=new l,this.helpView.$el.appendTo(this.$el.parent()),$(".title-bar .help-button").on("click",function(){this.helpView.helpClicked()}.bind(this)),$(".smokescreen").on("click",function(){this.helpView.hide()}.bind(this)),this.feedbackView=new r.FeedbackView,this.feedbackView.$el.appendTo(this.$el.parent()),$(".title-bar .feedback-button").on("click",this.feedbackView.show.bind(this.feedbackView))},isShowingBook:function(e){return e?this.mainView instanceof o&&this.mainView.model===e:!1},events:{"click a":"onLinkClicked"},showView:function(e){this.mainView&&this.mainView.remove(),this.mainView=e,this.$(".sheet-container").append(e.$el),e.render()},showBook:function(e){var t=n.Book.find(e);this.isShowingBook(t)?this.mainView.showBook():this.showView(new o({model:t}))},showSheet:function(e,t){var i=n.Sheet.find(e),r=i.book();this.isShowingBook(r)?this.mainView.showSheet(i,t):this.showView(new o({model:r,submodel:i,navKey:t}))},showRecord:function(e){var t=n.Record.find(e),i=t.sheet(),r=i&&i.book();this.isShowingBook(r)?this.mainView.showRecord(t):this.showView(new o({model:r,submodel:t}))},showBookList:function(){this.showView(new s({model:this.model}))},onFlash:function(e){"function"==typeof this.mainView.onFlash&&this.mainView.onFlash(e)}});t.exports=c},{"../models":33,"../viewModels":45,"./bookListView":71,"./bookView":113,"./feedbackView":73,"./helpView":67,"./recordView":76,"./sheetView":79,"./statusBarView":80,"./view":57}],79:[function(e,t){var n=e("../models"),i=e("../routing"),r=e("../keys"),s=e("./view"),o=e("./recordListView"),a=e("./reportRecordListView"),l=e("./powerbarView"),c=e("../../common/strings"),u=e("./index"),h=s.extend({className:"sheet-detail",tinySpinnerOptions:{lines:8,radius:2,length:3,width:2},initialize:function(){return this.viewModel=this.options.viewModel,this.listenTo(this.viewModel,"titleChanged",this.renderTitleDeferred),this.listenTo(this.viewModel,"sheetChanged",this.onSheetChanged),this.listenTo(this.viewModel,"queryChanged",this.renderQueryResultsDeferred),this.listenTo(this.viewModel,"queryTextChanged",this.renderQueryResultsDeferred),this.listenTo(this.viewModel,"groupsChanged",this.updateRecordListOrder),this.listenTo(this.viewModel,"load",this.renderDeferred),this.listenTo(this.viewModel,"fieldsChanged",this.renderGroupingMessage),this.listenTo(i.router,"route",this.renderPageTitle),this},renderSavedSearchQuery:function(){this.powerbarView&&this.powerbarView.renderSavedSearchQuery()},updateRecordListOrder:function(){var e=this.viewModel.recordLists(),t=this,n=[];_.each(this.recordListViews,function(e){e.$el.detach(),n.push(e)});var i,r=[];_.each(e,function(e){t.findOrCreateRecordListView(e,i,function(e,t){$(".table-container").append(e.$el),r.push(e),t&&e.render()}),i=e});var s=_.difference(n,r);_.invoke(s,"remove"),this.recordListViews=r,this.renderAppendGroupControl()},remove:function(){_.invoke(this.recordListViews,"remove"),s.prototype.remove.apply(this,arguments)},renderPageTitle:function(){"sheet"===i.observer.currentRoute.name&&(document.title=this.viewModel.title())},renderTitle:function(){var e=this.$(".sheet-title");e.is(":focus")||e.text(this.viewModel.title()),this.renderPageTitle()},renderTextWrap:function(){var e=this.$(".table-container");this.viewModel.sheet.get("wrapText")?e.addClass("wrapped"):e.removeClass("wrapped")},renderSheetActions:function(){var e=this.viewModel.sheet.attributes;this.$(".sheet-actions-menu").html(s.partials.sheetMenuItems(e))},onCellRender:function(e,t){t.removeHighlight(),this.viewModel.query&&this.viewModel.query.termsForKey(e.key).forEach(function(e){t.highlight(e)})},clearTables:function(){_.invoke(this.recordListViews,"remove"),this.recordListViews=[]},saveSelectionPosition:function(){var e,t=this,n=_.find(this.recordListViews,function(t,n){return e=n,!!t.isEditingTitle()});if(n)return void(this.restoreSelectionFunction=function(){var n=t.recordListViews[e];n&&n.beginEditingTitle()});if(n=_.find(this.recordListViews,function(t,n){return e=n,!!t.editingHeader()})){var i=n.editingHeader();return void(this.restoreSelectionFunction=function(){var n=t.recordListViews[e];n&&n.editHeader(i)})}if(n=_.find(this.recordListViews,function(t,n){return e=n,!!t.tableView.getSelected()})){var r=n.tableView.getSelected();return void(this.restoreSelectionFunction=function(){var n=t.recordListViews[e];n&&n.tableView.setSelected(r)})}this.restoreSelectionFunction=null},restoreSelectionPosition:function(){this.restoreSelectionFunction&&(this.restoreSelectionFunction(),this.restoreSelectionFunction=null)},renderAppendGroupControl:function(){var e=this.$(".append-group");return this.viewModel.isGrouped()?(0===e.length?(e=$(s.partials.insertGroup()),e.addClass("append-group")):e.detach(),this.viewModel.showGroupInsertActions()?this.$el.addClass("enable-insert-block"):this.$el.removeClass("enable-insert-block"),void this.$(".table-container").append(e)):void e.remove()},renderSortableGroupContainer:function(){if(!this.viewModel.allowGroupsSortable()){var e=this.$(".table-container");return void(e.hasClass("ui-sortable")&&e.sortable("destroy"))}this.$(".table-container").sortable({items:"> .record-list",axis:"y",handle:".record-list-header",tolerance:"pointer",update:_.bind(this.onGroupMoved,this)})},renderColumnsAndRows:function(){_.invoke(this.recordListViews,"renderColumnsAndRows")},findOrCreateRecordListView:function(e,t,n){var i=_.find(this.recordListViews,function(t){return t.model===e}),r=!i;return i||(i=this.createRecordListView(e,t)),n(i,r),i},createRecordListView:function(e,t){var n={model:e,parent:this,numberOfShownTitles:e.numberOfShownTitles(t)},i=o;return"report"===e.type&&(i=a),new i(n)},removeRecordListView:function(e){e&&(e.remove(),this.recordListViews=_.without(this.recordListViews,e))},renderGroupingMessage:function(){var e=this.viewModel.groupFields(),t=this.$(".grouping-message");if(_.isEmpty(e))return void t.hide();var n=_.map(e,function(e){var t=e.displayName();return{name:t,isEnum:e.isEnum(),key:e.get("key")}}),i=_.filter(n,function(e){return e.isEnum});t.html(s.partials.groupingMessage({fields:n,anyCustomOrder:i.length>0,customOrderFields:i})),t.show()},renderQueryResults:function(){this.viewModel.recordLists();return this.powerbarView&&this.powerbarView.renderSaveSearchButton(),this.renderTablesDeferred()},updatePendingRecords:function(){var e=_.find(this.recordListViews,function(e){return!!e.getSelectionRegion()}),t=[];e&&(t=e.getSelectionRegion().allRecords);var n,i=this.viewModel.recordLists(),r=this.recordListViews.indexOf(e);i&&(n=i[r]);var s,o,a=_.chain(i).invoke("getAllRecords").flatten(!0).value(),l=e&&e.model,h=this.pendingChangesForRecords(t,l,n,a),d={query:this.viewModel.queryString()};if(_.isEmpty(h)){if(!_.isEmpty(this.lastPendingChanges)){var f=this.pendingChangesForRecords(_.pluck(this.lastPendingChanges,"record"),l,n,a);_.isEmpty(f)?u.StatusBarView.hide({force:!0}):(s=this.lastPendingChanges[0].action,o=_.template(c["pending-records-done-"+s],d),u.StatusBarView.show({text:o}))}}else s=h[0].action,o=_.template(c["pending-records-"+s],d),u.StatusBarView.show({text:o},{permanent:!0});e&&e.setPendingRecords(h),this.lastPendingChanges=h},deselectAllLists:function(){_.invoke(this.recordListViews,"deselect")},pendingChangesForRecords:function(e,t,n,i){var r=[];return _.each(e,function(e){e.isEmptyRow||(n&&-1!==n.getIndexForRecord(e)?t&&t.getIndexForRecord(e)!==n.getIndexForRecord(e)&&r.push({record:e,action:"sort"}):r.push(_.contains(i,e)?{record:e,action:"sort"}:{record:e,action:"remove"}))}),r},hasPendingRecords:function(){return this.recordListViews&&_.any(this.recordListViews,function(e){return e.hasPendingRecords()})},renderTables:function(){return this.skipChangingRecordLists?(this.wantsRenderTables=!0,void this.updatePendingRecords()):(this.updatePendingRecords(),void this.renderTipsAndTables())},renderTipsAndTables:Tips.displayAfter(function(){if(!this.viewModel.needsFetch()){this.renderGroupingMessage();var e=this.$el.parent().scrollTop(),t=this.$(".table-container");if(0===t.length)return void this.render();this.saveSelectionPosition();var n,i=this.viewModel.recordLists(),r=this,s=_.map(i,function(e){var i=r.findOrCreateRecordListView(e,n,function(e,n){n&&(t.append(e.$el),e.render())});return n=e,i}),o=_.difference(this.recordListViews,s);_.each(o,_.bind(this.removeRecordListView,this));var a=_.any(s,function(e,t){return r.recordListViews.indexOf(e)!==t});if(a){_.each(this.recordListViews,function(e){e.$el.detach()});var l;_.each(s,function(e){t.append(e.$el),e.updateShownTitles(l),l=e})}this.recordListViews=s,this.listenToViews(s),this.renderAppendGroupControl(),this.renderSortableGroupContainer(),this.restoreSelectionPosition(),this.renderHighlights(),this.$el.parent().scrollTop(e),this.positionForAutocomplete()}}),listenToViews:function(e){_.each(e,function(e){this.stopListening(e),this.listenTo(e,"selectionChanged",function(t,n){this.onSelectionChanged(e,t,n)})}.bind(this))},onSelectionChanged:function(e,t,n){var i=!1;this.lastSelectedRecords&&(n&&_.isEqual(this.lastSelectedRecords,n.allRecords)?this.skipChangingRecordLists=!0:(this.skipChangingRecordLists=!1,i=!0)),this.lastSelectedRecords=n&&n.allRecords,this.trigger("selectionChanged",t,n),i&&this.wantsRenderTables&&(this.wantsRenderTables=!1,this.renderTables())},renderHighlights:function(){if(this.$el.removeHighlight(),this.viewModel.query){var e=this;this.$el.find(".record td.data").each(function(){var t=$(this),n=t.data("column");n&&_.each(e.viewModel.query.termsForKey(n.key),function(e){t.highlight(e)})})}},context:function(){return this.viewModel.toContext()},renderSheet:function(){this.$el.html(s.templates.sheet(this.context())),this.renderPowerbar(),this.renderTitle(),this.renderSheetActions(),this.renderTextWrap(),this.renderTables()},renderPowerbar:function(){this.powerbarView||(this.powerbarView=new l({viewModel:this.viewModel,el:this.$el.find(".powerbar")})),this.powerbarView.render()},render:Tips.displayAfter(function(){return this.viewModel.needsFetch()?this.viewModel.load():(this.saveSelectionPosition(),this.clearTables(),this.renderSheet(),void this.restoreSelectionPosition())}),onGroupMoved:function(e,t){var n=this;n.captureActions(function(){var e=n.$(".record-list").get(),i=e.map(function(e){return $(e).data("view").model}),r=$(t.item[0]).data("view").model,s=_.indexOf(i,r);n.viewModel.moveGroup(r,s,{error:n.errorHandler("reorder-group")})})},events:{"click a":"onLinkClicked","click .remove-custom-order":function(e){var t=this;t.captureActions(function(){var n=$(e.target).closest(".remove-custom-order").data("key");t.viewModel.removeCustomOrder(n,{error:t.errorHandler("reorder-group")})})},"click .ungroup":function(e){this.captureActions(function(){var t=$(e.target).closest(".ungroup").data("key");this.viewModel.ungroup(t)})},"focus .sheet-title":function(){this.onNextTick(function(){var e=this.$(".sheet-title");e.text(this.viewModel.editableTitleText()),e.selectText()})},"keydown .sheet-title":function(e){var t=$(e.target);e.which===r.COMMAND?e.stopPropagation():e.which===r.RETURN?(e.stopPropagation(),t.blur(),this.onNextTick(function(){this.beginEditingFirstHeader()})):e.which!==r.TAB||e.shiftKey||this.onNextTick(function(){this.beginEditingFirstHeader()})},"blur .sheet-title":function(e){this.captureActions(function(){var t=$(e.target),n=t.text().trim();this.viewModel.saveTitle(n,{error:this.errorHandler("update-title")}),this.renderTitle()})},"click .wrap-text":function(e){this.captureActions(function(){e.preventDefault();var t=this.viewModel.sheet;t.saveIfNeeded("wrapText",!t.get("wrapText"))})},"click .insert-group-button":function(e){this.viewModel.showGroupInsertActions()&&this.captureActions(function(){var t=$(e.target).closest(".insert-group-block"),n=this.$(".insert-group-block").index(t);this.viewModel.insertGroup(n,{error:this.errorHandler("insert-group")}),this.$(".record-list-title .editable-title").eq(n).focus()})},"click .search-field":function(e){e.preventDefault();var t=$(e.target).closest(".search-field"),n=this.viewModel.fieldWithKey(t.data("key")),i=_.soak(this.viewModel,"query.stringify()")||"",r=n.slug()+":";i.length>0&&" "!==i.slice(-1)&&(r=" "+r),this.viewModel.setQueryText(i+r),$(".chit-well").view().render();var s=$(".chit:not(:empty):last");s.focus(),s.view().setCursorPosition("end")},"click .search-cell-value":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".search-cell-value"),i=n.Record.find(t.data("id")),r=i.getDisplayValue(t.data("key"));this.viewModel.addKeyword(r.toLowerCase())})},"click .filter-cell-value":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".filter-cell-value"),i=n.Record.find(t.data("id")),r=i.getDisplayValue(t.data("key"));this.viewModel.addFilter(t.data("key"),r)})},"click .report-on-field":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".report-on-field").data("key");this.viewModel.reportOn(t)})},"click .sort-option":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest("th").data("key");this.deselectAllLists(),this.viewModel.toggleSortField(t)})},"click .group-option":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest("th").data("key");this.deselectAllLists(),this.viewModel.groupBy(t)})},"click .group-field":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".group-field");t.is(".disabled")||this.viewModel.groupBy(t.data("key"))})},"autocomplete:change":function(){this.onNextTick(this.positionForAutocomplete)}},beginEditingTitle:function(){this.$(".sheet-title").focus()},beginEditingFirstHeader:function(){this.recordListViews[0].beginEditingFirstHeader()},captureLink:function(e,t){/^\/records\//.test(t)&&i.router.flash({recordIterator:this.viewModel.recordIterator()}),s.prototype.captureLink.apply(this,arguments)},onSheetChanged:function(){this.renderSheetActionsDeferred(),this.renderTextWrapDeferred()},onFlash:function(e){e.editSheetTitle&&this.onNextTick(this.beginEditingTitle)},positionForAutocomplete:function(){var e=this.$(".autocomplete"),t=0;e.is(":visible")&&(t=e.outerHeight()+20);var n=this.$(".sheet-toolbar");n.css("margin-bottom",t);var i=n[0].getBoundingClientRect().height+t;this.$(".table-view.absolute").css("margin-top",i)}});h.deferrableRendering(),dev.add("sheetView",function(){return h.displayedView()}),dev.add("sheet",function(){return dev.sheetView.viewModel.sheet}),t.exports=h},{"../../common/strings":13,"../keys":4,"../models":33,"../routing":82,"./index":68,"./powerbarView":81,"./recordListView":74,"./reportRecordListView":75,"./view":57}],65:[function(e,t){var n=e("../../../common/strings"),i=e("../../../common/appError"),r=e("../../parser"),s=e("../../../common/values"),o=e("../../../common/errors"),a=t.exports=function(e,t){this.command=t,_.isString(e)&&(e={field:e}),_.extend(this,e);var n=this;_.each(this.expressionKeys,function(e){n[e]&&(n[e]=a.make(n[e],t))}),this.arguments&&(this.arguments=_.map(this.arguments,function(e){return a.make(e,t)}))},l=a.ParseError=i.extend({name:"ParseError",initialize:function(e){this.cause=e,this.message=e.message}}),c=a.ValidationError=o.DisplayableError.extend({name:"ValidationError"});a.make=function(e,t){return e instanceof a?(e.command=t,e):new a(e,t)},a.isFormula=function(e){var t=e;return s.isValueObject(e)&&(t=e.displayValue()),_.isString(t)&&"="===t[0]},a.parse=function(e,t,n){n=_.defaults(n||{},{partialAllowed:!1});var i=e;if(s.isValueObject(e)&&(i=e.displayValue()),!i)return null;"="===i[0]&&(i=i.slice(1));var o;try{o=n.partialAllowed?r.parsePartialFormula(i):r.parseFormula(i)}catch(a){throw new l(a)}var c=this.make(o);if(t){c.validate(t,n);var u=c.boundTerms(t);c=this.make(u)}return c},a.createOrder=function(e,t){var n={ascending:e,op:"order"},i=new a(n,t.command);return i.expr1=t,i},a.createAggregate=function(e,t,n){var i={op:"fn",name:e,arguments:t};return new a(i,n)},a.functions={length:{rawValues:!0,func:function(e){return e?e.displayValue().length:0}},isblank:{rawValues:!0,func:function(e){return e.isEmpty()}},abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:{args:2,func:Math.atan2},ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,pow:{args:2,func:Math.pow},random:{args:0,func:Math.random},round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,percent:function(e){return _.isNumber(e)?new s.types.PercentValue(e):e},currency:function(e){return _.isNumber(e)?new s.types.CurrencyValue(e):e}},a.functionConfig={},_.each(a.functions,function(e,t){var n=e;_.isFunction(e)?n={minArgs:1,maxArgs:2,func:e}:void 0!==n.args&&(n.minArgs=n.args,n.maxArgs=n.args),a.functionConfig[t]=_.defaults(n,{minArgs:1,maxArgs:1})}),_.each(s.aggregates.expressionAggregates,function(e){var t=e.prototype.functionName,n=e.prototype.minArgs;null==n&&(n=1);var i=e.prototype.maxArgs;null==i&&(i=1),a.functionConfig[t]={minArgs:n,maxArgs:i,aggregate:!0,rawValues:!0,func:function(t){var n=new e([t]);return n.perform()}}}),a.getFunctionConfig=function(e){return e in a.functionConfig?a.functionConfig[e]:null},_.extend(a.prototype,{expressionKeys:["expr","expr1","expr2","cond","then","else"],bindCopyKeys:["op","name","val","key","ascending"],isAggregate:function(){var e=this.getFunctionConfig();
return e?e.aggregate:!1},aggregateValueForRecords:function(e){if(this.arguments){var t=this,n=_.map(e,function(e){return 0===t.arguments.length?s.createEmpty():t.arguments[0].evaluate(e)});return this.getFunction().call(this,n)}return s.createEmpty()},getCompletionContext:function(){if(this.completionContext)return this.completionContext;var e,t=this;return _.each(this.expressionKeys,function(n){e=e||t[n]&&t[n].getCompletionContext()}),e},clone:function(){var e=_.keys(this);e=_.without(e,"command");var t=_.pick(this,e);return new a(t,this.command)},rightExprKey:function(){return this.expr2?"expr2":this.expr1?"expr1":this.expr?"expr":this.else?"else":this.then?"then":this.cond?"cond":null},rightExpr:function(){var e=this.rightExprKey();return e?this[e]:null},cursorExprKey:function(){return _.find(this.expressionKeys,function(e){return this[e]&&this[e].hasCursor()},this)},cursorExpr:function(){var e=this.cursorExprKey();return e?this[e]:null},lastExpr:function(){var e=this.rightExpr();return e?e.lastExpr():this},replace:function(e,t){return this[e]=a.make(t,this.command),this},replaceRightExpr:function(e){return this.replace(this.rightExprKey(),e)},replaceCursorExpr:function(e){return this.replace(this.cursorExprKey(),e)},replaceLastArgument:function(e){var t=a.make(e,this.command);return this.arguments[this.arguments.length-1]=t,this},replaceCursorArgument:function(e){var t=a.make(e,this.command);return _.find(this.arguments,function(e,n){var i=e.hasCursor();return i&&(this.arguments[n]=t),i},this),this},getCursorArgument:function(){return _.find(this.arguments,function(e){return e.hasCursor()})},addArgument:function(e){return this.arguments.push(a.make(e,this.command)),this},setComplete:function(){return this.cursor=!1,_.invoke(this.arguments,"setComplete"),_.each(this.expressionKeys,function(e){var t=this[e];t&&t.setComplete()},this),this},validateReportExpression:function(){if('"'!==this.op&&"'"!==this.op||""!==this.val){if("fn"!==this.op)throw new c("error-report-formula-not-aggregate");if(!this.isAggregate())throw new c("error-report-formula-not-aggregate",{name:this.name});if(this.arguments.length>1)throw new c("error-report-formula-too-many-args");var e=this.getFunctionConfig();if(this.arguments.length<this.getFunctionConfig().minArgs)throw new c("error-report-formula-too-few-args",{name:this.name,count:e.minArgs})}},validate:function(e,t){if(this.hasField()){var n=this.findField(e);if(!n){var i;throw i=this.field?"error-formula-unknown-field-named":"error-formula-unknown-field",new c(i,{input:this.field})}if(t.forbiddenFields&&_.each(t.forbiddenFields,function(e){if(_.isEqual(e,n))throw new c("error-formula-circular",{key:n.slug()})}),n.isFormula()){var r=_.clone(t.forbiddenFields)||[];r.push(n),n.get("expression").validate(e,{forbiddenFields:r})}}if("fn"===this.op){var s=this.getFunction();if(!_.isFunction(s))throw new c("error-formula-unknown-function",{name:this.name})}if("."===this.op){this.expr1.validate(e,t);var a;try{a=this.expr1.getLinkedSheet(e)}catch(l){throw l instanceof o.UnknownContext?new c("error-formula-field-not-link",{dotExprLeft:this.expr1.stringify(e)}):l}if(!a)throw new c("error-formula-field-not-link",{dotExprLeft:this.expr1.stringify(e)});this.expr2.validate(a,t)}else{var u=this;_.each(this,function(n,i){_.contains(u.expressionKeys,i)?n.validate(e,t):"arguments"===i&&_.each(u.arguments,function(n){n.validate(e,t)})})}},getFunction:function(){var e=this.getFunctionConfig();return e?e.func:null},getFunctionConfig:function(){if("fn"===this.op){var e=this.name.toLowerCase();return a.getFunctionConfig(e)}return null},addMatch:function(e,t){this.command&&this.command.addMatch(e,t)},boundTerms:function(e){this.field&&!this.key&&(this.key=this.keyId(e));var t={};this.cursor&&(t.cursor=this.cursor);var n=this;if("."===this.op){t.op=this.op,t.expr1=this.expr1.boundTerms(e);var i=this.expr1.getLinkedSheet(e);t.expr2=this.expr2.boundTerms(i)}else _.each(_.keys(this),function(i){_.contains(n.expressionKeys,i)?t[i]=n[i].boundTerms(e):_.contains(n.bindCopyKeys,i)?t[i]=n[i]:"arguments"===i&&(t[i]=_.invoke(n.arguments,"boundTerms",e))});return t},hasCursor:function(){return this.cursor},keyId:function(e){var t=this.findField(e);return t&&t.id},findField:function(e){var t=this,n=e.getFields();return n.find(this.key?function(e){return e.id===t.key}:function(e){return e.nameMatch(t.field)})},binaryOperators:{"+":"+","-":"-","*":"*","/":"/","^":"^","=":"=","!=":"!=","<":"<",">":">","<=":"<=",">=":">=",and:"and",or:"or","<>":"!=","&":"and","&&":"and","|":"or","||":"or","**":"^"},unaryOperators:{neg:"-",not:"not","!":"!"},hasOp:function(){return _.has(this,"op")},hasField:function(){return _.has(this,"key")||_.has(this,"field")},isEmpty:function(){return!this.hasOp()&&!this.hasField()},getLinkedSheet:function(e){if(this.hasField()){var t=this.findField(e);if(t&&t.isLink()&&t.linkedSheet())return t.linkedSheet();throw new o.UnknownContext("error-unknown-context",{name:this.field||n["unknown-field"]})}if("."===this.op){var i=this.expr1.getLinkedSheet(e);return this.expr2.getLinkedSheet(i)}throw new Error("not a dotExpr")},stringify:function(e,t){t=t||{};var i;if(this.hasField()){var r=this.findField(e);return _.soak(r,"slug()")||null}if(this.op in this.binaryOperators)return this.expr1.stringify(e,t)+" "+this.op+" "+this.expr2.stringify(e,t);if("."===this.op){var s=this.expr1.getLinkedSheet(e);return this.expr1.stringify(e,t)+"."+this.expr2.stringify(s,t)}if(":"===this.op)return this.expr1.stringify(e,t)+":"+this.expr2.stringify(e,t);if("neg"===this.op)return"-"+this.expr.stringify(e,t);if("not"===this.op)return"not "+this.expr.stringify(e,t);if("!"===this.op)return"!"+this.expr.stringify(e,t);if("if"===this.op)return i="if "+this.cond.stringify(e,t),this.then&&(i+=" then "+this.then.stringify(e,t)),this.else&&(i+=" else "+this.else.stringify(e,t)),i;if("fn"===this.op){var o=this.name.toLowerCase();return i=o+"("+_.invoke(this.arguments,"stringify",e,t).join(", "),this.cursor||(i+=")"),i}if("bareword"===this.op)return this.val;if("("===this.op)return i="("+this.expr.stringify(e,t),this.cursor||(i+=")"),i;if('"'===this.op)return i='"'+n.escapeChars(this.val,'"'),this.cursor||(i+='"'),i;if("'"===this.op)return i="'"+n.escapeChars(this.val,"'"),this.cursor||(i+="'"),i;if("order"===this.op){var a=this.ascending?" asc":" desc";return this.expr1.stringify(e,t)+a}if(this.getCompletionContext()&&t.includeCompletionContexts)return this.getCompletionContext().name;if(this.hasOp()){if("NONE"===this.op)return this.expr1.stringify(e,t)+this.expr2.stringify(e,t);throw new Error('unsupported operator "'+this.op+'"')}return""},nameify:function(e){if(this.hasField()){var t=this.findField(e);return _.soak(t,"displayName()")||""}if("fn"===this.op){var i=n.capitalize(this.name.toLowerCase());return this.arguments&&this.arguments.length>0?i+" of "+_.invoke(this.arguments,"nameify",e).join(", "):i}return'"'===this.op||"'"===this.op?this.val:this.stringify(e)},evaluate:function(e){try{return this.evaluateUnsafe(e)}catch(t){if(t instanceof o.ExecutionError)return s.makeError(t);throw t}},evaluateUnsafe:function(e){var t,n;if(void 0!==this.val)return'"'===this.op||"'"===this.op?new s.types.StringValue(this.val):s.create(this.val);if(this.hasField())return t=this.keyId(e),t?e.getValue(t):s.createEmpty();if("."===this.op){if(n=this.expr1.evaluateUnsafe(e),!n.isRef())return s.createEmpty();var i=n.linkedRecord();return i?this.expr2.evaluateUnsafe(i):s.createEmpty()}if(":"===this.op){t=this.expr1.keyId(e),n=this.expr1.evaluateUnsafe(e);var r=this.expr2.evaluateUnsafe(e);return this.addMatch(r.displayValue(),t),n.performOperation(this.op,r)}if(this.op in this.binaryOperators){var a=this.binaryOperators[this.op];return this.expr1.evaluateUnsafe(e).performOperation(a,this.expr2.evaluateUnsafe(e))}if("neg"===this.op)return this.expr.evaluateUnsafe(e).performOperation(this.op);if("not"===this.op||"!"===this.op)return this.expr.evaluateUnsafe(e).performOperation("!");if("("===this.op)return this.expr.evaluateUnsafe(e);if("if"===this.op)return this.cond.evaluateUnsafe(e).booleanValue()?this.then?this.then.evaluateUnsafe(e):s.createEmpty():this.else?this.else.evaluateUnsafe(e):s.createEmpty();if("fn"===this.op){var l=this.getFunction();if(!_.isFunction(l))throw new o.ExecutionError("error-formula-unknown-function",{name:this.name});var c=_.invoke(this.arguments,"evaluateUnsafe",e),u=this.getFunctionConfig();return u.rawValues||(c=_.pluck(c,"value")),u.aggregate&&(c=[c]),s.create(l.apply(Math,c))}if("order"===this.op)throw new Error("Cannot order (ascending/descending) except at top level of a sort");if(this.isEmpty())return s.createEmpty();throw new Error('unsupported operator "'+this.op+'"')},isOrder:function(){return"order"===this.op},isLValue:function(){return!!this.hasField()},isAssignment:function(){return"="===this.op&&this.expr1.isLValue()},executeAssignment:function(e){var t=this.expr1.keyId(e);return t?void e.setPending(t,this.expr2.evaluateUnsafe(e)):(console.log('warning: unknown field in assignment: "'+this.field+'"'),null)},isSimpleField:function(){return this.hasField()},isSimpleFieldFor:function(e){return this.hasField()?this.key===e.get("key")||e.nameMatch(this.field)?!0:!1:!1},contextify:function(e){var t=this,n={cid:this.cid};if(this.completionContext&&(n.completionText=this.completionContext.name),this.hasField()){var i=this.findField(e);return n.slug=_.soak(i,"slug()")||null,n}if(this.val)return n.val=this.val,n.quoteChar="bareword"===this.op?"":this.op,n;if(_.each(_.keys(this),function(i){_.contains(t.expressionKeys,i)?n[i]=t[i].contextify(e):_.contains(t.bindCopyKeys,i)?n[i]=t[i]:"arguments"===i&&(n[i]=_.invoke(t.arguments,"contextify",e))}),this.op in this.binaryOperators||"."===this.op||":"===this.op){if(n.isBinary=!0,n.spaceAroundOp=this.op in this.binaryOperators,"."===this.op){var r=this.expr1.getLinkedSheet(e);n.expr2=this.expr2.contextify(r)}}else this.op in this.unaryOperators?(n.isUnary=!0,n.spaceAroundOp="not"===this.op):"("===this.op?n.isParen=!0:"if"===this.op?n.isIf=!0:"fn"===this.op?n.isFunction=!0:"order"===this.op&&(n.isOrder=!0,n.ascending=this.ascending);return n}})},{"../../../common/appError":30,"../../../common/errors":31,"../../../common/strings":13,"../../../common/values":86,"../../parser":28}],60:[function(e,t,n){var i=e("../expressions/expression"),r=e("./results"),s=e("../../../common/strings"),o=e("../../../common/extendable"),a=e("../record"),l=e("../sheet"),c=(e("../field"),e("../../viewModels/reportRecordList")),u=e("../../../common/values"),h="default",d=n.lookup=function(e){return e=e||h,f[e]},f={},p=n.addToRegistry=function(e,t){f[e]=t},m=(n.commandsMatching=function(e){return _.filter(f,function(t){return 0===t.prototype.canonicalName.indexOf(e)})},n.isCommand=function(e){return!!f[e]},n.PowerBarCommand=function(){this.initialize.apply(this,arguments)});_.extend(m.prototype,{minArgs:1,hasParens:!1,isValid:!0,initialize:function(e,t){e=e||{},this.query=t,this.cursor=e.cursor,this.expressions=this.parseArguments(e.arguments)||[],this.setupOperation()},hasCommandName:!0,contextify:function(e){var t={cid:this.cid,icon:this.icon,hasParens:this.hasParens};return this.hasCommandName&&(t.name=this.completionName()),t.expressions=_.invoke(this.expressions,"contextify",e),t},clone:function(){var e=this.constructor,t=new e({cursor:this.cursor},this.query);return t.expressions=_.invoke(this.expressions,"clone"),t},isWhere:function(){return!1},isDefaultWhere:_.constant(!1),completionName:function(){return this.canonicalName},hasNoArguments:function(){return 0===this.expressions.length},isSort:function(){return!1},isGroup:function(){return!1},isReport:function(){return!1},isComplete:function(){return!this.cursor&&this.expressions.length>=this.minArgs},validate:function(e,t){return _.each(this.expressions,function(n){return n.validate(e,t)})},argsComplete:function(){return this.expressions.length<this.minArgs?!1:_.every(this.expressions,function(e){return!e.hasCursor()})},setComplete:function(){return this.cursor=!1,_.invoke(this.expressions,"setComplete"),this},areArgsComplete:function(){return 0===this.expressions.length||!_.last(this.expressions).cursor},canTakeMoreArgs:function(){return void 0===this.maxArgs||this.expressions.length<this.maxArgs},addArgument:function(e){return this.expressions.push(i.make(e,this)),this},replaceLastArgument:function(e){return this.expressions.pop(),this.addArgument(e)},getCompletionContext:function(){if(this.completionContext)return this.completionContext;var e;return _.each(this.expressions,function(t){e=e||t.getCompletionContext()}),e},replaceCursorArgument:function(e){var t=i.make(e,this),n=_.find(this.expressions,function(e,n){var i=e.cursor;return i&&(this.expressions[n]=t),i},this);if(!n){var r=this.expressions.length-1;0>r&&(r=0),this.expressions[r]=t}return this},getCursorArgument:function(){return _.find(this.expressions,function(e){return e.hasCursor()})},addMatch:function(e,t){this.query.addMatch(e,t)},parseArguments:function(e){var t=this;return _.map(e,function(e){return i.make(e,t)})},setupOperation:function(){},transformResult:function(e){var t=this,n=_.map(e.recordLists,function(e){return t.transformRecords(e)});return new r.Results(n)},transformRecords:function(e){var t=this,n=e.records.filter(function(e){return t.acceptRecord(e)});return r.createRecordListFromList(e,n)},stringifyExpressions:function(){return this.expressions},stringify:function(e,t){var n,i=_.map(this.stringifyExpressions(t),function(n){return n.stringify(e,t)});return this.hasParens?n=this.canonicalName+"("+i.join(", ")+")":(n=this.canonicalName,i.length&&(n+=" "+i.join(", "))),n},nameify:function(e){return this.stringify(e)},boundTerms:function(e){var t=_.map(this.expressions,function(t){return t.boundTerms(e)}),n={cmd:this.bindCommandString(),arguments:t};return this.cursor&&(n.cursor=this.cursor),n},bindCommandString:function(){return this.canonicalName},explain:function(){return null}}),m=o(m);var g=t.exports.WhereCommand=m.extend({canonicalName:"where",icon:"filter",isWhere:function(){return!0},acceptRecord:function(e){return _.every(this.expressions,function(t){return t.isEmpty()?!0:t.evaluate(e).booleanValue()})},explain:function(e){return _.template(s["command-where-tip"],{formula:_.invoke(this.expressions,"stringify",e).join(" ")})}});p("where",g);var v=(n.DefaultWhere=g.extend({maxArgs:0,isDefaultWhere:_.constant(!0),hasCommandName:!1,icon:"search",boundTerms:function(e){var t=this.expressions[0].boundTerms(e),n={cmd:t.expr1,arguments:[t.expr2]};return n},stringify:function(e,t){return _.invoke(this.stringifyExpressions(t),"stringify",e,t).join(" ")},explain:function(e){var t=this.expressions[0].boundTerms(e);return _.template(s["command-column-search-tip"],{column:e.getFields().get(t.expr1.key).get("name"),keyword:t.expr2.val})},completionName:function(){return null}}),n.SearchCommand=m.extend({canonicalName:"search",icon:"search",acceptRecord:function(e){var t=this,n=e.getFields();return _.every(t.expressions,function(i){var r=i.evaluate(e).displayValue(),o=n.any(function(t){return s.contains(e.getDisplayValue(t.id),r)});return o&&t.addMatch(r),o})},explain:function(e){return _.template(s["command-search-tip"],{keyword:_.invoke(this.expressions,"stringify",e).join(" ")})}}));p("search",v);var y=n.DefaultSearch=v.extend({maxArgs:0,hasCommandName:!1,parseArguments:function(e){var t=this;return _.map(e,function(e){var n=_.omit(e,"val");return n.val=s.normalizeCase(e.val),i.make(n,t)})},stringify:function(e,t){var n=_.map(this.stringifyExpressions(t),function(n){return n.stringify(e,t)});return n.join(" ")},bindCommandString:function(){return null},completionName:function(){return null}});p(h,y);var b=n.ReverseCommand=m.extend({canonicalName:"reverse",minArgs:0,maxArgs:0,hasParens:!0,icon:"sort-by-order-alt",transformRecords:function(e){var t=_.clone(e.records.models).reverse();return r.createRecordListFromList(e,t)}});p("reverse",b),p("rev",b);var w=n.SortCommand=m.extend({canonicalName:"sort",icon:"sort",transformRecords:function(e){var t=this,n=_.map(this.expressions,function(n){var i=!0;n.isOrder()&&!n.ascending&&(i=!1);var r=t.evalExpression(n),s={};return r.isSimpleField()&&(s=r.findField(e.sheet).enumOrderedValueMap()),new u.SortKey(function(e){return r.evaluate(e)},i,s)}),i=u.sortWithKeys(e.records.models,n);return r.createRecordListFromList(e,i,{sortable:!1})},isSort:function(){return!0},evalExpression:function(e){return e.isOrder()?e.expr1:e},toggleField:function(e){var t=this.expressions[0];if(void 0!==t){var n=this.evalExpression(t);if(n.isSimpleFieldFor(e)){if(t.isOrder())return t.ascending?void(t.ascending=!1):void(this.expressions=this.expressions.slice(1,this.expressions.length));var r=i.createOrder(!1,t);return void(this.expressions[0]=r)}}var s=i.make({key:e.get("key")});this.expressions.unshift(s)},explain:function(e){var t=(e.getFields(),""),n=s["command-sort-tip"];return this.expressions.forEach(function(i){var r=i.nameify(e);t+=_.template(n,{column:r}),n=s["command-more-tip"],i.ascending===!1&&(t+=s["command-sort-desc-tip"])}),t},validate:function(){if(m.prototype.validate.apply(this,arguments),0===this.expressions.length)throw new i.ValidationError("no-sort-expression")}});p("sort",w),p("order",w);var x=n.ReportCommand=m.extend({canonicalName:"report",icon:"bar-chart",createReportSheet:function(e){var t=l.add({_id:_.uniqueId("syntheticSheet_")}),n=[],i=e.firstRecordList();return i&&i.fixedValues&&(n=_.concat(n,i.fixedFields())),_.each(this.transformedExpressions(),function(t){var r={name:t.nameify(e),key:_.uniqueId("aggregateField_"),type:"report-formula",expression:t,sourceSheet:i.sheet};n.push(r)}),t.set("fields",n),t.synthetic=!0,t},createSummaryRecord:function(e,t,n,i){var r={_id:_.uniqueId("syntheticRecord_"),sheetId:i.id};_.each(t,function(e,t){r[e]=n[t]});var s=a.add(r);return s.synthetic=!0,s.sourceRecords=e,s},transformResult:function(e){this.assertValidCommand(e);var t,n=this.createReportSheet(e),i=this,o=_.map(e.recordLists,function(e){return i.createSummaryRecord(e.records.models,e.fixedKeys,e.fixedValues,n)}),a=e.firstRecordList();if(o.length>1){var l=_.chain(e.recordLists).map(function(e){return e.records.models}).flatten().value(),u=_.times(a.fixedKeys.length,function(){return s["all-clump-value"]});t=i.createSummaryRecord(l,a.fixedKeys,u,n)}return new r.Results([r.createRecordListFromList(a,o,{fixedKeys:[],fixedValues:[],sheet:n,type:c,summaryRecord:t,sourceSheet:e.firstSheet()})])},firstFixedValue:function(e){return e.fixedValues?e.fixedValues[0]:null},firstFixedKey:function(e){return e.fixedKeys?e.fixedKeys[0]:null},assertValidCommand:function(){var e=this.transformedExpressions();if(0===e.length)throw new Error("Must provide arguments to report command");_.each(e,function(e){e.validateReportExpression()})},transformedExpressions:function(){return this.expressions},isReport:function(){return!0}});p("report",x);var k=n.AggregateCommand=x.extend({hasParens:!0,transformedExpressions:function(){if(this.transformed)return this.transformed;var e=this;return 0!==this.expressions.length?this.transformed=_.map(this.expressions,function(t){return i.createAggregate(e.canonicalName,[t],e)}):this.expressions.length>=this.minArgs?[i.createAggregate(e.canonicalName,[],e)]:void 0}});_.each(i.functionConfig,function(e,t){if(e.aggregate){var n=k.extend({canonicalName:t,isAggregate:!0,minArgs:e.minArgs,maxArgs:e.maxArgs});p(t,n)}}),n.lookupAggregateCommand=function(e){return f[e]},n.defaultCommand=d(h),n.BadCommand=m.extend({isValid:!1,initialize:function(e){this.text=e.text,this.error=e.error,this.original=e.original},stringify:function(){return this.text},validate:function(){},isComplete:function(){return!0}})},{"../../../common/extendable":21,"../../../common/strings":13,"../../../common/values":86,"../../viewModels/reportRecordList":51,"../expressions/expression":65,"../field":105,"../record":107,"../sheet":42,"./results":93}],92:[function(e,t,n){!function(){var t=e("../../../common/strings"),i=e("./commands"),r=e("./results"),s=e("../../viewModels/groupRecordList"),o=e("../groupSort"),a=e("../../../common/values"),l=e("../expressions/expression"),c=function(){this.initialize.apply(this,arguments)};_.extend(c.prototype,{initialize:function(e,t,n,i){this.field=e[0],this.nextFields=_.rest(e),this.sheet=t,this.parent=n,this.fixedValue=i,this.children={},this.parent||0!==this.nextFields.length||this.initializeEnumGroups()},isEmpty:function(){return _.isEmpty(this.children)},initializeEnumGroups:function(){if(this.field&&this.field.isEnum()){var e=this;this.field.get("enum").each(function(t){var n=a.create(t.get("name"));e.getChildForKey(n)})}},getAllFields:function(){return _.concat(this.field,this.nextFields)},addRecord:function(e){if(this.field){var t=e.getValue(this.field.get("key"));this.getChildForKey(t).addRecord(e)}},getAllGroups:function(){return this.isLastGroup()?_.values(this.children):_.chain(this.children).map(function(e){return e.getAllGroups()}).concat().flatten(!0).value()},sortedGroups:function(){return o(this.getAllGroups(),this.getAllFields(),function(e,t){return e.getValue(t)})},getChildForKey:function(e){var t=e.groupingValue();if(_.has(this.children,t))return this.children[t];var n;return n=this.isLastGroup()?new u(this.sheet,this.fixedValues().concat([e]),this):new c(this.nextFields,this.sheet,this,e),this.children[t]=n},fixedValues:function(){return this.parent?this.parent.fixedValues().concat([this.fixedValue]):[]},isLastGroup:function(){return 0===this.nextFields.length}});var u=function(){this.initialize.apply(this,arguments)};_.extend(u.prototype,{initialize:function(e,t,n){this.sheet=e,this.fixedValues=t,this.records=[],this.parent=n},addRecord:function(e){this.records.push(e)},getValue:function(e){return this.fixedValues[e]}});var h=i.PowerBarCommand.extend({canonicalName:"group",hasParens:!1,icon:"th-list",isGroup:function(){return!0},currentFields:function(e){return _.chain(e.recordLists).map(function(e){return e.fixedFields?e.fixedFields():[]}).max(function(e){return e.length}).value()},createGroups:function(e){var t=_.uniq(this.simpleGroupFields(e).concat(this.currentFields(e))),n=new c(t,e.firstSheet()),i=!1;return _.chain(e.recordLists).map(function(e){return e.records.models}).flatten(!0).each(function(e){i=!0,n.addRecord(e)}),!i&&n.isEmpty()&&n.getChildForKey(a.createEmpty()),n},sortGroups:function(e){e.getAllFields();return e.sortedGroups()},assertValidCommand:function(){if(!this.hasSimpleExpressions())throw new Error("Cannot group by a formula")},transformResult:function(e){this.assertValidCommand(e);var t=this.createGroups(e),n=[];if(t.isEmpty())n.push(r.createRecordListFromList(e.firstRecordList(),[]));else{var i=this.sortGroups(t,e),o=_.map(t.getAllFields(),function(e){return e.get("key")});n=_.map(i,function(t){return r.createRecordListFromList(e.firstRecordList(),t.records,{fixedValues:t.fixedValues,fixedKeys:o,type:s})})}return new r.Results(n)},hasSimpleExpressions:function(){return _.all(this.expressions,function(e){return e.isSimpleField()})},simpleGroupFields:function(e){if(this.hasSimpleExpressions()){return _.chain(this.expressions).map(function(t){return t.findField(e)}).uniq().value()}return[]},nameify:function(e){var n=_.map(this.simpleGroupFields(e),function(e){return e?e.displayName():t["unknown-field"]}).join(", ");return _.template(t["by-groups"],{fieldNames:n})},removeField:function(e,t){this.expressions=_.filter(this.expressions,function(n){return n.findField(t).get("key")!==e})},addField:function(e){var t=l.make({key:e.get("key")});this.expressions.unshift(t)},explain:function(e){var n=this.simpleGroupFields(e),i=_.template(t["command-group-tip"],{column:n[0].get("name")});return _.each(_.rest(n),function(e){i+=_.template(t["command-more-tip"],{column:e.get("name")})}),i},validate:function(e){if(i.PowerBarCommand.prototype.validate.apply(this,arguments),this.assertValidCommand(e),0===this.expressions.length)throw new l.ValidationError("no-group-expression")}});n=i.GroupCommand=h,i.addToRegistry("group",h)}()},{"../../../common/strings":13,"../../../common/values":86,"../../viewModels/groupRecordList":47,"../expressions/expression":65,"../groupSort":108,"./commands":60,"./results":93}],93:[function(e,t,n){var i=e("../index"),r=e("../../viewModels"),s=n.Results=function(){this.initialize.apply(this,arguments)};_.extend(s.prototype,{initialize:function(e){this.recordLists=e},applyCommands:function(e){return _.reduce(e,function(e,t){return t.isValid?t.transformResult(e):e},this)},getFields:function(){var e=new i.Field.Collection([]);return _.each(this.recordLists,function(t){e.add(t.getFields().models)}),e},getFixedFields:function(){if(this.fixedFields)return this.fixedFields;var e=this.firstRecordList();return _.soak(e,"fixedValues")?this.fixedFields=e.fixedFields():null},startListeners:function(){_.invoke(this.recordLists,"startListeners")},reuseRecordLists:function(e){if(e){var t={};_.each(e.recordLists,function(e){e.records.each(function(n){var i=n.cid;if(i in t)throw new Error("Record in two record lists!");t[i]=e})});var n=_.map(this.recordLists,function(n){if(0===n.records.size()){var i=_.find(e.recordLists,function(e){return e.isEqual(n)});return i?i:n}var r=n.records.at(0);if(!(r.cid in t))return n;var s=t[r.cid];return s.isEqual(n)?s:n});this.recordLists=n}},firstRecordList:function(){return this.recordLists.length>0?this.recordLists[0]:null},firstSheet:function(){return this.recordLists.length>0?this.recordLists[0].sheet:null}}),s.fromSheet=function(e){var t=[new r.RecordList({sheet:e,records:e.get("records"),delayListeners:!0})];return new s(t)},n.createRecordListFromList=function(e,t,n){return n=n||{},_.defaults(n,{delayListeners:!0}),e.cloneWithRecords(t,n)}},{"../../viewModels":45,"../index":33}],98:[function(e,t){t.exports={entries:[{title:"How do I view the detail page for a record?",keyWords:["row"],conditions:["OnRecordDetail"],content:"<p>This is the detail page for â€œ{{name}}â€. Itâ€™s like looking at just one row, laid out vertically.</p>",cid:"detail-page"},{title:"How do I search/filter?",keyWords:["power","bar","query"],conditions:["OnSheetDetail","SheetNotEmpty"],target:".search",pointer:"left",content:"<p><strong>Search here</strong> using keywords or <code>field:value</code>.</p>\n\n<p>To filter by a formula, use <code>where(formula)</code>.</p>\n\n<h1>Keyboard shortcut: <code>/</code></h1>"},{title:"How do I group by a column?",keyWords:["grouped","grouping"],conditions:["OnSheetDetail","SheetNotEmpty","NotOnFormulaPanel"],pointer:"top",cid:"group",content:"<p><strong>Click here</strong> to group by {{col}} column.</p>"},{title:"How do I create a subsheet?",keyWords:["link"],conditions:["OnRecordDetail","SubsheetButtonClicked"],target:".subsheets .record-list-title:last",pointer:"left",content:"<p>Done! You added a new subsheet.</p>"},{title:"How do I add a sum (average, count, etc.) at the bottom of a column?",keyWords:["count","average","avg","min","max","formula","totals","aggregates"],conditions:["AggregatesMenuOpened"]},{title:"How do I add a formula to a column?",keyWords:["calculate","calculation","expression","math"],conditions:["OnFormulaPanelForNewField"],target:".formula-field",pointer:"bottom-right",content:"<p>Enter a formula here and click â€œSaveâ€ when you&#39;re done.</p>\n\n<h1>Type &quot;=&quot; into any cell to open this panel.</h1>"},{title:"How do I import a CSV file?",keyWords:["upload","spreadsheet","excel","google","docs"],conditions:["OnBookList"],target:".import-csv",pointer:"top",content:"<p><strong>Click here</strong> to upload a CSV, or simply drag a file and drop it here.</p>"},{title:"How do I export a sheet as a CSV file?",keyWords:["download","spreadsheet","excel","google","docs"],conditions:["SheetMenuOpened"],target:".export-csv",pointer:"left",content:"<p><strong>Click here</strong> to download.</p>"},{title:"Can I import/export an Excel or Google spreadsheet?",keyWords:["upload","download"],content:"<p>Right now we only support import/export of single sheets in CSV format.</p>\n\n<p>You can&#39;t import or export full multi-sheet workbooks yet.</p>",conditions:[]},{title:"Can I put validation rules on a field?",content:"<p>Sorry, we don&#39;t have validation rules yet.</p>",conditions:[]},{title:"Can I do conditional formatting?",content:"<p>Sorry, we don&#39;t have conditional formatting yet.</p>",conditions:[]}],steps:[{name:"GoToRecord",conditions:["OnSheetDetail","NotOnFormulaPanel","SheetNotEmpty"],target:"a.short-id",pointer:"top",content:"<p><strong>Click the ID number</strong> to go to the record.</p>"},{name:"GoToSheet",conditions:["OnBookDetail"],target:".sheet-tabs",pointer:"left",content:"<p><strong>Click on a sheet</strong> so we can demonstrate.</p>"},{name:"GoToNonEmptySheet",conditions:["OnBookDetail"],target:".sheet-tabs",pointer:"left",content:"<p>This sheet is empty. Go to a sheet with some records first.</p>"},{name:"GoToBookDetail",conditions:["OnBookList"],target:".book-link",pointer:"left",content:"<p><strong>Click on a book</strong> so we can demonstrate.</p>"},{name:"GoToBookList",target:".book-header a:first",pointer:"left",content:"<p><strong>Click this link</strong> to go to the book list.</p>",conditions:[]},{name:"CloseFormulaPanel",conditions:["OnFormulaPanel"],target:".formula-panel .close",pointer:"left",content:"<p><strong>Click here</strong> to close the formula panel.</p>"},{name:"OpenFormulaPanel",conditions:["OnSheetDetail"],target:"td.data",pointer:"left",content:"<p>Type &quot;=&quot; into a cell to open the formula panel.</p>"},{name:"ClickSubsheetButton",conditions:["OnRecordDetail"],target:".add-subsheet",pointer:"left",content:"<p><strong>Click here</strong> to add a subsheet.</p>"},{name:"OpenSheetMenu",conditions:["OnSheetDetail","NotOnFormulaPanel"],target:".sheet-actions",pointer:"left",content:"<p><strong>Click here</strong> for a menu.</p>"},{name:"OpenAggregatesMenu",conditions:["OnSheetDetail","NotOnFormulaPanel","AggregatesVisible"],target:[".summary","tr.empty td.data"],pointer:"top",content:"<p>Summary functions (sum, average, count, etc.) are shown here automatically.</p>\n\n<p>Right click to change what kind of summary function is shown.</p>"},{name:"ScrollToAggregates",conditions:["OnSheetDetail","NotOnFormulaPanel"],content:"<p><strong>Scroll down</strong> to the bottom of the sheet.</p>"},{name:"OpenNewFieldSettings",conditions:["OnSheetDetail","NamedNewField","NotOnFormulaPanel"],pointer:"top",content:"<p><strong>Click here</strong> to open the field options menu.</p>"},{name:"NameNewField",conditions:["OnSheetDetail","AddedField","NotOnFormulaPanel"],pointer:"top",content:"<p>You can give the field a name now if you want.</p>"},{name:"OpenFormulaPanelForNewField",conditions:["OnSheetDetail","NewFieldSettingsOpened"],target:".set-formula",pointer:"left",content:"<p><strong>Click here</strong> to set a formula.</p>"},{name:"AddField",conditions:["OnSheetDetail"],target:".add-field",pointer:"top-right",content:"<p>We&#39;ll demonstrate on a new column. <strong>Click here</strong> to add one.</p>"}]}},{}],114:[function(e){function t(e){o.add(o.extend({title:e.title,createConditions:function(){this.conditions=e.conditions.map(function(e){return new s[e]})},keyWords:e.keyWords,noTip:null==e.content,tipContent:e.content?function(){var t=this.createContext();return t?_.template(e.content,t):e.content}:null,findElement:function(){var t=e.target;return t?(_.isArray(t)&&(t=_.find(t,function(e){return $(e).length})),$(t)):void 0},pointer:e.pointer,cid:e.cid}))}var n=e("../../models/sheet"),i=e("./help"),r=e("../../gen/help.json").entries,s=i.Condition,o=i.Entry,a=e("../../views");r.forEach(t),o.implement("group",{findElement:function(){var e=$(".group-option:last"),t=n.displayedSheet();if(!t)return e;var i=t.goodGroupField();if(!i)return e;var r=_.find($(".sheet-detail thead th"),function(e){var t=$(e).data("column");return t&&t.field===i});r=$(r);var s=r.find(".group-option");
return s.length?(this.state.columnName=i.get("name"),s):e},createContext:function(){return{col:this.state.columnName?"the â€œ"+this.state.columnName+"â€":"this"}}}),o.implement("detail-page",{createContext:function(){var e=a.RecordView.displayedView();return{name:e.model.name()}}})},{"../../gen/help.json":98,"../../models/sheet":42,"../../views":68,"./help":69}],101:[function(e){var t=e("./tip"),n=e("../../views"),i=e("../../models");t.ElementTip.extend({id:"demo",shouldTrigger:function(){return this.context instanceof n.BookListView?i.Account.account.get("hasDemoBooks")?$(".book-link").length?!0:!1:!1:!1},findElement:function(){return $(".book-link:first")}}),t.ElementTip.extend({id:"help",prerequisite:"pbar",shouldTrigger:function(){return!0},findElement:function(){return $(".help-button")},pointerLocation:"top-right"})},{"../../models":33,"../../views":68,"./tip":95}],102:[function(e){{var t=e("./tip"),n=e("../../views");e("../../models")}t.Tip.extend({id:"detail",throttled:!1,shouldTrigger:function(){return this.context instanceof n.RecordView},makeTemplateContext:function(){return{name:this.context.model.name()}}}),t.ElementTip.extend({id:"subsheet",prerequisite:"detail",shouldTrigger:function(){return this.context instanceof n.RecordView?!$(".subsheets").is(":empty")&&$(".subsheets tbody tr:not(.empty)").length:!1},makeTemplateContext:function(){var e=this.context.sheet,t=this.context.recordListViews[0].model.sheet,n=t.getFields().find(function(t){return t.isLinkToSheet(e)});return{source:$(".subsheets .record-list-header:first .editable-title").text(),link:n.displayName(),name:this.context.model.name()}},findElement:function(){return $(".subsheets tbody tr:not(.empty)").first().parents("table").find("thead")}})},{"../../models":33,"../../views":68,"./tip":95}],100:[function(e){function t(e){if(!(e instanceof i.SheetView))return!1;var t=e.viewModel;if(!t.sheet.isLoaded())return!1;if(!t.isGrouped())return!1;var n=t.recordLists();return{viewModel:t,recordLists:n}}var n=e("./tip"),i=e("../../views"),r=e("../../models"),s=e("../../../common/strings");n.Tip.extend({id:"sheetview",throttled:!1,shouldTrigger:function(){return this.context instanceof i.SheetView}}),n.ElementTip.extend({id:"shortid",pointerLocation:"top",shouldTrigger:function(){if(!(this.context instanceof i.SheetView))return!1;if(!$(".short-id").length)return!1;var e=_.find($(".table-view tbody tr"),function(e){e=$(e);var t=e.find("td.data").filter(function(e,t){return t.textContent.trim()});return t.length>=4});return this.row=$(e),this.el=$(e).find(".short-id"),this.el.length>0},makeTemplateContext:function(){var e=this.row.data("id"),t=r.Record.find(e);return{name:t.name()}},findElement:function(){return this.el}}),n.Tip.extend({id:"grouped",throttled:!1,shouldTrigger:function(){var e=t(this.context);if(!e)return!1;var n=0,i=0;return _.some(e.recordLists,function(e){return e.records.length&&n++,e.records.length>1&&i++,n>=2&&i>=1})},makeTemplateContext:function(){return{groupField:this.context.viewModel.firstGroupField().displayName()}}}),n.ElementTip.extend({id:"singlegroup",throttled:!1,shouldTrigger:function(){var e=t(this.context);if(!e)return!1;var n=0,i=0;return _.every(e.recordLists,function(e){return e.records.length&&n++,e.records.length>1&&i++,1>=i&&1>=n})&&1===i&&1===n},makeTemplateContext:function(){var e=_.find(this.context.viewModel.recordLists(),function(e){return e.records.length}),t=e.fixedValues[0];return{groupField:this.context.viewModel.firstGroupField().displayName(),value:t}},findElement:function(){return $(".ungroup:first")}}),n.ElementTip.extend({id:"uniquegroup",throttled:!1,shouldTrigger:function(){var e=t(this.context);if(!e)return!1;var n=0;return _.every(e.recordLists,function(e){return e.records.length&&n++,e.records.length<=1})&&n>1},makeTemplateContext:function(){return{groupField:this.context.viewModel.firstGroupField().displayName()}},findElement:function(){return $(".ungroup:first")}}),n.ElementTip.extend({id:"movegroup",prerequisite:"grouped",shouldTrigger:function(){var e=t(this.context);return e?e.viewModel.canModifyGroups()?e.recordLists.length>=2:!1:!1},findElement:function(){return $(".group-title-section:first")}}),n.ElementTip.extend({id:"moverow",prerequisite:"movegroup",pointerLocation:"top",shouldTrigger:function(){var e=t(this.context);return e?e.viewModel.canModifyGroups()?e.recordLists.length<2?!1:_.every(e.recordLists,function(e){return!e.records.length})?!1:e.recordLists[0].sortable:!1:!1},makeTemplateContext:function(){return{groupField:this.context.viewModel.firstGroupField().displayName()}},findElement:function(){return $(".icon-reorder:first")}}),n.ElementTip.extend({id:"pbar",prerequisite:"shortid",shouldTrigger:function(){if(!(this.context instanceof i.SheetView))return!1;var e=this.context.viewModel;if(!e.sheet.isLoaded())return!1;var t=e.recordLists(),n=0;return _.any(t,function(e){return n+=e.records.length,n>=3})},findElement:function(){return $(".search-container")}}),n.ElementTip.extend({id:"+nav",prerequisite:"pbar",shouldTrigger:function(){return $(".save-search").is(":enabled")&&$(".save-search").text().trim()===s["save-search"]&&$(".search").val()&&!$(".search").is(":focus")},findElement:function(){return $(".save-search")}}),n.ElementTip.extend({id:"link",prerequisite:"shortid",pointerLocation:"top",shouldTrigger:function(){if(!(this.context instanceof i.SheetView))return!1;var e=this.context.viewModel;if(!e.sheet.isLoaded())return!1;var t=e.recordLists(),n=0,r=_.any(t,function(e){return n+=e.records.length});if(!r)return!1;var s=e.groupFields(),o=e.sheet.getFields().chain().toArray().difference(s).value(),a=_(o).any(function(e){return e.isLink()});return a},getLinkField:function(){var e=this.context.viewModel.recordLists()[0],t=e.getFields();return t.find(function(e){return e.isLink()})},makeTemplateContext:function(){var e=this.getLinkField(),t=e.linkedSheet();return{field:e.displayName(),sheet:t.displayTitle()}},findElement:function(){var e,t=this.getLinkField();return $(".record-list tbody td.data").each(function(n,i){return i=$(i),""!==i.text().trim()?i.data("column").field===t?(e=i,!1):void 0:void 0}),e?e.find("a"):null}})},{"../../../common/strings":13,"../../models":33,"../../views":68,"./tip":95}],emitter:[function(e,t){t.exports=e("g/KREB")},{}],"g/KREB":[function(e,t){function n(e){return e?i(e):void 0}function i(e){for(var t in n.prototype)e[t]=n.prototype[t];return e}var r=e("indexof");t.exports=n,n.prototype.on=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},n.prototype.once=function(e,t){function n(){i.off(e,n),t.apply(this,arguments)}var i=this;return this._callbacks=this._callbacks||{},t._off=n,this.on(e,n),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;var i=r(n,t._off||t);return~i&&n.splice(i,1),this},n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var i=0,r=n.length;r>i;++i)n[i].apply(this,t)}return this},n.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{indexof:115}],38:[function(e,t,n){!function(){var i=e("backbone"),r=e("../common/extendable"),s=e("./actionQueue"),o=t.exports,a={},l=n.Action=function(){this.initialize.apply(this,arguments)};_.extend(l.prototype,{initialize:function(){},replaceUndefinedWithNull:function(e){return _.each(e,function(t,n){void 0===t&&(e[n]=null)}),e},refreshModel:function(){if(this.model&&this.collection){var e=this.collection.get(this.model.id);e&&(this.model=e)}},perform:function(){throw new Error("perform not implemented")},revert:function(){throw new Error("can't undo")},reperform:function(e){return this.perform(e)},"do":function(e){return this.getQueue().addOperation(this,"perform",e),this.push()},push:function(){return o.history.push(this),this},undo:function(e){return this.getQueue().addOperation(this,"revert",e),this},redo:function(e){return this.getQueue().addOperation(this,"reperform",e),this},getQueue:function(){return s.findOrCreateQueue(this.queueTarget())},queueTarget:function(){return this.collection?this.collection.queueTarget():this.model?this.model.queueTarget():a}}),l=r(l);var c=(n.Add=l.extend({initialize:function(e,t){this.collection=e,this.attrs=t},perform:function(e){this.model=i.Collection.prototype.create.call(this.collection,this.attrs,e)},revert:function(e){i.Model.prototype.destroy.call(this.model,e)},reperform:function(e){this.collection.restore(this.model,e)}}),n.CreateOrUpdate=l.extend({initialize:function(e,t,n){this.model=e,this.collection=e.collection,this.attrs=t,this.previousAttrs=this.replaceUndefinedWithNull(n)},initializeIsNewIfNecessary:function(){null==this.isNew&&(this.isNew=this.model.isNew())},perform:function(e){this.initializeIsNewIfNecessary(),this.isNew?(this.model.set(this.attrs),this.model.save(null,e)):this.model.save(this.attrs,_.extend({patch:!0},e))},revert:function(e){this.initializeIsNewIfNecessary(),this.isNew?i.Model.prototype.destroy.call(this.model,e):this.model.save(this.previousAttrs,_.extend({patch:!0},e))},reperform:function(e){return this.initializeIsNewIfNecessary(),this.isNew?void this.collection.restore(this.model,e):this.perform()},queueTarget:function(){return this.model.queueTarget()}}),n.Move=l.extend({initialize:function(e,t,n){this.collection=e,this.model=t,this.index=n,this.prevIndex=e.indexOf(t)},move:function(e,t){var n={op:"move",id:this.model.id,path:"/"+e};this.collection.patch([n],t),this.collection.remove(this.model,{silent:!0}),this.collection.add(this.model,{at:e,silent:!0}),this.collection.trigger("sort")},perform:function(e){this.move(this.index,e)},revert:function(e){this.move(this.prevIndex,e)}}),n.Delete=l.extend({initialize:function(e){this.model=e,this.collection=e.collection},perform:function(e){i.Model.prototype.destroy.call(this.model,e)},revert:function(e){this.collection.restore(this.model,e)}}),n.Custom=l.extend({initialize:function(e){this.performFunction=e.perform,this.revertFunction=e.revert,this.target=e.queueTarget},perform:function(){this.performFunction.apply(this,arguments)},revert:function(){this.revertFunction.apply(this,arguments)},queueTarget:function(){return this.target?this.target:l.prototype.queueTarget.apply(this,arguments)}}));n.performCustomAction=function(e){var t=new c({perform:e.perform,revert:e.revert,queueTarget:e.queueTarget});t.do()};var u=n.ActionHistory=function(){this.stack=[],this.redoStack=[],this.currentActions=null,this.captureDepth=0};_.extend(u.prototype,i.Events,{capture:function(e){this.beginCapture();try{e()}finally{this.endCapture()}},beginCapture:function(){return this.currentActions?void this.captureDepth++:void(this.currentActions=[])},endCapture:function(){return this.captureDepth>0?void this.captureDepth--:(this.currentActions.length>0&&(this.stack.push(this.currentActions),this.redoStack.length=0,this.trigger("do")),void(this.currentActions=null))},canUndo:function(){return this.stack.length>0},canRedo:function(){return this.redoStack.length>0},push:function(e){this.currentActions&&this.currentActions.push(e)},undo:function(e){var t=this.stack.pop();t&&(_.each(t,function(t){t.undo(e)}),this.redoStack.push(t),this.trigger("undo"))},redo:function(e){var t=this.redoStack.pop();t&&(_.each(t,function(t){t.redo(e)}),this.stack.push(t),this.trigger("redo"))},reset:function(){this.stack.length=0,this.redoStack.length=0,this.trigger("reset")}}),n.history=new u}()},{"../common/extendable":21,"./actionQueue":1,backbone:"eVKbg4"}],64:[function(e,t){var n=e("backbone");t.exports=_.clone(n.Events)},{backbone:"eVKbg4"}],82:[function(e,t,n){!function(){var t=e("url"),i=e("backbone"),r=e("./views"),s=n.flash={params:{},addParams:function(e){_.extend(this.params,e)},perform:function(e){_.isEmpty(this.params)||(e&&"function"==typeof e.onFlash&&e.onFlash(this.params),this.params={})}},o=n.Router=i.Router.extend({routes:{"":"home",books:"bookList","books/:id":"book","sheets/:id(/:navKey)":"sheet","records/:id":"record"},home:function(){mixpanel.track("view_home"),this.root.showBookList()},bookList:function(){mixpanel.track("view_book_list"),this.root.showBookList()},book:function(e){this.root.showBook(e)},sheet:function(e,t){mixpanel.track("view_sheet",{id:e,navKey:t}),this.root.showSheet(e,t)},record:function(e){mixpanel.track("view_record",{id:e}),this.root.showRecord(e)},flash:function(e){return s.addParams(e),this},navigate:function(){return i.Router.prototype.navigate.apply(this,arguments),s.perform(this.root),this},goToBook:function(e){var t="books/"+e;this.navigate(t,{trigger:!0})},goToSheet:function(e,t){var n="sheets/"+e;t&&(n+="/"+t),this.navigate(n,{trigger:!0})},goToRecord:function(e){var t="records/"+e;this.navigate(t,{trigger:!0})},goToBookList:function(){this.navigate("books",{trigger:!0})}}),a=n.router=new o,l=n.observer=_.extend(i.Events,{currentRoute:{},onRoute:function(e,t){var n=["router:",e];t&&t.length>0&&n.push(t),console.log.apply(console,n),this.currentRoute.name=e,this.currentRoute.args=t},currentRouteIsBook:function(e){var t=this.currentRoute;return"book"===t.name&&t.args[0]===e},currentRouteIsSheet:function(e,t){var n=this.currentRoute;if("sheet"!==n.name)return!1;if(n.args[0]!==e)return!1;var i=n.args[1];return t===i||!t&&!i}});l.listenTo(a,"route",l.onRoute);{var c=n.params=function(){var e=t.parse(window.location.href,!0);return e.query},u=(n.param=function(e){return c()[e]},n.hasParam=function(e){return e in c()},n.history=i.history);n.start=function(e){a.root=new r.RootView({el:e}),u.start({pushState:!0})}}}()},{"./views":68,backbone:"eVKbg4",url:23}],103:[function(e,t){var n=e("q"),i=e("../common/errors"),r="undefined"==typeof window?null:window.trackJs;r&&(n.onerror=function(e){throw r.track(e),e},r.configure({onError:function(e){return e.message&&i.isDisplayableErrorMessage(e.message)?(console.debug(i.removeDisplayableErrorPrefix(e.message)),!1):!0}})),t.exports.watch=function(e,t){return r?r.watch(e,t):_.bind(e,t)},_.each(["watchAll","track"],function(e){t.exports[e]=function(){return r?r[e].apply(r,arguments):void 0}}),t.exports.console={},_.each(["debug","error","info","log","warn"],function(e){t.exports.console[e]=function(){return r?r.console[e].apply(r.console,arguments):void 0}})},{"../common/errors":31,q:116}],104:[function(e,t,n){var i=e("jquery2"),r=e("backbone"),s=e("./keys"),o=e("./env"),a=(t.exports,n.TableView=r.View.extend({className:"table-view",defaultOptions:{columns:[],data:[],startRows:0,startCols:0,autoWrapRow:!0,stretchH:"none",undo:!1},wrapCallback:function(e){if("function"!=typeof e)return e;var t=this;return function(){var n=_.toArray(arguments);n.unshift(t),e.apply(null,n)}},makeTableOptions:function(){var e=this.options.options||{};return e=_.clone(e),e=_.defaults(e,this.defaultOptions),e.beforeInitWalkontable=_.bind(this.beforeInitWalkontable,this),e.beforeRender=_.bind(this.beforeRender,this),e.afterGetColHeader=_.bind(this.afterGetColHeader,this),e.afterRender=_.bind(this.afterRender,this),e.afterSelection=_.bind(this.afterSelection,this),e.afterDeselect=_.bind(this.afterDeselect,this),e.beforeKeyDown=_.bind(this.beforeKeyDown,this),e.afterChange=this.wrapCallback(e.afterChange),e.afterColumnResize=this.wrapCallback(e.afterColumnResize),e},beforeInitWalkontable:function(e){var t=e.selections;t.current.border.color="hsl(45, 100%, 47%)",t.area.border.color="hsl(45, 100%, 60%)",t.fill.border.color="hsl(45, 100%, 47%)",this.savedRowOffset&&(e.offsetRow=this.savedRowOffset),this.savedColOffset&&(e.offsetColumn=this.savedColOffset)},remove:function(){this.table.getSelected()&&this.trigger("afterDeselect",this),this.table&&this.table.destroy(),r.View.prototype.remove.apply(this)},initialize:function(){this.tableOptions=this.makeTableOptions(),this.didRender=_.soak(this.options,"options.didRender"),this.willKeyDown=_.soak(this.options,"options.willKeyDown"),this.$el.data("view",this),this.reset()},reset:function(){var e;this.table&&(this.savedRowOffset=this.table.rowOffset(),this.savedColOffset=this.table.colOffset(),e=this.getSelected(),this.table.destroy());var t=_.clone(this.tableOptions);t.columns=this.columns,t.data=this.rows,t.manualColumnMove=!1,this.$el.handsontable(t),this.table=this.$el.handsontable("getInstance"),i(document).on("keyup.handsontable."+this.table.guid,_.bind(this.onKeyUp,this)),this.setSelected(e)},render:function(){this.table.render()},headerCells:function(){var e=this.$("thead th");return this.table.getSettings().rowHeaders&&(e=e.slice(1)),e},afterGetColHeader:function(e,t){var n=this.columnAt(e);n.decorateHeaderCell(i(t))},afterRender:function(){if(this.tableOptions.manualRowMove){var e=this,t={handle:"th",axis:"y",tolerance:"pointer",helper:function(t,n){var r=i("<div>");r.addClass(e.className),r.addClass("handsontable sortable-helper");var s=i("<table>");s.append(e.$("colgroup").clone());var o=i("<tbody>");return o.append(n.clone()),s.append(o),r.append(s),r},start:function(){e.deselect()},over:function(e,t){var n=t.placeholder.closest(".table-view"),i=t.placeholder.data("lastAddedToTable")||t.sender.closest(".table-view"),r=n.find(".wtHider"),s=i.find(".wtHider"),o=t.placeholder.data("heightDelta");o||(o=t.placeholder.height()-1,t.placeholder.data("heightDelta",o)),r.height(r.height()+o),s.height(s.height()-o),t.placeholder.data("lastAddedToTable",n)},stop:function(t,n){var i=n.item,r=i.closest("tbody").find("tr");e.tableOptions.afterRowMove.call(null,e,i,r)}};_.isObject(this.tableOptions.manualRowMove)&&_.extend(t,this.tableOptions.manualRowMove),this.$("tbody").sortable(t)}if(this.tableOptions.manualColumnMove){var n=this.tableOptions.manualColumnMove,r=this.$("thead tr").find(n);r.draggable({scope:"headers",axis:"x",opacity:.5,revert:"invalid",revertDuration:200,zIndex:10}),r.droppable({scope:"headers",tolerance:o.droppableTolerance||"pointer",hoverClass:"drophover",drop:function(t,n){var s=n.draggable,o=i(t.target),a=r.index(s)+e.table.colOffset(),l=r.index(o)+e.table.colOffset();e.tableOptions.afterColumnMove.call(null,e,a,l),s.css({left:""})}})}_.result(this,"didRender")},setRowSortable:function(e){this.tableOptions.manualRowMove&&this.$("tbody").sortable("option","disabled",!e)},afterSelection:function(e,t,n,i){if(this.$("tbody th.area").removeClass("area"),0===t&&i===this.columns.length-1){var r=this.table.rowOffset(),s=Math.min(e,n)-r,o=Math.max(e,n)-r,a=this.$("tbody tr").slice(s,o+1);a.find("th").addClass("area")}this.trigger.apply(this,["afterSelection",this].concat(_.toArray(arguments))),_.result(this,"didRender")},afterDeselect:function(){this.$("tbody th.area").removeClass("area"),this.trigger.apply(this,["afterDeselect",this].concat(_.toArray(arguments))),_.result(this,"didRender")},beforeKeyDown:function(e){if(_.result(this,"willKeyDown"),e.which===s.OPTION){var t=this.table.getSelected();t&&(this.originalSelection=_.clone(t),t[1]=0,t[3]=this.columns.length-1,this.table.selectCell.apply(this.table,t))}var n=this.options.options&&this.options.options.beforeKeyDown;"function"==typeof n&&n.call(null,this,e)},onKeyUp:function(e){if(e.which===s.OPTION){if(!this.originalSelection)return;var t=this.table.getSelected();if(!t)return;t[1]=this.originalSelection[1],t[3]=this.originalSelection[3],this.table.selectCell.apply(this.table,t),this.originalSelection=null}},cleanUpHeaderCells:function(){this.headerCells().each(function(e,t){var n=i(t),r=n.data("column");r&&r.cleanUpHeaderCell(n)})},beforeRender:function(){this.table&&(_.soak(Tips.currentTipView,"dismiss()"),_.defer(Tips.throttledDisplay),this.cleanUpHeaderCells())},forceArray:function(e){return e?"function"==typeof e.toArray?e.toArray():e.length?_.toArray(e):[]:[]},load:function(e){var t={};e.columns&&(t.columns=this.columns=e.columns),e.rows&&(t.data=this.rows=this.forceArray(e.rows)),this.table.updateSettings(t)},addRow:function(e){var t=this.rows.length;return this.rows.push(e),this.render(),t},getSelected:function(){return this.table.getSelected()},setSelected:function(e){e&&(_.isEqual(e,this.getSelected())||this.table.selectCell.apply(this,e.concat([!1])))},select:function(e,t){e=e||0,t=t||0,this.table.selectCell(e,t)},deselect:function(){this.table.deselectCell(),this.$(".area").removeClass("area")},selectRow:function(e){e=e||0,this.table.selectCell(e,0,e,this.table.countCols()-1,!1)},selectColumn:function(e){e=e||0,this.table.selectCell(0,e,this.table.countRows()-1,e,!1)},scrollToColumn:function(e){var t=this.table.rowOffset();this.select(t,e),this.deselect()},rowAt:function(e){return this.table.getDataAtRow(e)},columnAt:function(e){return this.table.getSettings().columns[e]},columnIndexForHeaderCell:function(e){var t=e.data("column");return this.columns.indexOf(t)},findColumnCells:function(e){var t=_.findWhere(this.columns,e),n=this.columns.indexOf(t);if(-1===n)return console.debug("Number of column objects: "+this.columns.length),console.debug("Found column: "+t),console.debug("Columns toString: "+_.invoke(this.columns,"toString").join(", ")),console.debug("Column fields: "+_.chain(this.columns).map(function(e){return e&&e.field&&e.field.id}).value().join(", ")),i([]);var r=this.table.countRows();return i(_.chain(r).range().map(function(e){try{return this.getCell(e,n)}catch(t){var i="Error on getCell(i="+e+", columnIndex="+n+"): "+t.toString();throw new Error(i)}},this.table).compactNullish().value())},rowIndexForTableRow:function(e){return this.$("tbody tr").index(e)+this.table.rowOffset()},getColWidth:function(e){return this.table.getColWidth(e)},beginEditing:function(e,t,n){var r=void 0===n;if(this.table.selectCell(e,t),this.table.textEditor){var s=this.table.getCellMeta(e,t);this.table.textEditor.beginEditing(e,t,s.prop,r)}else{var o=i.Event("keydown",{keyCode:113});i(this.table.rootElement).trigger(o)}r||this.$(".handsontableInput").val(n)},endEditing:function(e){i(":focus").blur(),this.table.destroyEditor(e)}}),n.Column=function(e){this.options=e||{},this.data=this.wrapDataAccessor(),this.renderer=this.wrapRenderer(),this.initialize()});_.extend(a.prototype,r.Events,{wrapDataAccessor:function(){var e=this,t=function(t,n){return void 0===n?(n=e.get(t),void 0===n?"":n):void e.set(t,n)};return t.column=this,t},wrapRenderer:function(){var e=this;return function(t,n,r,s,o,a){var l=i(n);l.data("column",e);var c=t.getDataAtRow(r);e.className&&l.addClass(e.className),e.bodyClassName&&l.addClass(e.bodyClassName),e.render(l,c,a)}},decorateHeaderCell:function(e){e.data("column",this),this.className&&e.addClass(this.className),this.headerClassName&&e.addClass(this.headerClassName)},cleanUpHeaderCell:function(e){e.removeData("column"),this.className&&e.removeClass(this.className),this.headerClassName&&e.removeClass(this.headerClassName)},initialize:function(){},get:function(){return null},set:function(){},render:function(e,t,n){e.text(n)}}),a.extend=r.View.extend;n.ModelKeyColumn=a.extend({initialize:function(){this.options.key&&(this.key=this.options.key)},get:function(e){return e&&e.get(this.key)},set:function(e,t){e&&e.set(this.key,t)}})},{"./env":26,"./keys":4,backbone:"eVKbg4",jquery2:"abnWWX"}],115:[function(e,t){var n=[].indexOf;t.exports=function(e,t){if(n)return e.indexOf(t);for(var i=0;i<e.length;++i)if(e[i]===t)return i;return-1}},{}],116:[function(e,t,n){!function(e){!function(e){if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof n)t.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else Q=e()}(function(){"use strict";function t(e){var t=Function.call;return function(){return t.apply(e,arguments)}}function n(e){return e===Object(e)}function i(e){return"[object StopIteration]"===bt(e)||e instanceof lt}function r(e,t){if(st&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(xt)){for(var n=[],i=t;i;i=i.source)i.stack&&n.unshift(i.stack);n.unshift(e.stack);var r=n.join("\n"+xt+"\n");e.stack=s(r)}}function s(e){for(var t=e.split("\n"),n=[],i=0;i<t.length;++i){var r=t[i];l(r)||o(r)||!r||n.push(r)}return n.join("\n")}function o(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function a(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var i=/.*@(.+):(\d+)$/.exec(e);return i?[i[1],Number(i[2])]:void 0}function l(e){var t=a(e);if(!t)return!1;var n=t[0],i=t[1];return n===at&&i>=ct&&$t>=i}function c(){if(st)try{throw new Error}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],i=a(n);if(!i)return;return at=i[0],i[1]}}function u(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack),e.apply(e,arguments)}}function h(e){return R(e)}function d(){function e(e){t=e,s.source=e,ft(n,function(t,n){ht(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,i=void 0}var t,n=[],i=[],r=gt(d.prototype),s=gt(p.prototype);if(s.promiseDispatch=function(e,r,s){var o=dt(arguments);n?(n.push(o),"when"===r&&s[1]&&i.push(s[1])):ht(function(){t.promiseDispatch.apply(t,o)})},s.valueOf=u(function(){if(n)return s;var e=m(t);return g(e)&&(t=e),e},"valueOf","inspect"),s.inspect=function(){return t?t.inspect():{state:"pending"}},h.longStackSupport&&st)try{throw new Error}catch(o){s.stack=o.stack.substring(o.stack.indexOf("\n")+1)}return r.promise=s,r.resolve=function(n){t||e(R(n))},r.fulfill=function(n){t||e($(n))},r.reject=function(n){t||e(S(n))},r.notify=function(e){t||ft(i,function(t,n){ht(function(){n(e)})},void 0)},r}function f(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=d();return q(e,t.resolve,t.reject,t.notify).fail(t.reject),t.promise}function p(e,t,n){void 0===t&&(t=function(e){return S(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var i=gt(p.prototype);if(i.promiseDispatch=function(n,r,s){var o;try{o=e[r]?e[r].apply(i,s):t.call(i,r,s)}catch(a){o=S(a)}n&&n(o)},i.inspect=n,n){var r=n();"rejected"===r.state&&(i.exception=r.reason),i.valueOf=u(function(){var e=n();return"pending"===e.state||"rejected"===e.state?i:e.value})}return i}function m(e){if(g(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function g(e){return n(e)&&"function"==typeof e.promiseDispatch&&"function"==typeof e.inspect}function v(e){return n(e)&&"function"==typeof e.then}function y(e){return g(e)&&"pending"===e.inspect().state}function b(e){return!g(e)||"fulfilled"===e.inspect().state}function w(e){return g(e)&&"rejected"===e.inspect().state}function x(){Et||"undefined"==typeof window||window.Touch||!window.console||console.warn("[Q] Unhandled rejection reasons (should be empty):",kt),Et=!0}function k(){for(var e=0;e<kt.length;e++){var t=kt[e];t&&"undefined"!=typeof t.stack?console.warn("Unhandled rejection reason:",t.stack):console.warn("Unhandled rejection reason (no stack):",t)}}function _(){kt.length=0,_t.length=0,Et=!1,Ct||(Ct=!0,"undefined"!=typeof e&&e.on&&e.on("exit",k))}function E(e,t){Ct&&(_t.push(e),kt.push(t),x())}function C(e){if(Ct){var t=pt(_t,e);-1!==t&&(_t.splice(t,1),kt.splice(t,1))}}function S(e){var t=p({when:function(t){return t&&C(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return E(t,e),t}function $(e){return p({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return yt(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function R(e){return g(e)?e:v(e)?A(e):$(e)}function A(e){var t=d();return ht(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function F(e){return p({isDef:function(){}},function(t,n){return M(e,t,n)},function(){return R(e).inspect()})}function T(e,t,n,i){return h(e).then(t,n,i)}function V(e,t,n){return T(e,function(e){return H(e).then(function(e){return t.apply(void 0,e)},n)},n)}function I(e){return function(){function t(e,t){var o;if(wt){try{o=n[e](t)}catch(a){return S(a)}return o.done?o.value:T(o.value,r,s)}try{o=n[e](t)}catch(a){return i(a)?a.value:S(a)}return T(o,r,s)}var n=e.apply(this,arguments),r=t.bind(t,"send"),s=t.bind(t,"throw");return r()}}function N(e){h.done(h.async(e)())}function O(e){throw new lt(e)}function L(e){return function(){return V([this,H(arguments)],function(t,n){return e.apply(t,n)})}}function M(e,t,n){var i=d();return ht(function(){R(e).promiseDispatch(i.resolve,t,n)}),i.promise}function D(e){return function(t){var n=dt(arguments,1);return M(t,e,n)}}function P(e,t){var n=dt(arguments,2);return St(e,t,n)}function B(e,t){return M(e,"apply",[void 0,t])}function q(e){var t=dt(arguments,1);return B(e,t)}function U(e){var t=dt(arguments,1);return function(){var n=t.concat(dt(arguments));return M(e,"apply",[this,n])}}function H(e){return T(e,function(e){var t=0,n=d();return ft(e,function(i,r,s){var o;g(r)&&"fulfilled"===(o=r.inspect()).state?e[s]=o.value:(++t,T(r,function(i){e[s]=i,0===--t&&n.resolve(e)},n.reject))},void 0),0===t&&n.resolve(e),n.promise})}function j(e){return T(e,function(e){return e=mt(e,R),T(H(mt(e,function(e){return T(e,ut,ut)})),function(){return e})})}function K(e){return T(e,function(e){return H(mt(e,function(t,n){return T(t,function(t){return e[n]={state:"fulfilled",value:t},e[n]},function(t){return e[n]={state:"rejected",reason:t},e[n]})})).thenResolve(e)})}function W(e,t){return T(e,void 0,t)}function z(e,t){return T(e,void 0,void 0,t)}function G(e,t){return T(e,function(e){return T(t(),function(){return e})},function(e){return T(t(),function(){return S(e)})})}function Q(t,n,i,s){var o=function(e){ht(function(){if(r(e,t),!h.onerror)throw e;h.onerror(e)})},a=n||i||s?T(t,n,i,s):t;"object"==typeof e&&e&&e.domain&&(o=e.domain.bind(o)),W(a,o)}function Y(e,t,n){var i=d(),r=setTimeout(function(){i.reject(new Error(n||"Timed out after "+t+" ms"))},t);return T(e,function(e){clearTimeout(r),i.resolve(e)},function(e){clearTimeout(r),i.reject(e)},i.notify),i.promise}function J(e,t){void 0===t&&(t=e,e=void 0);var n=d();return T(e,void 0,void 0,n.notify),setTimeout(function(){n.resolve(e)},t),n.promise}function X(e,t){var n=dt(t),i=d();return n.push(i.makeNodeResolver()),B(e,n).fail(i.reject),i.promise}function Z(e){var t=dt(arguments,1),n=d();return t.push(n.makeNodeResolver()),B(e,t).fail(n.reject),n.promise}function et(e){var t=dt(arguments,1);return function(){var n=t.concat(dt(arguments)),i=d();return n.push(i.makeNodeResolver()),B(e,n).fail(i.reject),i.promise}}function tt(e,t){var n=dt(arguments,2);return function(){function i(){return e.apply(t,arguments)}var r=n.concat(dt(arguments)),s=d();return r.push(s.makeNodeResolver()),B(i,r).fail(s.reject),s.promise}}function nt(e,t,n){var i=dt(n||[]),r=d();return i.push(r.makeNodeResolver()),St(e,t,i).fail(r.reject),r.promise}function it(e,t){var n=dt(arguments,2),i=d();return n.push(i.makeNodeResolver()),St(e,t,n).fail(i.reject),i.promise}function rt(e,t){return t?void e.then(function(e){ht(function(){t(null,e)})},function(e){ht(function(){t(e)})}):e}var st=!1;try{throw new Error}catch(ot){st=!!ot.stack}var at,lt,ct=c(),ut=function(){},ht=function(){function t(){for(;n.next;){n=n.next;var e=n.task;n.task=void 0;var i=n.domain;i&&(n.domain=void 0,i.enter());try{e()}catch(s){if(o)throw i&&i.exit(),setTimeout(t,0),i&&i.enter(),s;setTimeout(function(){throw s},0)}i&&i.exit()}r=!1}var n={task:void 0,next:null},i=n,r=!1,s=void 0,o=!1;if(ht=function(t){i=i.next={task:t,domain:o&&e.domain,next:null},r||(r=!0,s())
},"undefined"!=typeof e&&e.nextTick)o=!0,s=function(){e.nextTick(t)};else if("function"==typeof setImmediate)s="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var a=new MessageChannel;a.port1.onmessage=t,s=function(){a.port2.postMessage(0)}}else s=function(){setTimeout(t,0)};return ht}(),dt=t(Array.prototype.slice),ft=t(Array.prototype.reduce||function(e,t){var n=0,i=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=i)throw new TypeError}for(;i>n;n++)n in this&&(t=e(t,this[n],n));return t}),pt=t(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),mt=t(Array.prototype.map||function(e,t){var n=this,i=[];return ft(n,function(r,s,o){i.push(e.call(t,s,o,n))},void 0),i}),gt=Object.create||function(e){function t(){}return t.prototype=e,new t},vt=t(Object.prototype.hasOwnProperty),yt=Object.keys||function(e){var t=[];for(var n in e)vt(e,n)&&t.push(n);return t},bt=t(Object.prototype.toString);lt="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var wt;try{new Function("(function* (){ yield 1; })"),wt=!0}catch(ot){wt=!1}var xt="From previous event:";h.nextTick=ht,h.longStackSupport=!1,h.defer=d,d.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):e.resolve(arguments.length>2?dt(arguments,1):n)}},h.promise=f,h.makePromise=p,p.prototype.then=function(e,t,n){function i(t){try{return"function"==typeof e?e(t):t}catch(n){return S(n)}}function s(e){if("function"==typeof t){r(e,a);try{return t(e)}catch(n){return S(n)}}return S(e)}function o(e){return"function"==typeof n?n(e):e}var a=this,l=d(),c=!1;return ht(function(){a.promiseDispatch(function(e){c||(c=!0,l.resolve(i(e)))},"when",[function(e){c||(c=!0,l.resolve(s(e)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=o(e)}catch(i){if(n=!0,!h.onerror)throw i;h.onerror(i)}n||l.notify(t)}]),l.promise},p.prototype.thenResolve=function(e){return T(this,function(){return e})},p.prototype.thenReject=function(e){return T(this,function(){throw e})},ft(["isFulfilled","isRejected","isPending","dispatch","when","spread","get","set","del","delete","post","send","mapply","invoke","mcall","keys","fapply","fcall","fbind","all","allResolved","timeout","delay","catch","finally","fail","fin","progress","done","nfcall","nfapply","nfbind","denodeify","nbind","npost","nsend","nmapply","ninvoke","nmcall","nodeify"],function(e,t){p.prototype[t]=function(){return h[t].apply(h,[this].concat(dt(arguments)))}},void 0),p.prototype.toSource=function(){return this.toString()},p.prototype.toString=function(){return"[object Promise]"},h.nearer=m,h.isPromise=g,h.isPromiseAlike=v,h.isPending=y,h.isFulfilled=b,h.isRejected=w;var kt=[],_t=[],Et=!1,Ct=!0;h.resetUnhandledRejections=_,h.getUnhandledReasons=function(){return kt.slice()},h.stopUnhandledRejectionTracking=function(){_(),"undefined"!=typeof e&&e.on&&e.removeListener("exit",k),Ct=!1},_(),h.reject=S,h.fulfill=$,h.resolve=R,h.master=F,h.when=T,h.spread=V,h.async=I,h.spawn=N,h["return"]=O,h.promised=L,h.dispatch=M,h.dispatcher=D,h.get=D("get"),h.set=D("set"),h["delete"]=h.del=D("delete");var St=h.post=D("post");h.mapply=St,h.send=P,h.invoke=P,h.mcall=P,h.fapply=B,h["try"]=q,h.fcall=q,h.fbind=U,h.keys=D("keys"),h.all=H,h.allResolved=u(j,"allResolved","allSettled"),h.allSettled=K,h["catch"]=h.fail=W,h.progress=z,h["finally"]=h.fin=G,h.done=Q,h.timeout=Y,h.delay=J,h.nfapply=X,h.nfcall=Z,h.nfbind=et,h.denodeify=h.nfbind,h.nbind=tt,h.npost=nt,h.nmapply=nt,h.nsend=it,h.ninvoke=h.nsend,h.nmcall=h.nsend,h.nodeify=rt;var $t=c();return h})}(e("__browserify_process"))},{__browserify_process:15}],templates:[function(e,t){t.exports=e("c2TOuZ")},{}],c2TOuZ:[function(e,t){!function(n){(function(){n.Handlebars=e("handlebars-runtime"),this.Handlebars=this.Handlebars||{},this.Handlebars.templates=this.Handlebars.templates||{},Handlebars.registerPartial("addLinkCandidate",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l="function",c=this.escapeExpression;return a+='    <label class="join-field-label"><input name="join-field" class="join-field-option join-field-option-',(o=n.key)?s=o.call(t,{hash:{},data:r}):(o=t&&t.key,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+'" type="radio" value="',(o=n.key)?s=o.call(t,{hash:{},data:r}):(o=t&&t.key,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+'"> ',(o=n.name)?s=o.call(t,{hash:{},data:r}):(o=t&&t.name,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+"</label>\n"})),Handlebars.registerPartial("addLinkPreview",Handlebars.template(function(e,t,n,i,r){function s(){return'\n<div class="preview-block">\n  <p class="no-preview">Choose a field to see the preview.</p>\n</div>\n'}function o(e,t){var i,r,s="";return s+='\n<div class="preview-block matched">\n  <i class="preview-icon icon-fixed-width icon-check icon-2x"></i>\n  <p class="preview-text">\n    ',i=n["if"].call(e,e&&e.oneMatch,{hash:{},inverse:M.program(6,l,t),fn:M.program(4,a,t),data:t}),(i||0===i)&&(s+=i),s+="\n    will link to the existing record",i=n.unless.call(e,e&&e.oneMatch,{hash:{},inverse:M.noop,fn:M.program(16,p,t),data:t}),(i||0===i)&&(s+=i),s+=' in the <span class="display-name">',(r=n.toSheet)?i=r.call(e,{hash:{},data:t}):(r=e&&e.toSheet,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+"</span> sheet\n  </p>\n</div>\n"}function a(e){var t,n="";return n+='\n      <span class="display-name value">'+L((t=e&&e.match,t=null==t||t===!1?t:t[0],typeof t===O?t.apply(e):t))+"</span>\n      "}function l(e,t){var i,r="";return r+="\n        ",i=n["if"].call(e,e&&e.allMatch,{hash:{},inverse:M.program(9,u,t),fn:M.program(7,c,t),data:t}),(i||0===i)&&(r+=i),r+="\n    "}function c(e,t){var i,r,s="";return s+='\n          <span class="display-name value">All ',(r=n.matchCount)?i=r.call(e,{hash:{},data:t}):(r=e&&e.matchCount,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+" values</span>\n        "}function u(e,t){var i,r="";return r+="\n          ",i=n["if"].call(e,e&&e.twoMatch,{hash:{},inverse:M.noop,fn:M.program(10,h,t),data:t}),(i||0===i)&&(r+=i),r+="\n          ",i=n["if"].call(e,e&&e.threeMatch,{hash:{},inverse:M.noop,fn:M.program(12,d,t),data:t}),(i||0===i)&&(r+=i),r+="\n          ",i=n["if"].call(e,e&&e.manyMatch,{hash:{},inverse:M.noop,fn:M.program(14,f,t),data:t}),(i||0===i)&&(r+=i),r+="\n        "}function h(e){var t,n="";return n+='\n            <span class="display-name value">'+L((t=e&&e.match,t=null==t||t===!1?t:t[0],typeof t===O?t.apply(e):t))+'</span> and\n            <span class="display-name value">'+L((t=e&&e.match,t=null==t||t===!1?t:t[1],typeof t===O?t.apply(e):t))+"</span>\n          "}function d(e){var t,n="";return n+='\n            <span class="display-name value">'+L((t=e&&e.match,t=null==t||t===!1?t:t[0],typeof t===O?t.apply(e):t))+'</span>,\n            <span class="display-name value">'+L((t=e&&e.match,t=null==t||t===!1?t:t[1],typeof t===O?t.apply(e):t))+'</span>, and\n            <span class="display-name value">'+L((t=e&&e.match,t=null==t||t===!1?t:t[2],typeof t===O?t.apply(e):t))+"</span>\n          "}function f(e,t){var i,r,s="";return s+='\n            <span class="display-name value">'+L((i=e&&e.match,i=null==i||i===!1?i:i[0],typeof i===O?i.apply(e):i))+'</span>,\n            <span class="display-name value">'+L((i=e&&e.match,i=null==i||i===!1?i:i[1],typeof i===O?i.apply(e):i))+'</span>, and\n            <span class="display-name value">',(r=n.moreMatch)?i=r.call(e,{hash:{},data:t}):(r=e&&e.moreMatch,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+" other values</span>\n          "}function p(){return"s"}function m(e,t){var i,r,s="";return s+='\n<div class="preview-block added">\n  <i class="preview-icon icon-fixed-width icon-plus-sign-alt icon-2x"></i>\n  <p class="preview-text">\n    ',i=n["if"].call(e,e&&e.oneAdded,{hash:{},inverse:M.program(21,v,t),fn:M.program(19,g,t),data:t}),(i||0===i)&&(s+=i),s+="\n    will be added as ",i=n["if"].call(e,e&&e.oneAdded,{hash:{},inverse:M.noop,fn:M.program(31,_,t),data:t}),(i||0===i)&&(s+=i),s+="new record",i=n.unless.call(e,e&&e.oneAdded,{hash:{},inverse:M.noop,fn:M.program(16,p,t),data:t}),(i||0===i)&&(s+=i),s+=' in the <span class="display-name">',(r=n.toSheet)?i=r.call(e,{hash:{},data:t}):(r=e&&e.toSheet,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+"</span> sheet\n  </p>\n</div>\n"}function g(e){var t,n="";return n+='\n      <span class="display-name value">'+L((t=e&&e.added,t=null==t||t===!1?t:t[0],typeof t===O?t.apply(e):t))+"</span>\n      "}function v(e,t){var i,r="";return r+="\n        ",i=n["if"].call(e,e&&e.allAdded,{hash:{},inverse:M.program(24,b,t),fn:M.program(22,y,t),data:t}),(i||0===i)&&(r+=i),r+="\n    "}function y(e,t){var i,r,s="";return s+='\n          <span class="display-name value">All ',(r=n.addedCount)?i=r.call(e,{hash:{},data:t}):(r=e&&e.addedCount,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+" values</span>\n        "}function b(e,t){var i,r="";return r+="\n          ",i=n["if"].call(e,e&&e.twoAdded,{hash:{},inverse:M.noop,fn:M.program(25,w,t),data:t}),(i||0===i)&&(r+=i),r+="\n          ",i=n["if"].call(e,e&&e.threeAdded,{hash:{},inverse:M.noop,fn:M.program(27,x,t),data:t}),(i||0===i)&&(r+=i),r+="\n          ",i=n["if"].call(e,e&&e.manyAdded,{hash:{},inverse:M.noop,fn:M.program(29,k,t),data:t}),(i||0===i)&&(r+=i),r+="\n        "}function w(e){var t,n="";return n+='\n            <span class="display-name value">'+L((t=e&&e.added,t=null==t||t===!1?t:t[0],typeof t===O?t.apply(e):t))+'</span> and\n            <span class="display-name value">'+L((t=e&&e.added,t=null==t||t===!1?t:t[1],typeof t===O?t.apply(e):t))+"</span>\n          "}function x(e){var t,n="";return n+='\n            <span class="display-name value">'+L((t=e&&e.added,t=null==t||t===!1?t:t[0],typeof t===O?t.apply(e):t))+'</span>,\n            <span class="display-name value">'+L((t=e&&e.added,t=null==t||t===!1?t:t[1],typeof t===O?t.apply(e):t))+'</span>, and\n            <span class="display-name value">'+L((t=e&&e.added,t=null==t||t===!1?t:t[2],typeof t===O?t.apply(e):t))+"</span>\n          "}function k(e,t){var i,r,s="";return s+='\n            <span class="display-name value">'+L((i=e&&e.added,i=null==i||i===!1?i:i[0],typeof i===O?i.apply(e):i))+'</span>,\n            <span class="display-name value">'+L((i=e&&e.added,i=null==i||i===!1?i:i[1],typeof i===O?i.apply(e):i))+'</span>, and\n            <span class="display-name value">',(r=n.moreAdded)?i=r.call(e,{hash:{},data:t}):(r=e&&e.moreAdded,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+" other values</span>\n          "}function _(){return"a "}function E(e,t){var i,r,s="";return s+='\n<div class="preview-block extra">\n  <i class="preview-icon icon-fixed-width icon-edit icon-2x"></i>\n  <p class="preview-text">\n    ',i=n["if"].call(e,e&&e.useId,{hash:{},inverse:M.program(37,$,t),fn:M.program(34,C,t),data:t}),(i||0===i)&&(s+=i),s+='\n    in the <span class="display-name">',(r=n.toSheet)?i=r.call(e,{hash:{},data:t}):(r=e&&e.toSheet,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+"</span> sheet\n  </p>\n</div>\n"}function C(e,t){var i,r,s="";return s+='\n    Values typed like <span class="display-name value">',(r=n.shortIdExample)?i=r.call(e,{hash:{},data:t}):(r=e&&e.shortIdExample,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+'</span> in the <span class="display-name">',(r=n.fromField)?i=r.call(e,{hash:{},data:t}):(r=e&&e.fromField,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+"</span> column of this\n    sheet will ",i=n.unless.call(e,e&&e.allExtra,{hash:{},inverse:M.noop,fn:M.program(35,S,t),data:t}),(i||0===i)&&(s+=i),s+=" be matched against ID numbers\n    "}function S(){return"also"}function $(e,t){var i,r,s="";return s+='\n      Values typed in the <span class="display-name">',(r=n.fromField)?i=r.call(e,{hash:{},data:t}):(r=e&&e.fromField,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+"</span> column of this sheet will ",i=n.unless.call(e,e&&e.allExtra,{hash:{},inverse:M.noop,fn:M.program(35,S,t),data:t}),(i||0===i)&&(s+=i),s+=" be matched against\n      the\n      ",i=n["if"].call(e,e&&e.zeroExtra,{hash:{},inverse:M.noop,fn:M.program(38,R,t),data:t}),(i||0===i)&&(s+=i),s+="\n      ",i=n["if"].call(e,e&&e.oneExtra,{hash:{},inverse:M.noop,fn:M.program(40,A,t),data:t}),(i||0===i)&&(s+=i),s+="\n      ",i=n["if"].call(e,e&&e.twoExtra,{hash:{},inverse:M.noop,fn:M.program(42,F,t),data:t}),(i||0===i)&&(s+=i),s+="\n      ",i=n["if"].call(e,e&&e.threeExtra,{hash:{},inverse:M.noop,fn:M.program(44,T,t),data:t}),(i||0===i)&&(s+=i),s+="\n      ",i=n["if"].call(e,e&&e.manyExtra,{hash:{},inverse:M.noop,fn:M.program(46,V,t),data:t}),(i||0===i)&&(s+=i),s+="\n    "}function R(e,t){var i,r,s="";return s+='\n        <span class="display-name">',(r=n.toField)?i=r.call(e,{hash:{},data:t}):(r=e&&e.toField,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+"</span> column\n      "}function A(e){var t,n="";return n+='\n        value <span class="display-name value">'+L((t=e&&e.extra,t=null==t||t===!1?t:t[0],typeof t===O?t.apply(e):t))+"</span>\n      "}function F(e){var t,n="";return n+='\n        values <span class="display-name value">'+L((t=e&&e.extra,t=null==t||t===!1?t:t[0],typeof t===O?t.apply(e):t))+'</span> and\n        <span class="display-name value">'+L((t=e&&e.extra,t=null==t||t===!1?t:t[1],typeof t===O?t.apply(e):t))+"</span>\n      "}function T(e){var t,n="";return n+='\n        values <span class="display-name value">'+L((t=e&&e.extra,t=null==t||t===!1?t:t[0],typeof t===O?t.apply(e):t))+'</span>,\n        <span class="display-name value">'+L((t=e&&e.extra,t=null==t||t===!1?t:t[1],typeof t===O?t.apply(e):t))+'</span>,\n        and <span class="display-name value">'+L((t=e&&e.extra,t=null==t||t===!1?t:t[2],typeof t===O?t.apply(e):t))+"</span>\n      "}function V(e,t){var i,r,s="";return s+='\n        values <span class="display-name value">'+L((i=e&&e.extra,i=null==i||i===!1?i:i[0],typeof i===O?i.apply(e):i))+'</span>,\n        <span class="display-name value">'+L((i=e&&e.extra,i=null==i||i===!1?i:i[1],typeof i===O?i.apply(e):i))+'</span>,\n        and <span class="display-name value">',(r=n.moreExtra)?i=r.call(e,{hash:{},data:t}):(r=e&&e.moreExtra,i=typeof r===O?r.call(e,{hash:{},data:t}):r),s+=L(i)+" others</span>\n      "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var I,N="",O="function",L=this.escapeExpression,M=this;return I=n["if"].call(t,t&&t.noPreview,{hash:{},inverse:M.noop,fn:M.program(1,s,r),data:r}),(I||0===I)&&(N+=I),N+="\n\n",I=n["if"].call(t,t&&t.matchCount,{hash:{},inverse:M.noop,fn:M.program(3,o,r),data:r}),(I||0===I)&&(N+=I),N+="\n\n",I=n["if"].call(t,t&&t.addedCount,{hash:{},inverse:M.noop,fn:M.program(18,m,r),data:r}),(I||0===I)&&(N+=I),N+="\n\n",I=n["if"].call(t,t&&t.extraCount,{hash:{},inverse:M.noop,fn:M.program(33,E,r),data:r}),(I||0===I)&&(N+=I),N+="\n"})),Handlebars.registerPartial("addSubsheetButtons",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r="";return r+='\n  <button class="btn dropdown-toggle add-subsheet-menu-toggle" data-toggle="dropdown">\n    <span class="caret"></span>\n  </button>\n  <ul class="dropdown-menu add-subsheet-menu">\n    ',i=n.each.call(e,e&&e.potentialSubsheets,{hash:{},inverse:f.noop,fn:f.programWithDepth(2,o,t,e),data:t}),(i||0===i)&&(r+=i),r+='\n    <li class="add-subsheet">\n      <a href="#" tabindex="-1">From new sheet</a>\n    </li>\n  </ul>\n'}function o(e,t,n){var i,r="";return r+='\n      <li class="add-subsheet" data-sheet-id="'+d((i=e&&e.sheet,i=null==i||i===!1?i:i._id,typeof i===h?i.apply(e):i))+'" data-field-key="'+d((i=e&&e.field,i=null==i||i===!1?i:i.key,typeof i===h?i.apply(e):i))+'">\n        <a href="#" tabindex="-1">From '+d((i=e&&e.sheet,i=null==i||i===!1?i:i.title,typeof i===h?i.apply(e):i))+" where "+d((i=e&&e.field,i=null==i||i===!1?i:i.name,typeof i===h?i.apply(e):i))+" = "+d((i=n&&n.recordName,typeof i===h?i.apply(e):i))+"</a>\n      </li>\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var a,l,c,u="",h="function",d=this.escapeExpression,f=this,p=n.helperMissing;return u+='<button class="btn add-subsheet"><i class="icon-plus-sign"></i> '+d((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"add-subsheet",c):p.call(t,"s","add-subsheet",c)))+"</button>\n",a=n["if"].call(t,t&&t.potentialSubsheets,{hash:{},inverse:f.noop,fn:f.program(1,s,r),data:r}),(a||0===a)&&(u+=a),u+="\n"})),Handlebars.registerPartial("aggregateMenuItems",Handlebars.template(function(e,t,n,i,r){function s(e,t,i){var r,s,a="";return a+='\n  <li class="set-aggregate" data-type=',(s=n.type)?r=s.call(e,{hash:{},data:t}):(s=e&&e.type,r=typeof s===c?s.call(e,{hash:{},data:t}):s),a+=u(r)+" data-key="+u((r=i&&i.key,typeof r===c?r.apply(e):r))+'>\n    <a tabindex="-1" href="#">',(s=n.typeName)?r=s.call(e,{hash:{},data:t}):(s=e&&e.typeName,r=typeof s===c?s.call(e,{hash:{},data:t}):s),a+=u(r),r=n["if"].call(e,e&&e.isCurrent,{hash:{},inverse:h.noop,fn:h.program(2,o,t),data:t}),(r||0===r)&&(a+=r),a+="</a>\n  </li>\n"}function o(){return' <i class="icon-fixed-width icon-ok"></i>'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var a,l="",c="function",u=this.escapeExpression,h=this;return a=n.each.call(t,t&&t.aggregates,{hash:{},inverse:h.noop,fn:h.programWithDepth(1,s,r,t),data:r}),(a||0===a)&&(l+=a),l+="\n"})),Handlebars.registerPartial("bookForbidden",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l=n.helperMissing,c=this.escapeExpression;return a+='<div class="book-error well">\n  <h2 class="error-title">'+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"book-error-forbidden-title",o):l.call(t,"s","book-error-forbidden-title",o)))+"</h2>\n  <p>"+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"book-error-forbidden-message",o):l.call(t,"s","book-error-forbidden-message",o)))+"</p>\n</div>\n"})),Handlebars.registerPartial("bookInvited",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a,l="",c=n.helperMissing,u=this.escapeExpression,h="function";return l+='<div class="book-invite">\n  <p class="invite-message">'+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"book-invite-message",a):c.call(t,"s","book-invite-message",a)))+'</p>\n  <p class="current-user well well-small"><img class="user-image" src='+u((s=t&&t.currentUser,s=null==s||s===!1?s:s.imageUrl,typeof s===h?s.apply(t):s))+"> "+u((s=t&&t.currentUser,s=null==s||s===!1?s:s.name,typeof s===h?s.apply(t):s))+" ("+u((s=t&&t.currentUser,s=null==s||s===!1?s:s.email,typeof s===h?s.apply(t):s))+')</p>\n  <p class="invite-options">'+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"book-invite-options",a):c.call(t,"s","book-invite-options",a)))+'</p>\n\n  <form class="claim-form claim-invite" method="post" action="/invitations/'+u((s=t&&t.invitedUser,s=null==s||s===!1?s:s._id,typeof s===h?s.apply(t):s))+'/claim">\n    <input type="hidden" name="bookId" value="',(o=n._id)?s=o.call(t,{hash:{},data:r}):(o=t&&t._id,s=typeof o===h?o.call(t,{hash:{},data:r}):o),l+=u(s)+'">\n    <input type="hidden" name="_csrf" value="',(o=n.csrfToken)?s=o.call(t,{hash:{},data:r}):(o=t&&t.csrfToken,s=typeof o===h?o.call(t,{hash:{},data:r}):o),l+=u(s)+'">\n    <button type="submit" class="btn btn-success">'+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"claim-invite",a):c.call(t,"s","claim-invite",a)))+'</button>\n  </form>\n\n  <form class="claim-form claim-invite-logout" method="post" action="/logout">\n    <input type="hidden" name="_csrf" value="',(o=n.csrfToken)?s=o.call(t,{hash:{},data:r}):(o=t&&t.csrfToken,s=typeof o===h?o.call(t,{hash:{},data:r}):o),l+=u(s)+'">\n    <input type="hidden" name="redirect" value="/books/',(o=n._id)?s=o.call(t,{hash:{},data:r}):(o=t&&t._id,s=typeof o===h?o.call(t,{hash:{},data:r}):o),l+=u(s)+'">\n    <button type="submit" class="btn btn-info">'+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"claim-invite-different-user",a):c.call(t,"s","claim-invite-different-user",a)))+"</button>\n  </form>\n</div>\n"})),Handlebars.registerPartial("bookLink",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l="function",c=this.escapeExpression;return a+='<li class="book-item" data-id="',(o=n._id)?s=o.call(t,{hash:{},data:r}):(o=t&&t._id,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+'">\n  <a class="book-link" href="',(o=n.url)?s=o.call(t,{hash:{},data:r}):(o=t&&t.url,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+'">',(o=n.displayTitle)?s=o.call(t,{hash:{},data:r}):(o=t&&t.displayTitle,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+"</a>\n</li>\n"})),Handlebars.registerPartial("bookLoadError",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l=n.helperMissing,c=this.escapeExpression;return a+='<div class="book-error well">\n  <h2 class="error-title">'+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"book-load-error-title",o):l.call(t,"s","book-load-error-title",o)))+"</h2>\n  <p>"+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"book-load-error-message",o):l.call(t,"s","book-load-error-message",o)))+"</p>\n</div>\n"})),Handlebars.registerPartial("bookNav",Handlebars.template(function(e,t,n,i,r){function s(){return" disabled"}function o(e,t){var r,s="";return s+="\n      ",r=h.invokePartial(i.sheetTab,"sheetTab",e,n,i,t),(r||0===r)&&(s+=r),s+="\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=this.merge(i,e.partials),r=r||{};var a,l,c,u="",h=this,d=n.helperMissing,f=this.escapeExpression;return u+='<form class="form-inline">\n  <button class="btn share-book">\n    <i class="icon-group"></i> '+f((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"share",c):d.call(t,"s","share",c)))+'\n  </button>\n\n  <div class="btn-group">\n    <a class="btn book-actions dropdown-toggle" data-toggle="dropdown" href="#">\n      <span class="caret"></span>\n    </a>\n    <ul class="book-actions-menu dropdown-menu">\n      <li class="undo disabled">\n        <a tabindex="-1" href="#">\n          <i class="icon-fixed-width icon-undo"></i> '+f((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"undo",c):d.call(t,"s","undo",c)))+'\n        </a>\n      </li>\n      <li class="redo disabled">\n        <a tabindex="-1" href="#">\n          <i class="icon-fixed-width icon-repeat"></i> '+f((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"redo",c):d.call(t,"s","redo",c)))+'\n        </a>\n      </li>\n\n      <li class="divider"></li>\n\n      <li class="copy-book">\n        <a tabindex="-1" href="#">\n          <i class="icon-fixed-width icon-copy"></i> '+f((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"copy-book",c):d.call(t,"s","copy-book",c)))+'\n        </a>\n      </li>\n      <li class="leave-book',a=n.unless.call(t,t&&t.canLeave,{hash:{},inverse:h.noop,fn:h.program(1,s,r),data:r}),(a||0===a)&&(u+=a),u+='">\n        <a tabindex="-1" href="#">\n          <i class="icon-fixed-width icon-signout"></i> '+f((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"leave-book",c):d.call(t,"s","leave-book",c)))+'\n        </a>\n      </li>\n      <li class="delete-book',a=n.unless.call(t,t&&t.canDelete,{hash:{},inverse:h.noop,fn:h.program(1,s,r),data:r}),(a||0===a)&&(u+=a),u+='">\n        <a tabindex="-1" href="#">\n          <i class="icon-fixed-width icon-trash"></i> '+f((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"delete-book",c):d.call(t,"s","delete-book",c)))+'\n        </a>\n      </li>\n    </ul>\n  </div>\n</form>\n\n<div class="book-nav-scroll">\n  <ul class="sheet-tabs">\n    ',a=n.each.call(t,t&&t.sheets,{hash:{},inverse:h.noop,fn:h.program(3,o,r),data:r}),(a||0===a)&&(u+=a),u+='\n    <li class="sheet-tab add-sheet">\n      <a href="#">\n        <i class="icon-plus-sign"></i> '+f((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"add-sheet",c):d.call(t,"s","add-sheet",c)))+'\n      </a>\n    </li>\n  </ul>\n\n  <div class="iterator"></div>\n\n  <div class="selection-aggregate-container"></div>\n\n</div>\n'})),Handlebars.registerPartial("cellMenuItems",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s,o="";return o+='\n  <li class="search-cell-value" data-id="'+f((i=e&&e.row,i=null==i||i===!1?i:i.id,typeof i===d?i.apply(e):i))+'" data-key="'+f((i=e&&e.field,i=null==i||i===!1?i:i.key,typeof i===d?i.apply(e):i))+'">\n    <a tabindex="-1" href="#"><i class="icon-fixed-width icon-search"></i> '+f((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"search-cell-value",s):p.call(e,"s","search-cell-value",s)))+'</a>\n  </li>\n  <li class="filter-cell-value" data-id="'+f((i=e&&e.row,i=null==i||i===!1?i:i.id,typeof i===d?i.apply(e):i))+'" data-key="'+f((i=e&&e.field,i=null==i||i===!1?i:i.key,typeof i===d?i.apply(e):i))+'">\n    <a tabindex="-1" href="#"><i class="icon-fixed-width icon-filter"></i> '+f((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"filter-cell-value",s):p.call(e,"s","filter-cell-value",s)))+'</a>\n  </li>\n\n  <li class="divider"></li>\n'}function o(e,t){var i,r,s,o="";return o+='\n  <li class="insert-record-above" data-id="',(r=n.id)?i=r.call(e,{hash:{},data:t}):(r=e&&e.id,i=typeof r===d?r.call(e,{hash:{},data:t}):r),o+=f(i)+'">\n    <a tabindex="-1" href="#"><i class="icon-fixed-width icon-long-arrow-up"></i> '+f((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"insert-record-above",s):p.call(e,"s","insert-record-above",s)))+'</a>\n  </li>\n  <li class="insert-record-below" data-id="',(r=n.id)?i=r.call(e,{hash:{},data:t}):(r=e&&e.id,i=typeof r===d?r.call(e,{hash:{},data:t}):r),o+=f(i)+'">\n    <a tabindex="-1" href="#"><i class="icon-fixed-width icon-long-arrow-down"></i> '+f((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"insert-record-below",s):p.call(e,"s","insert-record-below",s)))+'</a>\n  </li>\n  <li class="delete-record" data-id="',(r=n.id)?i=r.call(e,{hash:{},data:t}):(r=e&&e.id,i=typeof r===d?r.call(e,{hash:{},data:t}):r),o+=f(i)+'">\n    <a tabindex="-1" href="#"><i class="icon-fixed-width icon-remove"></i> '+f((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"delete-record",s):p.call(e,"s","delete-record",s)))+"</a>\n  </li>\n"}function a(e,t){var i,r,s="";return s+='\n  <li class="delete-field" data-key="',(r=n.key)?i=r.call(e,{hash:{},data:t}):(r=e&&e.key,i=typeof r===d?r.call(e,{hash:{},data:t}):r),s+=f(i)+'">\n    <a tabindex="-1" href="#">\n      <i class="icon-fixed-width icon-remove"></i>\n      ',i=n["if"].call(e,e&&e.name,{hash:{},inverse:m.program(8,c,t),fn:m.program(6,l,t),data:t}),(i||0===i)&&(s+=i),s+="\n    </a>\n  </li>\n"}function l(e,t){var i,r;return f((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"delete-field",r):p.call(e,"s","delete-field",r)))}function c(e,t){var i,r;return f((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"delete-unnamed-field",r):p.call(e,"s","delete-unnamed-field",r)))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var u,h="",d="function",f=this.escapeExpression,p=n.helperMissing,m=this;return u=n["if"].call(t,t&&t.value,{hash:{},inverse:m.noop,fn:m.program(1,s,r),data:r}),(u||0===u)&&(h+=u),h+="\n\n",u=n["with"].call(t,t&&t.row,{hash:{},inverse:m.noop,fn:m.program(3,o,r),data:r}),(u||0===u)&&(h+=u),h+='\n\n<li class="divider"></li>\n\n',u=n["with"].call(t,t&&t.field,{hash:{},inverse:m.noop,fn:m.program(5,a,r),data:r}),(u||0===u)&&(h+=u),h+="\n"})),Handlebars.registerPartial("completionExpression",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r="";return i=n["if"].call(e,e&&e.isOrder,{hash:{},inverse:$.noop,fn:$.program(2,o,t),data:t}),(i||0===i)&&(r+=i),i=n["if"].call(e,e&&e.slug,{hash:{},inverse:$.noop,fn:$.program(7,c,t),data:t}),(i||0===i)&&(r+=i),i=n["if"].call(e,e&&e.val,{hash:{},inverse:$.noop,fn:$.program(9,u,t),data:t}),(i||0===i)&&(r+=i),i=n["if"].call(e,e&&e.isBinary,{hash:{},inverse:$.noop,fn:$.program(11,h,t),data:t}),(i||0===i)&&(r+=i),i=n["if"].call(e,e&&e.isUnary,{hash:{},inverse:$.noop,fn:$.program(16,p,t),data:t}),(i||0===i)&&(r+=i),i=n["if"].call(e,e&&e.isParen,{hash:{},inverse:$.noop,fn:$.program(21,v,t),data:t}),(i||0===i)&&(r+=i),i=n["if"].call(e,e&&e.isIf,{hash:{},inverse:$.noop,fn:$.program(23,y,t),data:t}),(i||0===i)&&(r+=i),i=n["if"].call(e,e&&e.isFunction,{hash:{},inverse:$.noop,fn:$.program(28,x,t),data:t}),(i||0===i)&&(r+=i),i=n["if"].call(e,e&&e.completionText,{hash:{},inverse:$.noop,fn:$.program(32,E,t),data:t}),(i||0===i)&&(r+=i),r}function o(e,t){var r,s="";return r=$.invokePartial(i.completionExpression,"completionExpression",e&&e.expr1,n,i,t),(r||0===r)&&(s+=r),s+=" ",r=n["if"].call(e,e&&e.ascending,{hash:{},inverse:$.program(5,l,t),fn:$.program(3,a,t),data:t}),(r||0===r)&&(s+=r),s}function a(){return"asc"}function l(){return"desc"}function c(e,t){var i,r,s="";return s+='<span class="field">',(r=n.slug)?i=r.call(e,{hash:{},data:t}):(r=e&&e.slug,i=typeof r===R?r.call(e,{hash:{},data:t}):r),s+=A(i)+"</span>"}function u(e,t){var i,r,s="";return s+='<span class="val">',(r=n.quoteChar)?i=r.call(e,{hash:{},data:t}):(r=e&&e.quoteChar,i=typeof r===R?r.call(e,{hash:{},data:t}):r),s+=A(i),(r=n.val)?i=r.call(e,{hash:{},data:t}):(r=e&&e.val,i=typeof r===R?r.call(e,{hash:{},data:t}):r),s+=A(i),(r=n.quoteChar)?i=r.call(e,{hash:{},data:t}):(r=e&&e.quoteChar,i=typeof r===R?r.call(e,{hash:{},data:t}):r),s+=A(i)+"</span>"}function h(e,t){var i,r="";return i=n["if"].call(e,e&&e.spaceAroundOp,{hash:{},inverse:$.program(14,f,t),fn:$.program(12,d,t),data:t}),(i||0===i)&&(r+=i),r}function d(e,t){var r,s,o="";return r=$.invokePartial(i.completionExpression,"completionExpression",e&&e.expr1,n,i,t),(r||0===r)&&(o+=r),o+=" ",(s=n.op)?r=s.call(e,{hash:{},data:t}):(s=e&&e.op,r=typeof s===R?s.call(e,{hash:{},data:t}):s),o+=A(r)+" ",r=$.invokePartial(i.completionExpression,"completionExpression",e&&e.expr2,n,i,t),(r||0===r)&&(o+=r),o}function f(e,t){var r,s,o="";return r=$.invokePartial(i.completionExpression,"completionExpression",e&&e.expr1,n,i,t),(r||0===r)&&(o+=r),(s=n.op)?r=s.call(e,{hash:{},data:t}):(s=e&&e.op,r=typeof s===R?s.call(e,{hash:{},data:t}):s),o+=A(r),r=$.invokePartial(i.completionExpression,"completionExpression",e&&e.expr2,n,i,t),(r||0===r)&&(o+=r),o}function p(e,t){var i,r="";return i=n["if"].call(e,e&&e.spaceAroundOp,{hash:{},inverse:$.program(19,g,t),fn:$.program(17,m,t),data:t}),(i||0===i)&&(r+=i),r}function m(e,t){var r,s,o="";return(s=n.op)?r=s.call(e,{hash:{},data:t}):(s=e&&e.op,r=typeof s===R?s.call(e,{hash:{},data:t}):s),o+=A(r)+" ",r=$.invokePartial(i.completionExpression,"completionExpression",e&&e.expr,n,i,t),(r||0===r)&&(o+=r),o}function g(e,t){var r,s,o="";return(s=n.op)?r=s.call(e,{hash:{},data:t}):(s=e&&e.op,r=typeof s===R?s.call(e,{hash:{},data:t}):s),o+=A(r),r=$.invokePartial(i.completionExpression,"completionExpression",e&&e.expr,n,i,t),(r||0===r)&&(o+=r),o}function v(e,t){var r,s="";return s+="(",r=$.invokePartial(i.completionExpression,"completionExpression",e&&e.expr,n,i,t),(r||0===r)&&(s+=r),s+=")"}function y(e,t){var r,s="";return s+="if ",r=$.invokePartial(i.completionExpression,"completionExpression",e&&e.cond,n,i,t),(r||0===r)&&(s+=r),r=n["if"].call(e,e&&e.then,{hash:{},inverse:$.noop,fn:$.program(24,b,t),data:t}),(r||0===r)&&(s+=r),r=n["if"].call(e,e&&e["else"],{hash:{},inverse:$.noop,fn:$.program(26,w,t),data:t}),(r||0===r)&&(s+=r),s}function b(e,t){var r,s="";return s+=" then ",r=$.invokePartial(i.completionExpression,"completionExpression",e&&e.then,n,i,t),(r||0===r)&&(s+=r),s}function w(e,t){var r,s="";return s+=" else ",r=$.invokePartial(i.completionExpression,"completionExpression",e&&e["else"],n,i,t),(r||0===r)&&(s+=r),s}function x(e,t){var i,r,s="";return(r=n.name)?i=r.call(e,{hash:{},data:t}):(r=e&&e.name,i=typeof r===R?r.call(e,{hash:{},data:t}):r),s+=A(i)+"(",i=n.each.call(e,e&&e.arguments,{hash:{},inverse:$.noop,fn:$.program(29,k,t),data:t}),(i||0===i)&&(s+=i),s+=")"}function k(e,t){var r,s="";return r=n["if"].call(e,null==t||t===!1?t:t.index,{hash:{},inverse:$.noop,fn:$.program(30,_,t),data:t}),(r||0===r)&&(s+=r),r=$.invokePartial(i.completionExpression,"completionExpression",e,n,i,t),(r||0===r)&&(s+=r),s
}function _(){return", "}function E(e,t){var i,r,s="";return s+='<span class="completion-text">',(r=n.completionText)?i=r.call(e,{hash:{},data:t}):(r=e&&e.completionText,i=typeof r===R?r.call(e,{hash:{},data:t}):r),s+=A(i)+"</span>"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=this.merge(i,e.partials),r=r||{};var C,S="",$=this,R="function",A=this.escapeExpression;return C=n["if"].call(t,t,{hash:{},inverse:$.noop,fn:$.program(1,s,r),data:r}),(C||0===C)&&(S+=C),S})),Handlebars.registerPartial("completionItem",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+="icon-",(r=n.icon)?i=r.call(e,{hash:{},data:t}):(r=e&&e.icon,i=typeof r===v?r.call(e,{hash:{},data:t}):r),s+=y(i)}function o(e,t){var i,r,s="";return s+='\n    <span class="',i=n["if"].call(e,e&&e["class"],{hash:{},inverse:b.noop,fn:b.program(4,a,t),data:t}),(i||0===i)&&(s+=i),s+='">',(r=n.text)?i=r.call(e,{hash:{},data:t}):(r=e&&e.text,i=typeof r===v?r.call(e,{hash:{},data:t}):r),s+=y(i)+"</span>\n  "}function a(e,t){var i,r;return(r=n["class"])?i=r.call(e,{hash:{},data:t}):(r=e&&e["class"],i=typeof r===v?r.call(e,{hash:{},data:t}):r),y(i)}function l(e,t){var i,r,s,o="";return o+="\n    ",i=n["if"].call(e,e&&e.name,{hash:{},inverse:b.noop,fn:b.program(7,c,t),data:t}),(i||0===i)&&(o+=i),r=n.join||e&&e.join,s={hash:{},inverse:b.noop,fn:b.program(12,d,t),data:t},i=r?r.call(e,e&&e.expressions,", ",s):w.call(e,"join",e&&e.expressions,", ",s),(i||0===i)&&(o+=i),i=n["if"].call(e,e&&e.name,{hash:{},inverse:b.noop,fn:b.program(14,f,t),data:t}),(i||0===i)&&(o+=i),o}function c(e,t){var i,r,s="";return s+='<span class="command">',(r=n.name)?i=r.call(e,{hash:{},data:t}):(r=e&&e.name,i=typeof r===v?r.call(e,{hash:{},data:t}):r),s+=y(i)+"</span>",i=n["if"].call(e,e&&e.hasParens,{hash:{},inverse:b.program(10,h,t),fn:b.program(8,u,t),data:t}),(i||0===i)&&(s+=i),s}function u(){return"("}function h(){return" "}function d(e,t){var r,s="";return r=b.invokePartial(i.completionExpression,"completionExpression",e,n,i,t),(r||0===r)&&(s+=r),s}function f(e,t){var i,r="";return i=n["if"].call(e,e&&e.hasParens,{hash:{},inverse:b.noop,fn:b.program(15,p,t),data:t}),(i||0===i)&&(r+=i),r}function p(){return")"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=this.merge(i,e.partials),r=r||{};var m,g="",v="function",y=this.escapeExpression,b=this,w=n.helperMissing;return g+='<span class="completion">\n  <i class="icon icon-fixed-width ',m=n["if"].call(t,t&&t.icon,{hash:{},inverse:b.noop,fn:b.program(1,s,r),data:r}),(m||0===m)&&(g+=m),g+='"></i>\n\n  ',m=n["if"].call(t,t&&t.text,{hash:{},inverse:b.program(6,l,r),fn:b.program(3,o,r),data:r}),(m||0===m)&&(g+=m),g+="\n</span>\n"})),Handlebars.registerPartial("divider",Handlebars.template(function(e,t,n,i,r){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{},'<li class="divider"></li>\n'})),Handlebars.registerPartial("feedbackPopup",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l="function",c=this.escapeExpression;return a+='<div class="feedback-popup">\n  <p class="feedback-popup-title"></p>\n  <form class="form feedback-form">\n    <textarea class="feedback-input">',(o=n.text)?s=o.call(t,{hash:{},data:r}):(o=t&&t.text,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+'</textarea>\n    <button type="submit" class="btn btn-success">Send</button>\n    <span class="feedback-status help-inline"></span>\n  </form>\n</div>\n'})),Handlebars.registerPartial("fieldHeaderButtons",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+='\n    <i class="icon-sort field-option sort-option" title="'+d((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"sort-field",r):h.call(e,"s","sort-field",r)))+'"></i>\n  '}function o(e,t){var i,r,s="";return s+='\n    <i class="icon-th-list field-option group-option" title="'+d((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"group-field",r):h.call(e,"s","group-field",r)))+'"></i>\n  '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var a,l,c,u="",h=n.helperMissing,d=this.escapeExpression,f=this;return u+='<div class="field-options">\n  ',a=n["if"].call(t,t&&t.showSortOption,{hash:{},inverse:f.noop,fn:f.program(1,s,r),data:r}),(a||0===a)&&(u+=a),u+="\n  ",a=n["if"].call(t,t&&t.showGroupOption,{hash:{},inverse:f.noop,fn:f.program(3,o,r),data:r}),(a||0===a)&&(u+=a),u+='\n  <i class="icon-gear field-option field-settings" title="'+d((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"field-actions",c):h.call(t,"s","field-actions",c)))+'"></i>\n</div>\n'})),Handlebars.registerPartial("fieldMenuItems",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r;return k((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"rename-field",r):x.call(e,"s","rename-field",r)))}function o(e,t){var i,r;return k((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"name-field",r):x.call(e,"s","name-field",r)))}function a(e,t){var i,r="";return r+="\n  ",i=n["if"].call(e,e&&e.slug,{hash:{},inverse:E.noop,fn:E.program(6,l,t),data:t}),(i||0===i)&&(r+=i),r+="\n"}function l(e,t){var i,r,s,o="";return o+='\n    <li class="search-field" data-key=',(r=n.key)?i=r.call(e,{hash:{},data:t}):(r=e&&e.key,i=typeof r===_?r.call(e,{hash:{},data:t}):r),o+=k(i)+'>\n      <a tabindex="-1" href="#"><i class="icon-fixed-width icon-search"></i> '+k((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"search-field",s):x.call(e,"s","search-field",s)))+"</a>\n    </li>\n  "}function c(e,t){var i,r,s,o="";return o+='\n  <li class="group-field" data-key=',(r=n.key)?i=r.call(e,{hash:{},data:t}):(r=e&&e.key,i=typeof r===_?r.call(e,{hash:{},data:t}):r),o+=k(i)+'>\n    <a tabindex="-1" href="#"><i class="icon-fixed-width icon-th-list"></i> '+k((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"group-field",s):x.call(e,"s","group-field",s)))+"</a>\n  </li>\n"}function u(e,t){var i,r,s,o="";return o+='\n  <li class="report-on-field" data-key=',(r=n.key)?i=r.call(e,{hash:{},data:t}):(r=e&&e.key,i=typeof r===_?r.call(e,{hash:{},data:t}):r),o+=k(i)+'>\n    <a tabindex="-1" href="#"><i class="icon-fixed-width icon-bar-chart"></i> '+k((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"report-on-field",s):x.call(e,"s","report-on-field",s)))+"</a>\n  </li>\n"}function h(e,t){var i,r,s,o="";return o+='\n  <li class="remove-link" data-key=',(r=n.key)?i=r.call(e,{hash:{},data:t}):(r=e&&e.key,i=typeof r===_?r.call(e,{hash:{},data:t}):r),o+=k(i)+'>\n    <a tabindex="-1" href="#"><i class="icon-fixed-width icon-unlink"></i> '+k((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"remove-link",s):x.call(e,"s","remove-link",s)))+"</a>\n  </li>\n"}function d(e,t){var i,r,s,o="";return o+='\n  <li class="add-link-menu dropdown-submenu">\n    <a tabindex="-1" href="#"><i class="icon-fixed-width icon-link"></i> '+k((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"add-link",s):x.call(e,"s","add-link",s)))+'</a>\n    <ul class="dropdown-menu">\n      ',i=n.each.call(e,e&&e.sheets,{hash:{},inverse:E.noop,fn:E.programWithDepth(15,f,t,e),data:t}),(i||0===i)&&(o+=i),o+='\n      <li class="extract-supersheet" data-key=',(r=n.key)?i=r.call(e,{hash:{},data:t}):(r=e&&e.key,i=typeof r===_?r.call(e,{hash:{},data:t}):r),o+=k(i)+'>\n        <a tabindex="-1" href="#"><span class="add-link-new-sheet">'+k((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"add-link-new-sheet",s):x.call(e,"s","add-link-new-sheet",s)))+"</span></a>\n      </li>\n    </ul>\n  </li>\n"}function f(e,t,i){var r,s,o="";return o+='\n        <li class="add-link" data-key='+k((r=i&&i.key,typeof r===_?r.apply(e):r))+" data-sheet-id=",(s=n._id)?r=s.call(e,{hash:{},data:t}):(s=e&&e._id,r=typeof s===_?s.call(e,{hash:{},data:t}):s),o+=k(r)+'>\n          <a tabindex="-1" href="#">',(s=n.title)?r=s.call(e,{hash:{},data:t}):(s=e&&e.title,r=typeof s===_?s.call(e,{hash:{},data:t}):s),o+=k(r),r=n["if"].call(e,e&&e.isCurrent,{hash:{},inverse:E.noop,fn:E.program(16,p,t),data:t}),(r||0===r)&&(o+=r),o+="</a>\n        </li>\n      "}function p(e,t){var i,r,s="";return s+=' <span class="add-link-this-sheet">'+k((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"add-link-this-sheet",r):x.call(e,"s","add-link-this-sheet",r)))+"</span>"}function m(e,t){var i,r;return k((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"delete-field",r):x.call(e,"s","delete-field",r)))}function g(e,t){var i,r;return k((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"delete-unnamed-field",r):x.call(e,"s","delete-unnamed-field",r)))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=this.merge(i,e.partials),r=r||{};var v,y,b,w="",x=n.helperMissing,k=this.escapeExpression,_="function",E=this;return w+='<li class="rename-field" data-key=',(y=n.key)?v=y.call(t,{hash:{},data:r}):(y=t&&t.key,v=typeof y===_?y.call(t,{hash:{},data:r}):y),w+=k(v)+'>\n  <a tabindex="-1" href="#">\n    <i class="icon-fixed-width icon-pencil"></i>\n    ',v=n["if"].call(t,t&&t.name,{hash:{},inverse:E.program(3,o,r),fn:E.program(1,s,r),data:r}),(v||0===v)&&(w+=v),w+="\n  </a>\n</li>\n\n",v=n["if"].call(t,t&&t.showSearchAction,{hash:{},inverse:E.noop,fn:E.program(5,a,r),data:r}),(v||0===v)&&(w+=v),w+="\n\n",v=n["if"].call(t,t&&t.showGroupAction,{hash:{},inverse:E.noop,fn:E.program(8,c,r),data:r}),(v||0===v)&&(w+=v),w+="\n\n",v=n["if"].call(t,t&&t.showReportAction,{hash:{},inverse:E.noop,fn:E.program(10,u,r),data:r}),(v||0===v)&&(w+=v),w+='\n\n<li class="divider"></li>\n\n',v=n["if"].call(t,t&&t.linkedSheet,{hash:{},inverse:E.program(14,d,r),fn:E.program(12,h,r),data:r}),(v||0===v)&&(w+=v),w+='\n\n<li class="divider"></li>\n\n<li class="set-formula" data-key=',(y=n.key)?v=y.call(t,{hash:{},data:r}):(y=t&&t.key,v=typeof y===_?y.call(t,{hash:{},data:r}):y),w+=k(v)+'>\n  <a tabindex="-1" href="#"><i class="icon-fixed-width">&fnof;</i> '+k((y=n.s||t&&t.s,b={hash:{},data:r},y?y.call(t,"set-field-formula",b):x.call(t,"s","set-field-formula",b)))+'</a>\n</li>\n\n<li class="aggregate-menu dropdown-submenu">\n  <a tabindex="-1" href="#"><i class="icon-fixed-width">&Sigma;</i> '+k((y=n.s||t&&t.s,b={hash:{},data:r},y?y.call(t,"set-field-aggregate",b):x.call(t,"s","set-field-aggregate",b)))+'</a>\n  <ul class="dropdown-menu">\n    ',v=E.invokePartial(i.aggregateMenuItems,"aggregateMenuItems",t,n,i,r),(v||0===v)&&(w+=v),w+='\n  </ul>\n</li>\n\n<li class="divider"></li>\n\n<li class="delete-field" data-key=',(y=n.key)?v=y.call(t,{hash:{},data:r}):(y=t&&t.key,v=typeof y===_?y.call(t,{hash:{},data:r}):y),w+=k(v)+'>\n  <a tabindex="-1" href="#">\n    <i class="icon-fixed-width icon-remove"></i>\n    ',v=n["if"].call(t,t&&t.name,{hash:{},inverse:E.program(20,g,r),fn:E.program(18,m,r),data:r}),(v||0===v)&&(w+=v),w+="\n  </a>\n</li>\n"})),Handlebars.registerPartial("groupMenuItems",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l=n.helperMissing,c=this.escapeExpression;return a+='<li class="delete-record-list">\n  <a tabindex="-1" href="#">\n    <i class="icon-fixed-width icon-remove"></i>\n    '+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,t&&t.deleteActionTemplate,o):l.call(t,"s",t&&t.deleteActionTemplate,o)))+"\n  </a>\n</li>\n"})),Handlebars.registerPartial("groupTitles",Handlebars.template(function(e,t,n,i,r){function s(e,t,i){var r,s,c="";return c+='\n  <div class="group-title-section">\n    <span class="group-title-',(s=n.size)?r=s.call(e,{hash:{},data:t}):(s=e&&e.size,r=typeof s===p?s.call(e,{hash:{},data:t}):s),c+=m(r)+'">\n      ',r=n["if"].call(e,i&&i.showFieldNames,{hash:{},inverse:g.noop,fn:g.program(2,o,t),data:t}),(r||0===r)&&(c+=r),c+="\n\n      ",r=n["if"].call(e,e&&e.url,{hash:{},inverse:g.programWithDepth(6,l,t,i),fn:g.program(4,a,t),data:t}),(r||0===r)&&(c+=r),c+="\n\n      ",r=n["if"].call(e,i&&i.showDeleteListAction,{hash:{},inverse:g.noop,fn:g.program(9,u,t),data:t}),(r||0===r)&&(c+=r),c+="\n    </span>\n    ",r=n["if"].call(e,e&&e.ruler,{hash:{},inverse:g.noop,fn:g.program(11,h,t),data:t}),(r||0===r)&&(c+=r),c+="\n  </div>\n"}function o(e,t){var i,r,s="";return s+='\n        <span class="field-name">\n          ',(r=n.fieldName)?i=r.call(e,{hash:{},data:t}):(r=e&&e.fieldName,i=typeof r===p?r.call(e,{hash:{},data:t}):r),s+=m(i)+":\n        </span>\n      "}function a(e,t){var i,r,s="";return s+='\n        <a href="',(r=n.url)?i=r.call(e,{hash:{},data:t}):(r=e&&e.url,i=typeof r===p?r.call(e,{hash:{},data:t}):r),s+=m(i)+'">',(r=n.title)?i=r.call(e,{hash:{},data:t}):(r=e&&e.title,i=typeof r===p?r.call(e,{hash:{},data:t}):r),s+=m(i)+"</a>\n      "}function l(e,t,i){var r,s,o="";return o+='\n        <span class="editable-title" ',r=n["if"].call(e,i&&i.allowTitleRename,{hash:{},inverse:g.noop,fn:g.program(7,c,t),data:t}),(r||0===r)&&(o+=r),o+=">",(s=n.title)?r=s.call(e,{hash:{},data:t}):(s=e&&e.title,r=typeof s===p?s.call(e,{hash:{},data:t}):s),o+=m(r)+"</span>\n      "}function c(){return"contenteditable=true"}function u(){return'\n        <i class="icon-gear record-list-settings"></i>\n      '}function h(){return"<hr>"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var d,f="",p="function",m=this.escapeExpression,g=this;return d=n.each.call(t,t&&t.titles,{hash:{},inverse:g.noop,fn:g.programWithDepth(1,s,r,t),data:r}),(d||0===d)&&(f+=d),f+="\n"})),Handlebars.registerPartial("groupingMessage",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s,o="";return(r=n.name)?i=r.call(e,{hash:{},data:t}):(r=e&&e.name,i=typeof r===d?r.call(e,{hash:{},data:t}):r),o+=f(i)+' (<span data-key="',(r=n.key)?i=r.call(e,{hash:{},data:t}):(r=e&&e.key,i=typeof r===d?r.call(e,{hash:{},data:t}):r),o+=f(i)+'" class="ungroup link">'+f((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"ungroup",s):p.call(e,"s","ungroup",s)))+"</span>)"}function o(e,t){var i,r,s,o="";return o+="\n"+f((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"custom-order-message",s):p.call(e,"s","custom-order-message",s)))+"\n",r=n.join||e&&e.join,s={hash:{},inverse:m.noop,fn:m.program(4,a,t),data:t},i=r?r.call(e,e&&e.customOrderFields,", ",s):p.call(e,"join",e&&e.customOrderFields,", ",s),(i||0===i)&&(o+=i),o+=".\n"}function a(e,t){var i,r,s,o="";return(r=n.name)?i=r.call(e,{hash:{},data:t}):(r=e&&e.name,i=typeof r===d?r.call(e,{hash:{},data:t}):r),o+=f(i)+' (<span data-key="',(r=n.key)?i=r.call(e,{hash:{},data:t}):(r=e&&e.key,i=typeof r===d?r.call(e,{hash:{},data:t}):r),o+=f(i)+'" class="remove-custom-order link">'+f((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"remove",s):p.call(e,"s","remove",s)))+"</span>)"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var l,c,u,h="",d="function",f=this.escapeExpression,p=n.helperMissing,m=this;return h+=f((c=n.s||t&&t.s,u={hash:{},data:r},c?c.call(t,"grouping-by",u):p.call(t,"s","grouping-by",u)))+"\n",c=n.join||t&&t.join,u={hash:{},inverse:m.noop,fn:m.program(1,s,r),data:r},l=c?c.call(t,t&&t.fields,", ",u):p.call(t,"join",t&&t.fields,", ",u),(l||0===l)&&(h+=l),h+=".\n\n",l=n["if"].call(t,t&&t.anyCustomOrder,{hash:{},inverse:m.noop,fn:m.program(3,o,r),data:r}),(l||0===l)&&(h+=l),h+="\n"})),Handlebars.registerPartial("idFieldMenuItems",Handlebars.template(function(e,t,n,i,r){function s(){return"icon-ok"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var o,a,l,c="",u="function",h=this.escapeExpression,d=this,f=n.helperMissing;return c+='<li class="toggle-name-field" data-key=',(a=n.key)?o=a.call(t,{hash:{},data:r}):(a=t&&t.key,o=typeof a===u?a.call(t,{hash:{},data:r}):a),c+=h(o)+'>\n  <a tabindex="-1" href="#">\n    <i class="icon-fixed-width ',o=n["if"].call(t,t&&t.hasName,{hash:{},inverse:d.noop,fn:d.program(1,s,r),data:r}),(o||0===o)&&(c+=o),c+='"></i>\n    <i class="icon-fixed-width">@</i>\n    '+h((a=n.s||t&&t.s,l={hash:{},data:r},a?a.call(t,"record-list-toggle-name",l):f.call(t,"s","record-list-toggle-name",l)))+"\n  </a>\n</li>\n"})),Handlebars.registerPartial("insertGroup",Handlebars.template(function(e,t,n,i,r){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{},'<div class="insert-group-block">\n  <i class="insert-group-button icon-plus-sign"></i>\n  <div class="insert-group-line"></div>\n</div>\n'})),Handlebars.registerPartial("link",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l="function",c=this.escapeExpression;return a+='<a href="',(o=n.url)?s=o.call(t,{hash:{},data:r}):(o=t&&t.url,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+'">',(o=n.text)?s=o.call(t,{hash:{},data:r}):(o=t&&t.text,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+"</a>\n"})),Handlebars.registerPartial("logoutPopover",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a,l="",c="function",u=this.escapeExpression,h=n.helperMissing;return l+='<form class="logout-form" action="/logout" method="post">\n  <input type="hidden" name="_csrf" value="',(o=n.csrfToken)?s=o.call(t,{hash:{},data:r}):(o=t&&t.csrfToken,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'">\n  <button class="btn btn-primary logout">'+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"sign-out",a):h.call(t,"s","sign-out",a)))+"</button>\n</form>\n"})),Handlebars.registerPartial("nameFieldMenuItems",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r="";return r+="\n  ",i=n["if"].call(e,e&&e.slug,{hash:{},inverse:p.noop,fn:p.program(2,o,t),data:t}),(i||0===i)&&(r+=i),r+="\n"}function o(e,t){var i,r,s,o="";return o+='\n    <li class="search-field" data-key=',(r=n.key)?i=r.call(e,{hash:{},data:t}):(r=e&&e.key,i=typeof r===h?r.call(e,{hash:{},data:t}):r),o+=d(i)+'>\n      <a tabindex="-1" href="#"><i class="icon-fixed-width icon-search"></i> '+d((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"search-field",s):f.call(e,"s","search-field",s)))+"</a>\n    </li>\n  "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=this.merge(i,e.partials),r=r||{};var a,l,c,u="",h="function",d=this.escapeExpression,f=n.helperMissing,p=this;return a=n["if"].call(t,t&&t.showSearchAction,{hash:{},inverse:p.noop,fn:p.program(1,s,r),data:r}),(a||0===a)&&(u+=a),u+='\n\n<li class="divider"></li>\n\n<li class="set-formula" data-key=',(l=n.key)?a=l.call(t,{hash:{},data:r}):(l=t&&t.key,a=typeof l===h?l.call(t,{hash:{},data:r}):l),u+=d(a)+'>\n  <a tabindex="-1" href="#"><i class="icon-fixed-width">&fnof;</i> '+d((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"set-field-formula",c):f.call(t,"s","set-field-formula",c)))+'</a>\n</li>\n\n<li class="aggregate-menu dropdown-submenu">\n  <a tabindex="-1" href="#"><i class="icon-fixed-width">&Sigma;</i> '+d((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"set-field-aggregate",c):f.call(t,"s","set-field-aggregate",c)))+'</a>\n  <ul class="dropdown-menu">\n    ',a=p.invokePartial(i.aggregateMenuItems,"aggregateMenuItems",t,n,i,r),(a||0===a)&&(u+=a),u+='\n  </ul>\n</li>\n\n<li class="divider"></li>\n\n<li class="hide-name-field" data-key=',(l=n.key)?a=l.call(t,{hash:{},data:r}):(l=t&&t.key,a=typeof l===h?l.call(t,{hash:{},data:r}):l),u+=d(a)+'>\n  <a tabindex="-1" href="#">\n    <i class="icon-fixed-width icon-ban-circle"></i>\n    '+d((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"record-list-hide-name",c):f.call(t,"s","record-list-hide-name",c)))+"\n  </a>\n</li>\n"})),Handlebars.registerPartial("recordIterator",Handlebars.template(function(e,t,n,i,r){function s(){return' disabled="true"'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var o,a,l="",c="function",u=this.escapeExpression,h=this;return l+='<p class="iterator-message">',(a=n.number)?o=a.call(t,{hash:{},data:r}):(a=t&&t.number,o=typeof a===c?a.call(t,{hash:{},data:r}):a),l+=u(o)+" of ",(a=n.total)?o=a.call(t,{hash:{},data:r}):(a=t&&t.total,o=typeof a===c?a.call(t,{hash:{},data:r}):a),l+=u(o)+'</p>\n<div class="btn-group">\n  <button class="iterator-button prev-record btn" data-id="',(a=n.prevId)?o=a.call(t,{hash:{},data:r}):(a=t&&t.prevId,o=typeof a===c?a.call(t,{hash:{},data:r}):a),l+=u(o)+'"',o=n.unless.call(t,t&&t.prevId,{hash:{},inverse:h.noop,fn:h.program(1,s,r),data:r}),(o||0===o)&&(l+=o),l+='><i class="icon-chevron-left"></i></button>\n  <button class="iterator-button next-record btn" data-id="',(a=n.nextId)?o=a.call(t,{hash:{},data:r}):(a=t&&t.nextId,o=typeof a===c?a.call(t,{hash:{},data:r}):a),l+=u(o)+'"',o=n.unless.call(t,t&&t.nextId,{hash:{},inverse:h.noop,fn:h.program(1,s,r),data:r}),(o||0===o)&&(l+=o),l+='><i class="icon-chevron-right"></i></button>\n</div>\n'})),Handlebars.registerPartial("recordLink",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a,l="",c="function",u=this.escapeExpression,h=n.helperMissing;return l+='<a class="view-record" href="',(o=n.url)?s=o.call(t,{hash:{},data:r}):(o=t&&t.url,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'">'+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"view-record",a):h.call(t,"s","view-record",a)))+"</a>\n"})),Handlebars.registerPartial("recordMenuItems",Handlebars.template(function(e,t,n,i,r){function s(){return"disabled"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var o,a,l,c="",u=this,h="function",d=this.escapeExpression,f=n.helperMissing;return c+='<li class="insert-record-above ',o=n["if"].call(t,t&&t.disabled,{hash:{},inverse:u.noop,fn:u.program(1,s,r),data:r}),(o||0===o)&&(c+=o),c+='" data-id=',(a=n.id)?o=a.call(t,{hash:{},data:r}):(a=t&&t.id,o=typeof a===h?a.call(t,{hash:{},data:r}):a),c+=d(o)+'>\n  <a tabindex="-1" href="#"><i class="icon-fixed-width icon-long-arrow-up"></i> '+d((a=n.s||t&&t.s,l={hash:{},data:r},a?a.call(t,"insert-record-above",l):f.call(t,"s","insert-record-above",l)))+'</a>\n</li>\n<li class="insert-record-below ',o=n["if"].call(t,t&&t.disabled,{hash:{},inverse:u.noop,fn:u.program(1,s,r),data:r}),(o||0===o)&&(c+=o),c+='" data-id=',(a=n.id)?o=a.call(t,{hash:{},data:r}):(a=t&&t.id,o=typeof a===h?a.call(t,{hash:{},data:r}):a),c+=d(o)+'>\n  <a tabindex="-1" href="#"><i class="icon-fixed-width icon-long-arrow-down"></i> '+d((a=n.s||t&&t.s,l={hash:{},data:r},a?a.call(t,"insert-record-below",l):f.call(t,"s","insert-record-below",l)))+'</a>\n</li>\n<li class="delete-record ',o=n["if"].call(t,t&&t.disabled,{hash:{},inverse:u.noop,fn:u.program(1,s,r),data:r}),(o||0===o)&&(c+=o),c+='" data-id=',(a=n.id)?o=a.call(t,{hash:{},data:r}):(a=t&&t.id,o=typeof a===h?a.call(t,{hash:{},data:r}):a),c+=d(o)+'>\n  <a tabindex="-1" href="#"><i class="icon-fixed-width icon-remove"></i> '+d((a=n.s||t&&t.s,l={hash:{},data:r},a?a.call(t,"delete-record",l):f.call(t,"s","delete-record",l)))+"</a>\n</li>\n"})),Handlebars.registerPartial("recordNameMenuItems",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+='\n  <li>\n    <a class="select-name-field" tabindex="-1" href="#">\n      '+m((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"select-name-field",r):p.call(e,"s","select-name-field",r)))+"\n    </a>\n  </li>\n"}function o(){return" icon-ok"}function a(e,t){var i,r,s="";return s+='\n      <span class="name-option-value">'+m((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"id",r):p.call(e,"s","id",r)))+"</span>\n    "}function l(e,t){var i,r,s,o="";return o+='\n      <span class="name-option-value">',(r=n.shortId)?i=r.call(e,{hash:{},data:t}):(r=e&&e.shortId,i=typeof r===g?r.call(e,{hash:{},data:t}):r),o+=m(i)+'</span>\n      <span class="name-option-field">('+m((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"id",s):p.call(e,"s","id",s)))+")</span>\n    "}function c(e,t,i){var r,s="";return s+='\n  <li class="name-option" data-key="'+m((r=e&&e.field,r=null==r||r===!1?r:r.key,typeof r===g?r.apply(e):r))+'">\n    <a tabindex="-1" href="#">\n      <i class="icon-fixed-width',r=n["if"].call(e,(r=e&&e.field,null==r||r===!1?r:r.isNameField),{hash:{},inverse:v.noop,fn:v.program(3,o,t),data:t}),(r||0===r)&&(s+=r),s+='"></i>\n      ',r=n["if"].call(e,i&&i.namesOnly,{hash:{},inverse:v.program(12,h,t),fn:v.program(10,u,t),data:t}),(r||0===r)&&(s+=r),s+="\n    </a>\n  </li>\n"}function u(e){var t,n="";return n+='\n        <span class="name-option-value">'+m((t=e&&e.field,t=null==t||t===!1?t:t.name,typeof t===g?t.apply(e):t))+"</span>\n      "}function h(e,t){var i,r,s="";return s+='\n        <span class="name-option-value">',(r=n.displayValue)?i=r.call(e,{hash:{},data:t}):(r=e&&e.displayValue,i=typeof r===g?r.call(e,{hash:{},data:t}):r),s+=m(i)+'</span>\n        <span class="name-option-field">('+m((i=e&&e.field,i=null==i||i===!1?i:i.name,typeof i===g?i.apply(e):i))+")</span>\n      "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var d,f="",p=n.helperMissing,m=this.escapeExpression,g="function",v=this;return d=n["if"].call(t,t&&t.hasTitle,{hash:{},inverse:v.noop,fn:v.program(1,s,r),data:r}),(d||0===d)&&(f+=d),f+='\n\n<li class="name-option no-name">\n  <a tabindex="-1" href="#">\n    <i class="icon-fixed-width',d=n["if"].call(t,t&&t.noName,{hash:{},inverse:v.noop,fn:v.program(3,o,r),data:r}),(d||0===d)&&(f+=d),f+='"></i>\n    ',d=n["if"].call(t,t&&t.namesOnly,{hash:{},inverse:v.program(7,l,r),fn:v.program(5,a,r),data:r}),(d||0===d)&&(f+=d),f+="\n  </a>\n</li>\n\n",d=n.each.call(t,t&&t.options,{hash:{},inverse:v.noop,fn:v.programWithDepth(9,c,r,t),data:r}),(d||0===d)&&(f+=d),f+="\n"})),Handlebars.registerPartial("reportFormulaFieldMenuItems",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a,l="",c="function",u=this.escapeExpression,h=n.helperMissing;return l+='<li class="edit-formula" data-key=',(o=n.key)?s=o.call(t,{hash:{},data:r}):(o=t&&t.key,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'>\n  <a tabindex="-1" href="#"><i class="icon-fixed-width">&fnof;</i> '+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"edit-report-formula",a):h.call(t,"s","edit-report-formula",a)))+'</a>\n</li>\n\n<li class="insert-column-before" data-key=',(o=n.key)?s=o.call(t,{hash:{},data:r}):(o=t&&t.key,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'>\n  <a tabindex="-1" href="#">\n    <i class="icon-fixed-width icon-long-arrow-left "></i>\n    '+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"insert-report-column-before",a):h.call(t,"s","insert-report-column-before",a)))+'\n  </a>\n</li>\n\n<li class="insert-column-after" data-key=',(o=n.key)?s=o.call(t,{hash:{},data:r}):(o=t&&t.key,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'>\n  <a tabindex="-1" href="#">\n    <i class="icon-fixed-width icon-long-arrow-right "></i>\n    '+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"insert-report-column-after",a):h.call(t,"s","insert-report-column-after",a)))+'\n  </a>\n</li>\n\n<li class="delete-field" data-key=',(o=n.key)?s=o.call(t,{hash:{},data:r}):(o=t&&t.key,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'>\n  <a tabindex="-1" href="#">\n    <i class="icon-fixed-width icon-remove"></i>\n    '+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"remove-report-column",a):h.call(t,"s","remove-report-column",a)))+"\n  </a>\n</li>\n"})),Handlebars.registerPartial("sheetMenuItems",Handlebars.template(function(e,t,n,i,r){function s(){return'<i class="icon-ok"></i>'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var o,a,l,c="",u=n.helperMissing,h=this.escapeExpression,d=this,f="function";return c+='<li class="wrap-text">\n  <a tabindex="-1" href="#">\n    <i class="icon-fixed-width icon-align-left"></i> '+h((a=n.s||t&&t.s,l={hash:{},data:r},a?a.call(t,"wrap-text",l):u.call(t,"s","wrap-text",l)))+"\n    ",o=n["if"].call(t,t&&t.wrapText,{hash:{},inverse:d.noop,fn:d.program(1,s,r),data:r}),(o||0===o)&&(c+=o),c+='\n  </a>\n</li>\n<li class="export-csv">\n  <a tabindex="-1" href="/sheets/',(a=n._id)?o=a.call(t,{hash:{},data:r}):(a=t&&t._id,o=typeof a===f?a.call(t,{hash:{},data:r}):a),c+=h(o)+'.csv" download="',(a=n.title)?o=a.call(t,{hash:{},data:r}):(a=t&&t.title,o=typeof a===f?a.call(t,{hash:{},data:r}):a),c+=h(o)+'.csv" target="_blank">\n    <i class="icon-fixed-width icon-download-alt"></i> '+h((a=n.s||t&&t.s,l={hash:{},data:r},a?a.call(t,"export-csv",l):u.call(t,"s","export-csv",l)))+"\n  </a>\n</li>\n"})),Handlebars.registerPartial("sheetTab",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+='\n      <li class="sheet-tab-item nav-item" data-key="',(r=n.key)?i=r.call(e,{hash:{},data:t}):(r=e&&e.key,i=typeof r===c?r.call(e,{hash:{},data:t}):r),s+=u(i)+'">\n        <a class="nav-item-link" href="',(r=n.shortUrl)?i=r.call(e,{hash:{},data:t}):(r=e&&e.shortUrl,i=typeof r===c?r.call(e,{hash:{},data:t}):r),s+=u(i)+'">',(r=n.displayName)?i=r.call(e,{hash:{},data:t}):(r=e&&e.displayName,i=typeof r===c?r.call(e,{hash:{},data:t}):r),s+=u(i)+'</a>\n        <i class="delete-item delete-nav-item icon-remove"></i>\n      </li>\n    '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var o,a,l="",c="function",u=this.escapeExpression,h=this;return l+='<li class="sheet-tab existing-sheet" data-id="',(a=n._id)?o=a.call(t,{hash:{},data:r}):(a=t&&t._id,o=typeof a===c?a.call(t,{hash:{},data:r}):a),l+=u(o)+'">\n  <ul class="sheet-tab-items">\n    <li class="sheet-tab-item sheet-item dropdown">\n      <a class="sheet-link" href="',(a=n.url)?o=a.call(t,{hash:{},data:r}):(a=t&&t.url,o=typeof a===c?a.call(t,{hash:{},data:r}):a),l+=u(o)+'">',(a=n.displayTitle)?o=a.call(t,{hash:{},data:r}):(a=t&&t.displayTitle,o=typeof a===c?a.call(t,{hash:{},data:r}):a),l+=u(o)+'</a>\n      <i class="delete-item delete-sheet icon-remove"></i>\n    </li>\n    ',o=n.each.call(t,t&&t.navItems,{hash:{},inverse:h.noop,fn:h.program(1,s,r),data:r}),(o||0===o)&&(l+=o),l+="\n  </ul>\n</li>\n"})),Handlebars.registerPartial("shortId",Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+='\n  <a class="short-id" href="',(r=n.url)?i=r.call(e,{hash:{},data:t}):(r=e&&e.url,i=typeof r===c?r.call(e,{hash:{},data:t}):r),s+=u(i)+'">#',(r=n.shortId)?i=r.call(e,{hash:{},data:t}):(r=e&&e.shortId,i=typeof r===c?r.call(e,{hash:{},data:t}):r),s+=u(i)+"</a>\n"}function o(){return'\n  <span class="short-id">&mdash;</span>\n'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var a,l="",c="function",u=this.escapeExpression,h=this;return l+='<i class="icon-reorder"></i>\n',a=n["if"].call(t,t&&t.shortId,{hash:{},inverse:h.program(3,o,r),fn:h.program(1,s,r),data:r}),(a||0===a)&&(l+=a),l+="\n"})),Handlebars.registerPartial("summaryCell",Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l="function",c=this.escapeExpression;return a+='<span class="summary"><span class="summary-name">',(o=n.displayName)?s=o.call(t,{hash:{},data:r}):(o=t&&t.displayName,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+'</span><span class="summary-value">',(o=n.summaryValue)?s=o.call(t,{hash:{},data:r}):(o=t&&t.summaryValue,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+"</span></span>\n"})),Handlebars.registerPartial("value",Handlebars.template(function(e,t,n,i,r){function s(){return"text-right"}function o(){return"error-value"}function a(e,t){var i,r,s="";return s+='<a href="',(r=n.href)?i=r.call(e,{hash:{},data:t}):(r=e&&e.href,i=typeof r===h?r.call(e,{hash:{},data:t}):r),s+=d(i)+'">',(r=n.text)?i=r.call(e,{hash:{},data:t}):(r=e&&e.text,i=typeof r===h?r.call(e,{hash:{},data:t}):r),s+=d(i)+"</a>"}function l(e,t){var i,r;return d((i=n.linkify||e&&e.linkify,r={hash:{},data:t},i?i.call(e,e&&e.text,r):f.call(e,"linkify",e&&e.text,r)))}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var c,u="",h="function",d=this.escapeExpression,f=n.helperMissing,p=this;return u+='<p class="value ',c=n["if"].call(t,t&&t.rightAligned,{hash:{},inverse:p.noop,fn:p.program(1,s,r),data:r}),(c||0===c)&&(u+=c),c=n["if"].call(t,t&&t.error,{hash:{},inverse:p.noop,fn:p.program(3,o,r),data:r}),(c||0===c)&&(u+=c),u+='">',c=n["if"].call(t,t&&t.href,{hash:{},inverse:p.program(7,l,r),fn:p.program(5,a,r),data:r}),(c||0===c)&&(u+=c),u+="</p>\n"})),Handlebars.registerPartial("content/welcomeBanner",Handlebars.template(function(e,t,n,i,r){function s(){return'\n  <p><b>Welcome!</b> We\'ve started you with some demo books, so you can explore the features of Fieldbook.</p>\n  <p>For a quick overview, see our <a href="http://www.youtube.com/watch?v=fgPtk9ek1WI" target="_blank">demo video</a> (only 3 minutes).</p>\n'
}function o(){return'\n  <p>\n    <b>Welcome!</b> For a quick overview, see our <a href="http://www.youtube.com/watch?v=fgPtk9ek1WI" target="_blank">demo video</a> (only 3\n    minutes).\n  </p>\n  <p>\n    Send feedback anytime using the bottoms at the bottomâ€”we\'d love to hear from you!\n  </p>\n'}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var a,l="",c=this;return a=n["if"].call(t,(a=t&&t.user,null==a||a===!1?a:a.hasDemoBooks),{hash:{},inverse:c.program(3,o,r),fn:c.program(1,s,r),data:r}),(a||0===a)&&(l+=a),l+="\n"})),this.Handlebars.templates.addLink=Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+='\n        Values typed into the <span class="display-name">',(r=n.fromField)?i=r.call(e,{hash:{},data:t}):(r=e&&e.fromField,i=typeof r===b?r.call(e,{hash:{},data:t}):r),s+=w(i)+"</span> column of this sheet\n      "}function o(e,t){var i,r="";return r+="\n        ",i=n["if"].call(e,e&&e.oneValue,{hash:{},inverse:x.program(6,l,t),fn:x.program(4,a,t),data:t}),(i||0===i)&&(r+=i),r+="\n      "}function a(e){var t,n="";return n+="\n          The value <span class = 'display-name'>"+w((t=e&&e.values,t=null==t||t===!1?t:t[0],typeof t===b?t.apply(e):t))+"</span>\n        "}function l(e,t){var i,r="";return r+="\n          The values\n          ",i=n["if"].call(e,e&&e.twoValue,{hash:{},inverse:x.noop,fn:x.program(7,c,t),data:t}),(i||0===i)&&(r+=i),r+="\n          ",i=n["if"].call(e,e&&e.threeValue,{hash:{},inverse:x.noop,fn:x.program(9,u,t),data:t}),(i||0===i)&&(r+=i),r+="\n          ",i=n["if"].call(e,e&&e.manyValue,{hash:{},inverse:x.noop,fn:x.program(11,h,t),data:t}),(i||0===i)&&(r+=i),r+="\n        "}function c(e){var t,n="";return n+="\n            <span class = 'display-name'>"+w((t=e&&e.values,t=null==t||t===!1?t:t[0],typeof t===b?t.apply(e):t))+"</span> and\n            <span class = 'display-name'>"+w((t=e&&e.values,t=null==t||t===!1?t:t[1],typeof t===b?t.apply(e):t))+"</span>\n          "}function u(e){var t,n="";return n+="\n            <span class = 'display-name'>"+w((t=e&&e.values,t=null==t||t===!1?t:t[0],typeof t===b?t.apply(e):t))+"</span>,\n            <span class = 'display-name'>"+w((t=e&&e.values,t=null==t||t===!1?t:t[1],typeof t===b?t.apply(e):t))+"</span>, and\n            <span class = 'display-name'>"+w((t=e&&e.values,t=null==t||t===!1?t:t[2],typeof t===b?t.apply(e):t))+"</span>\n          "}function h(e,t){var i,r,s="";return s+="\n            <span class = 'display-name'>"+w((i=e&&e.values,i=null==i||i===!1?i:i[0],typeof i===b?i.apply(e):i))+"</span>,\n            <span class = 'display-name'>"+w((i=e&&e.values,i=null==i||i===!1?i:i[1],typeof i===b?i.apply(e):i))+"</span>, and\n            <span class = 'display-name'>",(r=n.moreValue)?i=r.call(e,{hash:{},data:t}):(r=e&&e.moreValue,i=typeof r===b?r.call(e,{hash:{},data:t}):r),s+=w(i)+" others</span>\n          "}function d(){return" (choose)"}function f(e,t){var r,s="";return s+="\n    ",r=x.invokePartial(i.addLinkCandidate,"addLinkCandidate",e,n,i,t),(r||0===r)&&(s+=r),s+="\n    "}function p(){return"disabled"}function m(){return"\n        (empty columns only)\n      "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=this.merge(i,e.partials),r=r||{};var g,v,y="",b="function",w=this.escapeExpression,x=this;return y+='<div class="modal-header">\n  <h3>\n    <i class="icon-link"></i> Make link: <span class="display-name">',(v=n.fromField)?g=v.call(t,{hash:{},data:r}):(v=t&&t.fromField,g=typeof v===b?v.call(t,{hash:{},data:r}):v),y+=w(g)+'</span> field\n    <i class="icon-long-arrow-right"></i> <span class="display-name">',(v=n.toSheet)?g=v.call(t,{hash:{},data:r}):(v=t&&t.toSheet,g=typeof v===b?v.call(t,{hash:{},data:r}):v),y+=w(g)+'</span> sheet\n  </h3>\n</div>\n\n<div class="modal-body">\n  <p>\n    Each cell in the <span class="display-name">',(v=n.fromField)?g=v.call(t,{hash:{},data:r}):(v=t&&t.fromField,g=typeof v===b?v.call(t,{hash:{},data:r}):v),y+=w(g)+'</span> column of this sheet will link to one record in the\n    <span class="display-name">',(v=n.toSheet)?g=v.call(t,{hash:{},data:r}):(v=t&&t.toSheet,g=typeof v===b?v.call(t,{hash:{},data:r}):v),y+=w(g)+"</span> sheet.\n  </p>\n\n  <form class=\"join-field\">\n    <h4>Match on columnâ€¦</h4>\n    <p class = 'add-link-explanation'>\n      ",g=n["if"].call(t,t&&t.noValue,{hash:{},inverse:x.program(3,o,r),fn:x.program(1,s,r),data:r}),(g||0===g)&&(y+=g),y+='\n      </span>\n      will be matched against one column in the <span class="display-name">',(v=n.toSheet)?g=v.call(t,{hash:{},data:r}):(v=t&&t.toSheet,g=typeof v===b?v.call(t,{hash:{},data:r}):v),y+=w(g)+"</span> sheet",g=n.unless.call(t,t&&t.noChoice,{hash:{},inverse:x.noop,fn:x.program(13,d,r),data:r}),(g||0===g)&&(y+=g),y+=":\n    </p>\n    ",g=n.each.call(t,t&&t.joinFields,{hash:{},inverse:x.noop,fn:x.program(15,f,r),data:r}),(g||0===g)&&(y+=g),y+='\n    <label class="join-field-label no-name ',g=n.unless.call(t,t&&t.noValue,{hash:{},inverse:x.noop,fn:x.program(17,p,r),data:r}),(g||0===g)&&(y+=g),y+='">\n      <input name="join-field" class="join-field-option" type="radio" value="" ',g=n.unless.call(t,t&&t.noValue,{hash:{},inverse:x.noop,fn:x.program(17,p,r),data:r}),(g||0===g)&&(y+=g),y+="> ID\n      ",g=n.unless.call(t,t&&t.noValue,{hash:{},inverse:x.noop,fn:x.program(19,m,r),data:r}),(g||0===g)&&(y+=g),y+='\n    </label>\n  </form>\n\n  <div class="preview">\n    <h4>Preview</h4>\n    <div class="preview-blocks"></div>\n  </div>\n\n  <p class="remember">We\'ll remember this choice for future links.</p>\n</div>\n<div class="modal-footer">\n  <button class="btn" data-dismiss="modal">Cancel</button>\n  <button class="btn btn-primary make-link" disabled="disabled">Make link</button>\n</div>\n'}),this.Handlebars.templates.aggregateBox=Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+='\n  <li class="aggregate-item">\n    <span class="display-name">',(r=n.displayName)?i=r.call(e,{hash:{},data:t}):(r=e&&e.displayName,i=typeof r===u?r.call(e,{hash:{},data:t}):r),s+=h(i)+'</span>\n    <span class="value">'+h((i=e&&e.value,typeof i===u?i.apply(e):i))+"</span>\n  </li>\n  "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var o,a,l,c="",u="function",h=this.escapeExpression,d=n.helperMissing,f=this;return c+="<h4 class>"+h((a=n.s||t&&t.s,l={hash:{},data:r},a?a.call(t,"selection",l):d.call(t,"s","selection",l)))+'</h4>\n\n<ul class="aggregate-list">\n  ',o=n.each.call(t,t&&t.aggregates,{hash:{},inverse:f.noop,fn:f.program(1,s,r),data:r}),(o||0===o)&&(c+=o),c+="\n</ul>\n"}),this.Handlebars.templates.book=Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l=n.helperMissing,c=this.escapeExpression;return a+='<h2 class="book-header">\n  <a href="/">'+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"all-books",o):l.call(t,"s","all-books",o)))+'</a> <i class="icon-angle-right"></i> <span class="book-title" contenteditable=true></span>\n</h2>\n\n<div class="book-nav"></div>\n\n<div class="submodel-content"></div>\n'}),this.Handlebars.templates.bookList=Handlebars.template(function(e,t,n,i,r){function s(e,t){var r,s="";return s+='\n  <div class="welcome-banner alert alert-block fade in">\n    <button type="button" class="close" data-dismiss="alert">&times;</button>\n    ',r=h.invokePartial(i["content/welcomeBanner"],"content/welcomeBanner",e,n,i,t),(r||0===r)&&(s+=r),s+="\n  </div>\n"}function o(e,t){var i,r,s="";return s+='\n      <button class="btn btn-danger test-errors" type="button"><i class="icon-bug"></i> '+f((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"test-errors",r):d.call(e,"s","test-errors",r)))+"</button>\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=this.merge(i,e.partials),r=r||{};var a,l,c,u="",h=this,d=n.helperMissing,f=this.escapeExpression,p="function";return a=n["if"].call(t,(a=t&&t.user,null==a||a===!1?a:a.needsWelcome),{hash:{},inverse:h.noop,fn:h.program(1,s,r),data:r}),(a||0===a)&&(u+=a),u+='\n\n<div class="content-box">\n  <h2 class="title">'+f((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"book-links-title",c):d.call(t,"s","book-links-title",c)))+'</h2>\n  <ul class="book-links"></ul>\n  <p class="no-books"></p>\n\n  <form class="form-inline new-book-buttons">\n    <button class="btn blank-book" type="button"><i class="icon-file-alt"></i> '+f((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"blank-book",c):d.call(t,"s","blank-book",c)))+'</button>\n    <button class="btn import-csv" type="button"><i class="icon-upload-alt"></i> '+f((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"import-csv",c):d.call(t,"s","import-csv",c)))+"</button>\n    ",a=n["if"].call(t,t&&t.testErrors,{hash:{},inverse:h.noop,fn:h.program(3,o,r),data:r}),(a||0===a)&&(u+=a),u+='\n  </form>\n\n  <form class="import-form fallback" action="/books" enctype="multipart/form-data" method="post">\n    <input class="import-input" type="file" name="import">\n    <input type="hidden" name="_csrf" value="',(l=n.csrfToken)?a=l.call(t,{hash:{},data:r}):(l=t&&t.csrfToken,a=typeof l===p?l.call(t,{hash:{},data:r}):l),u+=f(a)+'">\n  </form>\n</div>\n'}),this.Handlebars.templates.bookUsers=Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s,a="";return a+="\n    <p>"+y((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"shared-with",s):b.call(e,"s","shared-with",s)))+'</p>\n    <ul class="user-list">\n      ',i=n.each.call(e,e&&e.sharedWith,{hash:{},inverse:w.noop,fn:w.program(2,o,t),data:t}),(i||0===i)&&(a+=i),a+="\n    </ul>\n  "}function o(e,t){var i,r,s,o="";return o+='\n        <li class="user',i=n["if"].call(e,e&&e.removed,{hash:{},inverse:w.noop,fn:w.program(3,a,t),data:t}),(i||0===i)&&(o+=i),o+='" data-book-user-id="',(r=n._id)?i=r.call(e,{hash:{},data:t}):(r=e&&e._id,i=typeof r===v?r.call(e,{hash:{},data:t}):r),o+=y(i)+'">\n          <img class="user-image" src='+y((r=n.userImage||e&&e.userImage,s={hash:{},data:t},r?r.call(e,e&&e.user,s):b.call(e,"userImage",e&&e.user,s)))+">\n\n          ",i=n["if"].call(e,(i=e&&e.user,null==i||i===!1?i:i.isPlaceholder),{hash:{},inverse:w.program(7,c,t),fn:w.program(5,l,t),data:t}),(i||0===i)&&(o+=i),o+="\n\n          ",i=n["if"].call(e,e&&e.removed,{hash:{},inverse:w.program(11,h,t),fn:w.program(9,u,t),data:t}),(i||0===i)&&(o+=i),o+="\n        </li>\n      "}function a(){return" removed"}function l(e){var t,n="";return n+='\n            <span class="name">'+y((t=e&&e.user,t=null==t||t===!1?t:t.email,typeof t===v?t.apply(e):t))+" (invited)</span>\n          "}function c(e){var t,n="";return n+='\n            <span class="name">'+y((t=e&&e.user,t=null==t||t===!1?t:t.name,typeof t===v?t.apply(e):t))+"</span>\n          "}function u(e,t){var i,r,s="";return s+="\n            "+y((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"removed-user",r):b.call(e,"s","removed-user",r)))+' (<span class="restore-user link">'+y((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"restore-user",r):b.call(e,"s","restore-user",r)))+"</span>)\n          "}function h(e,t){var i,r="";return r+="\n            ",i=n["if"].call(e,e&&e.canDelete,{hash:{},inverse:w.noop,fn:w.program(12,d,t),data:t}),(i||0===i)&&(r+=i),r+="\n          "}function d(){return'\n              <i class="remove-user icon-remove"></i>\n            '}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var f,p,m,g="",v="function",y=this.escapeExpression,b=n.helperMissing,w=this;return g+='<div class="modal-header">\n  <h3 class="title">'+y((p=n.s||t&&t.s,m={hash:{},data:r},p?p.call(t,"share-title",m):b.call(t,"s","share-title",m)))+'</h3>\n</div>\n\n<div class="modal-body">\n  ',f=n["if"].call(t,t&&t.sharedWith,{hash:{},inverse:w.noop,fn:w.program(1,s,r),data:r}),(f||0===f)&&(g+=f),g+='\n\n  <form class="invite-form form-inline" onsubmit="return false;">\n    <input type="email" class="invite-input input-xlarge" placeholder="'+y((p=n.s||t&&t.s,m={hash:{},data:r},p?p.call(t,"invite-placeholder",m):b.call(t,"s","invite-placeholder",m)))+'">\n    <button type="submit" class="invite btn">'+y((p=n.s||t&&t.s,m={hash:{},data:r},p?p.call(t,"invite",m):b.call(t,"s","invite",m)))+'</button>\n    <p class="error text-error"></p>\n  </form>\n  <p class="share-explanation">'+y((p=n.s||t&&t.s,m={hash:{},data:r},p?p.call(t,"share-explanation",m):b.call(t,"s","share-explanation",m)))+'</p>\n</div>\n\n<div class="modal-footer">\n  <a href="#" class="done btn btn-success" data-dismiss="modal">'+y((p=n.s||t&&t.s,m={hash:{},data:r},p?p.call(t,"done",m):b.call(t,"s","done",m)))+"</a>\n</div>\n"}),this.Handlebars.templates.confirmLeave=Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l=n.helperMissing,c=this.escapeExpression;return a+='<div class="modal-header">\n  <h3 class="title">'+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"confirm-leave-title",o):l.call(t,"s","confirm-leave-title",o)))+'</h3>\n</div>\n\n<div class="modal-body">\n  <p class="message">'+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"confirm-leave-message",o):l.call(t,"s","confirm-leave-message",o)))+'</p>\n</div>\n\n<div class="modal-footer">\n  <a href="#" class="btn btn-danger confirm-leave" data-dismiss="modal">'+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"confirm-leave",o):l.call(t,"s","confirm-leave",o)))+'</a>\n  <a href="#" class="btn btn cancel" data-dismiss="modal">'+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"cancel",o):l.call(t,"s","cancel",o)))+"</a>\n</div>\n"}),this.Handlebars.templates.errorAlert=Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s,o="";return o+='\n    <span class="show-details link">'+h((r=n.s||e&&e.s,s={hash:{},data:t},r?r.call(e,"details",s):u.call(e,"s","details",s)))+'</span>\n    <pre class="error-details well">',(r=n.report)?i=r.call(e,{hash:{},data:t}):(r=e&&e.report,i=typeof r===d?r.call(e,{hash:{},data:t}):r),o+=h(i)+"</pre>\n  "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var o,a,l,c="",u=n.helperMissing,h=this.escapeExpression,d="function",f=this;return c+='<div class="modal-body">\n  <p class="error-message">',(a=n.message)?o=a.call(t,{hash:{},data:r}):(a=t&&t.message,o=typeof a===d?a.call(t,{hash:{},data:r}):a),c+=h(o)+"</p>\n  ",o=n["if"].call(t,t&&t.report,{hash:{},inverse:f.noop,fn:f.program(1,s,r),data:r}),(o||0===o)&&(c+=o),c+='\n</div>\n\n<div class="modal-footer">\n  <a href="#" class="btn cancel" data-dismiss="modal">'+h((a=n.s||t&&t.s,l={hash:{},data:r},a?a.call(t,"cancel",l):u.call(t,"s","cancel",l)))+'</a>\n  <a href="#" class="btn btn-success reload">'+h((a=n.s||t&&t.s,l={hash:{},data:r},a?a.call(t,"reload",l):u.call(t,"s","reload",l)))+"</a>\n</div>\n"}),this.Handlebars.templates.feedback=Handlebars.template(function(e,t,n,i,r){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{},'<h3 class="feedback-title">Instant feedback</h3>\n<div class="icons">\n  <i class="icon icon-3x icon-heart"    data-sentiment="happy"></i>\n  <i class="icon icon-3x icon-frown"    data-sentiment="upset"></i>\n  <i class="icon icon-3x icon-question" data-sentiment="question"></i>\n</div>\n'}),this.Handlebars.templates.feedbackPanel=Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l=n.helperMissing,c=this.escapeExpression;return a+='<div class="smokescreen"></div>\n<div class="help">\n  <div class="help-form">\n    <p class="feedback-title"></p>\n    <textarea class=\'feedback-input\'></textarea>\n    <div>\n      <button class="btn btn-success send-button">'+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"feedback-send",o):l.call(t,"s","feedback-send",o)))+'</button>\n      <span class="feedback-status help-inline"></span>\n    </div>\n  </div>\n</div>\n'}),this.Handlebars.templates.formula=Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+="\n      "+d((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"report-formula-panel-text",r):h.call(e,"s","report-formula-panel-text",r)))+"\n    "}function o(e,t){var i,r,s="";return s+="\n      "+d((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"formula-panel-text",r):h.call(e,"s","formula-panel-text",r)))+"\n    "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var a,l,c,u="",h=n.helperMissing,d=this.escapeExpression,f=this,p="function";return u+="<div class=\"formula-panel\">\n  <div class = 'top'>\n    ",a=n["if"].call(t,t&&t.isReportFormula,{hash:{},inverse:f.program(3,o,r),fn:f.program(1,s,r),data:r}),(a||0===a)&&(u+=a),u+='\n    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>\n  </div>\n  <form class="form-inline" onsubmit="return false;">\n    <div class="input-prepend input-append field-group">\n      <span class="add-on">'+d((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"formula-panel-equals",c):h.call(t,"s","formula-panel-equals",c)))+'</span>\n      <input type="text" class="formula-field formula-field-style" value="',(l=n.initialValue)?a=l.call(t,{hash:{},data:r}):(l=t&&t.initialValue,a=typeof l===p?l.call(t,{hash:{},data:r}):l),u+=d(a)+'">\n      <button class="btn btn-success fv-save">'+d((l=n.s||t&&t.s,c={hash:{},data:r},l?l.call(t,"formula-panel-save",c):h.call(t,"s","formula-panel-save",c)))+'</button>\n    </div>\n    <span class = \'autocomplete-container\'></span>\n  </form>\n  <div class="error">\n    <span class="text"></span>\n  </div>\n</div>\n'}),this.Handlebars.templates.help=Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l=n.helperMissing,c=this.escapeExpression;return a+='<div class="smokescreen"></div>\n<div class="help">\n\n  <div class="help-form">\n    <input type="text" class="help-input" placeholder="'+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"help-placeholder",o):l.call(t,"s","help-placeholder",o)))+'">\n  </div>\n  <ul class="questions">\n\n  </ul>\n</div>\n'}),this.Handlebars.templates.helpQuestions=Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+='\n<li class="question" data-entry="',(r=n.id)?i=r.call(e,{hash:{},data:t}):(r=e&&e.id,i=typeof r===u?r.call(e,{hash:{},data:t}):r),s+=h(i)+'">',(r=n.title)?i=r.call(e,{hash:{},data:t}):(r=e&&e.title,i=typeof r===u?r.call(e,{hash:{},data:t}):r),s+=h(i)+"</li>\n"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var o,a,l,c="",u="function",h=this.escapeExpression,d=this,f=n.helperMissing;return o=n.each.call(t,t&&t.questions,{hash:{},inverse:d.noop,fn:d.program(1,s,r),data:r}),(o||0===o)&&(c+=o),c+='\n<li class="question ask">'+h((a=n.s||t&&t.s,l={hash:{},data:r},a?a.call(t,"help-ask",l):f.call(t,"s","help-ask",l)))+"</li>\n"}),this.Handlebars.templates.linkName=Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a,l="",c="function",u=this.escapeExpression,h=n.helperMissing;return l+='<div class="modal-header">\n  <h4>\n    <i class="icon-link"></i> Make link:\n    <span class="display-name">',(o=n.fieldName)?s=o.call(t,{hash:{},data:r}):(o=t&&t.fieldName,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'</span>&nbsp;column\n    <i class="icon-long-arrow-right"></i> <span class="display-name">',(o=n.sheetTitle)?s=o.call(t,{hash:{},data:r}):(o=t&&t.sheetTitle,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'</span>&nbsp;sheet\n  </h4>\n</div>\n\n<div class="modal-body">\n  <p>\n    Sheet <span class="display-name">',(o=n.sheetTitle)?s=o.call(t,{hash:{},data:r}):(o=t&&t.sheetTitle,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'</span> does not have a name column.\n  </p>\n\n  <p>\n    That means that your links will look like <span class="display-name">',(o=n.linkExample)?s=o.call(t,{hash:{},data:r}):(o=t&&t.linkExample,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'</span>.\n  </p>\n\n  <p>\n    If you add a name column to <span class="display-name">',(o=n.sheetTitle)?s=o.call(t,{hash:{},data:r}):(o=t&&t.sheetTitle,s=typeof o===c?o.call(t,{hash:{},data:r}):o),l+=u(s)+'</span>, you can give each record a name to use in links.\n  </p>\n</div>\n\n<div class="modal-footer">\n  <button class="btn use-ids" data-dismiss="modal">'+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"link-name-use-ids",a):h.call(t,"s","link-name-use-ids",a)))+'</button>\n  <button class="btn btn-primary add-name">'+u((o=n.s||t&&t.s,a={hash:{},data:r},o?o.call(t,"link-name-add",a):h.call(t,"s","link-name-add",a)))+"</button>\n</div>\n"}),this.Handlebars.templates.powerbar=Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+='\n    <span class="btn-group">\n      <button type="button" class="btn btn-default save-search"><i class="icon-upload"></i> '+u((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"update-search",r):c.call(e,"s","update-search",r)))+'</button>\n      <button type="button" class="btn btn-default dropdown-toggle search-actions-menu" data-toggle="dropdown">\n        <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu" role="menu">\n        <li><a class="save-as-new" href="#"><i class="icon-pushpin"></i> '+u((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"save-search-as-new",r):c.call(e,"s","save-search-as-new",r)))+"</a></li>\n      </ul>\n    </span>\n  "}function o(e,t){var i,r,s="";return s+='\n    <button class="btn save-search"><i class="icon-pushpin"></i> '+u((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"save-search",r):c.call(e,"s","save-search",r)))+"</button>\n  "}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var a,l="",c=n.helperMissing,u=this.escapeExpression,h=this;return l+='<form class="search-form form-inline" onsubmit="return false;">\n  <div class="search-container"></div>\n\n  ',a=n["if"].call(t,t&&t.showUpdateSearchButton,{hash:{},inverse:h.program(3,o,r),fn:h.program(1,s,r),data:r}),(a||0===a)&&(l+=a),l+="\n</form>\n"}),this.Handlebars.templates.record=Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var s,o,a="",l=n.helperMissing,c=this.escapeExpression;return a+='<h2 class="record-header">\n  <a href="" class="sheet-title"></a> <i class="icon-angle-right"></i> <span class="record-name" contenteditable="true"> </span> <span class="short-id"></span>\n  <span class="dropdown">\n    <i class="icon-gear name-settings dropdown-toggle" data-toggle="dropdown"></i>\n    <ul class="name-menu dropdown-menu">\n      <li class="show-name">\n        <a tabindex="-1" href="#">\n          <i class="icon-fixed-width name-shown-check"></i> '+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"record-show-names",o):l.call(t,"s","record-show-names",o)))+'\n        </a>\n      </li>\n      <li class="hide-name">\n        <a tabindex="-1" href="#">\n          <i class="icon-fixed-width name-hidden-check"></i> '+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"record-show-ids",o):l.call(t,"s","record-show-ids",o)))+'\n        </a>\n      </li>\n    </ul>\n  </span>\n</h2>\n\n<div class="attributes table-view"></div>\n\n<p class="loading-subsheets">'+c((s=n.s||t&&t.s,o={hash:{},data:r},s?s.call(t,"loading",o):l.call(t,"s","loading",o)))+'</p>\n<div class="subsheets table-container"></div>\n\n<div class="btn-group add-subsheet-group">\n</div>\n'}),this.Handlebars.templates.recordList=Handlebars.template(function(e,t,n,i,r){function s(e,t){var r,s="";return s+="\n  ",r=c.invokePartial(i.insertGroup,"insertGroup",e,n,i,t),(r||0===r)&&(s+=r),s+='\n  <h3 class="record-list-header">\n    <span class="record-list-title"></span>\n  </h3>\n'}function o(){return"absolute"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=this.merge(i,e.partials),r=r||{};var a,l="",c=this;return a=n["if"].call(t,t&&t.hasTitles,{hash:{},inverse:c.noop,fn:c.program(1,s,r),data:r}),(a||0===a)&&(l+=a),l+='\n<div class="table-view ',a=n["if"].call(t,t&&t.absolute,{hash:{},inverse:c.noop,fn:c.program(3,o,r),data:r}),(a||0===a)&&(l+=a),l+='"></div>\n\n<div class="floating-dropdown dropdown">\n  <div class="dropdown-toggle" data-toggle="dropdown"></div>\n  <ul class="dropdown-menu" role="menu">\n  </ul>\n</div>\n'}),this.Handlebars.templates.root=Handlebars.template(function(e,t,n,i,r){return this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{},'<div class="status-bar"></div>\n\n<div class="content">\n  <div class="sheet-container inner-content"></div>\n  <div class="feedback"></div>\n</div>\n'}),this.Handlebars.templates.sheet=Handlebars.template(function(e,t,n,i,r){this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=this.merge(i,e.partials),r=r||{};var s,o,a="",l="function",c=this.escapeExpression,u=this;return a+='<h2 class="sheet-header">\n  <span class="sheet-title" contenteditable=true>',(o=n.title)?s=o.call(t,{hash:{},data:r}):(o=t&&t.title,s=typeof o===l?o.call(t,{hash:{},data:r}):o),a+=c(s)+'</span>\n</h2>\n\n<div class="sheet-toolbar">\n  <div class="powerbar"></div>\n  <div class="btn-group">\n    <a class="btn sheet-actions dropdown-toggle" data-toggle="dropdown" href="#">\n      <span class="caret"></span>\n    </a>\n    <ul class="sheet-actions-menu dropdown-menu">\n      ',s=u.invokePartial(i.sheetMenuItems,"sheetMenuItems",t,n,i,r),(s||0===s)&&(a+=s),a+='\n    </ul>\n  </div>\n</div>\n\n<div class="grouping-message hide"></div>\n\n<div class="table-container"></div>\n'}),this.Handlebars.templates.statusBar=Handlebars.template(function(e,t,n,i,r){function s(e,t){var i,r,s="";return s+=" alert-",(r=n.type)?i=r.call(e,{hash:{},data:t}):(r=e&&e.type,i=typeof r===u?r.call(e,{hash:{},data:t}):r),s+=h(i)}function o(e,t){var i,r,s="";return s+='<span class="undo link">'+h((i=n.s||e&&e.s,r={hash:{},data:t},i?i.call(e,"undo",r):d.call(e,"s","undo",r)))+"</span>"}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),r=r||{};var a,l,c="",u="function",h=this.escapeExpression,d=n.helperMissing,f=this;return c+='<span class="message alert',a=n["if"].call(t,t&&t.type,{hash:{},inverse:f.noop,fn:f.program(1,s,r),data:r}),(a||0===a)&&(c+=a),c+='">\n  <span class="text">',(l=n.text)?a=l.call(t,{hash:{},data:r}):(l=t&&t.text,a=typeof l===u?l.call(t,{hash:{},data:r}):l),c+=h(a)+"</span> ",a=n["if"].call(t,t&&t.undoable,{hash:{},inverse:f.noop,fn:f.program(3,o,r),data:r}),(a||0===a)&&(c+=a),c+="\n</span>\n"})}).call(n,t,void 0)}(self)},{"handlebars-runtime":"AqiUHR"}],109:[function(e){function t(e){return"GET"!==e&&"HEAD"!==e&&"OPTIONS"!==e}var n=e("backbone"),i=e("node-uuid"),r=e("../csrf"),s=e("./index"),o=e("../globalEvents"),a=e("../trackJs");s.outstandingModifyingRequests=0,s.outstandingRequests=0,s.overallRequests=0;var l=n.ajax;n.ajax=function(e){if(e.dataType&&e.url){var c="."+e.dataType;-1===e.url.indexOf(c,e.url.length-c.length)&&(e.url+=c)}var u=e.headers||{};u["X-Request-ID"]||(u["X-Request-ID"]=i.v4()),s.outstandingRequests+=1,s.overallRequests+=1;var h=t(e.type);h&&(_.defaults(u,r.headers()),s.outstandingModifyingRequests+=1);var d=e.complete;e.complete=function(){s.outstandingRequests-=1,s.outstandingRequests||o.trigger("noOutstandingRequests"),h&&(s.outstandingModifyingRequests-=1),d&&d.apply(this,arguments)},e.headers=u;var f=e.error;return e.error=function(t){t.requestSettings=e,f&&f.apply(this,arguments)},a.watchAll(e),l.call(n,e)}},{"../csrf":2,"../globalEvents":64,"../trackJs":103,"./index":33,backbone:"eVKbg4","node-uuid":117}],106:[function(e,t){var n=e("q"),i=e("./index"),r=e("./model"),s=e("./collection"),o=e("./store"),a=r.extend({urlRoot:"/books",hasOne:{creator:function(e){return i.User.add(e)}},hasMany:{users:function(){return new i.BookUser.Collection([],{url:function(){return this.parent.url()+"/users"}})},sheets:function(){return new i.Sheet.Collection([],{url:function(){return this.parent.url()+"/sheets"}})}},ensureCollection:function(){this.collection=this.collection||a.collection},needsFetch:function(){return r.prototype.needsFetch.call(this)?!0:this.get("sheets").any(function(e){return e.needsFetch()})},markFetched:function(){r.prototype.markFetched.call(this),this.get("sheets")&&this.get("sheets").markFetched()},sheetWithId:function(e){var t=this.get("sheets");return t&&t.findWhere({_id:e})},bookUserForUser:function(e){return this.get("users").find(function(t){return t.get("user")===e})},bookUserForEmail:function(e){return this.get("users").find(function(t){return t.get("user").hasEmail(e)})},sharedWith:function(){return this.get("users").reject(function(e){return i.Account.isCurrentUser(e.get("user"))})},addSheet:function(e){this.get("sheets").create({},e)},extractSupersheet:function(e,t,n){this.get("sheets").create({sourceId:e.id,sourceKey:t},n)},copy:function(e){this.ensureCollection(),this.collection.create({sourceId:this.id},e)},leave:function(e){var t=this.bookUserForUser(i.Account.currentUser());t.destroy(e)},destroy:function(){this.ensureCollection(),r.prototype.destroy.apply(this,arguments)},queueTarget:function(){return this},canLeave:function(){var e=this.bookUserForUser(i.Account.currentUser());return e&&e.canDelete()},canDelete:function(){return i.Account.isCurrentUser(this.get("creator"))},contextKeys:["url","displayTitle","canLeave","canDelete"]});o.addStore(a),a.qfetchBySheet=function(e){var t={data:$.param({sheetId:e.id})},n=new a.Collection;return n.qfetch(t).then(function(e){var t=e.at(0);return t.fetched=!0,t})},a.qfetchBySheetIfNeeded=function(e){var t=e.book();return t&&!t.needsFetch()?n(t):this.qfetchBySheet(e)},a.Collection=s.extend({model:function(e,t){return a.add(e,t)},url:"/books",comparator:function(e,t){var n=e.id,i=t.id;return n===i?0:i>n?1:-1}}),a.collection=new a.Collection,t.exports=a},{"./collection":36,"./index":33,"./model":34,"./store":8,q:116}],36:[function(e,t){var n=e("backbone"),i=e("../actions"),r=e("./actionable"),s=e("./fetchable"),o=e("./qfetchable"),a=n.Collection.extend({create:function(e,t){return this.action(i.Add,e).do(t)},move:function(e,t,n){this.indexOf(e)!==t&&this.action(i.Move,e,t).do(n)},patch:function(e,t){return this.request("patch",e,t)},update:function(e,t){return this.request("update",e,t)},request:function(e,t,n){n=n?_.clone(n):{},n=_.defaults(n,{reset:!0}),n.attrs=t,void 0===n.parse&&(n.parse=!0);var i=n.success,r=this;n.success=function(e){var t=n.reset?"reset":"set";r[t](e,n),i&&i(r,e,n),r.trigger("sync",r,e,n)};var s=n.error;return n.error=function(e){s&&s(r,e,n),r.trigger("error",r,e,n)},this.sync(e,this,n)},restore:function(e,t){var n=[{op:"restore",id:e.id}];return this.patch(n,_.extend({reset:!0},t))},toContext:function(){return this.invoke("toContext")},queueTarget:function(){return this.parent?this.parent.queueTarget():this},sync:function(){return this.parent&&this.parent.synthetic?void 0:n.Collection.prototype.sync.apply(this,arguments)}});s(a),o(a),_.extend(a.prototype,r,{markFetched:function(){s.methods.markFetched.call(this),this.invoke("markFetched")}}),t.exports=a},{"../actions":38,"./actionable":5,"./fetchable":6,"./qfetchable":118,backbone:"eVKbg4"}],34:[function(e,t){var n=e("backbone"),i=e("../../common/strings"),r=e("../actions"),s=e("./actionable"),o=e("./fetchable"),a=e("./qfetchable"),l=e("./collection"),c=n.Model.extend({idAttribute:"_id",maximumEventDepth:3,hasMany:{},hasOne:{},allRelationKeys:function(){return Object.keys(this.hasMany).concat(Object.keys(this.hasOne))},updateHasManyRelation:function(e,t,n){var i=this.get(e);if(!i){var r=_.bind(this.hasMany[e],this);i=this.attributes[e]=r(),i.parent=this,this.listenToRelation(e,i)}t instanceof l&&(t=t.models),i.models!==t&&i.reset(t,_.extend({silent:!1},n))},updateHasOneRelation:function(e,t){var n=this.get(e);if(t instanceof c&&(t=t.attributes),n&&n.id===t[this.idAttribute])n.set(t);else{var i=_.bind(this.hasOne[e],this);n=i(t),this.listenToRelation(e,n)}return n},listenToRelation:function(e,t){var n=this,i=this.onRelationEvent;t.on("all",i,{parent:n,key:e})},onRelationEvent:function(e){var t=e.match(/:/g);if(!(t&&t.length>=this.parent.maximumEventDepth)){var n=this.key+":"+e,i=_.toArray(arguments);
i.shift(),i.unshift(n),this.parent.trigger.apply(this.parent,i)}},set:function(e,t,i){if(null==e)return this;var r;null===e||_.isObject(e)?(r=_.clone(e),i=t):(r={})[e]=t;var s=this;return Object.keys(this.hasMany).forEach(function(e){e in r&&(s.updateHasManyRelation(e,r[e],i),delete r[e])}),Object.keys(this.hasOne).forEach(function(e){e in r&&(r[e]=s.updateHasOneRelation(e,r[e],i))}),n.Model.prototype.set.call(this,r,i)},patch:function(e,t,n){return this.action(r.CreateOrUpdate,e,t).do(n)},stash:function(){this.stashedAttributes||(this.stashedAttributes=_.clone(this.attributes))},sync:function(){return this.synthetic?void 0:n.Model.prototype.sync.apply(this,arguments)},restoreStashed:function(){if(this.stashedAttributes){var e=_.union(_.keys(this.stashedAttributes),_.keys(this.attributes));_.each(e,function(e){this.attributes[e]!==this.stashedAttributes[e]&&(this.attributes[e]=this.stashedAttributes[e])},this),delete this.stashedAttributes,this.trigger("reset",this)}},saveIfNeeded:function(e,t,n){var i={},r=n;_.isObject(e)?(i=e,r=t):i[e]=t;var s=this,o={};_.each(_.keys(i),function(e){o[e]=s.get(e)});var a=_.any(i,function(e,t){return!_.isEqual(e,o[t])});return a?(this.set(i,r),this.patch(this.changedAttributes(),o,n)):void 0},destroy:function(e){return this.action(r.Delete).do(e)},isBlank:function(){return _.all(this.attributes,function(e){return void 0===e||null===e||e.toString().match(/^\s*$/)})},displayTitle:function(){return i.defaultString(this.get("title"),"untitled")},displayName:function(){return i.defaultString(this.get("name"),"unnamed")},toJSON:function(){var e=_.clone(this.attributes);return this.allRelationKeys().forEach(function(t){t in e&&(e[t]=e[t].toJSON())}),e},toContext:function(){var e=this,t=_.clone(this.attributes);return _.each(this.allRelationKeys(),function(e){e in t&&(t[e]=t[e].toContext())}),_.each(this.contextKeys,function(n){var i=_.result(e,n);(i instanceof c||i instanceof l)&&(i=_.clone(i.attributes)),t[n]=i}),t},queueTarget:function(){return this.collection&&this.collection.parent?this.collection.parent.queueTarget():this},request:function(e,t,n){n=n?_.clone(n):{},void 0===n.parse&&(n.parse=!0),n.attrs=t;var i=this,r=n.success;n.success=function(e){return i.set(i.parse(e,n),n)?(r&&r(i,e,n),void i.trigger("sync",i,e,n)):!1};var s=n.error;return n.error=function(e){s&&s(i,e,n),i.trigger("error",i,e,n)},this.sync(e,this,n)}});o(c),a(c),_.extend(c.prototype,s),t.exports=c},{"../../common/strings":13,"../actions":38,"./actionable":5,"./collection":36,"./fetchable":6,"./qfetchable":118,backbone:"eVKbg4"}],118:[function(e,t){var n=e("q"),i={qfetch:function(e){var t=n.defer();return e=e||{},_.extend(e,{success:function(e){t.resolve(e)},error:function(e,n,i){var r=new Error(n.status+" "+n.statusText);r.model=e,r.response=n,r.options=i,t.reject(r)}}),this.fetch(e),t.promise},qfetchIfNeeded:function(e){return this.needsFetch()?this.qfetch(e):n(this)}};t.exports=function(e){_.extend(e.prototype,i)}},{q:116}],107:[function(e,t){var n=e("backbone"),i=e("inflection"),r=e("../actions"),s=e("./index"),o=e("./model"),a=e("./collection"),l=e("./store"),c=e("./expressions/derivedValue"),u=e("../../common/values"),h=e("q"),d=o.extend({initialize:function(){},hasData:function(){return!!this.id||this.synthetic},postInitialize:function(){this.referenceObserver=new f(this),this.valueObserver=new p(this)},getFields:function(){return this.sheet().getFields()},urlRoot:function(){return this.isNew()&&this.collection&&this.collection.url?null:"/records"},effectiveSheetId:function(){return this.get("sheetId")||this.get("deletedFromSheetId")},sheet:function(){var e=this.effectiveSheetId();return e&&s.Sheet.find(e)},needsFetch:function(){if(o.prototype.needsFetch.call(this))return!0;var e=_.values(this.get("children"));return _.any(e,function(e){return e.any(function(e){return e.dirty})})},nameKey:function(){var e=this.sheet();return e&&e.get("nameKey")},displayId:function(){return this.has("shortId")?"#"+this.get("shortId"):null},name:function(){var e=this.nameKey(),t="";return _.soak(this,"sheet().nameField()")&&(t=this.getDisplayValue(e)),""===t&&(t=this.displayIdName()),t},displayIdName:function(){var e=this.displayId();if(!e)return null;var t=this.sheet();return t&&t.get("title")?i.singularize(t.get("title"))+" "+e:e},shortName:function(){var e=this.nameKey();return e?this.getDisplayValue(e):this.displayId()},hasName:function(){var e=this.nameKey();return e&&this.has(e)},setName:function(e){var t=this.nameKey();t&&this.set(t,e)},saveName:function(e){var t=this.nameKey();t&&this.saveIfNeeded(t,e)},getDisplayValue:function(e){var t=this.getValue(e);return t?t.displayValue():""},fieldWithKey:function(e){var t=this.sheet();return t&&t.fieldWithKey(e)},getValue:function(e){var t,n=this.fieldWithKey(e);return t=n&&n.hasAnyFormula()?this.valueObserver.derivedValueFor(n).getValue():this.get(e),t||u.createEmpty()},getValues:function(){return this.getFields().map(function(e){return this.getValue(e.get("key"))},this)},set:function(e,t,i){var r=this;return this.parseAttributes(e,t,i,function(e,t){return e=r.wrapValues(e),n.Model.prototype.set.call(r,e,t)})},sheetPromise:function(){var e=this.sheet();if(null==e){var t=h.defer(),n=this;return this.listenToOnce(this,"change:sheetId change:deletedFromSheetId",function(){t.resolve(n.sheetPromise())}),t.promise}return h(e)},parseAttributes:function(e,t,n,i){var r,s,o={};return _.isObject(e)?(o=e,r=t,s=n):null!=e?(o[e]=t,r=n,s=i):(o=null,r=t),i(o,r)},parse:function(e){var t=this;return e.children&&_.each(e.children,function(n,i){var r=t.childrenCollectionFor(i,function(){return[]});r.reset(n),e.children[i]=r}),this.wrapValues(e)},wrapValues:function(e){var t={},n=this;return _.each(e,function(e,i){t[i]=n.noValueKeys[i]?e:u.parseType(e)}),t},noValueKeys:{_id:!0,sheetId:!0,deletedFromSheetId:!0,ordinal:!0,children:!0,__v:!0,shortId:!0},markDirty:function(){o.prototype.markDirty.apply(this,arguments),this.set("children",{})},childrenCollectionFor:function(e,t){var n=this.get("children");n||(n={},this.set("children",n));var i=n[e];if(!i){var r=this,s=t();i=new d.Collection(s,{url:function(){return r.url()+"/children/"+e}}),n[e]=i}return i},childrenFor:function(e){var t=this;return this.childrenCollectionFor(e,function(){return t.findChildrenFor(e)})},findChildrenFor:function(e){var t=this.sheet().get("subsheets").findWhere({_id:e}),n=this,i=t.get("field").get("key"),r=t.get("sheet").get("records").filter(function(e){var t=e.getValue(i);return t.isRef()?t.hasId(n.id):!1});return r},toJSON:function(){var e=o.prototype.toJSON.apply(this,arguments);return this.unwrapValues(e)},unwrapValues:function(e){var t={};return _.each(e,function(e,n){t[n]=u.isValueObject(e)?e.toJSON():e}),t},save:function(e,t,n){var i=this;return this.parseAttributes(e,t,n,function(e,t){var n=i.unwrapValues(e);return o.prototype.save.call(i,n,t)})},queueTarget:function(){return this}});l.addStore(d),d.Collection=a.extend({model:function(e,t){return d.add(e,t)},comparator:"ordinal",insertRecord:function(e){this.each(function(t){var n=t.get("ordinal");n>=e&&t.set("ordinal",n+1)});var t=d.add({ordinal:e,sheetId:this.parent.id});return this.add(t),t},move:function(e,t,n){return _.isEmpty(t)?void 0:this.action(d.Move,e,t).do(n)},bulkUpdate:function(e,t,n,i){return this.action(d.BulkUpdate,e,t,n).do(i)}}),d.Move=r.Action.extend({initialize:function(e,t,n){this.collection=e,this.record=t,this.update=t.unwrapValues(n);var i=this.replaceUndefinedWithNull(_.pick(t.attributes,_.keys(n)));this.original=t.unwrapValues(i)},move:function(e,t){var n=[],i=this.record.id;_.each(e,function(e,t){n.push("ordinal"===t?{op:"reorder",id:i,ordinal:e}:{op:"replace",id:i,path:"/"+t,value:e})}),this.collection.patch(n,t)},perform:function(e){this.move(this.update,e)},revert:function(e){this.move(this.original,e)}}),d.BulkUpdate=r.Action.extend({initialize:function(e,t,n,i){this.collection=e,this.field=t,this.from=n,this.to=i},bulkUpdate:function(e,t,n){n=_.defaults(n||{},{reset:!1});var i=this.field.get("key"),r=[{op:"bulkUpdate",key:i,from:e,to:t}];this.collection.patch(r,n)},perform:function(){this.bulkUpdate(this.from,this.to)},revert:function(){this.bulkUpdate(this.to,this.from)}}),t.exports=d;var f=function(e){this.record=e,this.updateSubscriptions()};_.extend(f.prototype,n.Events,{onRecordChanged:function(e){var t=this,n=e.sheet();_.each(e.changed,function(i,r){var s=n&&n.fieldWithKey(r);t.markDirtyIfRef(s,i),t.markDirtyIfRef(s,e.previous(r))}),this.updateSubscriptions()},updateSubscriptions:function(){this.stopListening(),this.listenTo(this.record,"change",this.onRecordChanged);var e=this,t=_.bind(this.markRecordDirty,this);_.each(this.record.attributes,function(n){if(u.isRef(n)){var i=n.linkedRecord();i&&e.listenTo(i,"change",t);var r=i&&i.sheet();r&&e.listenTo(r,"change:nameKey",t)}})},markRecordDirty:function(){this.record.markDirty()},markDirtyIfRef:function(e,t){if(u.isRef(t)){var n=t.linkedRecord();if(n)n.markDirty();else if(e){var i=e.linkedSheet();i&&i.markDirty()}}}});var p=function(e){this.record=e,this.derivedValues={},this.readyPromise=this.listenToSheet(),this.readyPromise.done()};_.extend(p.prototype,n.Events,{triggerChange:function(e){var t=e.id,n=this.derivedValues[t],i=n?n.getValue():this.record.getValue(t);this.record.changed[t]=i,this.record.trigger("change:"+t,this.record),this.record.trigger("change",this.record)},derivedValueFor:function(e){var t=this.derivedValues[e.id];return t||this.addDerivedValue(e)},addDerivedValue:function(e){var t=new c(this.record,e.get("expression"),e.isReportFormula());return this.listenTo(t,"change",function(){this.triggerChange(e)}),this.derivedValues[e.id]=t},removeDerivedValue:function(e){var t=this.derivedValues[e];t&&(this.stopListening(t),t.stopListening(),delete this.derivedValues[e])},clearDerivedValues:function(){var e=this;_.each(this.derivedValues,function(t){e.stopListening(t)}),this.derivedValues={}},updateDerivedValue:function(e){this.removeDerivedValue(e.id),e.hasAnyFormula()&&this.addDerivedValue(e)},updateDerivedValues:function(){var e=this.record.sheet();if(e&&e.get("fields")){this.clearDerivedValues();var t=this;e.get("fields").each(function(e){e.hasAnyFormula()&&t.addDerivedValue(e)})}},listenToSheet:function(){var e=this;return this.record.sheetPromise().then(function(t){e.listenTo(t,"fields:change:expression",e.onFieldExpressionChanged),e.listenTo(t,"fields:add",e.onFieldAdded),e.listenTo(t,"fields:remove",e.onFieldRemoved),e.listenTo(t,"fields:reset",e.onFieldsReset),e.updateDerivedValues()})},onFieldExpressionChanged:function(e){this.updateDerivedValue(e),this.triggerChange(e)},onFieldAdded:function(e){e.hasAnyFormula()&&this.onFieldExpressionChanged(e)},onFieldRemoved:function(e){this.removeDerivedValue(e.id)},onFieldsReset:function(){this.updateDerivedValues()}}),u.types.RefValue.prototype.linkedRecord=function(){if(!this.id)return null;var e=d.find(this.id);return this.sheetId&&!e.effectiveSheetId()&&e.set("sheetId",this.sheetId),this.name&&!e.hasName()&&this.name!==e.displayIdName()&&e.setName(this.name),e},u.types.RefValue.prototype.displayValue=function(){if(!this.id)return this.name;var e=this.linkedRecord();return e?e.name():null}},{"../../common/values":86,"../actions":38,"./collection":36,"./expressions/derivedValue":119,"./index":33,"./model":34,"./store":8,backbone:"eVKbg4",inflection:120,q:116}],55:[function(e,t){var n=e("backbone"),i=e("../models/actionable"),r=e("../../common/extendable"),s=function(e){this.options=e||{},this.initialize()};_.extend(s.prototype,n.Events,{initialize:function(){},remove:function(){this.stopListening()}}),_.extend(s.prototype,i),t.exports=r(s)},{"../../common/extendable":21,"../models/actionable":5,backbone:"eVKbg4"}],111:[function(e,t){var n=e("./view"),i=e("./modalView"),r=e("inflection"),s=e("../../common/strings"),o=i.extend({className:"add-link-panel modal hide fade",template:n.templates.addLink,noPreviewContext:{noPreview:!0},initialize:function(){return this.sheet=this.options.sheet,this.fromSheet=this.options.fromSheet,this.field=this.options.field,this.fromValues=_.chain(this.fromSheet.displayValuesForField(this.field)).without("").uniq().value(),this.sortedFromValues=this.fromValues.concat().sort(),this.canAutoLink()?(this.auto=!0,void this.remove()):void this.render()},canAutoLink:function(){var e=this.sheet.nameField();if(!e)return!1;var t=this.sheet.displayValuesForField(e);return t=_.without(t,"").sort(),0===_.differenceSorted(this.fromValues,t).length},renderPreview:function(){var e=n.partials.addLinkPreview(this.previewContext());this.$(".preview-blocks").html(e)},context:function(){var e=this.fromValues,t=this.joinFields();return{fromField:this.field.displayName(),toSheet:this.sheet.get("title"),joinFields:t,noChoice:1===t.length&&e.length>0,values:e,noValue:0===e.length,oneValue:1===e.length,twoValue:2===e.length,threeValue:3===e.length,manyValue:e.length>3,moreValue:e.length-2}},previewContext:function(){var e=this.$(".join-field-option:checked");if(0===e.length)return{noPreview:!0};var t=e.val();if(!t)return{useId:!0,allExtra:!0,extraCount:1,shortIdExample:r.singularize(this.sheet.get("title"))+" #1",toSheet:this.sheet.get("title"),fromField:this.field.displayName()};var n=this.sheet.fieldWithKey(t),i=this.sheet.displayValuesForField(n);i=_.without(i,"").sort();var o={match:[],added:[]};return this.fromValues.forEach(function(e){-1===_.indexOf(i,e,!0)?o.added.push(e):o.match.push(e)}),o.extra=_.chain(i).differenceSorted(this.sortedFromValues).uniq(!0).value(),console.log(o),["match","added","extra"].forEach(function(e){var t=s.capitalize(e),n=o[e];o[e+"Count"]=n.length,o["all"+t]=n.length===this.fromValues.length,o["one"+t]=1===n.length,o["two"+t]=2===n.length,o["three"+t]=3===n.length,o["many"+t]=n.length>3,o["more"+t]=n.length-2}.bind(this)),o.allExtra=!(o.matchCount||o.addedCount),o.allExtra&&0===o.extraCount&&(o.extraCount=1,o.zeroExtra=!0,o.toField=n.displayName()),o.toSheet=this.sheet.get("title"),o.fromField=this.field.displayName(),o},render:function(){i.prototype.render.apply(this,arguments);var e=this.sheet.get("nameKey");e&&(this.$("input.join-field-option-"+e).prop("checked",!0),this.$(".make-link").removeAttr("disabled")),1===this.$(".join-field-option:enabled").length&&(this.$(".join-field-option:enabled").prop("checked",!0),this.$(".make-link").removeAttr("disabled")),this.renderPreview()},joinFields:function(){var e=this.sheet.getFields();return e.map(function(e){return{key:e.get("key"),name:e.displayName()}})},show:function(){this.auto?this.trigger("addlink-complete",this.sheet.get("nameKey")):i.prototype.show.apply(this,arguments)},events:{"change .join-field":function(){this.renderPreview(),this.$(".make-link").removeAttr("disabled")},"click .cancel":function(){this.hide()},"click .make-link":function(){this.trigger("addlink-complete",this.$(".join-field-option:checked").val()),this.hide()}}});t.exports=o},{"../../common/strings":13,"./modalView":62,"./view":57,inflection:120}],66:[function(e,t){var n=e("./view"),i=e("../keys"),r=e("q"),s=e("../parser"),o=n.extend({tagName:"ul",className:"autocomplete",initialize:function(){_.extend(this,_.pick(this.options,"input","onSelect","source","inputSelectorClass"));var e={};_(["update","hide","onKeyDown"]).each(function(t){e[t]=_.bind(this[t],this)},this),this.input.on("input focus select keyup click",e.update),this.input.on("blur",e.hide),this.input.on("keydown",e.onKeyDown),this.setupHintField(),this.cleanUpEvents=function(){_.chain(e).values().each(function(e){this.input.off("",e)},this)}},remove:function(){this.cleanUpEvents(),n.prototype.remove.apply(this,arguments)},setupHintField:function(){if(this.hintField=this.input.data("hintField"),!this.hintField){var e=$("<div>"),t=window.getComputedStyle(this.input.get(0)),n=_.pick(t,"display","top","left","right","bottom");n.position=_.contains(["absolute","static","fixed"],t)?this.input.css("position"):"relative",e.css(n),this.hintField=$("<input>").addClass(this.input.prop("class")).addClass("hint-field").prop("type",this.input.prop("type")).prop("placeholder",""),this.inputSelectorClass&&this.hintField.removeClass(this.inputSelectorClass),this.input.addClass("autocomplete-input"),this.input.data("hintField",this.hintField),this.input.wrap(e),this.input.parent().prepend(this.hintField)}},events:{"mouseup li":function(e){e.preventDefault(),this.onSelect($(e.target).text())},"mouseenter li":function(e){this.$(".active").removeClass("active"),$(e.target).addClass("active")},"mouseleave li":function(e){$(e.target).removeClass("active")}},show:function(){this.willHide=!1,this.$el.show(),this.input.trigger("autocomplete:change"),this.$el.innerWidth(this.input.innerWidth());var e=this.$el.offset();e.left=this.input.offset().left,this.$el.offset(e)},hide:function(){var e=this;this.willHide=!0,this.hintField.val(""),_.delay(function(){e.willHide&&e.$el.hide(),e.willHide=!1,e.input.trigger("autocomplete:change")},200)},update:function(e){if(!_.contains([i.DOWN,i.UP],e.keyCode)){var t=this,n=r.defer(),o=this.input.val(),a=this.input.prop("selectionStart"),l=this.input.prop("selectionEnd");o=o.slice(0,a)+s.cursorToken+o.slice(l);var c=this.source(o,n.resolve);null!=c&&n.resolve(c),n.promise.then(function(e){if(e=_.without(e,t.input.val()),t.updateHintField(e[0]),!e.length)return void t.hide();var n=_.map(e,function(e){var t=$("<li>");return t.text(e),t});t.show(),t.$el.empty().append(n),t.input.trigger("autocomplete:change")}).done()}},isInputOverflow:function(){var e=$("<div>"),t=window.getComputedStyle(this.input.get(0));e.css({font:t.font,position:"absolute",width:"auto",top:-9e3}),e.text(this.input.val()),$("body").append(e);var n=e.width()>=this.input.width();return e.remove(),n},updateHintField:function(e){var t=this.input.val();this.isInputOverflow()?this.hintField.hide():this.hintField.show(),this.hintField.val(t.length&&_.hasPrefix(e,t)?e:"")},onSelect:function(e){this.input.val(e),this.input.trigger("input")},onKeyDown:function(e){if(this.$el.is(":visible"))if(e.keyCode===i.DOWN||e.keyCode===i.UP){this.$("li").length>1&&e.preventDefault();var t=this.$("li.active");this.$("li").removeClass("active");var n;e.keyCode===i.DOWN?(n=t.next(),0===n.length&&(n=this.$("li").first())):e.keyCode===i.UP&&(n=t.prev(),0===n.length&&(n=this.$("li").last()));var r=n.text();this.input.val(r),this.input.prop({selectionStart:r.length,selectionEnd:r.length}),this.updateHintField(),t.removeClass("active"),n.addClass("active")}else if(e.keyCode===i.RETURN){if(this.hintField.val()&&this.input.val()!==this.hintField.val()){var s=this.$("li.active");s.length&&this.onSelect(s.text()),this.hide()}}else{var o;if(e.keyCode===i.TAB)o=!0;else if(e.keyCode===i.RIGHT){var a=this.input.get(0);o=a.selectionEnd===a.selectionStart&&a.selectionEnd===a.value.length}var l=this.hintField.val();o&&l&&(e.preventDefault(),this.input.val(l),this.input.trigger("input"))}}});t.exports=o},{"../keys":4,"../parser":28,"./view":57,q:116}],113:[function(e,t){var n=e("q"),i=e("../../common/strings"),r=e("../models"),s=e("../actions"),o=e("../viewModels"),a=e("../routing"),l=e("../keys"),c=e("./view"),u=e("./sheetView"),h=e("./recordView"),d=e("./bookUsersView"),f=e("./confirmLeaveView"),p=e("./statusBarView"),m=e("./aggregateBoxView"),g=c.extend({className:"book-detail",initialize:function(){this.submodel=this.options.submodel,this.navKey=this.options.navKey,this.$el.html(c.templates.book()),this.$title=this.$(".book-title"),this.$nav=this.$(".book-nav"),this.$submodelContent=this.$(".submodel-content"),this.aggregateBoxView=new m,this.listenForUndo(),this.listenTo(s.history,"do undo redo reset",this.updateUndoActions),this.activeTableView=null,p.hide(),this.load()},remove:function(){this.submodelView&&this.submodelView.remove(),c.prototype.remove.apply(this,arguments)},addSheetSpinnerOptions:_.defaults({color:"hsl(120, 50%, 30%)"},c.prototype.greyButtonSpinnerOptions),modelPromise:function(){return this.model?this.model.qfetchIfNeeded():this.sheetPromise().then(function(e){return r.Book.qfetchBySheetIfNeeded(e)})},sheet:function(){return this.submodel instanceof r.Sheet?this.submodel:this.submodel instanceof r.Record?this.submodel.sheet():void 0},sheetPromise:function(){return this.submodel instanceof r.Sheet?n(this.submodel):this.submodel instanceof r.Record?this.submodel.qfetchIfNeeded().invoke("sheet"):void 0},load:function(){var e=this;this.modelPromise().then(function(t){e.model=t,e.listenTo(t,"change",e.render),e.listenTo(t,"sheets:add",e.onSheetAdded),e.listenTo(t,"sheets:change",e.render),e.listenTo(t,"sheets:remove",e.onSheetRemoved),e.listenTo(t,"sheets:sort",e.render),e.listenTo(t,"sheets:reset",e.onSheetsReset),e.listenTo(t,"sync",e.render),e.listenToAllSheets(),e.render()}).fail(function(t){e.renderError(t)}).done()},listenToSheet:function(e){this.stopListening(e),this.listenTo(e,"navItems:add",this.renderNav),this.listenTo(e,"navItems:change",this.renderNav),this.listenTo(e,"navItems:remove",this.onNavItemRemoved),this.listenTo(e,"navItems:sort",this.renderNav),this.listenTo(e,"navItems:reset",this.renderNav)},listenToAllSheets:function(){var e=this.model.get("sheets");e&&e.each(_.bind(this.listenToSheet,this))},selectionChanged:function(e,t){(null!=t||e===this.activeTableView)&&(this.activeTableView=e,this.aggregateBoxView.setRegion(t))},showBook:function(){this.submodel=null,this.navKey=null,this.iterator=null,this.render()},showSheet:function(e,t){this.submodel=e,this.navKey=t,this.iterator=null,this.isShowingSheet(this.submodel,this.navKey)?this.submodelView.renderSavedSearchQueryDeferred():this.render()},showRecord:function(e){this.submodel=e,this.navKey=null,this.iterator=null,this.render()},render:function(){this.model&&this.model.isLoaded()&&(this.submodel||this.model&&this.model.has("sheets")&&(this.submodel=this.model.get("sheets").first()),this.renderTitle(),this.renderNav(),this.renderSubmodel(),this.renderSelectionAggregates())},renderTitle:function(){"book"===a.observer.currentRoute.name&&(document.title=this.model.displayTitle()),this.$title.text(this.model.displayTitle())},renderSelectionAggregates:function(){this.aggregateBoxView.render()},tabForSheet:function(e){return this.$nav.find('.sheet-tab[data-id="'+e.id+'"]')},itemForNavItem:function(e){var t=this.tabForSheet(e.sheet());return t.find('.nav-item[data-key="'+e.id+'"]')},markCurrentNavActive:function(){this.$nav.find(".sheet-tab,.sheet-link,.nav-item-link").removeClass("active");var e=this.sheet();if(e){var t=this.tabForSheet(e);if(t.addClass("active"),e===this.submodel){if(!this.navKey)return void t.find(".sheet-link").addClass("active");var n=t.find('[data-key="'+this.navKey+'"]');n.find(".nav-item-link").addClass("active")}}},shareTip:function(){var e=this.model.sharedWith();if(0===e.length)return i["sheet-sharing-private"];if(1===e.length){var t=e[0].get("user");return _.template(i["sheet-sharing-one"],{nameOrEmail:t.get("name")||t.get("email")})}return _.template(i["sheet-sharing-multiple"],{count:e.length})},updateUndoActions:function(){var e=this.$(".book-actions-menu");s.history.canUndo()?e.find(".undo").removeClass("disabled"):e.find(".undo").addClass("disabled"),s.history.canRedo()?e.find(".redo").removeClass("disabled"):e.find(".redo").addClass("disabled")},renderNav:function(){var e=this.model.toContext();this.$nav.html(c.partials.bookNav(e)),this.$(".selection-aggregate-container").append(this.aggregateBoxView.$el),this.markCurrentNavActive(),this.$nav.find(".share-book").tooltip({placement:"right",container:".book-detail",delay:{show:200,hide:0},title:_.bind(this.shareTip,this)}),this.$nav.find(".sheet-tabs").sortable({items:"> .existing-sheet",axis:"y",tolerance:"pointer",update:_.bind(this.onTabMoved,this)}),this.iterator&&(e=this.iterator.toContext(),this.$nav.find(".iterator").html(c.partials.recordIterator(e))),this.updateUndoActions(),this.$(".book-actions-menu .disabled").each(function(e,t){var n,r=$(t);r.is(".leave-book")&&(n=i["disabled-reason-leave-book"]),r.is(".delete-book")&&(n=i["disabled-reason-delete-book"]),n&&r.tooltip({title:n,placement:"right",container:".book-detail"})})},isShowingSheet:function(e,t){if(!(this.submodelView instanceof u))return!1;var n=this.submodelView.viewModel;return n.sheet===e&&n.navKey===t},isShowingRecord:function(e){return this.submodelView instanceof h?this.submodelView.model===e:!1},renderSubmodel:function(){var e;if(this.submodel instanceof r.Sheet){if(this.isShowingSheet(this.submodel,this.navKey))return;var t=new o.SheetViewModel({sheet:this.submodel,navKey:this.navKey});e=new u({viewModel:t})}else if(this.submodel instanceof r.Record){if(this.isShowingRecord(this.submodel))return;e=new h({model:this.submodel})}this.submodelView&&this.submodelView.remove(),this.submodelView=e,e&&(this.listenTo(e,"selectionChanged",this.selectionChanged),this.$submodelContent.append(e.$el),e.render())},renderError:function(e){var t=e.response,n=t&&t.responseJSON,i=n&&n.invitedUser,s=t&&403===t.status,o=s&&!!i;if(this.$title.html("&nbsp;"),this.$nav.empty(),o){var a=_.clone(n);a.currentUser=r.Account.account.toContext(),this.$title.text(a.title),this.$submodelContent.html(c.partials.bookInvited(a))}else{if(!s)throw this.$submodelContent.html(c.partials.bookLoadError()),e;this.$submodelContent.html(c.partials.bookForbidden())}},events:{"focus .book-title":"onFocusTitle","keydown .book-title":"onKeydownTitle","blur .book-title":function(){this.captureActions(function(){var e=this.$title.text().trim();this.model.saveIfNeeded("title",e,{error:this.errorHandler("update-title")}),this.renderTitle()})},"click .add-sheet":function(e){this.captureActions(function(){e.preventDefault(),e.stopPropagation();var t=$(e.target).closest(".add-sheet");this.addSpinner(t,this.addSheetSpinnerOptions);var n=this;this.model.addSheet({wait:!0,success:function(e){n.stopSpinning(t),a.router.flash({editSheetTitle:!0}).goToSheet(e.id)},error:this.errorHandler({action:"create-sheet",spinner:t})})})},"click .delete-sheet":function(e){this.captureActions(function(){var t=$(e.target).closest(".sheet-tab"),n=t.data("id"),i=this.model.sheetWithId(n);i&&i.destroy({wait:!0,success:this.showStatus({action:"delete-sheet",context:i,undoable:!0}),error:this.errorHandler({actionTemplate:"delete-sheet",object:i})})})},"click .delete-nav-item":function(e){this.captureActions(function(){var t=$(e.target).closest(".nav-item"),n=$(e.target).closest(".sheet-tab"),i=n.data("id"),r=t.data("key"),s=this.model.sheetWithId(i),o=s.navItemWithKey(r);o.destroy({wait:!0,success:this.showStatus({action:"delete-nav-item",context:o,undoable:!0}),error:this.errorHandler({actionTemplate:"delete-nav-item",object:o})})})},"click .undo":function(e){e.preventDefault(),this.undo()},"click .redo":function(e){e.preventDefault(),this.redo()},"click .share-book":function(e){e.preventDefault(),this.usersView=new d({model:this.model}),this.usersView.show()},"click .copy-book":function(e){e.preventDefault();var t=this.$nav.find(".book-actions");this.addSpinner(t,this.greyButtonSpinnerOptions);var n=this;this.model.copy({wait:!0,success:function(e){n.stopSpinning(t),a.router.flash({editBookTitle:!0}).goToBook(e.id)},error:this.errorHandler({action:"copy-book",spinner:t})})},"click .leave-book":function(e){var t=this,n=this.model;e.preventDefault();var i=$(e.target).closest(".leave-book");if(!i.is(".disabled")){var r=this.showStatus({action:"leave-book",context:n});this.confirmLeaveView=new f({onConfirm:function(){n.leave({wait:!0,success:function(){a.router.goToBookList(),r()},error:t.errorHandler("leave-book")})}}),this.confirmLeaveView.show()}},"click .delete-book":function(e){this.captureActions(function(){e.preventDefault();var t=$(e.target).closest(".delete-book");if(!t.is(".disabled")){var n=this.showStatus({action:"delete-book",context:this.model,undoable:!0});this.model.destroy({wait:!0,success:function(){a.router.goToBookList(),n()},error:this.errorHandler("delete-book")})}})},"click .iterator-button":function(e){var t=$(e.target).closest(".iterator-button"),n=t.data("id");n&&a.router.flash({recordIterator:this.iterator}).goToRecord(n)}},onFocusTitle:function(){this.onNextTick(function(){this.$title.text(this.model.get("title")),this.$title.selectText()})},onKeydownTitle:function(e){e.which===l.RETURN&&(e.stopPropagation(),$(e.target).blur())},onTabMoved:function(e,t){this.captureActions(function(){var e=t.item.data("id"),n=this.model.get("sheets"),i=n.get(e),r=this.$(".sheet-tab").index(t.item);n.move(i,r,{error:this.errorHandler("move-sheet")})})},beginEditingTitle:function(){this.$title.focus()},onSheetAdded:function(e){this.listenToSheet(e),this.render()},onSheetRemoved:function(e,t,n){var i=this,r=this.tabForSheet(e),s=r.is(".active"),o=this.model;r.fadeOut({complete:function(){if(r.remove(),s){var e=o.get("sheets"),t=n.index,l=e.length<t?e.at(t):e.last();l?a.router.goToSheet(l.id):a.observer.currentRouteIsBook(o.id)?i.showBook():a.router.goToBook(o.id)}}})},onSheetsReset:function(){this.listenToAllSheets(),this.render()},onNavItemRemoved:function(e){var t=e.sheet(),n=this.itemForNavItem(e),i=n.find("a").is(".active");n.fadeOut({complete:function(){n.remove(),i&&a.router.goToSheet(t.id)}})},onFlash:function(e){var t=e.recordIterator;t&&t.contains(this.submodel)&&(this.iterator=t,this.iterator.setCurrent(this.submodel),this.renderNav()),this.onNextTick(function(){e.editBookTitle&&this.beginEditingTitle(),this.submodelView&&"function"==typeof this.submodelView.onFlash&&this.submodelView.onFlash(e)})}});t.exports=g},{"../../common/strings":13,"../actions":38,"../keys":4,"../models":33,"../routing":82,"../viewModels":45,"./aggregateBoxView":110,"./bookUsersView":78,"./confirmLeaveView":61,"./recordView":76,"./sheetView":79,"./statusBarView":80,"./view":57,q:116}],72:[function(e,t){var n=e("./view"),i=e("./modalView"),r=(e("backbone"),i.extend({className:"error-alert modal hide fade",template:n.templates.errorAlert,events:{"click .show-details":function(){var e=this;this.$(".error-details").slideToggle({complete:function(){e.$(".error-details").selectText()}})},"click .reload":function(){window.location.reload()}}}));t.exports=r},{"./modalView":62,"./view":57,backbone:"eVKbg4"}],112:[function(e,t){var n=e("./view"),i=e("./modalView"),r=e("inflection"),r=(e("../../common/strings"),e("inflection")),s=e("q"),o=i.extend({className:"link-name-panel modal hide fade",template:n.templates.linkName,initialize:function(){this.sheetTitle=this.options.sheet.get("title"),this.fieldName=this.options.field.displayName(),this.deferred=s.defer(),i.prototype.initialize.apply(this,arguments)},context:function(){return _.chain(this).pick(["sheetTitle","fieldName"]).extend({linkExample:r.singularize(this.sheetTitle)+" #1"}).value()},events:{"click .modal-footer .btn":"onClick"},onClick:function(e){var t=$(e.target).closest(".btn"),n=t.hasClass("add-name");this.hide(),this.deferred.resolve(n)}});o.promptNameColumn=function(e){var t=new o(e);return t.show(),t.deferred.promise},t.exports=o},{"../../common/strings":13,"./modalView":62,"./view":57,inflection:120,q:116}],83:[function(e,t){var n=e("./view"),i=e("../keys"),r=e("q"),s=(e("../parser"),e("../models/powerbar/query")),o=e("../../common/strings"),a=e("../models/powerbar/commands"),l=10,c=n.extend({tagName:"ul",className:"autocomplete",initialize:function(){_.extend(this,_.pick(this.options,"input","onSelect","source","inputSelectorClass","sheet")),this.menuStack=[];var e={};_(["update","hide","onKeyDown","onChitBlur"]).each(function(t){e[t]=_.bind(this[t],this)},this),this.input.on("input focus",e.update),this.input.on("blur nonedit-select",e.hide),this.input.on("keydown",e.onKeyDown),this.input.on("blur",".chit",e.onChitBlur),this.cleanUpEvents=function(){_.chain(e).values().each(function(e){this.input.off("",e)},this)}},onChitBlur:function(){this.menuStack=[]},remove:function(){this.cleanUpEvents(),n.prototype.remove.apply(this,arguments)},doneAction:function(e){var t=e.data("context"),n=e.data("editingChit");
n.val(t.queryText),this.input.view().blur()},selectedCompletionItem:function(e,t){var n=e.data("query");if(!n)return t.stopPropagation(),void(e.hasClass("completion-back")?this.popMenu(e,t):e.hasClass("completion-done")&&this.doneAction(e));this.pushMenu(e);var i=e.data("editingChit"),r=this.getCompletionText(e);this.editedChit(r,i),i.$el.focus(),i.setCursorPosition(r.length),this.currentCompletionContext=this.getNextContext(n),this.isTerminalCompletion(n)?this.input.view().onTab(t):this.update(t)},events:{"mouseup li":function(e){e.preventDefault();var t=$(e.target).closest("li");this.selectedCompletionItem(t,e)},"mousedown li":function(e){e.preventDefault()},"mouseenter li":function(e){var t=$(e.target).closest("li");this.$(".active").removeClass("active"),t.hasClass("no-select")||t.addClass("active")},"mouseleave li":function(e){$(e.target).closest("li").removeClass("active")}},getNextContext:function(e){var t=e.getCompletionContext();return t&&t.useForNextCompletions?t:null},show:function(){this.input.view().editingChit()&&(this.clearShowHideDelays(),this.willHide=!1,this.$el.show(),this.input.trigger("autocomplete:change"),this.updatePosition())},clearShowHideDelays:function(){_.each(this.showHideDelays||[],function(e){clearTimeout(e)})},addShowHideDelay:function(e,t){this.showHideDelays=this.showHideDelays||[],this.showHideDelays.push(_.delay(e,t))},updatePosition:function(){var e=this.input.view().editingChit();if(!e)return void this.addShowHideDelay(function(){this.updatePosition()}.bind(this),50);var t=e.$el.offset();t.left-=parseInt(e.$el.css("margin-left")),t.top+=e.$el.outerHeight()+6,this.$el.offset(t)},hide:function(){var e=this;this.willHide=!0,this.clearShowHideDelays(),this.addShowHideDelay(function(){e.willHide&&e.$el.hide(),e.currentCompletionContext=null,e.menuStack=[],e.willHide=!1,e.$el.html(""),e.input.trigger("autocomplete:change")},200)},update:function(e,t){if(!_.contains([i.DOWN,i.UP],e.keyCode)&&!_.contains([i.DOWN,i.UP],_.soak(t,"keyCode"))){var n=this,s=r.defer(),a=this.input.view().editingChit();if(!a)return void this.hide();var c="",u=-1;if(a&&(c=a.textWithCursorToken(),u=$(".chit:not(:empty), .chit:focus").index(a.el)),this.currentCompletionContext){a?a.val():""}var h=this.source(c,s.resolve,this.currentCompletionContext);null!=h&&s.resolve(h),s.promise.then(function(e){var t=a?a.val():"";if(e=_.filter(e,function(e){return e?t.trim()!==e.stringify({includeCompletionContexts:!0}):!1}),e=_.uniq(e,function(e){return e.stringify({includeCompletionContexts:!0})}),e.length>l){var i=e.length-l;e=_.first(e,l),e.push({icon:"search",text:_.template(o["extra-completions"],{amountOver:i}),completion:!0,"class":"no-select completion-text"})}if((e.length>0||!_.isEmpty(n.menuStack))&&n.queryIsValid(a)&&e.push({icon:"ok",text:o["completion-done"],itemClass:"completion-done",queryText:a.val()}),_.isEmpty(n.menuStack)||e.push({icon:"chevron-left",text:o["completion-back"],itemClass:"completion-back",queryText:_.last(n.menuStack).text}),!e.length)return void n.hide();var r=a.val(),s=_.map(e,function(e){var t=$("<li>");return t.data("editingChit",a),t.data("originalText",r),n.renderCompletion(e,t),t});n.show(),n.$el.empty().append(s),n.input.trigger("autocomplete:change")}).done()}},queryIsValid:function(e){var t=new s(e.val(),null,this.sheet);try{t.validate(this.sheet,{forbiddenFields:[]})}catch(n){return!1}return 0===t.commands.length?!1:_.all(_.pluck(t.commands,"isValid"))?!0:!1},renderCompletion:function(e,t){var i;e instanceof s?(i=e.contextify().commands[0],t.data("query",e)):i=e,t.data("context",i),i.itemClass&&t.addClass(i.itemClass),t.html(n.partials.completionItem(i))},getCompletionText:function(e){var t,n=e.data("query"),i=e.data("editingChit");if(!n){var r=e.data("context");return null!=r.queryText?r.queryText:null}t=n.stringify();var s=i.val();return s!==t&&" "!==_.last(t)&&(t+=" "),t},pushMenu:function(e){var t=(e.data("editingChit"),e.data("originalText"));this.menuStack.push({text:t,context:this.currentCompletionContext})},popMenu:function(e,t){var n=e.data("editingChit"),i=this.menuStack.pop();n.val(i.text),n.setCursorPosition(i.text.length),this.currentCompletionContext=i.context,this.update(t)},editedChit:function(e,t){this.onSelect(e,t)},onSelect:function(e,t){t=t||this.input.view().editingChit(),t.val(e),this.input.trigger("input")},onKeyDown:function(e){if(this.$el.is(":visible")){var t=this.$("li.active");if(e.keyCode===i.DOWN||e.keyCode===i.UP){this.$("li").length>1&&e.preventDefault(),this.$("li").removeClass("active");var n;if(e.keyCode===i.DOWN){for(n=t.next();n.hasClass("no-select");)n=n.next();0===n.length&&(n=this.$("li").first())}else if(e.keyCode===i.UP)for(n=t.prev(),0===n.length&&(n=this.$("li").last());n.hasClass("no-select");)n=n.prev();var r=this.getCompletionText(n);null!=r?(this.input.view().editingChit().val(r),this.input.view().editingChit().setCursorPosition(r.length)):e.preventDefault(),t.removeClass("active"),n.addClass("active")}else if(e.keyCode===i.RETURN||e.keyCode===i.TAB){var s=this.$("li.active");s.hasClass("completion-back")?(e.preventDefault(),e.stopPropagation(),this.popMenu(s,e)):s.hasClass("completion-done")?(e.preventDefault(),e.stopPropagation(),this.doneAction(s)):s.length?this.selectedCompletionItem(s,e):e.keyCode===i.RETURN&&this.input.view().blur()}}},isTerminalCompletion:function(e){var t=e.firstCommand();if(t.isDefaultWhere()||t instanceof a.DefaultSearch){if(1!==t.expressions.length)return!1;if(t.getCompletionContext())return!1;if(e.isValid())return!0}return!1}});t.exports=c},{"../../common/strings":13,"../keys":4,"../models/powerbar/commands":60,"../models/powerbar/query":90,"../parser":28,"./view":57,q:116}],70:[function(e,t){!function(n){var i=e("backbone"),r=e("./view"),s=e("./index"),o=e("../models"),a=e("../viewModels/tips/tip"),l=e("../routing").router,c=e("./tipBackground");e("../viewModels/tips");var u=e("../globalEvents"),h=1500,d=_.clone(i.Events);_.extend(d,{checkStable:function(){o.outstandingRequests||s.deferredActions||this.trigger("stable")},onceStable:function(e){o.outstandingRequests||s.deferredActions?this.once("stable",e):e()}}),d.listenTo(u,"noDeferredActions noOutstandingRequests",d.checkStable);var f=!1,p=r.extend({className:"tip-box",initialize:function(){this.content=this.options.content,this.element=this.options.element,this.pointerLocation=this.options.pointerLocation,this.dismiss=this.dismiss.bind(this)},render:function(){this.contentEl=$("<div>").addClass("tip-content").html(this.content),$("body").append(this.$el),this.place(),this.element&&this.element.addClass("tip-target"),this.scroll=_.throttle(this.place.bind(this),100),_.delay(function(){$("body").one("click mousedown",this.dismiss)}.bind(this),1500),$("body").on("scroll mousewheel keydown",this.scroll)},dismiss:function(){p.currentTipView=null,this.element&&this.element.removeClass("tip-target"),this.$el.fadeOut(200,function(){this.remove()}.bind(this)),$("body").off(null,this.dismiss),$("body").off(null,this.scroll)},place:function(){if(this.element){if(!this.element.closest("body").length)return void this.dismiss();this.$el.addClass("has-pointer");var e=["left","top","top-right","bottom","bottom-right"];e=_.without(e,this.pointerLocation);var t=this.element[0].getBoundingClientRect(),n={top:{left:(t.right+t.left)/2,top:t.bottom},"top-right":{left:(t.right+t.left)/2,top:t.bottom},bottom:{left:(t.right+t.left)/2,top:t.top},left:{left:t.right,top:(t.top+t.bottom)/2},"bottom-right":{left:(t.right+t.left)/2,top:t.top}};e.unshift(this.pointerLocation);var i=function(e){return e.top>=0&&e.left>=0&&e.right<=window.innerWidth&&e.bottom<=window.innerHeight};e.every(function(e){this.adjustedPointerLocation=e,this.$el.offset(n[e]),this.$(".tip-background").remove(),this.addBackground(),this.$(".tip-background").append(this.contentEl);var t=this.$("canvas")[0].getBoundingClientRect();return!i(t)},this)}else this.$(".tip-background").remove(),this.addBackground(),this.$(".tip-background").append(this.contentEl)},addBackground:function(){this.contentEl.appendTo("body");var e=this.contentEl.outerWidth(!0),t=this.contentEl.outerHeight(!0);this.contentEl.remove();var n=c(e,t,this.adjustedPointerLocation);this.$el.append(n)}});p.create=function(e){return new p({content:e.content(),element:_.soak(e,"findElement()"),pointerLocation:e.pointerLocation})};var m=0;document.addEventListener("keydown",function(){m=Date.now()},!0),p.display=function(t){d.onceStable(function(){var n=e("../viewModels/help/help");if(n.Entry.currentEntry)return void n.Entry.currentEntry.showNext();var i=Date.now()-m;if(h>i)return void _.delay(p.display,h-i,t);if(!p.currentTipView){var r=a.create(t);if(r){var s=p.create(r);p.currentTipView=s,f=!1,_.delay(function(){return $(":focus").length&&(f=!0),f?(r.unshow(),s.remove(),f=!1,void(p.currentTipView=null)):(s.render(),void s.$el.hide().fadeIn(200))},800)}}})},p.throttledDisplay=_.throttle(p.display,100,{trailing:!0}),p.showTip=function(e){if(!p.currentTipView){_.each($(".tip-box"),function(e){$(e).data("view").dismiss()});var t=p.create(e);t.render(),t.$el.hide().fadeIn(200),p.currentTipView=t}},p.displayAfter=function(e,t){return function(){var n=e.apply(this,arguments);return this.onNextTick(function(){p.display(t||this)}),n}},p.currentAttachedElement=function(){return _.soak(p.currentTipView,"element")||$()},l.on("route",function(){p.currentTipView&&(f=!0,p.currentTipView.remove(),p.currentTipView=null)}),t.exports=p,n.Tips=p}(self)},{"../globalEvents":64,"../models":33,"../routing":82,"../viewModels/help/help":69,"../viewModels/tips":99,"../viewModels/tips/tip":95,"./index":68,"./tipBackground":11,"./view":57,backbone:"eVKbg4"}],57:[function(e,t){var n=e("jquery2"),i=e("backbone"),r=e("handlebars-runtime"),s=e("spin"),o=e("dropzone"),a=e("linkify"),l=e("../../common/strings"),c=e("../trackJs"),u=e("../csrf"),h=e("../models"),d=e("../actions"),f=e("../routing"),p=e("../../common/errors"),m=e("../keys"),g=e("../env"),v=e("./index"),y=e("../actionQueue"),b=e("../globalEvents"),w=function(e){var t=e.requestSettings,n=["REQUEST "+t.headers["X-Request-ID"],t.type+" "+t.url,t.data,"","RESPONSE "+e.status+" "+e.statusText,e.getAllResponseHeaders(),e.responseText,"","CLIENT","User agent: "+navigator.userAgent,"App version: "+navigator.appVersion,"Platform: "+navigator.platform,"Vendor: "+navigator.vendor];return n.join("\n")};n.fn.hasClosest=function(e){return this.closest(e).length>0},n.fn.selectText=function(){var e=window.getSelection();return e.removeAllRanges(),this.each(function(){var t=document.createRange();t.selectNodeContents(this),e.addRange(t)}),this},n.fn.view=function(){return this.data("view")},r.registerHelper("value",function(e){return new r.SafeString(C.partials.value({text:e}))}),r.registerHelper("s",function(e){var t=l[e];return t?_.template(t,this):""}),r.registerHelper("csrfToken",function(){return u.token}),r.registerHelper("userImage",function(e){return e.imageUrl||"/img/unknown-user.png"}),r.registerHelper("linkify",function(e){var t=r.Utils.escapeExpression(e);return new r.SafeString(a(t,{callback:function(e,t){return t?'<a target="_blank" href="'+t+'">'+e+"</a>":e}}))}),r.registerHelper("truncate",l.truncate),r.registerHelper("join",function(e,t,n){return e?_.compactNullish(e.map(function(e){return n.fn(e)})).join(t):""}),o.autoDiscover=!1,function(){var e=n._data(document,"events").click.filter(function(e){return"data-api.dropdown"===e.namespace&&void 0===e.selector})[0].handler;n(document).off("click.data-api.dropdown",e).on("click.data-api.dropdown",function(t){3!==t.which&&2!==t.button&&e()})}(),n(window).on("beforeunload",function(){return h.outstandingModifyingRequests>0||y.countQueuedActions()>0?l["outstanding-requests-warning"]:void 0});var x,k=/Script error\.?/,E=window.onerror;window.onerror=function(e,t,n,i,r){if(!(g.disableExceptionCatching||x&&x.isShown)){if(g.useAlertForErrors&&!f.hasParam("normal_errors"))return void window.alert(e);var s;if(r&&r.innerError&&(r=r.innerError),r instanceof p.DisplayableError)s={message:r.getMessage()};else if(p.isDisplayableErrorMessage(e))s={message:p.removeDisplayableErrorPrefix(e)};else{if(k.test(e)&&!t&&0===n&&null==r)return void console.warn("Script error in third-party code (maybe a browser extension?)");var o=new h.ErrorReport.makeFromError(r,e);o.save(),s={message:l["client-error"]},r&&(s.report=r.stack)}x=new v.ErrorAlertView(s),x.show(),E&&E.apply(this,arguments)}};var C=i.View.extend({id:function(){return(this.className||"").replace(" ","-")+"-"+this.cid},doubleClickThreshold:400,setElement:function(e,t){this.$el&&this.$el.data("view",void 0),i.View.prototype.setElement.call(this,e,t),this.$el.addClass(this.className),this.$el&&this.$el.data("view",this)},addSpinner:function(e,t){e.data("original-html")||(e.data("original-style",e.attr("style")||""),e.data("original-html",e.html()),e.width(e.width()),e.height(e.height()),e.html(""));var n=e.data("spinner");n&&n.stop(),t=_.extend({color:"#333",hwaccel:!0},t),n=new s(t).spin(e.get(0)),e.data("spinner",n)},greyButtonSpinnerOptions:{lines:11,radius:5,length:4,width:2,color:"#333"},stopSpinning:function(e){var t=e.data("spinner");t&&t.stop(),e.html(e.data("original-html")),e.attr("style",e.data("original-style")),e.removeData(["spinner","original-html","original-style"])},undo:function(){d.history.undo({error:this.errorHandler("undo")})},redo:function(){d.history.redo({error:this.errorHandler("redo")})},listenForUndo:function(){d.history.reset();var e=this;this.undoKeydownEventName="keydown.undo"+this.cid,n(document).on(this.undoKeydownEventName,function(t){if(t.metaKey&&t.which===m.Z){if(document.activeElement&&!n(document.activeElement).is("textarea.copyPaste"))return;t.preventDefault(),t.shiftKey?e.redo():e.undo()}})},remove:function(){this.undoKeydownEventName&&n(document).off(this.undoKeydownEventName),this.viewModel&&this.viewModel.remove(),i.View.prototype.remove.apply(this,arguments)},captureActions:function(e){d.history.capture(_.bind(e,this))},showAlert:function(e){_.isString(e)&&(e={message:e});var t=new v.ErrorAlertView(e);t.show()},errorHandler:function(e){var t=this;return function(n,i){_.isString(e)&&(e={action:e}),e.spinner&&t.stopSpinning(e.spinner);var r;e.action?r=l["action-"+e.action]:e.actionTemplate&&(r=_.template(l["action-"+e.actionTemplate],e.object.toContext()));var s=_.template(l["error-template"],{action:r}),o=w(i);return g.useAlertForErrors&&!f.hasParam("normal_errors")?void window.alert(s+" "+o):void t.showAlert({message:s,report:o})}},showStatus:function(e){return function(){var t=e.context||{};"function"==typeof t.toContext&&(t=t.toContext());var n=_.template(l["action-success-"+e.action],t);v.StatusBarView.show({text:n,undoable:e.undoable})}},show:function(){this.$el.show()},hide:function(){this.$el.hide()},endEditing:function(){n(":focus").blur()},onLinkClicked:function(e){if(!e.shiftKey&&!e.metaKey){var t=n(e.target).closest("a");if("_blank"!==t.attr("target")){var i=t.attr("href");"string"==typeof i&&i.match(/^\//)&&this.captureLink(e,i)}}},captureLink:function(e,t){e.preventDefault();var n=i.history.getFragment(t);return n===i.history.fragment?(i.history.fragment=null,void i.history.navigate(n,!0)):void f.router.navigate(t,{trigger:!0})},onNextTick:function(e){e=_.bind(e,this),v.deferredActions++,_.defer(function(){e(),v.deferredActions--,v.deferredActions||b.trigger("noDeferredActions")})},bubble:function(e,t){_.isArray(e)?_.each(e,function(e){this.bubble(e,t)},this):this.listenTo(e,t,_.bind(this.trigger,this,t))}});C.displayedView=function(){return n("."+this.prototype.className).data("view")};var S=C.extend;C.extend=function(e){var t=e.events;e.events&&delete e.events;var n=S.apply(this,arguments);return t&&(n.prototype.events=n.prototype.events||{},_.extend(n.prototype.events,t)),n},v.deferredActions=0,C.deferrable=function(){var e=this.prototype;e.getNeedsInvocation=function(e){return this.needsInvocation&&this.needsInvocation[e]},e.setNeedsInvocation=function(e,t){void 0===t&&(t=!0),this.needsInvocation=this.needsInvocation||{},this.needsInvocation[e]=t},e.registerDeferrable=function(e){var t=this[e];if("function"==typeof t){this[e]=function(){this.setNeedsInvocation(e,!1),c.console.debug(_.template(l["log-render"],{name:e,cid:this.cid,className:this.className||"unknown"})),t.apply(this,arguments)};var n=l.capitalize(e),i=e+"IfNeeded";this[i]=this[i]||function(){this.getNeedsInvocation(e)&&this[e].apply(this,arguments)};var r="setNeeds"+n;this[r]=this[r]||function(){this.setNeedsInvocation(e)};var s=e+"Deferred";this[s]=this[s]||function(){this[r](),this.onNextTick(this[i])}}},_.each(arguments,function(t){e.registerDeferrable(t)})},C.deferrableRendering=function(){var e=this.prototype,t=_.filter(_.keys(e),function(t){return 0===t.indexOf("render")&&"function"==typeof e[t]});this.deferrable.apply(this,t)},C.templates=r.templates,C.partials=r.partials,t.exports=C},{"../../common/errors":31,"../../common/strings":13,"../actionQueue":1,"../actions":38,"../csrf":2,"../env":26,"../globalEvents":64,"../keys":4,"../models":33,"../routing":82,"../trackJs":103,"./index":68,backbone:"eVKbg4",dropzone:"gxgH3g","handlebars-runtime":"AqiUHR",jquery2:"abnWWX",linkify:"57gGLX",spin:"cinjjV"}],85:[function(e,t,n){var i,r=e("../errors"),s=e("../extendable"),o=e("moment"),a=e("../strings"),l={},c=function(e){var t=e.prototype.type;l[t]=e,e.type=t},u=n.create=function(e){return h.create(e)},h=n.Value=function(){this.initialize.apply(this,arguments)};_.extend(h.prototype,{type:"generic",initialize:function(e,t){null==e&&(e=""),this.textValue=e.toString(),null==t&&(t=e),this.value=t},defaultOperators:{"+":function(e,t){return e.numericValue()+t.numericValue()},"-":function(e,t){return e.numericValue()-t.numericValue()},"*":function(e,t){return e.numericValue()*t.numericValue()},"/":function(e,t){return e.numericValue()/t.numericValue()},"^":function(e,t){return Math.pow(e.numericValue(),t.numericValue())},neg:function(e){return-e.numericValue()},":":function(e,t){return y.make(a.contains(e.displayValue(),t.displayValue()))},and:function(e,t){return y.make(e.booleanValue()&&t.booleanValue())},or:function(e,t){return y.make(e.booleanValue()||t.booleanValue())},"!":function(e){return y.make(!e.booleanValue())},"=":function(e,t){return y.make(0===e.differentTypeCompare(t))},"!=":function(e,t){return y.make(0!==e.differentTypeCompare(t))},"<":function(e,t){return y.make(e.differentTypeCompare(t)<0)},">":function(e,t){return y.make(e.differentTypeCompare(t)>0)},"<=":function(e,t){var n=e.differentTypeCompare(t);return y.make(0>=n)},">=":function(e,t){var n=e.differentTypeCompare(t);return y.make(n>=0)}},isValueObject:!0,differentTypeCompare:function(e){return this.order===e.order?this.compare(e):this.order-e.order},callOperation:function(e,t,n){var i=this.operators[e].call(this,t,n);return A(i)?i:new this.constructor(i)},numericValue:function(){return this.value},booleanValue:function(){return this.value},displayValue:function(){return this.textValue},groupingValue:function(){return this.displayValue()},toString:function(){return this.displayValue()},isError:function(){return!1},isRef:function(){return!1},isEqual:function(e){return 0===this.differentTypeCompare(e)},isDate:function(){return!1},isEmpty:function(){return!1},isNumericValue:function(){return!1},linkUrl:function(){return null},saveValue:function(){return this.textValue},highestPrecedenceType:function(e){return e?this.precedence>=e.precedence?this:e:this},hasOperator:function(e){return e in this.operators},performOperation:function(e,t){var n=this.highestPrecedenceType(t);if(n.hasOperator(e))return n.callOperation(e,this,t);var i={operator:e,a:this.value},s="error-unknown-operator-1";throw t&&(i.b=t.value,s="error-unknown-operator-2"),new r.ExecutionError(s,i)},toJSON:function(){return _.extend(this.jsonAttributes(),{type:this.type})},jsonAttributes:function(){return{value:this.saveValue()}}}),h.parse=function(e){return new this(e.value)},h.prototype.operators=h.prototype.defaultOperators,h.prototype.overrideOperators=function(e){var t=this;this.operators=_.clone(this.operators),_.each(e,function(e,n){void 0!==e?t.operators[n]=e:delete t.operators[n]})},h.create=function(e){if(A(e))return e;var t=R(e),n=_.find(T,function(n){return n.verifier(e,t)});return n||(n=i),n.make?n.make(e,t):new n(e,t)},s(h),h.verifier=function(){return!0},i=h;var d=h.extend;h.extend=function(){var e=d.apply(this,arguments);return c(e),e};var f=n.NumericValue=h.extend({type:"numeric",initialize:function(e,t){_.isNumber(e)?(this.value=e,this.textValue=e.toString()):(this.value=t,this.textValue=t.toString())},isNumericValue:function(){return!0},booleanValue:function(){return 0!==this.value},compare:function(e){return this.numericValue()-e.numericValue()},saveValue:function(){return this.displayValue()},jsonAttributes:function(){return{value:this.value}},formatNumber:function(e){return this.value%1===0?e.toString():(Math.round(1e3*e)/1e3).toString()},displayValue:function(){return this.formatNumber(this.value)}});f.prototype.overrideOperators({"/":function(e,t){var n=e.numericValue()/t.numericValue();if(e.type===t.type)return new f(n);if("numeric"===t.type){if("percent"===e.type)return new m(n);if("currency"===e.type)return new p(n)}return n}}),f.verifier=function(e,t){return _.isNumber(t)};var p=(n.createNumber=function(e){return new f(e)},n.CurrencyValue=f.extend({type:"currency",displayValue:function(){return this.value>=0?"$"+this.formatNumber(this.value):"-$"+this.formatNumber(Math.abs(this.value))},formatNumber:function(e){if(this.value%1===0)return e.toString();var t=Math.round(100*e)/100;return t.toFixed(2).toString()},saveValue:function(){return this.value>=0?"$"+this.value.toString():"-$"+Math.abs(this.value).toString()}}));p.verifier=function(e,t){if(_.isNumber(t)){var n=e.toString().trim();return n.match(/^-?\$/)?!0:n.match(/^\(\$/)&&n.match(/\)$/)?!0:!1}return!1};var m=n.PercentValue=f.extend({type:"percent",displayValue:function(){return this.formatNumber(100*this.value)+"%"}});m.verifier=function(e,t){return _.isNumber(t)?/%$/.test(e.toString().trim()):!1};var g=n.StringValue=h.extend({type:"string",initialize:function(e){this.value=e,this.textValue=e.toString()},booleanValue:function(){return"false"!==this.displayValue().trim().toLowerCase()},compare:function(e){return this.displayValue().localeCompare(e.displayValue())},differentTypeCompare:function(e){return"empty"===e.type&&""===this.displayValue().trim()?0:h.prototype.differentTypeCompare.apply(this,arguments)}});g.prototype.overrideOperators({"+":function(e,t){return e.displayValue()+t.displayValue()},"-":void 0,"*":void 0,"/":void 0,"^":void 0,neg:void 0}),g.verifier=function(e){return _.isString(e)&&""!==e&&!/^\s*$/.test(e)};var v=n.EmptyValue=h.extend({type:"empty",initialize:function(){this.value="",this.textValue=""},booleanValue:function(){return!1},numericValue:function(){return 0},compare:function(){return 0},differentTypeCompare:function(e){return"string"===e.type&&""===e.displayValue().trim()?0:h.prototype.differentTypeCompare.apply(this,arguments)},isEmpty:function(){return!0},toJSON:function(){return null}});v.parse=function(){return v.make()},v.verifier=function(e){return null==e?!0:""===e?!0:_.isString(e)&&/^\s*$/.test(e)?!0:!1},v.make=function(){return F};var y=n.BooleanValue=h.extend({type:"boolean",jsonAttributes:function(){return{value:this.value}}});y.parse=function(e){return y.make(e.value)},y.prototype.overrideOperators({"+":void 0,"-":void 0,"*":void 0,"/":void 0,"^":void 0,neg:void 0,">":void 0,"<":void 0,"<=":void 0,">=":void 0,"=":function(e,t){return y.make(e.value===t.value)},"!=":function(e,t){return y.make(e.value!==t.value)}}),y.make=function(e,t){var n;return _.isBoolean(e)?n=e:_.isString(t)&&(n="true"===t.toString().toLowerCase()),n?b:w};var b=new y(!0),w=new y(!1),x=n.RefValue=h.extend({type:"ref",initialize:function(e,t,n){e&&e._id?(this.id=e._id,this.sheetId=e.sheetId,this.name=e.name):(this.id=x.convertId(e),this.sheetId=t,this.name=n)},displayValue:function(){return this.name},booleanValue:function(){return!0},refOrdinal:function(){var e=this.linkedRecord();return e?e.get("ordinal"):Number.MAX_VALUE},compare:function(e){return this.refOrdinal()-e.refOrdinal()},isRef:function(){return!0},hasId:function(e){return this.id&&e&&this.id===e},linkUrl:function(){return this.id?"/records/"+this.id:null},saveValue:function(){return this.id},groupingValue:function(){return this.id},jsonAttributes:function(){var e={};return this.id&&(e.id=this.id),this.sheetId&&(e.sheetId=this.sheetId),void 0!==this.name&&(e.name=this.name),e},isEqual:function(e){return e.type===this.type?this.hasId(e.id):!1}});x.convertId=function(e){return e},x.prototype.overrideOperators({"+":function(e,t){return new g(e.displayValue()+t.displayValue())},"-":void 0,"*":void 0,"/":void 0,"^":void 0,neg:void 0,"=":function(e,t){return y.make(0===e.displayValue().localeCompare(t.displayValue()))},"!=":function(e,t){return y.make(0!==e.displayValue().localeCompare(t.displayValue()))},"<":function(e,t){return y.make(e.displayValue().localeCompare(t.displayValue())>0)},">":function(e,t){return y.make(e.displayValue().localeCompare(t.displayValue())<0)},"<=":function(e,t){var n=e.displayValue().localeCompare(t.displayValue());return y.make(0>=n)},">=":function(e,t){var n=e.displayValue().localeCompare(t.displayValue());return y.make(n>=0)}}),x.verifier=function(e){return _.isObject(e)},x.parse=function(e){return new x(e.id,e.sheetId,e.name)};var k=864e5,E=["MM/DD/YYYY","M/D/YYYY","MM/DD/YY","M/D/YY","MM/DD","M/D","YYYY-MM-DD","YYYY-M-D","MMM D YYYY","MMM DD YYYY","MMM D, YYYY","MMM DD, YYYY"];_.each(["st","nd","rd","th"],function(e){E.push("MMM D["+e+"] YYYY"),E.push("MMM DD["+e+"] YYYY"),E.push("MMM D["+e+",] YYYY"),E.push("MMM DD["+e+",] YYYY")});var C=n.DateValue=h.extend({type:"date",initialize:function(e){this.date=o.isMoment(e)?e:o.utc(e.toString().trim(),E,!0).utc()},displayValue:function(){return this.date.format("l")},numericValue:function(){return this.date.valueOf()/k},saveValue:function(){return this.date.format("L")},compare:function(e){return this.date-e.date},booleanValue:function(){return!0},isDate:function(){return!0}});C.parse=function(e){var t=o.utc(e.value,"MM/DD/YYYY",!0).utc();return new C(t)},C.prototype.overrideOperators({"+":function(e,t){if(e.isDate()&&t.isDate())throw new r.ExecutionError("error-data-add-dates");var n,i;if(e.isDate()?(n=e,i=t):(n=t,i=e),"numeric"!==i.type)throw new r.ExecutionError("error-date-add-bad-type",{otherType:i.type});return new C(o(n.date).add("days",i.numericValue()))},"-":function(e,t){if(e.isDate()&&t.isDate())return new f(e.numericValue()-t.numericValue());if(t.isDate())throw new r.ExecutionError("error-subtraction",{aType:e.type,bType:t.type});if("numeric"!==t.type)throw new r.ExecutionError("error-subtraction",{aType:e.type,bType:t.type});return new C(o(e.date).subtract("days",t.numericValue()))},"*":void 0,"/":void 0,"^":void 0,neg:void 0});var S=[/^\d{1,2}\/\d{1,2}(?:\/(?:\d{2}|\d{4}))?$/,/^\d{4}-\d{1,2}-\d{1,2}$/,/^\S+ \d{1,2}(?:st|nd|rd|th)?,? \d{4}$/];C.verifier=function(e,t){if(!_.isString(e))return!1;var n=_.any(S,function(e){return e.test(t)});return n?o(t,E,!0).isValid():!1};var $=n.ErrorValue=h.extend({type:"error",initialize:function(e){this.error=e},toJSON:function(){return null},compare:function(){return 0},isEqual:function(e){return this===e},isError:function(){return!0},displayValue:function(){return a["error-value"]},booleanValue:function(){throw this.error},numericValue:function(){throw this.error},callOperation:function(){throw this.error},getMessage:function(){return this.error.getMessage?this.error.getMessage():this.error.message}});n.makeError=function(e){return new $(e)};var R=n.canonicalValue=function(e){if(void 0===e||null===e)return"";if(_.isString(e)){for(var t=e.trim();/\d,\d\d\d\b/.test(t);)t=t.replace(/(\d),(\d\d\d)/,"$1$2");var n=!1;t.match(/^\(\$(\d*(\.\d*)?)\)$/)&&(t=t.replace(/^\(/,""),t=t.replace(/\)$/,""),n=!0),t=t.replace(/^(-?)\$/,"$1");var i=!1;if(t.match(/%$/)&&(i=!0,t=t.replace(/%$/,"")),t.match(/^\s*-?(\d+\.?|\d*\.\d+)\s*$/)){var r=parseFloat(t);return i?r/100:n?-r:r}return e.trim()}return e},A=n.isValueObject=function(e){return e&&e.isValueObject},F=(n.isRef=function(e){return A(e)?e.isRef():!1},n.isEmpty=function(e){return A(e)?e.isEmpty():v.verifier(e)},n.emptyValue=new v),T=(n.createEmpty=function(){return F},[x,p,m,f,C,g,v,h]),V=[v,h,m,f,p,y,C,g,x,$],I=n.addPrecedence=function(e){var t;_.contains(V,e)?t=V.indexOf(e):(t=V.length,V.push(e)),e.prototype.precedence=t};_.each(V,function(e){I(e)});var N=[f,C,g,x,v,h,$],O=n.addOrder=function(e,t){var n;_.contains(N,e)?n=N.indexOf(e):(n=void 0!==t?t:N.length,N.splice(n,0,e)),_.each(N,function(e,t){e.prototype.order=t})};_.each(N,function(e){O(e)});n.parseType=function(e){if(null==e)return F;if(A(e))return e;var t=e.type;if(t in l)return l[t].parse(e);if(void 0===t)return u(e);throw new Error("Cannot find type entry for "+t+" given value: "+JSON.stringify(e))},n.makeRef=function(e,t,n){return new x(e,t,n)},n.makeJSON=function(e){var t=u(e);return t.toJSON()}},{"../errors":31,"../extendable":21,"../strings":13,moment:"loqk/d"}],120:[function(e,t,n){!function(e){var i=["equipment","information","rice","money","species","series","fish","sheep","moose","deer","news"],r=[[new RegExp("(m)en$","gi")],[new RegExp("(pe)ople$","gi")],[new RegExp("(child)ren$","gi")],[new RegExp("([ti])a$","gi")],[new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi")],[new RegExp("(hive)s$","gi")],[new RegExp("(tive)s$","gi")],[new RegExp("(curve)s$","gi")],[new RegExp("([lr])ves$","gi")],[new RegExp("([^fo])ves$","gi")],[new RegExp("([^aeiouy]|qu)ies$","gi")],[new RegExp("(s)eries$","gi")],[new RegExp("(m)ovies$","gi")],[new RegExp("(x|ch|ss|sh)es$","gi")],[new RegExp("([m|l])ice$","gi")],[new RegExp("(bus)es$","gi")],[new RegExp("(o)es$","gi")],[new RegExp("(shoe)s$","gi")],[new RegExp("(cris|ax|test)es$","gi")],[new RegExp("(octop|vir)i$","gi")],[new RegExp("(alias|status)es$","gi")],[new RegExp("^(ox)en","gi")],[new RegExp("(vert|ind)ices$","gi")],[new RegExp("(matr)ices$","gi")],[new RegExp("(quiz)zes$","gi")],[new RegExp("(m)an$","gi"),"$1en"],[new RegExp("(pe)rson$","gi"),"$1ople"],[new RegExp("(child)$","gi"),"$1ren"],[new RegExp("^(ox)$","gi"),"$1en"],[new RegExp("(ax|test)is$","gi"),"$1es"],[new RegExp("(octop|vir)us$","gi"),"$1i"],[new RegExp("(alias|status)$","gi"),"$1es"],[new RegExp("(bu)s$","gi"),"$1ses"],[new RegExp("(buffal|tomat|potat)o$","gi"),"$1oes"],[new RegExp("([ti])um$","gi"),"$1a"],[new RegExp("sis$","gi"),"ses"],[new RegExp("(?:([^f])fe|([lr])f)$","gi"),"$1$2ves"],[new RegExp("(hive)$","gi"),"$1s"],[new RegExp("([^aeiouy]|qu)y$","gi"),"$1ies"],[new RegExp("(x|ch|ss|sh)$","gi"),"$1es"],[new RegExp("(matr|vert|ind)ix|ex$","gi"),"$1ices"],[new RegExp("([m|l])ouse$","gi"),"$1ice"],[new RegExp("(quiz)$","gi"),"$1zes"],[new RegExp("s$","gi"),"s"],[new RegExp("$","gi"),"s"]],s=[[new RegExp("(m)an$","gi")],[new RegExp("(pe)rson$","gi")],[new RegExp("(child)$","gi")],[new RegExp("^(ox)$","gi")],[new RegExp("(ax|test)is$","gi")],[new RegExp("(octop|vir)us$","gi")],[new RegExp("(alias|status)$","gi")],[new RegExp("(bu)s$","gi")],[new RegExp("(buffal|tomat|potat)o$","gi")],[new RegExp("([ti])um$","gi")],[new RegExp("sis$","gi")],[new RegExp("(?:([^f])fe|([lr])f)$","gi")],[new RegExp("(hive)$","gi")],[new RegExp("([^aeiouy]|qu)y$","gi")],[new RegExp("(x|ch|ss|sh)$","gi")],[new RegExp("(matr|vert|ind)ix|ex$","gi")],[new RegExp("([m|l])ouse$","gi")],[new RegExp("(quiz)$","gi")],[new RegExp("(m)en$","gi"),"$1an"],[new RegExp("(pe)ople$","gi"),"$1rson"],[new RegExp("(child)ren$","gi"),"$1"],[new RegExp("([ti])a$","gi"),"$1um"],[new RegExp("((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)ses$","gi"),"$1$2sis"],[new RegExp("(hive)s$","gi"),"$1"],[new RegExp("(tive)s$","gi"),"$1"],[new RegExp("(curve)s$","gi"),"$1"],[new RegExp("([lr])ves$","gi"),"$1f"],[new RegExp("([^fo])ves$","gi"),"$1fe"],[new RegExp("([^aeiouy]|qu)ies$","gi"),"$1y"],[new RegExp("(s)eries$","gi"),"$1eries"],[new RegExp("(m)ovies$","gi"),"$1ovie"],[new RegExp("(x|ch|ss|sh)es$","gi"),"$1"],[new RegExp("([m|l])ice$","gi"),"$1ouse"],[new RegExp("(bus)es$","gi"),"$1"],[new RegExp("(o)es$","gi"),"$1"],[new RegExp("(shoe)s$","gi"),"$1"],[new RegExp("(cris|ax|test)es$","gi"),"$1is"],[new RegExp("(octop|vir)i$","gi"),"$1us"],[new RegExp("(alias|status)es$","gi"),"$1"],[new RegExp("^(ox)en","gi"),"$1"],[new RegExp("(vert|ind)ices$","gi"),"$1ex"],[new RegExp("(matr)ices$","gi"),"$1ix"],[new RegExp("(quiz)zes$","gi"),"$1"],[new RegExp("ss$","gi"),"ss"],[new RegExp("s$","gi"),""]],o=["and","or","nor","a","an","the","so","but","to","of","at","by","from","into","on","onto","off","out","in","over","with","for"],a=new RegExp("(_ids|_id)$","g"),l=new RegExp("_","g"),c=new RegExp("[ _]","g"),u=new RegExp("([A-Z])","g"),h=new RegExp("^_"),d={_apply_rules:function(e,t,n,i){if(i)e=i;
else{var r=d.indexOf(n,e.toLowerCase())>-1;if(!r)for(var s=0,o=t.length;o>s;s++)if(e.match(t[s][0])){void 0!==t[s][1]&&(e=e.replace(t[s][0],t[s][1]));break}}return e},indexOf:function(e,t,n,i){n||(n=-1);for(var r=-1,s=n,o=e.length;o>s;s++)if(e[s]===t||i&&i(e[s],t)){r=s;break}return r},pluralize:function(e,t){return d._apply_rules(e,r,i,t)},singularize:function(e,t){return d._apply_rules(e,s,i,t)},camelize:function(e,t){for(var n=e.toLowerCase().split("/"),i=0,r=n.length;r>i;i++){for(var s=n[i].split("_"),o=t&&i+1===r?1:0,a=o,l=s.length;l>a;a++)s[a]=s[a].charAt(0).toUpperCase()+s[a].substring(1);n[i]=s.join("")}return n.join("::")},underscore:function(e,t){if(t&&e===e.toUpperCase())return e;for(var n=e.split("::"),i=0,r=n.length;r>i;i++)n[i]=n[i].replace(u,"_$1"),n[i]=n[i].replace(h,"");return n.join("/").toLowerCase()},humanize:function(e,t){return e=e.toLowerCase(),e=e.replace(a,""),e=e.replace(l," "),t||(e=d.capitalize(e)),e},capitalize:function(e){return e=e.toLowerCase(),e.substring(0,1).toUpperCase()+e.substring(1)},dasherize:function(e){return e.replace(c,"-")},titleize:function(e){e=e.toLowerCase().replace(l," ");for(var t=e.split(" "),n=0,i=t.length;i>n;n++){for(var r=t[n].split("-"),s=0,a=r.length;a>s;s++)d.indexOf(o,r[s].toLowerCase())<0&&(r[s]=d.capitalize(r[s]));t[n]=r.join("-")}return e=t.join(" "),e=e.substring(0,1).toUpperCase()+e.substring(1)},demodulize:function(e){var t=e.split("::");return t[t.length-1]},tableize:function(e){return e=d.underscore(e),e=d.pluralize(e)},classify:function(e){return e=d.camelize(e),e=d.singularize(e)},foreign_key:function(e,t){return e=d.demodulize(e),e=d.underscore(e)+(t?"":"_")+"id"},ordinalize:function(e){for(var t=e.split(" "),n=0,i=t.length;i>n;n++){var r=parseInt(t[n],10);if(!isNaN(r)){var s=t[n].substring(t[n].length-2),o=t[n].substring(t[n].length-1),a="th";"11"!=s&&"12"!=s&&"13"!=s&&("1"===o?a="st":"2"===o?a="nd":"3"===o&&(a="rd")),t[n]+=a}}return t.join(" ")}};return"undefined"==typeof n?e.inflection=d:(d.version="1.2.5",void(t.exports=d))}(this)},{}],119:[function(e,t){function n(e,t,n){this.record=e,this.expression=t,this.listenForChanges(t),this.useSourceRecords=n}var i=e("backbone");_.extend(n.prototype,i.Events,{listenForChanges:function(e,t){var n=this;if(t=t||this.record,e.hasField()){var i=e.keyId(t);return void this.listenTo(t,"change:"+i,this.onValueChanged)}"."===e.op?(this.listenForChanges(e.expr1),t.sheetPromise().then(function(){var i=e.expr1.evaluateUnsafe(t);if(i.isRef()){var r=i.linkedRecord();if(r)return r.sheetPromise().then(function(){n.listenForChanges(e.expr2,r)})}}).done()):_.each(_.keys(e),function(t){_.contains(e.expressionKeys,t)?n.listenForChanges(e[t]):"arguments"===t&&_.each(e.arguments,function(e){n.listenForChanges(e)})})},calculateValue:function(){return this.useSourceRecords&&this.record.sourceRecords?this.expression.aggregateValueForRecords(this.record.sourceRecords):this.expression.evaluate(this.record)},getValue:function(){return"value"in this||(this.value=this.calculateValue()),this.value},onValueChanged:function(){var e=this.value;this.value=this.calculateValue(),_.isEqual(e,this.value)||this.trigger("change")}}),t.exports=n},{backbone:"eVKbg4"}],121:[function(e,t){e=function(e,t,n,i){function r(i){if(!n[i]){if(!t[i]){if(e)return e(i);throw new Error("Cannot find module '"+i+"'")}var s=n[i]={exports:{}};t[i][0](function(e){var n=t[i][1][e];return r(n?n:e)},s,s.exports)}return n[i].exports}for(var s=0;s<i.length;s++)r(i[s]);return r}("undefined"!=typeof e&&e,{1:[function(e,t){function n(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}function i(e,t){return void 0===t?""+t:"number"!=typeof t||!isNaN(t)&&isFinite(t)?"function"==typeof t||t instanceof RegExp?t.toString():t:t.toString()}function r(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function s(e,t,n,i,r){throw new g.AssertionError({message:n,actual:e,expected:t,operator:i,stackStartFunction:r})}function o(e,t){e||s(e,!0,t,"==",g.ok)}function a(e,t){if(e===t)return!0;if(p.isBuffer(e)&&p.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():"object"!=typeof e&&"object"!=typeof t?e==t:u(e,t)}function l(e){return null===e||void 0===e}function c(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function u(e,t){if(l(e)||l(t))return!1;if(e.prototype!==t.prototype)return!1;if(c(e))return c(t)?(e=m.call(e),t=m.call(t),a(e,t)):!1;try{var i,r,s=n(e),o=n(t)}catch(u){return!1}if(s.length!=o.length)return!1;for(s.sort(),o.sort(),r=s.length-1;r>=0;r--)if(s[r]!=o[r])return!1;for(r=s.length-1;r>=0;r--)if(i=s[r],!a(e[i],t[i]))return!1;return!0}function h(e,t){return e&&t?t instanceof RegExp?t.test(e):e instanceof t?!0:t.call({},e)===!0?!0:!1:!1}function d(e,t,n,i){var r;"string"==typeof n&&(i=n,n=null);try{t()}catch(o){r=o}if(i=(n&&n.name?" ("+n.name+").":".")+(i?" "+i:"."),e&&!r&&s("Missing expected exception"+i),!e&&h(r,n)&&s("Got unwanted exception"+i),e&&r&&n&&!h(r,n)||!e&&r)throw r}var f=e("util"),p=e("buffer").Buffer,m=Array.prototype.slice,g=t.exports=o;g.AssertionError=function(e){this.name="AssertionError",this.message=e.message,this.actual=e.actual,this.expected=e.expected,this.operator=e.operator;var t=e.stackStartFunction||s;Error.captureStackTrace&&Error.captureStackTrace(this,t)},f.inherits(g.AssertionError,Error),g.AssertionError.prototype.toString=function(){return this.message?[this.name+":",this.message].join(" "):[this.name+":",r(JSON.stringify(this.actual,i),128),this.operator,r(JSON.stringify(this.expected,i),128)].join(" ")},g.AssertionError.__proto__=Error.prototype,g.fail=s,g.ok=o,g.equal=function(e,t,n){e!=t&&s(e,t,n,"==",g.equal)},g.notEqual=function(e,t,n){e==t&&s(e,t,n,"!=",g.notEqual)},g.deepEqual=function(e,t,n){a(e,t)||s(e,t,n,"deepEqual",g.deepEqual)},g.notDeepEqual=function(e,t,n){a(e,t)&&s(e,t,n,"notDeepEqual",g.notDeepEqual)},g.strictEqual=function(e,t,n){e!==t&&s(e,t,n,"===",g.strictEqual)},g.notStrictEqual=function(e,t,n){e===t&&s(e,t,n,"!==",g.notStrictEqual)},g.throws=function(){d.apply(this,[!0].concat(m.call(arguments)))},g.doesNotThrow=function(){d.apply(this,[!1].concat(m.call(arguments)))},g.ifError=function(e){if(e)throw e}},{util:2,buffer:3}],2:[function(e,t,n){function i(e){return e instanceof Array||Array.isArray(e)||e&&e!==Object.prototype&&i(e.__proto__)}function r(e){return e instanceof RegExp||"object"==typeof e&&"[object RegExp]"===Object.prototype.toString.call(e)}function s(e){if(e instanceof Date)return!0;if("object"!=typeof e)return!1;var t=Date.prototype&&a(Date.prototype),n=e.__proto__&&a(e.__proto__);return JSON.stringify(n)===JSON.stringify(t)}e("events");n.isArray=i,n.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},n.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},n.print=function(){},n.puts=function(){},n.debug=function(){},n.inspect=function(e,t,l,c){function u(e,l){if(e&&"function"==typeof e.inspect&&e!==n&&(!e.constructor||e.constructor.prototype!==e))return e.inspect(l);switch(typeof e){case"undefined":return d("undefined","undefined");case"string":var c="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return d(c,"string");case"number":return d(""+e,"number");case"boolean":return d(""+e,"boolean")}if(null===e)return d("null","null");var f=o(e),p=t?a(e):f;if("function"==typeof e&&0===p.length){if(r(e))return d(""+e,"regexp");var m=e.name?": "+e.name:"";return d("[Function"+m+"]","special")}if(s(e)&&0===p.length)return d(e.toUTCString(),"date");var g,v,y;if(i(e)?(v="Array",y=["[","]"]):(v="Object",y=["{","}"]),"function"==typeof e){var b=e.name?": "+e.name:"";g=r(e)?" "+e:" [Function"+b+"]"}else g="";if(s(e)&&(g=" "+e.toUTCString()),0===p.length)return y[0]+g+y[1];if(0>l)return r(e)?d(""+e,"regexp"):d("[Object]","special");h.push(e);var w=p.map(function(t){var n,r;if(e.__lookupGetter__&&(e.__lookupGetter__(t)?r=e.__lookupSetter__(t)?d("[Getter/Setter]","special"):d("[Getter]","special"):e.__lookupSetter__(t)&&(r=d("[Setter]","special"))),f.indexOf(t)<0&&(n="["+t+"]"),r||(h.indexOf(e[t])<0?(r=null===l?u(e[t]):u(e[t],l-1),r.indexOf("\n")>-1&&(r=i(e)?r.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+r.split("\n").map(function(e){return"   "+e}).join("\n"))):r=d("[Circular]","special")),"undefined"==typeof n){if("Array"===v&&t.match(/^\d+$/))return r;n=JSON.stringify(""+t),n.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(n=n.substr(1,n.length-2),n=d(n,"name")):(n=n.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),n=d(n,"string"))}return n+": "+r});h.pop();var x=0,k=w.reduce(function(e,t){return x++,t.indexOf("\n")>=0&&x++,e+t.length+1},0);return w=k>50?y[0]+(""===g?"":g+"\n ")+" "+w.join(",\n  ")+" "+y[1]:y[0]+g+" "+w.join(", ")+" "+y[1]}var h=[],d=function(e,t){var n={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i={special:"cyan",number:"blue","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"}[t];return i?"["+n[i][0]+"m"+e+"["+n[i][1]+"m":e};return c||(d=function(e){return e}),u(e,"undefined"==typeof l?2:l)};n.log=function(){},n.pump=null;var o=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t},a=Object.getOwnPropertyNames||function(e){var t=[];for(var n in e)Object.hasOwnProperty.call(e,n)&&t.push(n);return t},l=Object.create||function(e,t){var n;if(null===e)n={__proto__:null};else{if("object"!=typeof e)throw new TypeError("typeof prototype["+typeof e+"] != 'object'");var i=function(){};i.prototype=e,n=new i,n.__proto__=e}return"undefined"!=typeof t&&Object.defineProperties&&Object.defineProperties(n,t),n};n.inherits=function(e,t){e.super_=t,e.prototype=l(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})};var c=/%[sdj%]/g;n.format=function(e){if("string"!=typeof e){for(var t=[],i=0;i<arguments.length;i++)t.push(n.inspect(arguments[i]));return t.join(" ")}for(var i=1,r=arguments,s=r.length,o=String(e).replace(c,function(e){if("%%"===e)return"%";if(i>=s)return e;switch(e){case"%s":return String(r[i++]);case"%d":return Number(r[i++]);case"%j":return JSON.stringify(r[i++]);default:return e}}),a=r[i];s>i;a=r[++i])o+=null===a||"object"!=typeof a?" "+a:" "+n.inspect(a);return o}},{events:4}],5:[function(e,t,n){n.readIEEE754=function(e,t,n,i,r){var s,o,a=8*r-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?0:r-1,d=n?1:-1,f=e[t+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===s)s=1-c;else{if(s===l)return o?0/0:1/0*(f?-1:1);o+=Math.pow(2,i),s-=c}return(f?-1:1)*o*Math.pow(2,s-i)},n.writeIEEE754=function(e,t,n,i,r,s){var o,a,l,c=8*s-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?s-1:0,p=i?-1:1,m=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),t+=o+h>=1?d/l:d*Math.pow(2,1-h),t*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*l-1)*Math.pow(2,r),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[n+f]=255&a,f+=p,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;e[n+f]=255&o,f+=p,o/=256,c-=8);e[n+f-p]|=128*m}},{}],6:[function(e,t){var n=t.exports={};n.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){if(e.source===window&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var t=n.shift();t()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),n.title="browser",n.browser=!0,n.env={},n.argv=[],n.binding=function(){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t,n){!function(e){function t(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(t===e[n])return n;return-1}e.EventEmitter||(e.EventEmitter=function(){});var i=n.EventEmitter=e.EventEmitter,r="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=10;i.prototype.setMaxListeners=function(e){this._events||(this._events={}),this._events.maxListeners=e},i.prototype.emit=function(e){if("error"===e&&(!this._events||!this._events.error||r(this._events.error)&&!this._events.error.length))throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");if(!this._events)return!1;var t=this._events[e];if(!t)return!1;if("function"==typeof t){switch(arguments.length){case 1:t.call(this);break;case 2:t.call(this,arguments[1]);break;case 3:t.call(this,arguments[1],arguments[2]);break;default:var n=Array.prototype.slice.call(arguments,1);t.apply(this,n)}return!0}if(r(t)){for(var n=Array.prototype.slice.call(arguments,1),i=t.slice(),s=0,o=i.length;o>s;s++)i[s].apply(this,n);return!0}return!1},i.prototype.addListener=function(e,t){if("function"!=typeof t)throw new Error("addListener only takes instances of Function");if(this._events||(this._events={}),this.emit("newListener",e,t),this._events[e])if(r(this._events[e])){if(!this._events[e].warned){var n;n=void 0!==this._events.maxListeners?this._events.maxListeners:s,n&&n>0&&this._events[e].length>n&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),console.trace())}this._events[e].push(t)}else this._events[e]=[this._events[e],t];else this._events[e]=t;return this},i.prototype.on=i.prototype.addListener,i.prototype.once=function(e,t){var n=this;return n.on(e,function i(){n.removeListener(e,i),t.apply(this,arguments)}),this},i.prototype.removeListener=function(e,n){if("function"!=typeof n)throw new Error("removeListener only takes instances of Function");if(!this._events||!this._events[e])return this;var i=this._events[e];if(r(i)){var s=t(i,n);if(0>s)return this;i.splice(s,1),0==i.length&&delete this._events[e]}else this._events[e]===n&&delete this._events[e];return this},i.prototype.removeAllListeners=function(e){return 0===arguments.length?(this._events={},this):(e&&this._events&&this._events[e]&&(this._events[e]=null),this)},i.prototype.listeners=function(e){return this._events||(this._events={}),this._events[e]||(this._events[e]=[]),r(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]}}(e("__browserify_process"))},{__browserify_process:6}],"buffer-browserify":[function(e,t){t.exports=e("q9TxCC")},{}],q9TxCC:[function(e,t,n){function i(e){this.length=e}function r(e){return 16>e?"0"+e.toString(16):e.toString(16)}function s(e){for(var t=[],n=0;n<e.length;n++)if(e.charCodeAt(n)<=127)t.push(e.charCodeAt(n));else for(var i=encodeURIComponent(e.charAt(n)).substr(1).split("%"),r=0;r<i.length;r++)t.push(parseInt(i[r],16));return t}function o(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function a(t){return e("base64-js").toByteArray(t)}function l(e,t,n,i){for(var r=0;i>r&&!(r+n>=t.length||r>=e.length);)t[r+n]=e[r],r++;return r}function c(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function u(e){return e=~~Math.ceil(+e),0>e?0:e}function h(e,t,n){if(!(this instanceof h))return new h(e,t,n);var r;if("number"==typeof n)this.length=u(t),this.parent=e,this.offset=n;else{switch(r=typeof e){case"number":this.length=u(e);break;case"string":this.length=h.byteLength(e,t);break;case"object":this.length=u(e.length);break;default:throw new Error("First argument needs to be a number, array or string.")}if(this.length>h.poolSize?(this.parent=new i(this.length),this.offset=0):((!F||F.length-F.used<this.length)&&f(),this.parent=F,this.offset=F.used,F.used+=this.length),d(e))for(var s=0;s<this.length;s++)this.parent[s+this.offset]=e instanceof h?e.readUInt8(s):e[s];else"string"==r&&(this.length=this.write(e,0,t))}}function d(e){return Array.isArray(e)||h.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function f(){F=new i(h.poolSize),F.used=0}function p(e,t,n,i){var r=0;return i||(A.ok("boolean"==typeof n,"missing or invalid endian"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t+1<e.length,"Trying to read beyond buffer length")),t>=e.length?0:(n?(r=e.parent[e.offset+t]<<8,t+1<e.length&&(r|=e.parent[e.offset+t+1])):(r=e.parent[e.offset+t],t+1<e.length&&(r|=e.parent[e.offset+t+1]<<8)),r)}function m(e,t,n,i){var r=0;return i||(A.ok("boolean"==typeof n,"missing or invalid endian"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t+3<e.length,"Trying to read beyond buffer length")),t>=e.length?0:(n?(t+1<e.length&&(r=e.parent[e.offset+t+1]<<16),t+2<e.length&&(r|=e.parent[e.offset+t+2]<<8),t+3<e.length&&(r|=e.parent[e.offset+t+3]),r+=e.parent[e.offset+t]<<24>>>0):(t+2<e.length&&(r=e.parent[e.offset+t+2]<<16),t+1<e.length&&(r|=e.parent[e.offset+t+1]<<8),r|=e.parent[e.offset+t],t+3<e.length&&(r+=e.parent[e.offset+t+3]<<24>>>0)),r)}function g(e,t,n,i){var r,s;return i||(A.ok("boolean"==typeof n,"missing or invalid endian"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t+1<e.length,"Trying to read beyond buffer length")),s=p(e,t,n,i),r=32768&s,r?-1*(65535-s+1):s}function v(e,t,n,i){var r,s;return i||(A.ok("boolean"==typeof n,"missing or invalid endian"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t+3<e.length,"Trying to read beyond buffer length")),s=m(e,t,n,i),r=2147483648&s,r?-1*(4294967295-s+1):s}function y(t,n,i,r){return r||(A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(n+3<t.length,"Trying to read beyond buffer length")),e("./buffer_ieee754").readIEEE754(t,n,i,23,4)}function b(t,n,i,r){return r||(A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(n+7<t.length,"Trying to read beyond buffer length")),e("./buffer_ieee754").readIEEE754(t,n,i,52,8)}function w(e,t){A.ok("number"==typeof e,"cannot write a non-number as a number"),A.ok(e>=0,"specified a negative value for writing an unsigned value"),A.ok(t>=e,"value is larger than maximum value for type"),A.ok(Math.floor(e)===e,"value has a fractional component")}function x(e,t,n,i,r){r||(A.ok(void 0!==t&&null!==t,"missing value"),A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(void 0!==n&&null!==n,"missing offset"),A.ok(n+1<e.length,"trying to write beyond buffer length"),w(t,65535));for(var s=0;s<Math.min(e.length-n,2);s++)e.parent[e.offset+n+s]=(t&255<<8*(i?1-s:s))>>>8*(i?1-s:s)}function k(e,t,n,i,r){r||(A.ok(void 0!==t&&null!==t,"missing value"),A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(void 0!==n&&null!==n,"missing offset"),A.ok(n+3<e.length,"trying to write beyond buffer length"),w(t,4294967295));for(var s=0;s<Math.min(e.length-n,4);s++)e.parent[e.offset+n+s]=t>>>8*(i?3-s:s)&255}function _(e,t,n){A.ok("number"==typeof e,"cannot write a non-number as a number"),A.ok(t>=e,"value larger than maximum allowed value"),A.ok(e>=n,"value smaller than minimum allowed value"),A.ok(Math.floor(e)===e,"value has a fractional component")}function E(e,t,n){A.ok("number"==typeof e,"cannot write a non-number as a number"),A.ok(t>=e,"value larger than maximum allowed value"),A.ok(e>=n,"value smaller than minimum allowed value")}function C(e,t,n,i,r){r||(A.ok(void 0!==t&&null!==t,"missing value"),A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(void 0!==n&&null!==n,"missing offset"),A.ok(n+1<e.length,"Trying to write beyond buffer length"),_(t,32767,-32768)),t>=0?x(e,t,n,i,r):x(e,65535+t+1,n,i,r)}function S(e,t,n,i,r){r||(A.ok(void 0!==t&&null!==t,"missing value"),A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(void 0!==n&&null!==n,"missing offset"),A.ok(n+3<e.length,"Trying to write beyond buffer length"),_(t,2147483647,-2147483648)),t>=0?k(e,t,n,i,r):k(e,4294967295+t+1,n,i,r)}function $(t,n,i,r,s){s||(A.ok(void 0!==n&&null!==n,"missing value"),A.ok("boolean"==typeof r,"missing or invalid endian"),A.ok(void 0!==i&&null!==i,"missing offset"),A.ok(i+3<t.length,"Trying to write beyond buffer length"),E(n,3.4028234663852886e38,-3.4028234663852886e38)),e("./buffer_ieee754").writeIEEE754(t,n,i,r,23,4)}function R(t,n,i,r,s){s||(A.ok(void 0!==n&&null!==n,"missing value"),A.ok("boolean"==typeof r,"missing or invalid endian"),A.ok(void 0!==i&&null!==i,"missing offset"),A.ok(i+7<t.length,"Trying to write beyond buffer length"),E(n,1.7976931348623157e308,-1.7976931348623157e308)),e("./buffer_ieee754").writeIEEE754(t,n,i,r,52,8)}var A=e("assert");n.INSPECT_MAX_BYTES=50,i.byteLength=function(e,t){switch(t||"utf8"){case"hex":return e.length/2;case"utf8":case"utf-8":return s(e).length;case"ascii":case"binary":return e.length;case"base64":return a(e).length;default:throw new Error("Unknown encoding")}},i.prototype.utf8Write=function(e,t,n){return i._charsWritten=l(s(e),this,t,n)},i.prototype.asciiWrite=function(e,t,n){return i._charsWritten=l(o(e),this,t,n)},i.prototype.binaryWrite=i.prototype.asciiWrite,i.prototype.base64Write=function(e,t,n){return i._charsWritten=l(a(e),this,t,n)},i.prototype.base64Slice=function(){var t=Array.prototype.slice.apply(this,arguments);return e("base64-js").fromByteArray(t)},i.prototype.utf8Slice=function(){for(var e=Array.prototype.slice.apply(this,arguments),t="",n="",i=0;i<e.length;)e[i]<=127?(t+=c(n)+String.fromCharCode(e[i]),n=""):n+="%"+e[i].toString(16),i++;return t+c(n)},i.prototype.asciiSlice=function(){for(var e=Array.prototype.slice.apply(this,arguments),t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},i.prototype.binarySlice=i.prototype.asciiSlice,i.prototype.inspect=function(){for(var e=[],t=this.length,i=0;t>i;i++)if(e[i]=r(this[i]),i==n.INSPECT_MAX_BYTES){e[i+1]="...";break}return"<SlowBuffer "+e.join(" ")+">"},i.prototype.hexSlice=function(e,t){var n=this.length;(!e||0>e)&&(e=0),(!t||0>t||t>n)&&(t=n);for(var i="",s=e;t>s;s++)i+=r(this[s]);return i},i.prototype.toString=function(e,t,n){if(e=String(e||"utf8").toLowerCase(),t=+t||0,"undefined"==typeof n&&(n=this.length),+n==t)return"";switch(e){case"hex":return this.hexSlice(t,n);case"utf8":case"utf-8":return this.utf8Slice(t,n);case"ascii":return this.asciiSlice(t,n);case"binary":return this.binarySlice(t,n);case"base64":return this.base64Slice(t,n);case"ucs2":case"ucs-2":return this.ucs2Slice(t,n);default:throw new Error("Unknown encoding")}},i.prototype.hexWrite=function(e,t,n){t=+t||0;var r=this.length-t;n?(n=+n,n>r&&(n=r)):n=r;var s=e.length;if(s%2)throw new Error("Invalid hex string");n>s/2&&(n=s/2);for(var o=0;n>o;o++){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))throw new Error("Invalid hex string");this[t+o]=a}return i._charsWritten=2*o,o},i.prototype.write=function(e,t,n,i){if(isFinite(t))isFinite(n)||(i=n,n=void 0);else{var r=i;i=t,t=n,n=r}t=+t||0;var s=this.length-t;switch(n?(n=+n,n>s&&(n=s)):n=s,i=String(i||"utf8").toLowerCase()){case"hex":return this.hexWrite(e,t,n);case"utf8":case"utf-8":return this.utf8Write(e,t,n);case"ascii":return this.asciiWrite(e,t,n);case"binary":return this.binaryWrite(e,t,n);case"base64":return this.base64Write(e,t,n);case"ucs2":case"ucs-2":return this.ucs2Write(e,t,n);default:throw new Error("Unknown encoding")}},i.prototype.slice=function(e,t){if(void 0===t&&(t=this.length),t>this.length)throw new Error("oob");if(e>t)throw new Error("oob");return new h(this,t-e,+e)},i.prototype.copy=function(e,t,n,i){for(var r=[],s=n;i>s;s++)A.ok("undefined"!=typeof this[s],"copying undefined buffer bytes!"),r.push(this[s]);for(var s=t;s<t+r.length;s++)e[s]=r[s-t]},i.prototype.fill=function(e,t,n){if(n>this.length)throw new Error("oob");if(t>n)throw new Error("oob");for(var i=t;n>i;i++)this[i]=e},n.SlowBuffer=i,n.Buffer=h,h.poolSize=8192;var F;h.isBuffer=function(e){return e instanceof h||e instanceof i},h.concat=function(e,t){if(!Array.isArray(e))throw new Error("Usage: Buffer.concat(list, [totalLength])\n       list should be an Array.");if(0===e.length)return new h(0);if(1===e.length)return e[0];if("number"!=typeof t){t=0;for(var n=0;n<e.length;n++){var i=e[n];t+=i.length}}for(var r=new h(t),s=0,n=0;n<e.length;n++){var i=e[n];i.copy(r,s),s+=i.length}return r},h.prototype.inspect=function(){for(var e=[],t=this.length,i=0;t>i;i++)if(e[i]=r(this.parent[i+this.offset]),i==n.INSPECT_MAX_BYTES){e[i+1]="...";break}return"<Buffer "+e.join(" ")+">"},h.prototype.get=function(e){if(0>e||e>=this.length)throw new Error("oob");return this.parent[this.offset+e]},h.prototype.set=function(e,t){if(0>e||e>=this.length)throw new Error("oob");return this.parent[this.offset+e]=t},h.prototype.write=function(e,t,n,r){if(isFinite(t))isFinite(n)||(r=n,n=void 0);else{var s=r;r=t,t=n,n=s}t=+t||0;var o=this.length-t;n?(n=+n,n>o&&(n=o)):n=o,r=String(r||"utf8").toLowerCase();var a;switch(r){case"hex":a=this.parent.hexWrite(e,this.offset+t,n);break;case"utf8":case"utf-8":a=this.parent.utf8Write(e,this.offset+t,n);break;case"ascii":a=this.parent.asciiWrite(e,this.offset+t,n);break;case"binary":a=this.parent.binaryWrite(e,this.offset+t,n);break;case"base64":a=this.parent.base64Write(e,this.offset+t,n);break;case"ucs2":case"ucs-2":a=this.parent.ucs2Write(e,this.offset+t,n);break;default:throw new Error("Unknown encoding")}return h._charsWritten=i._charsWritten,a},h.prototype.toString=function(e,t,n){switch(e=String(e||"utf8").toLowerCase(),"undefined"==typeof t||0>t?t=0:t>this.length&&(t=this.length),"undefined"==typeof n||n>this.length?n=this.length:0>n&&(n=0),t+=this.offset,n+=this.offset,e){case"hex":return this.parent.hexSlice(t,n);case"utf8":case"utf-8":return this.parent.utf8Slice(t,n);case"ascii":return this.parent.asciiSlice(t,n);case"binary":return this.parent.binarySlice(t,n);case"base64":return this.parent.base64Slice(t,n);case"ucs2":case"ucs-2":return this.parent.ucs2Slice(t,n);default:throw new Error("Unknown encoding")}},h.byteLength=i.byteLength,h.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),"number"!=typeof e||isNaN(e))throw new Error("value is not a number");if(t>n)throw new Error("end < start");if(n===t)return 0;if(0==this.length)return 0;if(0>t||t>=this.length)throw new Error("start out of bounds");if(0>n||n>this.length)throw new Error("end out of bounds");return this.parent.fill(e,t+this.offset,n+this.offset)},h.prototype.copy=function(e,t,n,i){var r=this;if(n||(n=0),i||(i=this.length),t||(t=0),n>i)throw new Error("sourceEnd < sourceStart");if(i===n)return 0;if(0==e.length||0==r.length)return 0;if(0>t||t>=e.length)throw new Error("targetStart out of bounds");if(0>n||n>=r.length)throw new Error("sourceStart out of bounds");if(0>i||i>r.length)throw new Error("sourceEnd out of bounds");return i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n),this.parent.copy(e.parent,t+e.offset,n+this.offset,i+this.offset)},h.prototype.slice=function(e,t){if(void 0===t&&(t=this.length),t>this.length)throw new Error("oob");if(e>t)throw new Error("oob");return new h(this.parent,t-e,+e+this.offset)},h.prototype.utf8Slice=function(e,t){return this.toString("utf8",e,t)},h.prototype.binarySlice=function(e,t){return this.toString("binary",e,t)},h.prototype.asciiSlice=function(e,t){return this.toString("ascii",e,t)},h.prototype.utf8Write=function(e,t){return this.write(e,t,"utf8")},h.prototype.binaryWrite=function(e,t){return this.write(e,t,"binary")},h.prototype.asciiWrite=function(e,t){return this.write(e,t,"ascii")},h.prototype.readUInt8=function(e,t){var n=this;return t||(A.ok(void 0!==e&&null!==e,"missing offset"),A.ok(e<n.length,"Trying to read beyond buffer length")),e>=n.length?void 0:n.parent[n.offset+e]},h.prototype.readUInt16LE=function(e,t){return p(this,e,!1,t)},h.prototype.readUInt16BE=function(e,t){return p(this,e,!0,t)},h.prototype.readUInt32LE=function(e,t){return m(this,e,!1,t)},h.prototype.readUInt32BE=function(e,t){return m(this,e,!0,t)},h.prototype.readInt8=function(e,t){var n,i=this;return t||(A.ok(void 0!==e&&null!==e,"missing offset"),A.ok(e<i.length,"Trying to read beyond buffer length")),e>=i.length?void 0:(n=128&i.parent[i.offset+e],n?-1*(255-i.parent[i.offset+e]+1):i.parent[i.offset+e])},h.prototype.readInt16LE=function(e,t){return g(this,e,!1,t)},h.prototype.readInt16BE=function(e,t){return g(this,e,!0,t)},h.prototype.readInt32LE=function(e,t){return v(this,e,!1,t)},h.prototype.readInt32BE=function(e,t){return v(this,e,!0,t)},h.prototype.readFloatLE=function(e,t){return y(this,e,!1,t)},h.prototype.readFloatBE=function(e,t){return y(this,e,!0,t)},h.prototype.readDoubleLE=function(e,t){return b(this,e,!1,t)},h.prototype.readDoubleBE=function(e,t){return b(this,e,!0,t)},h.prototype.writeUInt8=function(e,t,n){var i=this;n||(A.ok(void 0!==e&&null!==e,"missing value"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t<i.length,"trying to write beyond buffer length"),w(e,255)),t<i.length&&(i.parent[i.offset+t]=e)},h.prototype.writeUInt16LE=function(e,t,n){x(this,e,t,!1,n)},h.prototype.writeUInt16BE=function(e,t,n){x(this,e,t,!0,n)},h.prototype.writeUInt32LE=function(e,t,n){k(this,e,t,!1,n)},h.prototype.writeUInt32BE=function(e,t,n){k(this,e,t,!0,n)},h.prototype.writeInt8=function(e,t,n){var i=this;n||(A.ok(void 0!==e&&null!==e,"missing value"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t<i.length,"Trying to write beyond buffer length"),_(e,127,-128)),e>=0?i.writeUInt8(e,t,n):i.writeUInt8(255+e+1,t,n)},h.prototype.writeInt16LE=function(e,t,n){C(this,e,t,!1,n)},h.prototype.writeInt16BE=function(e,t,n){C(this,e,t,!0,n)},h.prototype.writeInt32LE=function(e,t,n){S(this,e,t,!1,n)},h.prototype.writeInt32BE=function(e,t,n){S(this,e,t,!0,n)},h.prototype.writeFloatLE=function(e,t,n){$(this,e,t,!1,n)},h.prototype.writeFloatBE=function(e,t,n){$(this,e,t,!0,n)},h.prototype.writeDoubleLE=function(e,t,n){R(this,e,t,!1,n)},h.prototype.writeDoubleBE=function(e,t,n){R(this,e,t,!0,n)},i.prototype.readUInt8=h.prototype.readUInt8,i.prototype.readUInt16LE=h.prototype.readUInt16LE,i.prototype.readUInt16BE=h.prototype.readUInt16BE,i.prototype.readUInt32LE=h.prototype.readUInt32LE,i.prototype.readUInt32BE=h.prototype.readUInt32BE,i.prototype.readInt8=h.prototype.readInt8,i.prototype.readInt16LE=h.prototype.readInt16LE,i.prototype.readInt16BE=h.prototype.readInt16BE,i.prototype.readInt32LE=h.prototype.readInt32LE,i.prototype.readInt32BE=h.prototype.readInt32BE,i.prototype.readFloatLE=h.prototype.readFloatLE,i.prototype.readFloatBE=h.prototype.readFloatBE,i.prototype.readDoubleLE=h.prototype.readDoubleLE,i.prototype.readDoubleBE=h.prototype.readDoubleBE,i.prototype.writeUInt8=h.prototype.writeUInt8,i.prototype.writeUInt16LE=h.prototype.writeUInt16LE,i.prototype.writeUInt16BE=h.prototype.writeUInt16BE,i.prototype.writeUInt32LE=h.prototype.writeUInt32LE,i.prototype.writeUInt32BE=h.prototype.writeUInt32BE,i.prototype.writeInt8=h.prototype.writeInt8,i.prototype.writeInt16LE=h.prototype.writeInt16LE,i.prototype.writeInt16BE=h.prototype.writeInt16BE,i.prototype.writeInt32LE=h.prototype.writeInt32LE,i.prototype.writeInt32BE=h.prototype.writeInt32BE,i.prototype.writeFloatLE=h.prototype.writeFloatLE,i.prototype.writeFloatBE=h.prototype.writeFloatBE,i.prototype.writeDoubleLE=h.prototype.writeDoubleLE,i.prototype.writeDoubleBE=h.prototype.writeDoubleBE},{assert:1,"./buffer_ieee754":5,"base64-js":7}],7:[function(e,t){!function(){"use strict";function e(e){var t,n,r,s,o,a;if(e.length%4>0)throw"Invalid string. Length must be a multiple of 4";for(o=e.indexOf("="),o=o>0?e.length-o:0,a=[],r=o>0?e.length-4:e.length,t=0,n=0;r>t;t+=4,n+=3)s=i.indexOf(e[t])<<18|i.indexOf(e[t+1])<<12|i.indexOf(e[t+2])<<6|i.indexOf(e[t+3]),a.push((16711680&s)>>16),a.push((65280&s)>>8),a.push(255&s);return 2===o?(s=i.indexOf(e[t])<<2|i.indexOf(e[t+1])>>4,a.push(255&s)):1===o&&(s=i.indexOf(e[t])<<10|i.indexOf(e[t+1])<<4|i.indexOf(e[t+2])>>2,a.push(s>>8&255),a.push(255&s)),a
}function n(e){function t(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}var n,r,s,o=e.length%3,a="";for(n=0,s=e.length-o;s>n;n+=3)r=(e[n]<<16)+(e[n+1]<<8)+e[n+2],a+=t(r);switch(o){case 1:r=e[e.length-1],a+=i[r>>2],a+=i[r<<4&63],a+="==";break;case 2:r=(e[e.length-2]<<8)+e[e.length-1],a+=i[r>>10],a+=i[r>>4&63],a+=i[r<<2&63],a+="="}return a}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports.toByteArray=e,t.exports.fromByteArray=n}()},{}],8:[function(e,t,n){n.readIEEE754=function(e,t,n,i,r){var s,o,a=8*r-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?0:r-1,d=n?1:-1,f=e[t+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===s)s=1-c;else{if(s===l)return o?0/0:1/0*(f?-1:1);o+=Math.pow(2,i),s-=c}return(f?-1:1)*o*Math.pow(2,s-i)},n.writeIEEE754=function(e,t,n,i,r,s){var o,a,l,c=8*s-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?s-1:0,p=i?-1:1,m=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),t+=o+h>=1?d/l:d*Math.pow(2,1-h),t*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*l-1)*Math.pow(2,r),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[n+f]=255&a,f+=p,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;e[n+f]=255&o,f+=p,o/=256,c-=8);e[n+f-p]|=128*m}},{}],3:[function(e,t,n){function i(e){this.length=e}function r(e){return 16>e?"0"+e.toString(16):e.toString(16)}function s(e){for(var t=[],n=0;n<e.length;n++)if(e.charCodeAt(n)<=127)t.push(e.charCodeAt(n));else for(var i=encodeURIComponent(e.charAt(n)).substr(1).split("%"),r=0;r<i.length;r++)t.push(parseInt(i[r],16));return t}function o(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function a(t){return e("base64-js").toByteArray(t)}function l(e,t,n,i){for(var r=0;i>r&&!(r+n>=t.length||r>=e.length);)t[r+n]=e[r],r++;return r}function c(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function u(e){return e=~~Math.ceil(+e),0>e?0:e}function h(e,t,n){if(!(this instanceof h))return new h(e,t,n);var r;if("number"==typeof n)this.length=u(t),this.parent=e,this.offset=n;else{switch(r=typeof e){case"number":this.length=u(e);break;case"string":this.length=h.byteLength(e,t);break;case"object":this.length=u(e.length);break;default:throw new Error("First argument needs to be a number, array or string.")}if(this.length>h.poolSize?(this.parent=new i(this.length),this.offset=0):((!F||F.length-F.used<this.length)&&f(),this.parent=F,this.offset=F.used,F.used+=this.length),d(e))for(var s=0;s<this.length;s++)this.parent[s+this.offset]=e[s];else"string"==r&&(this.length=this.write(e,0,t))}}function d(e){return Array.isArray(e)||h.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function f(){F=new i(h.poolSize),F.used=0}function p(e,t,n,i){var r=0;return i||(A.ok("boolean"==typeof n,"missing or invalid endian"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t+1<e.length,"Trying to read beyond buffer length")),n?(r=e.parent[e.offset+t]<<8,r|=e.parent[e.offset+t+1]):(r=e.parent[e.offset+t],r|=e.parent[e.offset+t+1]<<8),r}function m(e,t,n,i){var r=0;return i||(A.ok("boolean"==typeof n,"missing or invalid endian"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t+3<e.length,"Trying to read beyond buffer length")),n?(r=e.parent[e.offset+t+1]<<16,r|=e.parent[e.offset+t+2]<<8,r|=e.parent[e.offset+t+3],r+=e.parent[e.offset+t]<<24>>>0):(r=e.parent[e.offset+t+2]<<16,r|=e.parent[e.offset+t+1]<<8,r|=e.parent[e.offset+t],r+=e.parent[e.offset+t+3]<<24>>>0),r}function g(e,t,n,i){var r,s;return i||(A.ok("boolean"==typeof n,"missing or invalid endian"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t+1<e.length,"Trying to read beyond buffer length")),s=p(e,t,n,i),r=32768&s,r?-1*(65535-s+1):s}function v(e,t,n,i){var r,s;return i||(A.ok("boolean"==typeof n,"missing or invalid endian"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t+3<e.length,"Trying to read beyond buffer length")),s=m(e,t,n,i),r=2147483648&s,r?-1*(4294967295-s+1):s}function y(t,n,i,r){return r||(A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(n+3<t.length,"Trying to read beyond buffer length")),e("./buffer_ieee754").readIEEE754(t,n,i,23,4)}function b(t,n,i,r){return r||(A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(n+7<t.length,"Trying to read beyond buffer length")),e("./buffer_ieee754").readIEEE754(t,n,i,52,8)}function w(e,t){A.ok("number"==typeof e,"cannot write a non-number as a number"),A.ok(e>=0,"specified a negative value for writing an unsigned value"),A.ok(t>=e,"value is larger than maximum value for type"),A.ok(Math.floor(e)===e,"value has a fractional component")}function x(e,t,n,i,r){r||(A.ok(void 0!==t&&null!==t,"missing value"),A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(void 0!==n&&null!==n,"missing offset"),A.ok(n+1<e.length,"trying to write beyond buffer length"),w(t,65535)),i?(e.parent[e.offset+n]=(65280&t)>>>8,e.parent[e.offset+n+1]=255&t):(e.parent[e.offset+n+1]=(65280&t)>>>8,e.parent[e.offset+n]=255&t)}function k(e,t,n,i,r){r||(A.ok(void 0!==t&&null!==t,"missing value"),A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(void 0!==n&&null!==n,"missing offset"),A.ok(n+3<e.length,"trying to write beyond buffer length"),w(t,4294967295)),i?(e.parent[e.offset+n]=t>>>24&255,e.parent[e.offset+n+1]=t>>>16&255,e.parent[e.offset+n+2]=t>>>8&255,e.parent[e.offset+n+3]=255&t):(e.parent[e.offset+n+3]=t>>>24&255,e.parent[e.offset+n+2]=t>>>16&255,e.parent[e.offset+n+1]=t>>>8&255,e.parent[e.offset+n]=255&t)}function _(e,t,n){A.ok("number"==typeof e,"cannot write a non-number as a number"),A.ok(t>=e,"value larger than maximum allowed value"),A.ok(e>=n,"value smaller than minimum allowed value"),A.ok(Math.floor(e)===e,"value has a fractional component")}function E(e,t,n){A.ok("number"==typeof e,"cannot write a non-number as a number"),A.ok(t>=e,"value larger than maximum allowed value"),A.ok(e>=n,"value smaller than minimum allowed value")}function C(e,t,n,i,r){r||(A.ok(void 0!==t&&null!==t,"missing value"),A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(void 0!==n&&null!==n,"missing offset"),A.ok(n+1<e.length,"Trying to write beyond buffer length"),_(t,32767,-32768)),t>=0?x(e,t,n,i,r):x(e,65535+t+1,n,i,r)}function S(e,t,n,i,r){r||(A.ok(void 0!==t&&null!==t,"missing value"),A.ok("boolean"==typeof i,"missing or invalid endian"),A.ok(void 0!==n&&null!==n,"missing offset"),A.ok(n+3<e.length,"Trying to write beyond buffer length"),_(t,2147483647,-2147483648)),t>=0?k(e,t,n,i,r):k(e,4294967295+t+1,n,i,r)}function $(t,n,i,r,s){s||(A.ok(void 0!==n&&null!==n,"missing value"),A.ok("boolean"==typeof r,"missing or invalid endian"),A.ok(void 0!==i&&null!==i,"missing offset"),A.ok(i+3<t.length,"Trying to write beyond buffer length"),E(n,3.4028234663852886e38,-3.4028234663852886e38)),e("./buffer_ieee754").writeIEEE754(t,n,i,r,23,4)}function R(t,n,i,r,s){s||(A.ok(void 0!==n&&null!==n,"missing value"),A.ok("boolean"==typeof r,"missing or invalid endian"),A.ok(void 0!==i&&null!==i,"missing offset"),A.ok(i+7<t.length,"Trying to write beyond buffer length"),E(n,1.7976931348623157e308,-1.7976931348623157e308)),e("./buffer_ieee754").writeIEEE754(t,n,i,r,52,8)}var A=e("assert");n.INSPECT_MAX_BYTES=50,i.byteLength=function(e,t){switch(t||"utf8"){case"hex":return e.length/2;case"utf8":case"utf-8":return s(e).length;case"ascii":return e.length;case"base64":return a(e).length;default:throw new Error("Unknown encoding")}},i.prototype.utf8Write=function(e,t,n){return i._charsWritten=l(s(e),this,t,n)},i.prototype.asciiWrite=function(e,t,n){return i._charsWritten=l(o(e),this,t,n)},i.prototype.base64Write=function(e,t,n){return i._charsWritten=l(a(e),this,t,n)},i.prototype.base64Slice=function(){var t=Array.prototype.slice.apply(this,arguments);return e("base64-js").fromByteArray(t)},i.prototype.utf8Slice=function(){for(var e=Array.prototype.slice.apply(this,arguments),t="",n="",i=0;i<e.length;)e[i]<=127?(t+=c(n)+String.fromCharCode(e[i]),n=""):n+="%"+e[i].toString(16),i++;return t+c(n)},i.prototype.asciiSlice=function(){for(var e=Array.prototype.slice.apply(this,arguments),t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},i.prototype.inspect=function(){for(var e=[],t=this.length,i=0;t>i;i++)if(e[i]=r(this[i]),i==n.INSPECT_MAX_BYTES){e[i+1]="...";break}return"<SlowBuffer "+e.join(" ")+">"},i.prototype.hexSlice=function(e,t){var n=this.length;(!e||0>e)&&(e=0),(!t||0>t||t>n)&&(t=n);for(var i="",s=e;t>s;s++)i+=r(this[s]);return i},i.prototype.toString=function(e,t,n){if(e=String(e||"utf8").toLowerCase(),t=+t||0,"undefined"==typeof n&&(n=this.length),+n==t)return"";switch(e){case"hex":return this.hexSlice(t,n);case"utf8":case"utf-8":return this.utf8Slice(t,n);case"ascii":return this.asciiSlice(t,n);case"binary":return this.binarySlice(t,n);case"base64":return this.base64Slice(t,n);case"ucs2":case"ucs-2":return this.ucs2Slice(t,n);default:throw new Error("Unknown encoding")}},i.prototype.hexWrite=function(e,t,n){t=+t||0;var r=this.length-t;n?(n=+n,n>r&&(n=r)):n=r;var s=e.length;if(s%2)throw new Error("Invalid hex string");n>s/2&&(n=s/2);for(var o=0;n>o;o++){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))throw new Error("Invalid hex string");this[t+o]=a}return i._charsWritten=2*o,o},i.prototype.write=function(e,t,n,i){if(isFinite(t))isFinite(n)||(i=n,n=void 0);else{var r=i;i=t,t=n,n=r}t=+t||0;var s=this.length-t;switch(n?(n=+n,n>s&&(n=s)):n=s,i=String(i||"utf8").toLowerCase()){case"hex":return this.hexWrite(e,t,n);case"utf8":case"utf-8":return this.utf8Write(e,t,n);case"ascii":return this.asciiWrite(e,t,n);case"binary":return this.binaryWrite(e,t,n);case"base64":return this.base64Write(e,t,n);case"ucs2":case"ucs-2":return this.ucs2Write(e,t,n);default:throw new Error("Unknown encoding")}},i.prototype.slice=function(e,t){if(void 0===t&&(t=this.length),t>this.length)throw new Error("oob");if(e>t)throw new Error("oob");return new h(this,t-e,+e)},i.prototype.copy=function(e,t,n,i){for(var r=[],s=n;i>s;s++)A.ok("undefined"!=typeof this[s],"copying undefined buffer bytes!"),r.push(this[s]);for(var s=t;s<t+r.length;s++)e[s]=r[s-t]},n.SlowBuffer=i,n.Buffer=h,h.poolSize=8192;var F;h.isBuffer=function(e){return e instanceof h||e instanceof i},h.concat=function(e,t){if(!Array.isArray(e))throw new Error("Usage: Buffer.concat(list, [totalLength])\n       list should be an Array.");if(0===e.length)return new h(0);if(1===e.length)return e[0];if("number"!=typeof t){t=0;for(var n=0;n<e.length;n++){var i=e[n];t+=i.length}}for(var r=new h(t),s=0,n=0;n<e.length;n++){var i=e[n];i.copy(r,s),s+=i.length}return r},h.prototype.inspect=function(){for(var e=[],t=this.length,i=0;t>i;i++)if(e[i]=r(this.parent[i+this.offset]),i==n.INSPECT_MAX_BYTES){e[i+1]="...";break}return"<Buffer "+e.join(" ")+">"},h.prototype.get=function(e){if(0>e||e>=this.length)throw new Error("oob");return this.parent[this.offset+e]},h.prototype.set=function(e,t){if(0>e||e>=this.length)throw new Error("oob");return this.parent[this.offset+e]=t},h.prototype.write=function(e,t,n,r){if(isFinite(t))isFinite(n)||(r=n,n=void 0);else{var s=r;r=t,t=n,n=s}t=+t||0;var o=this.length-t;n?(n=+n,n>o&&(n=o)):n=o,r=String(r||"utf8").toLowerCase();var a;switch(r){case"hex":a=this.parent.hexWrite(e,this.offset+t,n);break;case"utf8":case"utf-8":a=this.parent.utf8Write(e,this.offset+t,n);break;case"ascii":a=this.parent.asciiWrite(e,this.offset+t,n);break;case"binary":a=this.parent.binaryWrite(e,this.offset+t,n);break;case"base64":a=this.parent.base64Write(e,this.offset+t,n);break;case"ucs2":case"ucs-2":a=this.parent.ucs2Write(e,this.offset+t,n);break;default:throw new Error("Unknown encoding")}return h._charsWritten=i._charsWritten,a},h.prototype.toString=function(e,t,n){switch(e=String(e||"utf8").toLowerCase(),"undefined"==typeof t||0>t?t=0:t>this.length&&(t=this.length),"undefined"==typeof n||n>this.length?n=this.length:0>n&&(n=0),t+=this.offset,n+=this.offset,e){case"hex":return this.parent.hexSlice(t,n);case"utf8":case"utf-8":return this.parent.utf8Slice(t,n);case"ascii":return this.parent.asciiSlice(t,n);case"binary":return this.parent.binarySlice(t,n);case"base64":return this.parent.base64Slice(t,n);case"ucs2":case"ucs-2":return this.parent.ucs2Slice(t,n);default:throw new Error("Unknown encoding")}},h.byteLength=i.byteLength,h.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),"number"!=typeof e||isNaN(e))throw new Error("value is not a number");if(t>n)throw new Error("end < start");if(n===t)return 0;if(0==this.length)return 0;if(0>t||t>=this.length)throw new Error("start out of bounds");if(0>n||n>this.length)throw new Error("end out of bounds");return this.parent.fill(e,t+this.offset,n+this.offset)},h.prototype.copy=function(e,t,n,i){var r=this;if(n||(n=0),i||(i=this.length),t||(t=0),n>i)throw new Error("sourceEnd < sourceStart");if(i===n)return 0;if(0==e.length||0==r.length)return 0;if(0>t||t>=e.length)throw new Error("targetStart out of bounds");if(0>n||n>=r.length)throw new Error("sourceStart out of bounds");if(0>i||i>r.length)throw new Error("sourceEnd out of bounds");return i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n),this.parent.copy(e.parent,t+e.offset,n+this.offset,i+this.offset)},h.prototype.slice=function(e,t){if(void 0===t&&(t=this.length),t>this.length)throw new Error("oob");if(e>t)throw new Error("oob");return new h(this.parent,t-e,+e+this.offset)},h.prototype.utf8Slice=function(e,t){return this.toString("utf8",e,t)},h.prototype.binarySlice=function(e,t){return this.toString("binary",e,t)},h.prototype.asciiSlice=function(e,t){return this.toString("ascii",e,t)},h.prototype.utf8Write=function(e,t){return this.write(e,t,"utf8")},h.prototype.binaryWrite=function(e,t){return this.write(e,t,"binary")},h.prototype.asciiWrite=function(e,t){return this.write(e,t,"ascii")},h.prototype.readUInt8=function(e,t){var n=this;return t||(A.ok(void 0!==e&&null!==e,"missing offset"),A.ok(e<n.length,"Trying to read beyond buffer length")),n.parent[n.offset+e]},h.prototype.readUInt16LE=function(e,t){return p(this,e,!1,t)},h.prototype.readUInt16BE=function(e,t){return p(this,e,!0,t)},h.prototype.readUInt32LE=function(e,t){return m(this,e,!1,t)},h.prototype.readUInt32BE=function(e,t){return m(this,e,!0,t)},h.prototype.readInt8=function(e,t){var n,i=this;return t||(A.ok(void 0!==e&&null!==e,"missing offset"),A.ok(e<i.length,"Trying to read beyond buffer length")),n=128&i.parent[i.offset+e],n?-1*(255-i.parent[i.offset+e]+1):i.parent[i.offset+e]},h.prototype.readInt16LE=function(e,t){return g(this,e,!1,t)},h.prototype.readInt16BE=function(e,t){return g(this,e,!0,t)},h.prototype.readInt32LE=function(e,t){return v(this,e,!1,t)},h.prototype.readInt32BE=function(e,t){return v(this,e,!0,t)},h.prototype.readFloatLE=function(e,t){return y(this,e,!1,t)},h.prototype.readFloatBE=function(e,t){return y(this,e,!0,t)},h.prototype.readDoubleLE=function(e,t){return b(this,e,!1,t)},h.prototype.readDoubleBE=function(e,t){return b(this,e,!0,t)},h.prototype.writeUInt8=function(e,t,n){var i=this;n||(A.ok(void 0!==e&&null!==e,"missing value"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t<i.length,"trying to write beyond buffer length"),w(e,255)),i.parent[i.offset+t]=e},h.prototype.writeUInt16LE=function(e,t,n){x(this,e,t,!1,n)},h.prototype.writeUInt16BE=function(e,t,n){x(this,e,t,!0,n)},h.prototype.writeUInt32LE=function(e,t,n){k(this,e,t,!1,n)},h.prototype.writeUInt32BE=function(e,t,n){k(this,e,t,!0,n)},h.prototype.writeInt8=function(e,t,n){var i=this;n||(A.ok(void 0!==e&&null!==e,"missing value"),A.ok(void 0!==t&&null!==t,"missing offset"),A.ok(t<i.length,"Trying to write beyond buffer length"),_(e,127,-128)),e>=0?i.writeUInt8(e,t,n):i.writeUInt8(255+e+1,t,n)},h.prototype.writeInt16LE=function(e,t,n){C(this,e,t,!1,n)},h.prototype.writeInt16BE=function(e,t,n){C(this,e,t,!0,n)},h.prototype.writeInt32LE=function(e,t,n){S(this,e,t,!1,n)},h.prototype.writeInt32BE=function(e,t,n){S(this,e,t,!0,n)},h.prototype.writeFloatLE=function(e,t,n){$(this,e,t,!1,n)},h.prototype.writeFloatBE=function(e,t,n){$(this,e,t,!0,n)},h.prototype.writeDoubleLE=function(e,t,n){R(this,e,t,!1,n)},h.prototype.writeDoubleBE=function(e,t,n){R(this,e,t,!0,n)},i.prototype.readUInt8=h.prototype.readUInt8,i.prototype.readUInt16LE=h.prototype.readUInt16LE,i.prototype.readUInt16BE=h.prototype.readUInt16BE,i.prototype.readUInt32LE=h.prototype.readUInt32LE,i.prototype.readUInt32BE=h.prototype.readUInt32BE,i.prototype.readInt8=h.prototype.readInt8,i.prototype.readInt16LE=h.prototype.readInt16LE,i.prototype.readInt16BE=h.prototype.readInt16BE,i.prototype.readInt32LE=h.prototype.readInt32LE,i.prototype.readInt32BE=h.prototype.readInt32BE,i.prototype.readFloatLE=h.prototype.readFloatLE,i.prototype.readFloatBE=h.prototype.readFloatBE,i.prototype.readDoubleLE=h.prototype.readDoubleLE,i.prototype.readDoubleBE=h.prototype.readDoubleBE,i.prototype.writeUInt8=h.prototype.writeUInt8,i.prototype.writeUInt16LE=h.prototype.writeUInt16LE,i.prototype.writeUInt16BE=h.prototype.writeUInt16BE,i.prototype.writeUInt32LE=h.prototype.writeUInt32LE,i.prototype.writeUInt32BE=h.prototype.writeUInt32BE,i.prototype.writeInt8=h.prototype.writeInt8,i.prototype.writeInt16LE=h.prototype.writeInt16LE,i.prototype.writeInt16BE=h.prototype.writeInt16BE,i.prototype.writeInt32LE=h.prototype.writeInt32LE,i.prototype.writeInt32BE=h.prototype.writeInt32BE,i.prototype.writeFloatLE=h.prototype.writeFloatLE,i.prototype.writeFloatBE=h.prototype.writeFloatBE,i.prototype.writeDoubleLE=h.prototype.writeDoubleLE,i.prototype.writeDoubleBE=h.prototype.writeDoubleBE},{assert:1,"./buffer_ieee754":8,"base64-js":9}],9:[function(e,t){!function(){"use strict";function e(e){var t,n,r,s,o,a;if(e.length%4>0)throw"Invalid string. Length must be a multiple of 4";for(o=e.indexOf("="),o=o>0?e.length-o:0,a=[],r=o>0?e.length-4:e.length,t=0,n=0;r>t;t+=4,n+=3)s=i.indexOf(e[t])<<18|i.indexOf(e[t+1])<<12|i.indexOf(e[t+2])<<6|i.indexOf(e[t+3]),a.push((16711680&s)>>16),a.push((65280&s)>>8),a.push(255&s);return 2===o?(s=i.indexOf(e[t])<<2|i.indexOf(e[t+1])>>4,a.push(255&s)):1===o&&(s=i.indexOf(e[t])<<10|i.indexOf(e[t+1])<<4|i.indexOf(e[t+2])>>2,a.push(s>>8&255),a.push(255&s)),a}function n(e){function t(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}var n,r,s,o=e.length%3,a="";for(n=0,s=e.length-o;s>n;n+=3)r=(e[n]<<16)+(e[n+1]<<8)+e[n+2],a+=t(r);switch(o){case 1:r=e[e.length-1],a+=i[r>>2],a+=i[r<<4&63],a+="==";break;case 2:r=(e[e.length-2]<<8)+e[e.length-1],a+=i[r>>10],a+=i[r>>4&63],a+=i[r<<2&63],a+="="}return a}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports.toByteArray=e,t.exports.fromByteArray=n}()},{}]},{},[]),t.exports=e("buffer-browserify")},{}],117:[function(e,t){!function(n){(function(){function i(e,t,n){var i=t&&n||0,r=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>r&&(t[i+r++]=m[e])});16>r;)t[i+r++]=0;return t}function r(e,t){var n=t||0,i=p;return i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+"-"+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]+i[e[n++]]}function s(e,t,n){var i=t&&n||0,s=t||[];e=e||{};var o=null!=e.clockseq?e.clockseq:b,a=null!=e.msecs?e.msecs:(new Date).getTime(),l=null!=e.nsecs?e.nsecs:x+1,c=a-w+(l-x)/1e4;if(0>c&&null==e.clockseq&&(o=o+1&16383),(0>c||a>w)&&null==e.nsecs&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");w=a,x=l,b=o,a+=122192928e5;var u=(1e4*(268435455&a)+l)%4294967296;s[i++]=u>>>24&255,s[i++]=u>>>16&255,s[i++]=u>>>8&255,s[i++]=255&u;var h=a/4294967296*1e4&268435455;s[i++]=h>>>8&255,s[i++]=255&h,s[i++]=h>>>24&15|16,s[i++]=h>>>16&255,s[i++]=o>>>8|128,s[i++]=255&o;for(var d=e.node||y,f=0;6>f;f++)s[i+f]=d[f];return t?t:r(s)}function o(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"==e?new f(16):null,e=null),e=e||{};var s=e.random||(e.rng||a)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t)for(var o=0;16>o;o++)t[i+o]=s[o];return t||r(s)}var a,l=this;if("function"==typeof e)try{var c=e("crypto").randomBytes;a=c&&function(){return c(16)}}catch(u){}if(!a&&l.crypto&&crypto.getRandomValues){var h=new Uint8Array(16);a=function(){return crypto.getRandomValues(h),h}}if(!a){var d=new Array(16);a=function(){for(var e,t=0;16>t;t++)0===(3&t)&&(e=4294967296*Math.random()),d[t]=e>>>((3&t)<<3)&255;return d}}for(var f="function"==typeof n?n:Array,p=[],m={},g=0;256>g;g++)p[g]=(g+256).toString(16).substr(1),m[p[g]]=g;var v=a(),y=[1|v[0],v[1],v[2],v[3],v[4],v[5]],b=16383&(v[6]<<8|v[7]),w=0,x=0,k=o;if(k.v1=s,k.v4=o,k.parse=i,k.unparse=r,k.BufferClass=f,"function"==typeof define&&define.amd)define(function(){return k});else if("undefined"!=typeof t&&t.exports)t.exports=k;else{var _=l.uuid;k.noConflict=function(){return l.uuid=_,k},l.uuid=k}}).call(this)}(e("__browserify_Buffer").Buffer)},{__browserify_Buffer:121,crypto:122}],122:[function(e,t,n){!function(){function t(){var e=[].slice.call(arguments).join(" ");throw new Error([e,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function i(e,t){for(var n in e)t(e[n],n)}var r=e("buffer").Buffer,s=e("./sha"),o=e("./rng"),a=e("./md5"),l={sha1:{hex:s.hex_sha1,binary:s.b64_sha1,ascii:s.str_sha1},md5:{hex:a.hex_md5,binary:a.b64_md5,ascii:a.any_md5}};n.createHash=function(e){e=e||"sha1",l[e]||t("algorithm:",e,"is not yet supported");var n="",i=l[e];return{update:function(e){return n+=e,this},digest:function(r){r=r||"binary";var s;(s=i[r])||t("encoding:",r,"is not yet supported for algorithm",e);var o=s(n);return n=null,o}}},n.randomBytes=function(e,t){if(!t||!t.call)return new r(o(e));try{t.call(this,void 0,new r(o(e)))}catch(n){t(n)}},i(["createCredentials","createHmac","createCypher","createCypheriv","createDecipher","createDecipheriv","createSign","createVerify","createDeffieHellman","pbkdf2"],function(e){n[e]=function(){t("sorry,",e,"is not implemented yet")}})}()},{"./md5":126,"./rng":125,"./sha":124,buffer:123}],124:[function(e,t,n){function i(e){return v(c(m(e),e.length*x))}function r(e){return y(c(m(e),e.length*x))}function s(e){return g(c(m(e),e.length*x))}function o(e,t){return v(d(e,t))}function a(e,t){return y(d(e,t))}function l(e,t){return g(d(e,t))}function c(e,t){e[t>>5]|=128<<24-t%32,e[(t+64>>9<<4)+15]=t;for(var n=Array(80),i=1732584193,r=-271733879,s=-1732584194,o=271733878,a=-1009589776,l=0;l<e.length;l+=16){for(var c=i,d=r,m=s,g=o,v=a,y=0;80>y;y++){n[y]=16>y?e[l+y]:p(n[y-3]^n[y-8]^n[y-14]^n[y-16],1);var b=f(f(p(i,5),u(y,r,s,o)),f(f(a,n[y]),h(y)));a=o,o=s,s=p(r,30),r=i,i=b}i=f(i,c),r=f(r,d),s=f(s,m),o=f(o,g),a=f(a,v)}return Array(i,r,s,o,a)}function u(e,t,n,i){return 20>e?t&n|~t&i:40>e?t^n^i:60>e?t&n|t&i|n&i:t^n^i}function h(e){return 20>e?1518500249:40>e?1859775393:60>e?-1894007588:-899497514}function d(e,t){var n=m(e);n.length>16&&(n=c(n,e.length*x));for(var i=Array(16),r=Array(16),s=0;16>s;s++)i[s]=909522486^n[s],r[s]=1549556828^n[s];var o=c(i.concat(m(t)),512+t.length*x);return c(r.concat(o),672)}function f(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n}function p(e,t){return e<<t|e>>>32-t}function m(e){for(var t=Array(),n=(1<<x)-1,i=0;i<e.length*x;i+=x)t[i>>5]|=(e.charCodeAt(i/x)&n)<<32-x-i%32;return t}function g(e){for(var t="",n=(1<<x)-1,i=0;i<32*e.length;i+=x)t+=String.fromCharCode(e[i>>5]>>>32-x-i%32&n);return t}function v(e){for(var t=b?"0123456789ABCDEF":"0123456789abcdef",n="",i=0;i<4*e.length;i++)n+=t.charAt(e[i>>2]>>8*(3-i%4)+4&15)+t.charAt(e[i>>2]>>8*(3-i%4)&15);return n}function y(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="",i=0;i<4*e.length;i+=3)for(var r=(e[i>>2]>>8*(3-i%4)&255)<<16|(e[i+1>>2]>>8*(3-(i+1)%4)&255)<<8|e[i+2>>2]>>8*(3-(i+2)%4)&255,s=0;4>s;s++)n+=8*i+6*s>32*e.length?w:t.charAt(r>>6*(3-s)&63);return n}n.hex_sha1=i,n.b64_sha1=r,n.str_sha1=s,n.hex_hmac_sha1=o,n.b64_hmac_sha1=a,n.str_hmac_sha1=l;var b=0,w="",x=8},{}],125:[function(e,t){!function(){var e,n,i=this;if(e=function(e){for(var t,t,n=new Array(e),i=0;e>i;i++)0==(3&i)&&(t=4294967296*Math.random()),n[i]=t>>>((3&i)<<3)&255;return n},i.crypto&&crypto.getRandomValues){var r=new Uint32Array(4);n=function(e){var t=new Array(e);crypto.getRandomValues(r);for(var n=0;e>n;n++)t[n]=r[n>>2]>>>8*(3&n)&255;return t}}t.exports=n||e}()},{}],126:[function(e,t,n){function i(e){return a(o(u(e)))}function r(e){return l(o(u(e)))}function s(e,t){return c(o(u(e)),t)}function o(e){return d(f(h(e),8*e.length))}function a(e){try{}catch(t){x=0}for(var n,i=x?"0123456789ABCDEF":"0123456789abcdef",r="",s=0;s<e.length;s++)n=e.charCodeAt(s),r+=i.charAt(n>>>4&15)+i.charAt(15&n);return r}function l(e){try{}catch(t){k=""}for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",r=e.length,s=0;r>s;s+=3)for(var o=e.charCodeAt(s)<<16|(r>s+1?e.charCodeAt(s+1)<<8:0)|(r>s+2?e.charCodeAt(s+2):0),a=0;4>a;a++)i+=8*s+6*a>8*e.length?k:n.charAt(o>>>6*(3-a)&63);return i}function c(e,t){var n,i,r,s,o,a=t.length,l=Array(Math.ceil(e.length/2));for(n=0;n<l.length;n++)l[n]=e.charCodeAt(2*n)<<8|e.charCodeAt(2*n+1);var c=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),u=Array(c);for(i=0;c>i;i++){for(o=Array(),s=0,n=0;n<l.length;n++)s=(s<<16)+l[n],r=Math.floor(s/a),s-=r*a,(o.length>0||r>0)&&(o[o.length]=r);u[i]=s,l=o}var h="";for(n=u.length-1;n>=0;n--)h+=t.charAt(u[n]);return h}function u(e){for(var t,n,i="",r=-1;++r<e.length;)t=e.charCodeAt(r),n=r+1<e.length?e.charCodeAt(r+1):0,t>=55296&&56319>=t&&n>=56320&&57343>=n&&(t=65536+((1023&t)<<10)+(1023&n),r++),127>=t?i+=String.fromCharCode(t):2047>=t?i+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?i+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(i+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return i}function h(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(var n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t}function d(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t}function f(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,i=-271733879,r=-1732584194,s=271733878,o=0;o<e.length;o+=16){var a=n,l=i,c=r,u=s;n=m(n,i,r,s,e[o+0],7,-680876936),s=m(s,n,i,r,e[o+1],12,-389564586),r=m(r,s,n,i,e[o+2],17,606105819),i=m(i,r,s,n,e[o+3],22,-1044525330),n=m(n,i,r,s,e[o+4],7,-176418897),s=m(s,n,i,r,e[o+5],12,1200080426),r=m(r,s,n,i,e[o+6],17,-1473231341),i=m(i,r,s,n,e[o+7],22,-45705983),n=m(n,i,r,s,e[o+8],7,1770035416),s=m(s,n,i,r,e[o+9],12,-1958414417),r=m(r,s,n,i,e[o+10],17,-42063),i=m(i,r,s,n,e[o+11],22,-1990404162),n=m(n,i,r,s,e[o+12],7,1804603682),s=m(s,n,i,r,e[o+13],12,-40341101),r=m(r,s,n,i,e[o+14],17,-1502002290),i=m(i,r,s,n,e[o+15],22,1236535329),n=g(n,i,r,s,e[o+1],5,-165796510),s=g(s,n,i,r,e[o+6],9,-1069501632),r=g(r,s,n,i,e[o+11],14,643717713),i=g(i,r,s,n,e[o+0],20,-373897302),n=g(n,i,r,s,e[o+5],5,-701558691),s=g(s,n,i,r,e[o+10],9,38016083),r=g(r,s,n,i,e[o+15],14,-660478335),i=g(i,r,s,n,e[o+4],20,-405537848),n=g(n,i,r,s,e[o+9],5,568446438),s=g(s,n,i,r,e[o+14],9,-1019803690),r=g(r,s,n,i,e[o+3],14,-187363961),i=g(i,r,s,n,e[o+8],20,1163531501),n=g(n,i,r,s,e[o+13],5,-1444681467),s=g(s,n,i,r,e[o+2],9,-51403784),r=g(r,s,n,i,e[o+7],14,1735328473),i=g(i,r,s,n,e[o+12],20,-1926607734),n=v(n,i,r,s,e[o+5],4,-378558),s=v(s,n,i,r,e[o+8],11,-2022574463),r=v(r,s,n,i,e[o+11],16,1839030562),i=v(i,r,s,n,e[o+14],23,-35309556),n=v(n,i,r,s,e[o+1],4,-1530992060),s=v(s,n,i,r,e[o+4],11,1272893353),r=v(r,s,n,i,e[o+7],16,-155497632),i=v(i,r,s,n,e[o+10],23,-1094730640),n=v(n,i,r,s,e[o+13],4,681279174),s=v(s,n,i,r,e[o+0],11,-358537222),r=v(r,s,n,i,e[o+3],16,-722521979),i=v(i,r,s,n,e[o+6],23,76029189),n=v(n,i,r,s,e[o+9],4,-640364487),s=v(s,n,i,r,e[o+12],11,-421815835),r=v(r,s,n,i,e[o+15],16,530742520),i=v(i,r,s,n,e[o+2],23,-995338651),n=y(n,i,r,s,e[o+0],6,-198630844),s=y(s,n,i,r,e[o+7],10,1126891415),r=y(r,s,n,i,e[o+14],15,-1416354905),i=y(i,r,s,n,e[o+5],21,-57434055),n=y(n,i,r,s,e[o+12],6,1700485571),s=y(s,n,i,r,e[o+3],10,-1894986606),r=y(r,s,n,i,e[o+10],15,-1051523),i=y(i,r,s,n,e[o+1],21,-2054922799),n=y(n,i,r,s,e[o+8],6,1873313359),s=y(s,n,i,r,e[o+15],10,-30611744),r=y(r,s,n,i,e[o+6],15,-1560198380),i=y(i,r,s,n,e[o+13],21,1309151649),n=y(n,i,r,s,e[o+4],6,-145523070),s=y(s,n,i,r,e[o+11],10,-1120210379),r=y(r,s,n,i,e[o+2],15,718787259),i=y(i,r,s,n,e[o+9],21,-343485551),n=b(n,a),i=b(i,l),r=b(r,c),s=b(s,u)}return Array(n,i,r,s)}function p(e,t,n,i,r,s){return b(w(b(b(t,e),b(i,s)),r),n)}function m(e,t,n,i,r,s,o){return p(t&n|~t&i,e,t,r,s,o)}function g(e,t,n,i,r,s,o){return p(t&i|n&~i,e,t,r,s,o)}function v(e,t,n,i,r,s,o){return p(t^n^i,e,t,r,s,o)}function y(e,t,n,i,r,s,o){return p(n^(t|~i),e,t,r,s,o)}function b(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n}function w(e,t){return e<<t|e>>>32-t}var x=0,k="";n.hex_md5=i,n.b64_md5=r,n.any_md5=s},{}],127:[function(e,t){!function(){function n(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}function i(e,t){return void 0===t?""+t:"number"!=typeof t||!isNaN(t)&&isFinite(t)?"function"==typeof t||t instanceof RegExp?t.toString():t:t.toString()}function r(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function s(e,t,n,i,r){throw new g.AssertionError({message:n,actual:e,expected:t,operator:i,stackStartFunction:r})}function o(e,t){e||s(e,!0,t,"==",g.ok)}function a(e,t){if(e===t)return!0;if(p.isBuffer(e)&&p.isBuffer(t)){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():"object"!=typeof e&&"object"!=typeof t?e==t:u(e,t)}function l(e){return null===e||void 0===e}function c(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function u(e,t){if(l(e)||l(t))return!1;if(e.prototype!==t.prototype)return!1;if(c(e))return c(t)?(e=m.call(e),t=m.call(t),a(e,t)):!1;try{var i,r,s=n(e),o=n(t)}catch(u){return!1}if(s.length!=o.length)return!1;for(s.sort(),o.sort(),r=s.length-1;r>=0;r--)if(s[r]!=o[r])return!1;for(r=s.length-1;r>=0;r--)if(i=s[r],!a(e[i],t[i]))return!1;return!0}function h(e,t){return e&&t?t instanceof RegExp?t.test(e):e instanceof t?!0:t.call({},e)===!0?!0:!1:!1}function d(e,t,n,i){var r;"string"==typeof n&&(i=n,n=null);try{t()}catch(o){r=o}if(i=(n&&n.name?" ("+n.name+").":".")+(i?" "+i:"."),e&&!r&&s("Missing expected exception"+i),!e&&h(r,n)&&s("Got unwanted exception"+i),e&&r&&n&&!h(r,n)||!e&&r)throw r}var f=e("util"),p=e("buffer").Buffer,m=Array.prototype.slice,g=t.exports=o;g.AssertionError=function(e){this.name="AssertionError",this.message=e.message,this.actual=e.actual,this.expected=e.expected,this.operator=e.operator;var t=e.stackStartFunction||s;Error.captureStackTrace&&Error.captureStackTrace(this,t)},f.inherits(g.AssertionError,Error),g.AssertionError.prototype.toString=function(){return this.message?[this.name+":",this.message].join(" "):[this.name+":",r(JSON.stringify(this.actual,i),128),this.operator,r(JSON.stringify(this.expected,i),128)].join(" ")},g.AssertionError.__proto__=Error.prototype,g.fail=s,g.ok=o,g.equal=function(e,t,n){e!=t&&s(e,t,n,"==",g.equal)},g.notEqual=function(e,t,n){e==t&&s(e,t,n,"!=",g.notEqual)},g.deepEqual=function(e,t,n){a(e,t)||s(e,t,n,"deepEqual",g.deepEqual)},g.notDeepEqual=function(e,t,n){a(e,t)&&s(e,t,n,"notDeepEqual",g.notDeepEqual)},g.strictEqual=function(e,t,n){e!==t&&s(e,t,n,"===",g.strictEqual)},g.notStrictEqual=function(e,t,n){e===t&&s(e,t,n,"!==",g.notStrictEqual)},g.throws=function(){d.apply(this,[!0].concat(m.call(arguments)))},g.doesNotThrow=function(){d.apply(this,[!1].concat(m.call(arguments)))},g.ifError=function(e){if(e)throw e}}()},{buffer:123,util:22}],128:[function(e,t,n){n.readIEEE754=function(e,t,n,i,r){var s,o,a=8*r-i-1,l=(1<<a)-1,c=l>>1,u=-7,h=n?0:r-1,d=n?1:-1,f=e[t+h];for(h+=d,s=f&(1<<-u)-1,f>>=-u,u+=a;u>0;s=256*s+e[t+h],h+=d,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===s)s=1-c;
else{if(s===l)return o?0/0:1/0*(f?-1:1);o+=Math.pow(2,i),s-=c}return(f?-1:1)*o*Math.pow(2,s-i)},n.writeIEEE754=function(e,t,n,i,r,s){var o,a,l,c=8*s-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?s-1:0,p=i?-1:1,m=0>t||0===t&&0>1/t?1:0;for(t=Math.abs(t),isNaN(t)||1/0===t?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),t+=o+h>=1?d/l:d*Math.pow(2,1-h),t*l>=2&&(o++,l/=2),o+h>=u?(a=0,o=u):o+h>=1?(a=(t*l-1)*Math.pow(2,r),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[n+f]=255&a,f+=p,a/=256,r-=8);for(o=o<<r|a,c+=r;c>0;e[n+f]=255&o,f+=p,o/=256,c-=8);e[n+f-p]|=128*m}},{}],123:[function(e,t,n){!function(){function t(e,n,r){if(!(this instanceof t))return new t(e,n,r);this.parent=this,this.offset=0;var o;if("number"==typeof r)this.length=i(n),this.offset=r;else{switch(o=typeof e){case"number":this.length=i(e);break;case"string":this.length=t.byteLength(e,n);break;case"object":this.length=i(e.length);break;default:throw new Error("First argument needs to be a number, array or string.")}if(s(e))for(var a=0;a<this.length;a++)this[a]=e instanceof t?e.readUInt8(a):e[a];else if("string"==o)this.length=this.write(e,0,n);else if("number"===o)for(var a=0;a<this.length;a++)this[a]=0}}function i(e){return e=~~Math.ceil(+e),0>e?0:e}function r(e){return(Array.isArray||function(e){return"[object Array]"=={}.toString.apply(e)})(e)}function s(e){return r(e)||t.isBuffer(e)||e&&"object"==typeof e&&"number"==typeof e.length}function o(e){return 16>e?"0"+e.toString(16):e.toString(16)}function a(e){for(var t=[],n=0;n<e.length;n++)if(e.charCodeAt(n)<=127)t.push(e.charCodeAt(n));else for(var i=encodeURIComponent(e.charAt(n)).substr(1).split("%"),r=0;r<i.length;r++)t.push(parseInt(i[r],16));return t}function l(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t}function c(t){return e("base64-js").toByteArray(t)}function u(e,t,n,i){for(var r=0;i>r&&!(r+n>=t.length||r>=e.length);)t[r+n]=e[r],r++;return r}function h(e){try{return decodeURIComponent(e)}catch(t){return String.fromCharCode(65533)}}function d(e,t,n,i){var r=0;return i||($.ok("boolean"==typeof n,"missing or invalid endian"),$.ok(void 0!==t&&null!==t,"missing offset"),$.ok(t+1<e.length,"Trying to read beyond buffer length")),t>=e.length?0:(n?(r=e[t]<<8,t+1<e.length&&(r|=e[t+1])):(r=e[t],t+1<e.length&&(r|=e[t+1]<<8)),r)}function f(e,t,n,i){var r=0;return i||($.ok("boolean"==typeof n,"missing or invalid endian"),$.ok(void 0!==t&&null!==t,"missing offset"),$.ok(t+3<e.length,"Trying to read beyond buffer length")),t>=e.length?0:(n?(t+1<e.length&&(r=e[t+1]<<16),t+2<e.length&&(r|=e[t+2]<<8),t+3<e.length&&(r|=e[t+3]),r+=e[t]<<24>>>0):(t+2<e.length&&(r=e[t+2]<<16),t+1<e.length&&(r|=e[t+1]<<8),r|=e[t],t+3<e.length&&(r+=e[t+3]<<24>>>0)),r)}function p(e,t,n,i){var r,s;return i||($.ok("boolean"==typeof n,"missing or invalid endian"),$.ok(void 0!==t&&null!==t,"missing offset"),$.ok(t+1<e.length,"Trying to read beyond buffer length")),s=d(e,t,n,i),r=32768&s,r?-1*(65535-s+1):s}function m(e,t,n,i){var r,s;return i||($.ok("boolean"==typeof n,"missing or invalid endian"),$.ok(void 0!==t&&null!==t,"missing offset"),$.ok(t+3<e.length,"Trying to read beyond buffer length")),s=f(e,t,n,i),r=2147483648&s,r?-1*(4294967295-s+1):s}function g(t,n,i,r){return r||($.ok("boolean"==typeof i,"missing or invalid endian"),$.ok(n+3<t.length,"Trying to read beyond buffer length")),e("./buffer_ieee754").readIEEE754(t,n,i,23,4)}function v(t,n,i,r){return r||($.ok("boolean"==typeof i,"missing or invalid endian"),$.ok(n+7<t.length,"Trying to read beyond buffer length")),e("./buffer_ieee754").readIEEE754(t,n,i,52,8)}function y(e,t){$.ok("number"==typeof e,"cannot write a non-number as a number"),$.ok(e>=0,"specified a negative value for writing an unsigned value"),$.ok(t>=e,"value is larger than maximum value for type"),$.ok(Math.floor(e)===e,"value has a fractional component")}function b(e,t,n,i,r){r||($.ok(void 0!==t&&null!==t,"missing value"),$.ok("boolean"==typeof i,"missing or invalid endian"),$.ok(void 0!==n&&null!==n,"missing offset"),$.ok(n+1<e.length,"trying to write beyond buffer length"),y(t,65535));for(var s=0;s<Math.min(e.length-n,2);s++)e[n+s]=(t&255<<8*(i?1-s:s))>>>8*(i?1-s:s)}function w(e,t,n,i,r){r||($.ok(void 0!==t&&null!==t,"missing value"),$.ok("boolean"==typeof i,"missing or invalid endian"),$.ok(void 0!==n&&null!==n,"missing offset"),$.ok(n+3<e.length,"trying to write beyond buffer length"),y(t,4294967295));for(var s=0;s<Math.min(e.length-n,4);s++)e[n+s]=t>>>8*(i?3-s:s)&255}function x(e,t,n){$.ok("number"==typeof e,"cannot write a non-number as a number"),$.ok(t>=e,"value larger than maximum allowed value"),$.ok(e>=n,"value smaller than minimum allowed value"),$.ok(Math.floor(e)===e,"value has a fractional component")}function k(e,t,n){$.ok("number"==typeof e,"cannot write a non-number as a number"),$.ok(t>=e,"value larger than maximum allowed value"),$.ok(e>=n,"value smaller than minimum allowed value")}function _(e,t,n,i,r){r||($.ok(void 0!==t&&null!==t,"missing value"),$.ok("boolean"==typeof i,"missing or invalid endian"),$.ok(void 0!==n&&null!==n,"missing offset"),$.ok(n+1<e.length,"Trying to write beyond buffer length"),x(t,32767,-32768)),t>=0?b(e,t,n,i,r):b(e,65535+t+1,n,i,r)}function E(e,t,n,i,r){r||($.ok(void 0!==t&&null!==t,"missing value"),$.ok("boolean"==typeof i,"missing or invalid endian"),$.ok(void 0!==n&&null!==n,"missing offset"),$.ok(n+3<e.length,"Trying to write beyond buffer length"),x(t,2147483647,-2147483648)),t>=0?w(e,t,n,i,r):w(e,4294967295+t+1,n,i,r)}function C(t,n,i,r,s){s||($.ok(void 0!==n&&null!==n,"missing value"),$.ok("boolean"==typeof r,"missing or invalid endian"),$.ok(void 0!==i&&null!==i,"missing offset"),$.ok(i+3<t.length,"Trying to write beyond buffer length"),k(n,3.4028234663852886e38,-3.4028234663852886e38)),e("./buffer_ieee754").writeIEEE754(t,n,i,r,23,4)}function S(t,n,i,r,s){s||($.ok(void 0!==n&&null!==n,"missing value"),$.ok("boolean"==typeof r,"missing or invalid endian"),$.ok(void 0!==i&&null!==i,"missing offset"),$.ok(i+7<t.length,"Trying to write beyond buffer length"),k(n,1.7976931348623157e308,-1.7976931348623157e308)),e("./buffer_ieee754").writeIEEE754(t,n,i,r,52,8)}var $=e("assert");n.Buffer=t,n.SlowBuffer=t,t.poolSize=8192,n.INSPECT_MAX_BYTES=50,t.prototype.get=function(e){if(0>e||e>=this.length)throw new Error("oob");return this[e]},t.prototype.set=function(e,t){if(0>e||e>=this.length)throw new Error("oob");return this[e]=t},t.byteLength=function(e,t){switch(t||"utf8"){case"hex":return e.length/2;case"utf8":case"utf-8":return a(e).length;case"ascii":case"binary":return e.length;case"base64":return c(e).length;default:throw new Error("Unknown encoding")}},t.prototype.utf8Write=function(e,n,i){return t._charsWritten=u(a(e),this,n,i)},t.prototype.asciiWrite=function(e,n,i){return t._charsWritten=u(l(e),this,n,i)},t.prototype.binaryWrite=t.prototype.asciiWrite,t.prototype.base64Write=function(e,n,i){return t._charsWritten=u(c(e),this,n,i)},t.prototype.base64Slice=function(){var t=Array.prototype.slice.apply(this,arguments);return e("base64-js").fromByteArray(t)},t.prototype.utf8Slice=function(){for(var e=Array.prototype.slice.apply(this,arguments),t="",n="",i=0;i<e.length;)e[i]<=127?(t+=h(n)+String.fromCharCode(e[i]),n=""):n+="%"+e[i].toString(16),i++;return t+h(n)},t.prototype.asciiSlice=function(){for(var e=Array.prototype.slice.apply(this,arguments),t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},t.prototype.binarySlice=t.prototype.asciiSlice,t.prototype.inspect=function(){for(var e=[],t=this.length,i=0;t>i;i++)if(e[i]=o(this[i]),i==n.INSPECT_MAX_BYTES){e[i+1]="...";break}return"<Buffer "+e.join(" ")+">"},t.prototype.hexSlice=function(e,t){var n=this.length;(!e||0>e)&&(e=0),(!t||0>t||t>n)&&(t=n);for(var i="",r=e;t>r;r++)i+=o(this[r]);return i},t.prototype.toString=function(e,t,n){if(e=String(e||"utf8").toLowerCase(),t=+t||0,"undefined"==typeof n&&(n=this.length),+n==t)return"";switch(e){case"hex":return this.hexSlice(t,n);case"utf8":case"utf-8":return this.utf8Slice(t,n);case"ascii":return this.asciiSlice(t,n);case"binary":return this.binarySlice(t,n);case"base64":return this.base64Slice(t,n);case"ucs2":case"ucs-2":return this.ucs2Slice(t,n);default:throw new Error("Unknown encoding")}},t.prototype.hexWrite=function(e,n,i){n=+n||0;var r=this.length-n;i?(i=+i,i>r&&(i=r)):i=r;var s=e.length;if(s%2)throw new Error("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;i>o;o++){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))throw new Error("Invalid hex string");this[n+o]=a}return t._charsWritten=2*o,o},t.prototype.write=function(e,t,n,i){if(isFinite(t))isFinite(n)||(i=n,n=void 0);else{var r=i;i=t,t=n,n=r}t=+t||0;var s=this.length-t;switch(n?(n=+n,n>s&&(n=s)):n=s,i=String(i||"utf8").toLowerCase()){case"hex":return this.hexWrite(e,t,n);case"utf8":case"utf-8":return this.utf8Write(e,t,n);case"ascii":return this.asciiWrite(e,t,n);case"binary":return this.binaryWrite(e,t,n);case"base64":return this.base64Write(e,t,n);case"ucs2":case"ucs-2":return this.ucs2Write(e,t,n);default:throw new Error("Unknown encoding")}},t.prototype.slice=function(e,n){if(void 0===n&&(n=this.length),n>this.length)throw new Error("oob");if(e>n)throw new Error("oob");return new t(this,n-e,+e)},t.prototype.copy=function(e,t,n,i){var r=this;if(n||(n=0),(void 0===i||isNaN(i))&&(i=this.length),t||(t=0),n>i)throw new Error("sourceEnd < sourceStart");if(i===n)return 0;if(0==e.length||0==r.length)return 0;if(0>t||t>=e.length)throw new Error("targetStart out of bounds");if(0>n||n>=r.length)throw new Error("sourceStart out of bounds");if(0>i||i>r.length)throw new Error("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);for(var s=[],o=n;i>o;o++)$.ok("undefined"!=typeof this[o],"copying undefined buffer bytes!"),s.push(this[o]);for(var o=t;o<t+s.length;o++)e[o]=s[o-t]},t.prototype.fill=function(e,t,n){if(e||(e=0),t||(t=0),n||(n=this.length),"string"==typeof e&&(e=e.charCodeAt(0)),"number"!=typeof e||isNaN(e))throw new Error("value is not a number");if(t>n)throw new Error("end < start");if(n===t)return 0;if(0==this.length)return 0;if(0>t||t>=this.length)throw new Error("start out of bounds");if(0>n||n>this.length)throw new Error("end out of bounds");for(var i=t;n>i;i++)this[i]=e},t.isBuffer=function(e){return e instanceof t||e instanceof t},t.concat=function(e,n){if(!r(e))throw new Error("Usage: Buffer.concat(list, [totalLength])\n       list should be an Array.");if(0===e.length)return new t(0);if(1===e.length)return e[0];if("number"!=typeof n){n=0;for(var i=0;i<e.length;i++){var s=e[i];n+=s.length}}for(var o=new t(n),a=0,i=0;i<e.length;i++){var s=e[i];s.copy(o,a),a+=s.length}return o},t.prototype.readUInt8=function(e,t){var n=this;return t||($.ok(void 0!==e&&null!==e,"missing offset"),$.ok(e<n.length,"Trying to read beyond buffer length")),e>=n.length?void 0:n[e]},t.prototype.readUInt16LE=function(e,t){return d(this,e,!1,t)},t.prototype.readUInt16BE=function(e,t){return d(this,e,!0,t)},t.prototype.readUInt32LE=function(e,t){return f(this,e,!1,t)},t.prototype.readUInt32BE=function(e,t){return f(this,e,!0,t)},t.prototype.readInt8=function(e,t){var n,i=this;return t||($.ok(void 0!==e&&null!==e,"missing offset"),$.ok(e<i.length,"Trying to read beyond buffer length")),e>=i.length?void 0:(n=128&i[e],n?-1*(255-i[e]+1):i[e])},t.prototype.readInt16LE=function(e,t){return p(this,e,!1,t)},t.prototype.readInt16BE=function(e,t){return p(this,e,!0,t)},t.prototype.readInt32LE=function(e,t){return m(this,e,!1,t)},t.prototype.readInt32BE=function(e,t){return m(this,e,!0,t)},t.prototype.readFloatLE=function(e,t){return g(this,e,!1,t)},t.prototype.readFloatBE=function(e,t){return g(this,e,!0,t)},t.prototype.readDoubleLE=function(e,t){return v(this,e,!1,t)},t.prototype.readDoubleBE=function(e,t){return v(this,e,!0,t)},t.prototype.writeUInt8=function(e,t,n){var i=this;n||($.ok(void 0!==e&&null!==e,"missing value"),$.ok(void 0!==t&&null!==t,"missing offset"),$.ok(t<i.length,"trying to write beyond buffer length"),y(e,255)),t<i.length&&(i[t]=e)},t.prototype.writeUInt16LE=function(e,t,n){b(this,e,t,!1,n)},t.prototype.writeUInt16BE=function(e,t,n){b(this,e,t,!0,n)},t.prototype.writeUInt32LE=function(e,t,n){w(this,e,t,!1,n)},t.prototype.writeUInt32BE=function(e,t,n){w(this,e,t,!0,n)},t.prototype.writeInt8=function(e,t,n){var i=this;n||($.ok(void 0!==e&&null!==e,"missing value"),$.ok(void 0!==t&&null!==t,"missing offset"),$.ok(t<i.length,"Trying to write beyond buffer length"),x(e,127,-128)),e>=0?i.writeUInt8(e,t,n):i.writeUInt8(255+e+1,t,n)},t.prototype.writeInt16LE=function(e,t,n){_(this,e,t,!1,n)},t.prototype.writeInt16BE=function(e,t,n){_(this,e,t,!0,n)},t.prototype.writeInt32LE=function(e,t,n){E(this,e,t,!1,n)},t.prototype.writeInt32BE=function(e,t,n){E(this,e,t,!0,n)},t.prototype.writeFloatLE=function(e,t,n){C(this,e,t,!1,n)},t.prototype.writeFloatBE=function(e,t,n){C(this,e,t,!0,n)},t.prototype.writeDoubleLE=function(e,t,n){S(this,e,t,!1,n)},t.prototype.writeDoubleBE=function(e,t,n){S(this,e,t,!0,n)}}()},{"./buffer_ieee754":128,assert:127,"base64-js":129}],129:[function(e,t){!function(){"use strict";function e(e){var t,n,r,s,o,a;if(e.length%4>0)throw"Invalid string. Length must be a multiple of 4";for(o=e.indexOf("="),o=o>0?e.length-o:0,a=[],r=o>0?e.length-4:e.length,t=0,n=0;r>t;t+=4,n+=3)s=i.indexOf(e[t])<<18|i.indexOf(e[t+1])<<12|i.indexOf(e[t+2])<<6|i.indexOf(e[t+3]),a.push((16711680&s)>>16),a.push((65280&s)>>8),a.push(255&s);return 2===o?(s=i.indexOf(e[t])<<2|i.indexOf(e[t+1])>>4,a.push(255&s)):1===o&&(s=i.indexOf(e[t])<<10|i.indexOf(e[t+1])<<4|i.indexOf(e[t+2])>>2,a.push(s>>8&255),a.push(255&s)),a}function n(e){function t(e){return i[e>>18&63]+i[e>>12&63]+i[e>>6&63]+i[63&e]}var n,r,s,o=e.length%3,a="";for(n=0,s=e.length-o;s>n;n+=3)r=(e[n]<<16)+(e[n+1]<<8)+e[n+2],a+=t(r);switch(o){case 1:r=e[e.length-1],a+=i[r>>2],a+=i[r<<4&63],a+="==";break;case 2:r=(e[e.length-2]<<8)+e[e.length-1],a+=i[r>>10],a+=i[r>>4&63],a+=i[r<<2&63],a+="="}return a}var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t.exports.toByteArray=e,t.exports.fromByteArray=n}()},{}]},{},[1,38,2,3,26,27,29,16,19,20,"c2TOuZ",64,4,"GeNGfE",32,5,109,106,35,36,37,39,119,65,88,40,6,105,33,34,108,41,60,92,89,91,90,93,118,107,7,42,8,43,44,28,82,103,46,104,47,9,94,114,69,96,97,45,48,49,50,51,52,53,54,101,102,99,100,95,10,55,111,110,66,71,78,113,56,58,59,61,72,73,63,67,68,112,83,62,81,74,76,75,77,79,80,11,70,57,30,31,12,21,13,84,86,85,87,14]);